(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),data=require("./data"),sui=require("./sui"),EditorAccessibilityMenu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.openJavaScript=function(){pxt.tickEvent("accmenu.editor.openJS",void 0,{interactiveConsent:!0}),this.props.parent.openJavaScript()},e.prototype.selectLang=function(){pxt.tickEvent("accmenu.editor.importdialog",void 0,{interactiveConsent:!0}),this.props.parent.selectLang()},e.prototype.toggleHighContrast=function(){pxt.tickEvent("accmenu.editor.togglecontrast",void 0,{interactiveConsent:!0}),this.props.parent.toggleHighContrast()},e.prototype.goHome=function(){pxt.tickEvent("accmenu.editor.home",void 0,{interactiveConsent:!0}),this.props.parent.exitAndSave()},e.prototype.componentWillReceiveProps=function(t){var e={};void 0!=t.highContrast&&(e.highContrast=t.highContrast),Object.keys(e).length>0&&this.setState(e)},e.prototype.shouldComponentUpdate=function(t,e,n){return this.state.highContrast!=e.highContrast},e.prototype.renderCore=function(){var t=this,e=this.props.parent.state.highContrast,n=pxt.appTarget.appTheme;return React.createElement("div",{className:"ui accessibleMenu borderless fixed menu",role:"menubar"},React.createElement(sui.Item,{class:(n.invertedMenu?"inverted":"")+" menu",role:"menuitem",icon:"xicon js",text:lf("Skip to JavaScript editor"),onClick:function(){return t.openJavaScript()}}),n.selectLanguage?React.createElement(sui.Item,{class:(n.invertedMenu?"inverted":"")+" menu",role:"menuitem",icon:"xicon globe",text:lf("Select Language"),onClick:function(){return t.selectLang()}}):void 0,n.highContrast?React.createElement(sui.Item,{class:(n.invertedMenu?"inverted":"")+" menu",role:"menuitem",text:e?lf("High Contrast Off"):lf("High Contrast On"),onClick:function(){return t.toggleHighContrast()}}):void 0,React.createElement(sui.Item,{class:(n.invertedMenu?"inverted":"")+" menu",role:"menuitem",icon:"home",text:lf("Go Home"),onClick:function(){return t.goHome()}}))},e}(data.Component);exports.EditorAccessibilityMenu=EditorAccessibilityMenu;var HomeAccessibilityMenu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.newProject=function(){pxt.tickEvent("accmenu.home.new",void 0,{interactiveConsent:!0}),this.props.parent.newProject()},e.prototype.importProjectDialog=function(){pxt.tickEvent("accmenu.home.importdialog",void 0,{interactiveConsent:!0}),this.props.parent.importProjectDialog()},e.prototype.selectLang=function(){pxt.tickEvent("accmenu.home.langpicker"),this.props.parent.selectLang()},e.prototype.toggleHighContrast=function(){pxt.tickEvent("accmenu.home.togglecontrast",void 0,{interactiveConsent:!0}),this.props.parent.toggleHighContrast()},e.prototype.componentWillReceiveProps=function(t){var e={};void 0!=t.highContrast&&(e.highContrast=t.highContrast),Object.keys(e).length>0&&this.setState(e)},e.prototype.shouldComponentUpdate=function(t,e,n){return this.state.highContrast!=e.highContrast},e.prototype.renderCore=function(){var t=this,e=this.state.highContrast,n=pxt.appTarget.appTheme;return React.createElement("div",{className:"ui accessibleMenu borderless fixed menu",role:"menubar"},React.createElement(sui.Item,{class:(n.invertedMenu?"inverted":"")+" menu",role:"menuitem",icon:"add circle",text:lf("New Project"),onClick:function(){return t.newProject()}}),React.createElement(sui.Item,{class:(n.invertedMenu?"inverted":"")+" menu",role:"menuitem",icon:"upload",text:lf("Import Project"),onClick:function(){return t.importProjectDialog()}}),n.selectLanguage?React.createElement(sui.Item,{class:(n.invertedMenu?"inverted":"")+" menu",role:"menuitem",icon:"xicon globe",text:lf("Select Language"),onClick:function(){return t.selectLang()}}):void 0,n.highContrast?React.createElement(sui.Item,{class:(n.invertedMenu?"inverted":"")+" menu",role:"menuitem",text:e?lf("High Contrast Off"):lf("High Contrast On"),onClick:function(){return t.toggleHighContrast()}}):void 0)},e}(data.Component);exports.HomeAccessibilityMenu=HomeAccessibilityMenu;

},{"./data":14,"./sui":44,"react":269}],2:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();Object.defineProperty(exports,"__esModule",{value:!0});var theEditor,React=require("react"),ReactDOM=require("react-dom"),workspace=require("./workspace"),data=require("./data"),pkg=require("./package"),core=require("./core"),sui=require("./sui"),simulator=require("./simulator"),compiler=require("./compiler"),tdlegacy=require("./tdlegacy"),cmds=require("./cmds"),appcache=require("./appcache"),screenshot=require("./screenshot"),hidbridge=require("./hidbridge"),share=require("./share"),lang=require("./lang"),accessibility=require("./accessibility"),tutorial=require("./tutorial"),editortoolbar=require("./editortoolbar"),simtoolbar=require("./simtoolbar"),debug=require("./debugger"),filelist=require("./filelist"),container=require("./container"),scriptsearch=require("./scriptsearch"),projects=require("./projects"),extensions=require("./extensions"),sounds=require("./sounds"),make=require("./make"),monacoToolbox=require("./monacoSnippets"),monaco=require("./monaco"),pxtjson=require("./pxtjson"),serial=require("./serial"),blocks=require("./blocks"),serialindicator=require("./serialindicator"),draganddrop=require("./draganddrop"),notification=require("./notification"),Cloud=pxt.Cloud,Util=pxt.Util,CategoryMode=pxt.toolbox.CategoryMode;pxsim.util.injectPolyphils();var ProjectView=function(t){function e(e){var i=t.call(this,e)||this;i.allEditors=[],i.autoRunBlocksSimulator=pxtc.Util.debounce(function(){Util.now()-i.lastChangeTime<1e3||i.state.active&&i.runSimulator({debug:!!i.state.debugging,background:!0})},1e3,!0),i.autoRunSimulator=pxtc.Util.debounce(function(){Util.now()-i.lastChangeTime<1e3||i.state.active&&i.runSimulator({debug:!!i.state.debugging,background:!0})},2e3,!0),i._slowTypeCheck=0,i.typecheck=pxtc.Util.debounce(function(){if(!i.editor.isIncomplete()){var t=Util.now(),e=i.editor.snapshotState();compiler.typecheckAsync().done(function(o){var r=Util.now();if(!pxt.options.light&&r-t>1e4&&i._slowTypeCheck++>1&&(pxt.tickEvent("light.typecheck"),pxt.options.light=!0),i.editor.setDiagnostics(i.editorFile,e),data.invalidate("open-pkg-meta:"+pkg.mainEditorPkg().getPkgId()),pxt.appTarget.simulator&&pxt.appTarget.simulator.autoRun){var n=pkg.mainEditorPkg().outputPkg.files["output.txt"];!n||n.numDiagnosticsOverride||simulator.driver.state!=pxsim.SimulatorState.Running&&simulator.driver.state!=pxsim.SimulatorState.Paused&&simulator.driver.state!=pxsim.SimulatorState.Unloaded||(i.editor==i.blocksEditor?i.autoRunBlocksSimulator():i.autoRunSimulator())}})}},1e3,!1),i.markdownChangeHandler=Util.debounce(function(){i.state.currFile&&/\.md$/i.test(i.state.currFile.name)&&i.setSideMarkdown(i.editor.getCurrentSource())},4e3,!1),i.editorChangeHandler=Util.debounce(function(){i.editor.isIncomplete()||(i.saveFileAsync().done(),i.typecheck()),i.markdownChangeHandler()},500,!1),i.updatingEditorFile=!1,i.hexFileImporters=[{id:"default",canImport:function(t){return t.meta.cloudId=="ks/"+pxt.appTarget.id||t.meta.cloudId==pxt.CLOUD_ID+pxt.appTarget.id||Util.startsWith(t.meta.cloudId,pxt.CLOUD_ID+pxt.appTarget.id)},importAsync:function(t,e){var o={target:pxt.appTarget.id,editor:e.meta.editor,name:e.meta.name,meta:{},pubId:"",pubCurrent:!1},r=JSON.parse(e.source);return workspace.installAsync(o,r).then(function(t){return i.loadHeaderAsync(t,null)})}}],i.resourceImporters=[new serial.ResourceImporter],i.closeOnEscape=function(t){27===t.keyCode&&(t.preventDefault(),i.toggleSimulatorFullscreen())},i.debouncedSaveProjectName=Util.debounce(function(){i.saveProjectNameAsync().done()},2e3,!1),document.title=pxt.appTarget.title||pxt.appTarget.name,i.reload=!1,i.settings=JSON.parse(pxt.storage.getLocal("editorSettings")||"{}");var o=i.shouldShowHomeScreen(),r=pxt.shell.isSandboxMode()||pxt.shell.isReadOnly();return i.state={showFiles:!1,home:o,active:"visible"==document.visibilityState,collapseEditorTools:pxt.appTarget.simulator.headless||!r&&pxt.BrowserUtils.isMobile()},i.settings.editorFontSize||(i.settings.editorFontSize=/mobile/i.test(navigator.userAgent)?15:19),i.settings.fileHistory||(i.settings.fileHistory=[]),o&&i.homeLoaded(),i}return __extends(e,t),e.prototype.shouldShowHomeScreen=function(){var t=parseHash(),e=pxt.shell.isSandboxMode()||pxt.shell.isReadOnly(),i=pxt.appTarget.appTheme.allowParentController||"#editor"==window.location.hash;return!e&&!i&&!isProjectRelatedHash(t)},e.prototype.updateVisibility=function(){var t=this,e="visible"==document.visibilityState;if(pxt.debug("page visibility: "+e),this.setState({active:e}),e)if(workspace.isSessionOutdated()){pxt.debug("workspace changed, reloading...");var i=this.state.header?this.state.header.id:"";workspace.initAsync().done(function(){return!t.state.home&&i?t.loadHeaderAsync(workspace.getHeader(i),t.state.editorState):Promise.resolve()})}else this.state.resumeOnVisibility&&!this.state.running&&(this.setState({resumeOnVisibility:!1}),this.runSimulator());else this.state.running&&(this.stopSimulator(),this.setState({resumeOnVisibility:!0})),this.saveFileAsync().done()},e.prototype.saveSettings=function(){var t=this.settings;if(!this.reload){var e=this.editorFile;if(e&&e.epkg.getTopHeader()&&this.editor.hasHistory()){var i={id:e.epkg.getTopHeader().id,name:e.getName(),pos:this.editor.getViewState()};for(t.fileHistory=t.fileHistory.filter(function(t){return t.id!=i.id||t.name!=i.name});t.fileHistory.length>100;)t.fileHistory.pop();t.fileHistory.unshift(i)}pxt.storage.setLocal("editorSettings",JSON.stringify(this.settings))}},e.prototype.componentDidUpdate=function(){this.saveSettings(),this.editor.domUpdate(),simulator.setState(this.state.header?this.state.header.editor:"",this.state.tutorialOptions&&!!this.state.tutorialOptions.tutorial),this.editor.resize()},e.prototype.fireResize=function(){if(document.createEvent){var t=document.createEvent("Event");t.initEvent("resize",!0,!0),window.dispatchEvent(t)}else document.fireEvent("onresize")},e.prototype.updateEditorLogo=function(t,e){if(pxt.appTarget.appTheme.hideMenuBar){var i=document.getElementById("editorlogo");i&&(i.style.left=t+"px",i.style.display="block",i.style.background=e||"")}},e.prototype.saveFileAsync=function(){var t=this;return this.editorFile?this.saveTypeScriptAsync().then(function(){var e=t.editor.getCurrentSource();return e!=t.editorFile.content&&simulator.makeDirty(),t.editor.isIncomplete()?Promise.resolve():t.editorFile.setContentAsync(e)}):Promise.resolve()},e.prototype.isEmbedSimActive=function(){return this.state.embedSimView},e.prototype.isBlocksActive=function(){return!this.state.embedSimView&&this.editor==this.blocksEditor&&this.editorFile&&"main.blocks"==this.editorFile.name},e.prototype.isJavaScriptActive=function(){return!this.state.embedSimView&&this.editor==this.textEditor&&this.editorFile&&"main.ts"==this.editorFile.name},e.prototype.isAnyEditeableJavaScriptOrPackageActive=function(){return this.editor==this.textEditor&&this.editorFile&&!this.editorFile.isReadonly()&&/(\.ts|pxt.json)$/.test(this.editorFile.name)},e.prototype.openJavaScript=function(t){if(void 0===t&&(t=!0),this.isJavaScriptActive())return this.state.embedSimView&&this.setState({embedSimView:!1}),void(t&&this.textEditor.editor.focus());this.textEditor&&(this.textEditor.giveFocusOnLoading=t),this.isBlocksActive()?this.blocksEditor.openTypeScript():this.setFile(pkg.mainEditorPkg().files["main.ts"])},e.prototype.openBlocks=function(){var t=this;this.isBlocksActive()?this.state.embedSimView&&this.setState({embedSimView:!1}):(this.isJavaScriptActive()||this.shouldTryDecompile&&!this.state.embedSimView?this.textEditor.openBlocks():this.isAnyEditeableJavaScriptOrPackageActive()?this.saveFileAsync().then(function(){return compiler.newProject(),compiler.getBlocksAsync()}).done(function(e){pxt.blocks.initBlocks(e),t.blocksEditor.updateBlocksInfo(e),t.setFile(pkg.mainEditorPkg().files["main.blocks"])}):this.setFile(pkg.mainEditorPkg().files["main.blocks"]),this.shouldTryDecompile=!1)},e.prototype.openSettings=function(){this.setFile(pkg.mainEditorPkg().lookupFile("this/pxt.json"))},e.prototype.openSerial=function(t){if(pxt.appTarget.serial&&pxt.appTarget.serial.useEditor&&(this.editor!=this.serialEditor||this.serialEditor.isSim!=t)){var e=pkg.mainEditorPkg();if(e){e.lookupFile("this/"+pxt.SERIAL_EDITOR_FILE)||e.setFile(pxt.SERIAL_EDITOR_FILE,"serial\n"),this.serialEditor.setSim(t);var i="serial."+(t?"simulator":"device")+"EditorOpened";pxt.tickEvent(i),this.setFile(e.lookupFile("this/"+pxt.SERIAL_EDITOR_FILE))}}},e.prototype.openPreviousEditor=function(){"monacoEditor"==this.prevEditorId?this.openJavaScript(!1):this.openBlocks()},e.prototype.openTypeScriptAsync=function(){var t=this;return this.saveTypeScriptAsync(!0).then(function(){var e=t.state.header;e&&(e.editor=pxt.JAVASCRIPT_PROJECT_NAME,e.pubCurrent=!1)})},e.prototype.openSimView=function(){this.state.embedSimView?this.startStopSimulator():(this.setState({embedSimView:!0}),this.startSimulator())},e.prototype.typecheckNow=function(){this.saveFileAsync().done(),this.typecheck()},e.prototype.initEditors=function(){var t=this;this.textEditor=new monaco.Editor(this),this.pxtJsonEditor=new pxtjson.Editor(this),this.serialEditor=new serial.Editor(this),this.blocksEditor=new blocks.Editor(this);var e=function(){t.editorFile&&(t.editorFile.inSyncWithEditor&&pxt.tickActivity("edit","edit."+t.editor.getId().replace(/Editor$/,"")),t.editorFile.markDirty()),t.lastChangeTime=Util.now(),t.state.running&&pxt.appTarget.simulator&&pxt.appTarget.simulator.stopOnChange&&t.stopSimulator(),t.editorChangeHandler()};this.allEditors=[this.pxtJsonEditor,this.blocksEditor,this.serialEditor,this.textEditor],this.allEditors.forEach(function(t){return t.changeCallback=e}),this.editor=this.allEditors[this.allEditors.length-1]},e.prototype.componentWillMount=function(){this.initEditors(),this.initDragAndDrop()},e.prototype.componentDidMount=function(){var t=this;this.allEditors.forEach(function(t){return t.prepare()}),simulator.init($("#boardview")[0],{highlightStatement:function(e,i){return!!t.editor&&t.editor.highlightStatement(e,i)},restartSimulator:function(){core.hideDialog(),t.runSimulator()},onStateChanged:function(e){e==pxsim.SimulatorState.Paused?t.setState({running:!1}):e==pxsim.SimulatorState.Running&&t.setState({running:!0})},editor:this.state.header?this.state.header.editor:""}),(pxt.appTarget.appTheme.allowParentController||pxt.appTarget.appTheme.allowPackageExtensions||pxt.appTarget.appTheme.allowSimulatorTelemetry)&&pxt.editor.bindEditorMessages(this),this.forceUpdate()},e.prototype.pickEditorFor=function(t){return this.allEditors.filter(function(e){return e.acceptsFile(t)})[0]},e.prototype.updateEditorFile=function(t){var e=this;if(void 0===t&&(t=null),this.state.active&&(this.state.currFile!=this.editorFile||t)&&!this.updatingEditorFile){this.updatingEditorFile=!0,this.saveSettings();var i=this.state.highContrast;return this.saveFileAsync().then(function(){e.editorFile=e.state.currFile;var i=e.editor;return e.prevEditorId=i.getId(),e.editor=t||e.pickEditorFor(e.editorFile),e.allEditors.forEach(function(t){return t.setVisible(t==e.editor)}),i?i.unloadFileAsync():Promise.resolve()}).then(function(){return e.editor.loadFileAsync(e.editorFile,i)}).then(function(){e.saveFileAsync().done(),e.editor!=e.textEditor&&e.editor!=e.blocksEditor||e.typecheck();var t=e.settings.fileHistory.filter(function(t){return t.id==e.state.header.id&&t.name==e.editorFile.getName()})[0];t&&e.editor.setViewState(t.pos),container.SideDocs.notify({type:"fileloaded",name:e.editorFile.getName(),locale:pxt.Util.localeInfo()}),e.state.showBlocks&&e.editor==e.textEditor&&e.textEditor.openBlocks()}).finally(function(){e.forceUpdate(),e.updatingEditorFile=!1})}},e.prototype.setFile=function(t){t&&("main.ts"===t.name&&(this.shouldTryDecompile=!0),this.setState({currFile:t,showBlocks:!1,embedSimView:!1}))},e.prototype.setSideFile=function(t){var e=this,i=this.state.header;i&&(i.editor=this.getPreferredEditor(),i.pubCurrent=!1);var o=t.name,r=this.state.currFile.name;if(o!=r&&pkg.File.blocksFileNameRx.test(o)){pxt.tickEvent("sidebar.showBlocks");var n=t.getVirtualFileName(),a=pkg.mainEditorPkg().lookupFile("this/"+n);r==n?this.textEditor.openBlocks():a&&this.textEditor.decompileAsync(a.name).then(function(i){if(i.success)e.setFile(t);else{e.setFile(a);var o=!1;i.diagnostics.forEach(function(t){return o=o||9266===t.code}),e.textEditor.showConversionFailedDialog(t.name,o)}})}else(this.isTextEditor()||this.isPxtJsonEditor())&&(this.textEditor.giveFocusOnLoading=!1),this.setFile(t)},e.prototype.removeFile=function(t,e){var i=this;void 0===e&&(e=!1);var o=function(){pkg.mainEditorPkg().removeFileAsync(t.name).then(function(){return pkg.mainEditorPkg().saveFilesAsync(!0)}).then(function(){return i.reloadHeaderAsync()}).done()};e?o():core.confirmAsync({header:lf("Remove {0}",t.name),body:lf("You are about to remove a file from your project. You can't undo this. Are you sure?"),agreeClass:"red",agreeIcon:"trash",agreeLbl:lf("Remove it")}).done(function(t){t&&o()})},e.prototype.updateFileAsync=function(t,e,i){var o=this,r=pkg.mainEditorPkg();return r.setFile(t,e),r.updateConfigAsync(function(e){return e.files.indexOf(t)<0?e.files.push(t):0}).then(function(){return i&&o.setFile(r.lookupFile("this/"+t)),r.savePkgAsync()}).then(function(){return o.reloadHeaderAsync()})},e.prototype.setSideMarkdown=function(t){var e=this.refs.sidedoc;e&&e.setMarkdown(t)},e.prototype.setSideDoc=function(t,e){void 0===e&&(e=!0);var i=this.refs.sidedoc;i&&(t?i.setPath(t,e):i.collapse())},e.prototype.setTutorialStep=function(t){this.typecheckNow();var e=this.refs.tutorialcard;if(e&&t>-1){e.focusInitialized=!1;var i=this.state.tutorialOptions;i.tutorialStep=t,this.setState({tutorialOptions:i}),i.tutorialStepInfo[t].fullscreen?this.showTutorialHint():tutorial.TutorialContent.refresh()}},e.prototype.handleMessage=function(t){var e=this;switch(t.type){case"popoutcomplete":this.setState({sideDocsCollapsed:!0,sideDocsLoadUrl:""});break;case"tutorial":switch(t.subtype){case"loaded":var i=t;i.toolboxSubset&&Object.keys(i.toolboxSubset).length>0&&this.editor.filterToolbox({blocks:i.toolboxSubset,defaultState:pxt.editor.FilterState.Hidden},CategoryMode.Basic);var o=this.state.tutorialOptions;o.tutorialReady=!0,o.tutorialStepInfo=i.stepInfo,this.setState({tutorialOptions:o}),o.tutorialStepInfo[0].fullscreen?this.showTutorialHint():tutorial.TutorialContent.refresh(),core.hideLoading("tutorial");break;case"error":var r=t;pxt.reportException(r.message),core.errorNotification(lf("We're having trouble loading this tutorial, please try again later.")),this.setState({tutorialOptions:void 0});var n=pkg.mainEditorPkg().header;n.isDeleted=!0,workspace.saveAsync(n,{}).then(function(){e.openHome()}).finally(function(){core.hideLoading("tutorial")})}}},e.prototype.reloadHeaderAsync=function(){return this.loadHeaderAsync(this.state.header,this.state.editorState)},e.prototype.loadHeaderAsync=function(t,e,i){var o=this;return t?(this.stopSimulator(!0),this.clearSerial(),Util.jsonMergeFrom(e||{},this.state.editorState||{}),pkg.loadPkgAsync(t.id).then(function(){simulator.makeDirty(),compiler.newProject();var r=o.settings.fileHistory.filter(function(e){return e.id==t.id})[0],n=pkg.getEditorPkg(pkg.mainPkg),a=n.getMainFile();r&&(a=n.lookupFile(r.name)||a),r||t.editor!=pxt.JAVASCRIPT_PROJECT_NAME||pkg.File.tsFileNameRx.test(a.getName())||!a.getVirtualFileName()||(a=n.lookupFile("this/"+a.getVirtualFileName())||a),pkg.File.blocksFileNameRx.test(a.getName())&&a.getVirtualFileName()&&(a.content||(a=n.lookupFile("this/"+a.getVirtualFileName())||a)),o.setState({home:!1,showFiles:!1,editorState:e,tutorialOptions:i?o.state.tutorialOptions:void 0,header:t,projectName:t.name,currFile:a,sideDocsLoadUrl:"",debugging:!1}),"main.ts"===a.name&&(o.shouldTryDecompile=!0),pkg.getEditorPkg(pkg.mainPkg).onupdate=function(){o.loadHeaderAsync(t,o.state.editorState).done()},pkg.mainPkg.getCompileOptionsAsync().catch(function(t){if(t instanceof pxt.cpp.PkgConflictError){var e=t,i=function(t){return{label:lf("Remove {0}",t.id),class:"pink",icon:"trash",onclick:function(){core.showLoading("removedep",lf("Removing {0}...",t.id)),pkg.mainEditorPkg().removeDepAsync(t.id).then(function(){return o.reloadHeaderAsync()}).done(function(){return core.hideLoading("removedep")})}}};core.dialogAsync({hideCancel:!0,buttons:[i(e.pkg1),i(e.pkg0)],header:lf("Packages cannot be used together"),body:lf("Packages '{0}' and '{1}' cannot be used together, because they use incompatible settings ({2}).",e.pkg1.id,e.pkg0.id,e.settingName)})}}).done();var s=o.pickEditorFor(a),c=n.lookupFile("this/README.md");c&&c.content&&c.content.trim()?o.setSideMarkdown(c.content):pkg.mainPkg&&pkg.mainPkg.config&&pkg.mainPkg.config.documentation&&o.setSideDoc(pkg.mainPkg.config.documentation,s==o.blocksEditor)}).finally(function(){pxt.BrowserUtils.changeHash("#editor",!0),document.getElementById("root").focus(),o.editorLoaded()})):Promise.resolve()},e.prototype.removeProject=function(){var t=this;pkg.mainEditorPkg().header&&core.confirmDelete(pkg.mainEditorPkg().header.name,function(){var e=pkg.mainEditorPkg().header;return e.isDeleted=!0,workspace.saveAsync(e,{}).then(function(){workspace.getHeaders().length>0?t.openHome():t.newProject()})})},e.prototype.importHexFile=function(t){var e=this;t&&pxt.cpp.unpackSourceFromHexFileAsync(t).done(function(t){return e.importHex(t)})},e.prototype.importBlocksFiles=function(t){var e=this;t&&ts.pxtc.Util.fileReadAsTextAsync(t).done(function(i){e.newProject({filesOverride:{"main.blocks":i,"main.ts":"  "},name:t.name.replace(/\.blocks$/i,"")||lf("Untitled")})})},e.prototype.importTypescriptFile=function(t){var e=this;t&&ts.pxtc.Util.fileReadAsTextAsync(t).done(function(i){e.newProject({filesOverride:{"main.blocks":"","main.ts":i||"  "},name:t.name.replace(/\.ts$/i,"")||lf("Untitled")})})},e.prototype.convertTouchDevelopToTypeScriptAsync=function(t){return tdlegacy.td2tsAsync(t)},e.prototype.importHex=function(t,e){var i=this;void 0===e&&(e=!1);pxt.appTarget.id;if(!t||!t.meta)return core.warningNotification(lf("Sorry, we could not recognize this file.")),void(e&&this.openHome());var o=this.hexFileImporters.filter(function(e){return e.canImport(t)})[0];o?(pxt.tickEvent("import."+o.id),core.showLoading("importhex",lf("loading project...")),o.importAsync(this,t).done(function(){return core.hideLoading("importhex")},function(t){pxt.reportException(t,{importer:o.id}),core.hideLoading("importhex"),core.errorNotification(lf("Oops, something went wrong when importing your project")),e&&i.openHome()})):(core.warningNotification(lf("Sorry, we could not import this project.")),pxt.tickEvent("warning.importfailed"),e&&this.openHome())},e.prototype.importProjectCoreAsync=function(t){var e=this;return pxt.lzmaDecompressAsync(t).then(function(t){var i=JSON.parse(t);e.importHex(i)}).catch(function(t){core.warningNotification(lf("Sorry, we could not import this project.")),e.openHome()})},e.prototype.importProjectFile=function(t){var e=this;t&&ts.pxtc.Util.fileReadAsBufferAsync(t).then(function(t){return e.importProjectCoreAsync(t)})},e.prototype.importPNGFile=function(t){var e=this;t&&ts.pxtc.Util.fileReadAsBufferAsync(t).then(function(t){return screenshot.decodeBlobAsync("data:image/png;base64,"+btoa(Util.uint8ArrayToString(t)))}).then(function(t){return e.importProjectCoreAsync(t)})},e.prototype.importFile=function(t){if(t&&!pxt.shell.isReadOnly())if(isHexFile(t.name))this.importHexFile(t);else if(isBlocksFile(t.name))this.importBlocksFiles(t);else if(isTypescriptFile(t.name))this.importTypescriptFile(t);else if(isProjectFile(t.name))this.importProjectFile(t);else if(isPNGFile(t.name))this.importPNGFile(t);else{var e=this.resourceImporters.filter(function(e){return e.canImport(t)})[0];e?e.importAsync(this,t).done():core.warningNotification(lf("Oops, don't know how to load this file!"))}},e.prototype.importProjectAsync=function(t,e){var i=this,o=t.header;return o||(o={target:pxt.appTarget.id,editor:pxt.BLOCKS_PROJECT_NAME,name:lf("Untitled"),meta:{},pubId:"",pubCurrent:!1}),workspace.installAsync(o,t.text).then(function(t){return i.loadHeaderAsync(t,e)})},e.prototype.initDragAndDrop=function(){var t=this;draganddrop.setupDragAndDrop(document.body,function(t){return t.size<1e6&&isHexFile(t.name)||isBlocksFile(t.name)},function(e){e&&(pxt.tickEvent("dragandrop.open"),t.importFile(e[0]))})},e.prototype.openHome=function(){this.stopSimulator(),pxt.BrowserUtils.changeHash("",!0),this.setState({home:!0}),this.allEditors.forEach(function(t){return t.setVisible(!1)}),this.homeLoaded()},e.prototype.homeLoaded=function(){pxt.tickEvent("app.home")},e.prototype.editorLoaded=function(){pxt.tickEvent("app.editor")},e.prototype.reloadEditor=function(){this.state.home&&(location.hash="#reload"),location.reload()},e.prototype.exitAndSave=function(){this.state.projectName!==lf("Untitled")?this.openHome():this.exitAndSaveDialog.show()},e.prototype.exportProjectToFileAsync=function(){return pkg.mainPkg.compressToFileAsync(this.getPreferredEditor())},e.prototype.getPreferredEditor=function(){return this.editor==this.blocksEditor?pxt.BLOCKS_PROJECT_NAME:pxt.JAVASCRIPT_PROJECT_NAME},e.prototype.exportAsync=function(){return pxt.debug("exporting project"),this.exportProjectToFileAsync().then(function(t){return ts.pxtc.encodeBase64(Util.uint8ArrayToString(t))})},e.prototype.importProjectFromFileAsync=function(t){var e=this;return pxt.lzmaDecompressAsync(t).then(function(t){var i=JSON.parse(t);return e.importHex(i)}).catch(function(){return e.newProject()})},e.prototype.saveProjectAsPNG=function(){var t=this;return simulator.driver.postMessage({type:"screenshot",title:this.state.header.name}),new Promise(function(e,i){t.screenshotHandler=function(i){t.screenshotHandler=null,e(t.exportProjectToFileAsync().then(function(t){return screenshot.encodeBlobAsync(i,t)}).then(function(t){var e=pkg.genFileName(".png");pxt.BrowserUtils.browserDownloadDataUri(t,e)}))}})},e.prototype.saveProjectToFileAsync=function(){pkg.mainPkg;return pxt.appTarget.compile.saveAsPNG?this.saveProjectAsPNG():this.exportProjectToFileAsync().then(function(t){var e=pkg.genFileName(".mkcd");pxt.BrowserUtils.browserDownloadUInt8Array(t,e,"application/octet-stream")})},e.prototype.addPackage=function(){this.scriptSearch.showAddPackages()},e.prototype.openExtension=function(t,e,i){pxt.tickEvent("app.openextension",{extension:t}),this.extensions.showExtension(t,e,i)},e.prototype.handleExtensionRequest=function(t){this.extensions.handleExtensionRequest(t)},e.prototype.newEmptyProject=function(t,e){this.newProject({filesOverride:{"main.blocks":'<xml xmlns="http://www.w3.org/1999/xhtml"></xml>'},name:t,documentation:e})},e.prototype.newProject=function(t){void 0===t&&(t={}),pxt.tickEvent("app.newproject"),core.showLoading("newproject",lf("creating new project...")),this.createProjectAsync(t).then(function(){return Promise.delay(500)}).done(function(){return core.hideLoading("newproject")})},e.prototype.createProjectAsync=function(t){var e=this;this.setSideDoc(void 0),t.prj||(t.prj=pxt.appTarget.blocksprj);var i=pxt.U.clone(t.prj.config);i.name=t.name||lf("Untitled"),i.documentation=t.documentation;var o=Util.clone(t.prj.files);return t.filesOverride&&Util.jsonCopyFrom(o,t.filesOverride),t.dependencies&&Util.jsonMergeFrom(i.dependencies,t.dependencies),t.tsOnly&&(i.files=i.files.filter(function(t){return"main.blocks"!=t}),delete o["main.blocks"]),o["pxt.json"]=JSON.stringify(i,null,4)+"\n",workspace.installAsync({name:i.name,meta:{},editor:t.prj.id,pubId:"",pubCurrent:!1,target:pxt.appTarget.id,temporary:t.temporary},o).then(function(i){return e.loadHeaderAsync(i,{filters:t.filters},t.inTutorial)})},e.prototype.switchTypeScript=function(){var t=pkg.mainEditorPkg(),e=this.editorFile.getVirtualFileName(),i=t.files[e];this.setFile(i)},e.prototype.saveBlocksToTypeScriptAsync=function(){return this.blocksEditor.saveToTypeScript()},e.prototype.saveTypeScriptAsync=function(t){var e=this;if(void 0===t&&(t=!1),!this.editor||!this.state.currFile||this.editorFile.epkg!=pkg.mainEditorPkg()||this.reload)return Promise.resolve();var i=Promise.resolve().then(function(){return t?e.textEditor.loadMonacoAsync():Promise.resolve()}).then(function(){return e.editor.saveToTypeScript().then(function(i){if(!i)return Promise.resolve();var o=pkg.mainEditorPkg(),r=e.editorFile.getVirtualFileName();return Util.assert(r!=e.editorFile.name),o.setContentAsync(r,i).then(function(){if(t){var i=o.files[r];e.setFile(i)}})})});return t?core.showLoadingAsync("switchtojs",lf("switching to JavaScript..."),i,0):i},e.prototype.resetWorkspace=function(){var t=this;return this.reload=!0,workspace.resetAsync().done(function(){return t.reloadEditor()},function(){return t.reloadEditor()})},e.prototype.reset=function(){var t=this;core.confirmAsync({header:lf("Reset"),body:lf("You are about to clear all projects. Are you sure? This operation cannot be undone."),agreeLbl:lf("Reset"),agreeClass:"red focused",agreeIcon:"sign out",disagreeLbl:lf("Cancel")}).then(function(e){return e?Promise.resolve().then(function(){return pxt.winrt.releaseAllDevicesAsync()}).then(function(){return t.resetWorkspace()}):Promise.resolve()}).done()},e.prototype.pair=function(){pxt.usb.pairAsync().then(function(){core.infoNotification(lf("Device paired! Try downloading now."))},function(t){core.errorNotification(lf("Failed to pair the device: {0}",t.message))})},e.prototype.promptRenameProjectAsync=function(){var t=this;if(!this.state.header)return Promise.resolve(!1);var e={header:lf("Rename your project"),agreeLbl:lf("Save"),agreeClass:"green",input:lf("Enter your project name here")};return core.confirmAsync(e).then(function(i){return i&&e.inputValue?new Promise(function(i,o){t.setState({projectName:e.inputValue},function(){return i()})}).then(function(){return t.saveProjectNameAsync()}).then(function(){return!0}):Promise.resolve(!1)})},e.prototype.saveAndCompile=function(){var t=this;if(this.state.header)return this.setState({isSaving:!0}),(this.state.projectName!==lf("Untitled")?Promise.resolve(!0):this.promptRenameProjectAsync()).then(function(){return t.saveProjectNameAsync()}).then(function(){return t.saveFileAsync()}).then(function(){!pxt.appTarget.compile.hasHex||pxt.appTarget.compile.useMkcd||pxt.appTarget.compile.saveAsPNG?t.saveProjectToFileAsync().finally(function(){t.setState({isSaving:!1})}).done():t.compile(!0)})},e.prototype.beforeCompile=function(){},e.prototype.compile=function(t){var e=this;if(void 0===t&&(t=!1),pxt.tickEvent("compile"),pxt.debug("compiling..."),pxt.appTarget.compile.saveAsPNG)this.saveAndCompile();else{this.beforeCompile();var i=void 0;if(pxt.appTarget.compile.useModulator||!pxt.BrowserUtils.isBrowserDownloadInSameWindow()||pxt.BrowserUtils.isBrowserDownloadWithinUserContext()||(i=window.open("")),this.state.compiling)pxt.tickEvent("compile.double");else{var o=this.state.running;this.setState({compiling:!0}),this.clearSerial(),this.editor.beforeCompile(),o&&this.stopSimulator();var r=this.editor.snapshotState();compiler.compileAsync({native:!0,forceEmit:!0,preferredEditor:this.getPreferredEditor()}).then(function(o){e.editor.setDiagnostics(e.editorFile,r);var n=pxt.outputName();return o.outfiles[n]?(o.saveOnly=t,o.userContextWindow=i,o.downloadFileBaseName=pkg.genFileName(""),o.confirmAsync=core.confirmAsync,t?pxt.commands.saveOnlyAsync(o):pxt.commands.deployCoreAsync(o).catch(function(t){if(t.notifyUser)core.warningNotification(t.message);else{var e=pxt.appTarget.appTheme.useUploadMessage?lf("Upload failed, please try again."):lf("Download failed, please try again.");core.warningNotification(e)}if(pxt.reportException(t),i)try{i.close()}catch(t){}})):(pxt.tickEvent("compile.noemit"),core.warningNotification(lf("Compilation failed, please check your code for errors.")),Promise.resolve())}).catch(function(t){if(pxt.reportException(t),core.errorNotification(lf("Compilation failed, please contact support.")),i)try{i.close()}catch(t){}}).finally(function(){e.setState({compiling:!1,isSaving:!1}),o&&e.runSimulator()}).done()}}},e.prototype.overrideTypescriptFile=function(t){this.textEditor&&this.textEditor.overrideFile(t)},e.prototype.overrideBlocksFile=function(t){this.blocksEditor&&this.blocksEditor.overrideFile(t)},e.prototype.startStopSimulator=function(){this.state.running?this.stopSimulator():this.startSimulator()},e.prototype.restartSimulator=function(t){this.stopSimulator(),this.startSimulator(t)},e.prototype.toggleTrace=function(t){this.state.tracing?(this.editor.clearHighlightedStatements(),simulator.setTraceInterval(0)):simulator.setTraceInterval(void 0!=t?t:simulator.SLOW_TRACE_INTERVAL),this.setState({tracing:!this.state.tracing}),this.restartSimulator()},e.prototype.toggleDebugging=function(){var t=!this.state.debugging;this.setState({debugging:t,tracing:!1}),this.restartSimulator(t)},e.prototype.dbgPauseResume=function(){simulator.dbgPauseResume()},e.prototype.dbgStepOver=function(){simulator.dbgStepOver()},e.prototype.dbgStepInto=function(){simulator.dbgStepInto()},e.prototype.startSimulator=function(t){var e=this;pxt.tickEvent("simulator.start"),this.saveFileAsync().then(function(){return e.runSimulator(t?{debug:!0}:{})})},e.prototype.stopSimulator=function(t){pxt.tickEvent("simulator.stop"),simulator.stop(t),this.setState({running:!1})},e.prototype.proxySimulatorMessage=function(t){simulator.proxy({type:"custom",content:t})},e.prototype.toggleSimulatorCollapse=function(){var t=this.state;!t.running&&t.collapseEditorTools&&this.startStopSimulator(),t.collapseEditorTools?this.expandSimulator():this.collapseSimulator()},e.prototype.expandSimulator=function(){pxt.appTarget.simulator.headless?simulator.unhide():this.startSimulator(),this.setState({collapseEditorTools:!1})},e.prototype.collapseSimulator=function(){var t=this;simulator.hide(function(){t.setState({collapseEditorTools:!0})})},e.prototype.toggleSimulatorFullscreen=function(){this.state.fullscreen?document.removeEventListener("keydown",this.closeOnEscape):document.addEventListener("keydown",this.closeOnEscape),this.closeFlyout(),this.setState({fullscreen:!this.state.fullscreen})},e.prototype.closeFlyout=function(){this.editor.closeFlyout()},e.prototype.toggleMute=function(){simulator.mute(!this.state.mute),this.setState({mute:!this.state.mute})},e.prototype.openInstructions=function(){var t=this,e=this.state.running;e&&this.stopSimulator(),make.makeAsync().finally(function(){e&&t.startSimulator()})},e.prototype.printCode=function(){var t=pkg.mainEditorPkg().getAllFiles(),e=(pxt.webConfig.docsUrl||"/--docs")+"#project:"+encodeURIComponent(JSON.stringify(t))+":blocks:"+pxt.Util.localeInfo();window.open(e,"_blank")},e.prototype.clearSerial=function(){this.serialEditor.clear();var t=this.refs.simIndicator,e=this.refs.devIndicator;t&&t.clear(),e&&e.clear()},e.prototype.simDebug=function(){pxt.tickEvent("menu.debug.sim"),this.stopSimulator(),this.runSimulator({debug:!0})},e.prototype.hwDebug=function(){pxt.tickEvent("menu.debug.hw");var t=Promise.resolve();return this.state.running&&simulator.driver.runOptions.debug||(t=this.runSimulator({debug:!0})),t.then(function(){return simulator.driver.setHwDebugger({postMessage:function(t){pxt.HWDBG.handleMessage(t)}}),pxt.HWDBG.postMessage=function(t){return simulator.driver.handleHwDebuggerMsg(t)},Promise.join(compiler.compileAsync({debug:!0,native:!0}),hidbridge.initAsync()).then(function(t){return pxt.HWDBG.startDebugAsync(t[0],t[1])})})},e.prototype.runSimulator=function(t){var e=this;void 0===t&&(t={});var i=this.editor?this.editor.getId().replace(/Editor$/,""):"unknown";t.background?pxt.tickActivity("autorun","autorun."+i):pxt.tickEvent(t.debug?"debug":"run",{editor:i}),t.background||this.editor.beforeCompile(),this.state.tracing&&(t.trace=!0),this.stopSimulator();var o=this.editor.snapshotState();return compiler.compileAsync(t).then(function(i){e.clearSerial(),e.editor.setDiagnostics(e.editorFile,o),i.outfiles[pxtc.BINARY_JS]?(simulator.run(pkg.mainPkg,t.debug,i,e.state.mute,e.state.highContrast,pxt.options.light),e.setState({running:!0,showParts:simulator.driver.runOptions.parts.length>0})):t.background||core.warningNotification(lf("Oops, we could not run this project. Please check your code for errors."))})},e.prototype.editText=function(){var t=this;this.editor!=this.textEditor&&(this.updateEditorFile(this.textEditor).then(function(){t.textEditor.editor.focus()}),this.forceUpdate())},e.prototype.importFileDialog=function(){var t,e=this,i=".mkcd";pxt.appTarget.compile.hasHex&&(i=".hex"),pxt.appTarget.compile.useUF2&&(i=".uf2"),pxt.appTarget.compile.saveAsPNG&&(i=".png"),core.confirmAsync({header:lf("Open {0} file",i),onLoaded:function(e){t=e.find("input")[0]},htmlBody:'<div class="ui form">\n  <div class="ui field">\n    <label id="selectFileToOpenLabel">'+lf("Select a {0} file to open.",i)+'</label>\n    <input type="file" tabindex="0" autofocus aria-describedby="selectFileToOpenLabel" class="ui blue fluid focused"></input>\n  </div>\n</div>'}).done(function(i){i&&(pxt.tickEvent("app.open.file"),e.importFile(t.files[0]))})},e.prototype.importProjectDialog=function(){this.importDialog.show()},e.prototype.showReportAbuse=function(){var t,e,i=this,o=pxt.appTarget.appTheme.shareUrl||"https://makecode.com/";core.confirmAsync({header:lf("Report Abuse"),onLoaded:function(r){t=r.find("input"),e=r.find("textarea"),i.state.header&&i.state.header.pubCurrent&&i.state.header.pubId&&t.val(o+i.state.header.pubId)},agreeLbl:lf("Submit"),htmlBody:'<div class="ui form">\n  <div class="ui field">\n    <label>'+lf("What is the URL of the offensive project?")+'</label>\n    <input type="url" class="focused" tabindex="0" autofocus placeholder="Enter project URL here..."></input>\n  </div>\n  <div class="ui field">\n    <label>'+lf("Why do you find it offensive?")+"</label>\n    <textarea></textarea>\n  </div>\n</div>"}).done(function(i){if(i){pxt.tickEvent("app.reportabuse.send");var o=pxt.Cloud.parseScriptId(t.val());o?(core.infoNotification(lf("Sending abuse report...")),Cloud.privatePostAsync(o+"/abusereports",{text:e.val()}).then(function(t){core.infoNotification(lf("Report sent. Thank you!"))}).catch(function(t){404==t.statusCode?core.warningNotification(lf("Oops, we could not find this script.")):core.handleNetworkError(t)})):core.errorNotification(lf("Sorry, the project url looks invalid."))}})},e.prototype.importUrlDialog=function(){var t,e=pxt.appTarget.appTheme.shareUrl||"https://makecode.com/";core.confirmAsync({header:lf("Open project URL"),onLoaded:function(e){t=e.find("input")[0]},htmlBody:'<div class="ui form">\n<div class="ui icon violet message">\n    <i class="user icon"></i>\n    <div class="content">\n        <h3 class="header">\n            '+lf("User-provided content")+"\n        </h3>\n        <p>\n            "+lf("The content below is provided by a user, and is not endorsed by Microsoft.")+"\n            "+lf("If you think it's not appropriate, please report abuse through Settings -> Report Abuse.")+'\n        </p>\n    </div>\n</div>\n  <div class="ui field">\n    <label id="selectUrlToOpenLabel">'+lf("Copy the URL of the project.")+'</label>\n    <input type="url" tabindex="0" autofocus aria-describedby="selectUrlToOpenLabel" placeholder="'+e+'..." class="ui blue fluid"></input>\n  </div>\n</div>'}).done(function(e){if(e){pxt.tickEvent("app.open.url");var i=pxt.Cloud.parseScriptId(t.value);i?loadHeaderBySharedId(i):core.errorNotification(lf("Sorry, the project url looks invalid."))}})},e.prototype.launchFullEditor=function(){Util.assert(pxt.shell.isSandboxMode());var t=pxt.appTarget.appTheme.embedUrl;/\/$/.test(t)||(t+="/");var e=pkg.mainPkg,i=pkg.getEditorPkg(e);pxt.shell.isReadOnly()?(i.header.pubId,t+="#pub:"+i.header.pubId,window.open(t,"_blank")):this.exportAsync().done(function(e){pxt.tickEvent("sandbox.openfulleditor"),t+="#project:"+e,window.open(t,"_blank")})},e.prototype.anonymousPublishAsync=function(){var t=this;pxt.tickEvent("publish"),this.setState({publishing:!0});var e=pkg.mainPkg,i=pkg.getEditorPkg(e);return this.saveProjectNameAsync().then(function(){return t.saveFileAsync()}).then(function(){return e.filesToBePublishedAsync(!0)}).then(function(o){if(i.header.pubCurrent)return Promise.resolve(i.header.pubId);var r={description:e.config.description},n=t.blocksEditor.contentSize();return n&&(r.blocksHeight=n.height,r.blocksWidth=n.width),workspace.anonymousPublishAsync(i.header,o,r).then(function(t){return t.id})}).finally(function(){t.setState({publishing:!1})}).catch(function(t){throw core.errorNotification(t.message),t})},e.prototype.updateHeaderName=function(t){this.setState({projectName:t}),this.debouncedSaveProjectName()},e.prototype.saveProjectNameAsync=function(){if(!this.state.projectName||!this.state.header)return Promise.resolve();try{return this.updateHeaderNameAsync(this.state.projectName)}catch(t){return pxt.reportException(t),Promise.resolve()}},e.prototype.updateHeaderNameAsync=function(t){var e=this;if(pkg.mainPkg.config.name==t)return Promise.resolve();pkg.mainPkg.config.name=t,pxt.debug("saving project name to "+t);var i=pkg.mainEditorPkg().lookupFile("this/"+pxt.CONFIG_NAME),o=JSON.parse(i.content);return o.name=t,i.setContentAsync(JSON.stringify(o,null,4)+"\n").then(function(){e.state.header&&e.setState({projectName:t})})},e.prototype.isTextEditor=function(){return this.editor==this.textEditor},e.prototype.isPxtJsonEditor=function(){return this.editor==this.pxtJsonEditor},e.prototype.isBlocksEditor=function(){return this.editor==this.blocksEditor},e.prototype.loadBlocklyAsync=function(){return this.blocksEditor.loadBlocklyAsync()},e.prototype.about=function(){var t=pxt.appTarget.compileService,e=(pxt.appTarget.description||pxt.appTarget.title,pxt.appTarget.appTheme.githubUrl);core.confirmAsync({header:lf("About"),hideCancel:!0,agreeLbl:lf("Ok"),agreeClass:"positive focused",htmlBody:"\n"+(e?"<p>"+lf("{0} version:",Util.htmlEscape(pxt.appTarget.name))+' <a class="focused" href="'+Util.htmlEscape(e)+"/releases/tag/v"+Util.htmlEscape(pxt.appTarget.versions.target)+'" aria-label="'+lf("{0} version : {1}",Util.htmlEscape(pxt.appTarget.name),Util.htmlEscape(pxt.appTarget.versions.target))+'" target="_blank">'+Util.htmlEscape(pxt.appTarget.versions.target)+"</a></p>":"")+"\n<p>"+lf("{0} version:","Microsoft MakeCode")+' <a href="https://github.com/Microsoft/pxt/releases/tag/v'+Util.htmlEscape(pxt.appTarget.versions.pxt)+'" aria-label="'+lf("{0} version: {1}","Microsoft MakeCode",Util.htmlEscape(pxt.appTarget.versions.pxt))+'" target="_blank">'+Util.htmlEscape(pxt.appTarget.versions.pxt)+"</a></p>\n"+(t&&t.githubCorePackage&&t.gittag?"<p>"+lf("{0} version:","C++ runtime")+' <a href="'+Util.htmlEscape("https://github.com/"+t.githubCorePackage+"/releases/tag/"+t.gittag)+'" aria-label="'+lf("{0} version: {1}","C++ runtime",Util.htmlEscape(t.gittag))+'" target="_blank">'+Util.htmlEscape(t.gittag)+"</a></p>":"")+"\n"}).done()},e.prototype.share=function(){var t=this.state.header;this.shareEditor.show(t)},e.prototype.selectLang=function(){this.languagePicker.show()},e.prototype.renderBlocksAsync=function(t){return compiler.getBlocksAsync().then(function(e){return compiler.decompileSnippetAsync(t.ts,e)}).then(function(t){var e=pxt.blocks.render(t,{snippetMode:!0}),i=e.getAttribute("viewBox").split(/\s+/).map(function(t){return parseInt(t)});return pxt.blocks.layout.blocklyToSvgAsync(e,i[0],i[1],i[2],i[3])}).then(function(t){return t.xml})},e.prototype.startTutorial=function(t,e){pxt.tickEvent("tutorial.start"),pxt.Cloud.isNavigatorOnline()?(core.showLoading("tutorial",lf("starting tutorial...")),this.startTutorialAsync(t,e)):core.errorNotification(lf("No Internet access, please connect and try again."))},e.prototype.startTutorialAsync=function(t,e){var i=this,o=e||t.split("/").reverse()[0].replace("-"," ");return sounds.initTutorial(),Promise.resolve().then(function(){var e={tutorial:t,tutorialName:o,tutorialStep:0};i.setState({tutorialOptions:e,editorState:{searchBar:!1},tracing:void 0}),i.refs.tutorialcontent.setPath(t)}).then(function(){return i.createProjectAsync({name:o,inTutorial:!0})}).catch(function(t){core.hideLoading("tutorial"),core.handleNetworkError(t)})},e.prototype.completeTutorial=function(){var t=this;pxt.tickEvent("tutorial.complete"),core.showLoading("leavingtutorial",lf("leaving tutorial...")),this.exitTutorialAsync().then(function(){var e=pkg.mainEditorPkg().header;return t.loadHeaderAsync(e)}).done(function(){core.hideLoading("leavingtutorial")})},e.prototype.exitTutorial=function(){var t=this;pxt.tickEvent("tutorial.exit"),core.showLoading("leavingtutorial",lf("leaving tutorial...")),this.exitTutorialAsync().done(function(){core.hideLoading("leavingtutorial"),t.openHome()})},e.prototype.exitTutorialAsync=function(){var t=this,e=pkg.mainEditorPkg().header,i=pkg.mainEditorPkg().getAllFiles();return workspace.saveAsync(e,i).then(function(){return Promise.delay(500)}).finally(function(){t.setState({tutorialOptions:void 0,tracing:void 0,editorState:void 0}),core.resetFocus()})},e.prototype.toggleHighContrast=function(){var t=this,e=!this.state.highContrast;pxt.tickEvent("app.highcontrast",{on:e?1:0}),this.setState({highContrast:e},function(){return t.restartSimulator()}),core.setHighContrast(e),this.editor&&this.editor.isReady&&this.editor.setHighContrast(e)},e.prototype.showTutorialHint=function(){this.refs.tutorialhint.showHint();var t=this.state.tutorialOptions;pxt.tickEvent("tutorial.showhint",{tutorial:t.tutorial,step:t.tutorialStep})},e.prototype.setBanner=function(t){this.setState({bannerVisible:t})},e.prototype.renderCore=function(){var t=this;theEditor=this,this.editor&&this.editor.isReady&&this.updateEditorFile();Cloud.isLoggedIn()&&this.getData("cloud:me/settings?format=nonsensitive");var e=pxt.appTarget.appTheme,i=pxt.appTarget.simulator,o=pxt.appTarget.cloud&&pxt.appTarget.cloud.sharing,r=pxt.shell.isSandboxMode(),n=!this.editor.isVisible||this.getPreferredEditor()==pxt.BLOCKS_PROJECT_NAME,a=!(r||e.hideSideDocs),s=this.state.tutorialOptions,c=!!s&&!!s.tutorial,l=this.state.home&&!r,p=!!this.state.header,d=i&&!i.enableTrace||pxt.options.debug,u=e.hideMenuBar,h=e.hideEditorToolbar,m=i&&i.headless,f=e.selectLanguage,g=!h&&this.editor.hasEditorToolbar(),v=pxt.appTarget.serial&&!!pxt.appTarget.serial.useEditor,y=a&&this.state.sideDocsLoadUrl&&!this.state.sideDocsCollapsed,x=(this.state.hideEditorFloats||this.state.collapseEditorTools)&&(!c||m),k=this.state.collapseEditorTools&&(!c||m),b=cmds.isNativeHost()||pxt.winrt.isWinRT(),E=["ui",x?" hideEditorFloats":"",k?" collapsedEditorTools":"",this.state.fullscreen?"fullscreensim":"",this.state.highContrast?"hc":"",y?"sideDocs":"",pxt.shell.layoutTypeClass(),l?"inHome":"",c?"tutorial":"",pxt.options.light?"light":"",pxt.BrowserUtils.isTouchEnabled()?"has-touch":"",u?"hideMenuBar":"",g?"":"hideEditorToolbar",this.state.bannerVisible?"notificationBannerVisible":"",this.state.debugging?"debugging":"",r&&this.isEmbedSimActive()?"simView":"",b?"app":"","full-abs"],w=document.getElementById("root");w&&["dimmable","dimmed"].filter(function(t){return w.classList.contains(t)}).forEach(function(t){return E.push(t)});var S=sui.cx(E);return React.createElement("div",{id:"root",className:S},u?void 0:React.createElement("header",{className:"menubar",role:"banner"},p?React.createElement(accessibility.EditorAccessibilityMenu,{parent:this,highContrast:this.state.highContrast}):void 0,React.createElement(notification.NotificationBanner,{parent:this}),React.createElement(container.MainMenu,{parent:this})),c?React.createElement("div",{id:"maineditor",className:r?"sandbox":"",role:"main"},React.createElement(tutorial.TutorialCard,{ref:"tutorialcard",parent:this})):void 0,React.createElement("div",{id:"simulator"},d?React.createElement(debug.DebuggerToolbar,{parent:this}):void 0,React.createElement("aside",{id:"filelist",className:"ui items"},React.createElement("label",{htmlFor:"boardview",id:"boardviewLabel",className:"accessible-hidden","aria-hidden":"true"},lf("Simulator")),React.createElement("div",{id:"boardview",className:"ui vertical editorFloat",role:"region","aria-labelledby":"boardviewLabel"}),React.createElement(simtoolbar.SimulatorToolbar,{parent:this}),React.createElement("div",{className:"ui item portrait hide hidefullscreen"},pxt.options.debug?React.createElement(sui.Button,{key:"hwdebugbtn",class:"teal",icon:"xicon chip",text:"Dev Debug",onClick:function(){return t.hwDebug()}}):""),v?React.createElement("div",{id:"serialPreview",className:"ui editorFloat portrait hide hidefullscreen"},React.createElement(serialindicator.SerialIndicator,{ref:"simIndicator",isSim:!0,onClick:function(){return t.openSerial(!0)}}),React.createElement(serialindicator.SerialIndicator,{ref:"devIndicator",isSim:!1,onClick:function(){return t.openSerial(!1)}})):void 0,r||n||this.editor==this.serialEditor?void 0:React.createElement(filelist.FileList,{parent:this}))),React.createElement("div",{id:"maineditor",className:r?"sandbox":"",role:"main"},this.allEditors.map(function(t){return t.displayOuter()})),l?React.createElement("div",{id:"homescreen",className:"full-abs",role:"main"},React.createElement("div",{className:"ui home projectsdialog"},React.createElement("div",{className:"menubar",role:"banner"},React.createElement(accessibility.HomeAccessibilityMenu,{parent:this,highContrast:this.state.highContrast})," }",React.createElement(projects.ProjectsMenu,{parent:this})),React.createElement(projects.Projects,{parent:this,ref:function(e){return t.home=e}}))):void 0,c?React.createElement(tutorial.TutorialHint,{ref:"tutorialhint",parent:this}):void 0,c?React.createElement(tutorial.TutorialContent,{ref:"tutorialcontent",parent:this}):void 0,g?React.createElement("div",{id:"editortools",role:"complementary","aria-label":lf("Editor toolbar")},React.createElement(editortoolbar.EditorToolbar,{ref:"editortools",parent:this})):void 0,a?React.createElement(container.SideDocs,{ref:"sidedoc",parent:this,sideDocsCollapsed:this.state.sideDocsCollapsed,docsUrl:this.state.sideDocsLoadUrl}):void 0,r?void 0:React.createElement(scriptsearch.ScriptSearch,{parent:this,ref:function(e){return t.scriptSearch=e}}),r?void 0:React.createElement(extensions.Extensions,{parent:this,ref:function(e){return t.extensions=e}}),l?React.createElement(projects.ImportDialog,{parent:this,ref:function(e){return t.importDialog=e}}):void 0,r?void 0:React.createElement(projects.ExitAndSaveDialog,{parent:this,ref:function(e){return t.exitAndSaveDialog=e}}),r||!o?void 0:React.createElement(share.ShareEditor,{parent:this,ref:function(e){return t.shareEditor=e}}),f?React.createElement(lang.LanguagePicker,{parent:this,ref:function(e){return t.languagePicker=e}}):void 0,r?React.createElement(container.SandboxFooter,{parent:this}):void 0,u?React.createElement("div",{id:"editorlogo"},React.createElement("a",{className:"poweredbylogo"})):void 0)},e}(data.Component);function render(){ReactDOM.render(React.createElement(ProjectView,null),$("#content")[0])}function getEditor(){return theEditor}function isHexFile(t){return/\.(hex|uf2)$/i.test(t)}function isBlocksFile(t){return/\.blocks$/i.test(t)}function isTypescriptFile(t){return/\.ts$/i.test(t)}function isProjectFile(t){return/\.(pxt|mkcd)$/i.test(t)}function isPNGFile(t){return pxt.appTarget.compile.saveAsPNG&&/\.png$/i.test(t)}function initLogin(){var t;if((t=core.parseQueryString((location.hash||"#").slice(1).replace(/%23access_token/,"access_token"))).access_token){var e=pxt.storage.getLocal("oauthState");e&&e==t.state&&(pxt.storage.setLocal("access_token",t.access_token),pxt.storage.removeLocal("oauthState")),location.hash=location.hash.replace(/(%23)?[\#\&\?]*access_token.*/,"")}Cloud.accessToken=pxt.storage.getLocal("access_token")||"",(t=core.parseQueryString((location.hash||"#").slice(1).replace(/%local_token/,"local_token"))).local_token&&(pxt.storage.setLocal("local_token",t.local_token),location.hash=location.hash.replace(/(%23)?[\#\&\?]*local_token.*/,"")),Cloud.localToken=pxt.storage.getLocal("local_token")||""}function initSerial(){if(pxt.appTarget.serial&&(pxt.winrt.isWinRT()||Cloud.isLocalHost()&&Cloud.localToken))if(hidbridge.shouldUse())hidbridge.configureHidSerial(function(t,e){var i=Util.fromUTF8(Util.uint8ArrayToString(t));window.postMessage({type:"serial",id:"n/a",data:i},"*")});else{pxt.debug("initializing serial pipe");var t=new WebSocket("ws://localhost:"+pxt.options.wsPort+"/"+Cloud.localToken+"/serial"),e={};t.onopen=function(t){pxt.debug("serial: socket opened")},t.onclose=function(t){pxt.debug("serial: socket closed")},t.onerror=function(t){pxt.debug("serial: error")},t.onmessage=function(t){try{var i=JSON.parse(t.data);i&&"serial"==i.type&&pxt.Util.bufferSerial(e,i.data,i.id)}catch(e){pxt.debug("unknown message: "+t.data)}}}}function getsrc(){pxt.log(theEditor.editor.getCurrentSource())}function initScreenshots(){window.addEventListener("message",function(t){var e=t.data;if(e&&"screenshot"==e.type){pxt.tickEvent("sim.screenshot");var i=e;pxt.debug("received screenshot"),theEditor.screenshotHandler?theEditor.screenshotHandler(i.data):screenshot.saveAsync(theEditor.state.header,i.data).done(function(){pxt.debug("screenshot saved")})}},!1)}function enableAnalytics(){pxt.analytics.enable(),pxt.editor.enableControllerAnalytics();var t={};if("undefined"!=typeof window){var e=window.screen;t["screen.width"]=e.width,t["screen.height"]=e.height,t["screen.availwidth"]=e.availWidth,t["screen.availheight"]=e.availHeight,t["screen.innerWidth"]=window.innerWidth,t["screen.innerHeight"]=window.innerHeight,t["screen.devicepixelratio"]=pxt.BrowserUtils.devicePixelRatio()}pxt.tickEvent("editor.loaded",t)}function showIcons(){core.confirmAsync({header:"Icons",htmlBody:["cancel","certificate","checkmark","cloud","cloud upload","copy","disk outline","download","dropdown","edit","file outline","find","folder","folder open","help circle","keyboard","lock","play","puzzle","search","setting","settings","share alternate","sign in","sign out","square","stop","translate","trash","undo","upload","user","wizard","configure","align left"].map(function(t){return"<i style='font-size:2em' class=\"ui icon "+t+'"></i>&nbsp;'+t+"&nbsp; "}).join("\n")})}function assembleCurrent(){compiler.compileAsync({native:!0}).then(function(){return compiler.assembleAsync(getEditor().editorFile.content)}).then(function(t){var e=t.words;pxt.debug("["+e.map(function(t){return"0x"+t.toString(16)}).join(",")+"]")})}function log(t){console.log(t)}exports.ProjectView=ProjectView;var myexports={workspace:workspace,require:require,core:core,getEditor:getEditor,monaco:monaco,blocks:blocks,compiler:compiler,pkg:pkg,getsrc:getsrc,sim:simulator,apiAsync:core.apiAsync,showIcons:showIcons,assembleCurrent:assembleCurrent,log:log};function parseHash(){var t=/^#(\w+)(:([\/\-\+\=\w]+))?$/.exec(window.location.hash);return t?{cmd:t[1],arg:t[3]||""}:{cmd:"",arg:""}}function handleHash(t,e){if(!t)return!1;var i=theEditor;if(!i)return!1;switch(isProjectRelatedHash(t)&&i.setState({home:!1}),t.cmd){case"doc":pxt.tickEvent("hash.doc"),i.setSideDoc(t.arg,i==this.blockEditor);break;case"follow":return pxt.tickEvent("hash.follow"),i.newEmptyProject(void 0,t.arg),!0;case"newproject":return pxt.tickEvent("hash.newproject"),i.newProject(),pxt.BrowserUtils.changeHash(""),!0;case"newjavascript":return pxt.tickEvent("hash.newjavascript"),i.newProject({prj:pxt.appTarget.blocksprj,filesOverride:{"main.blocks":""}}),pxt.BrowserUtils.changeHash(""),!0;case"gettingstarted":return pxt.tickEvent("hash.gettingstarted"),i.newProject(),pxt.BrowserUtils.changeHash(""),!0;case"tutorial":return pxt.tickEvent("hash.tutorial"),i.startTutorial(t.arg),pxt.BrowserUtils.changeHash(""),!0;case"home":return pxt.tickEvent("hash.home"),i.openHome(),pxt.BrowserUtils.changeHash(""),!0;case"sandbox":case"pub":case"edit":return pxt.tickEvent("hash."+t.cmd),pxt.BrowserUtils.changeHash(""),loadHeaderBySharedId(t.arg),!0;case"sandboxproject":case"project":pxt.tickEvent("hash."+t.cmd);var o=Util.stringToUint8Array(atob(t.arg));return pxt.BrowserUtils.changeHash(""),core.showLoading("loadingproject",lf("loading project...")),i.importProjectFromFileAsync(o).done(function(){return core.hideLoading("loadingproject")}),!0;case"reload":return e&&pxt.BrowserUtils.changeHash(""),!1}return!1}function isProjectRelatedHash(t){if(!t)return!1;switch(t.cmd){case"follow":case"newproject":case"newjavascript":case"tutorial":case"projects":case"sandbox":case"pub":case"edit":case"sandboxproject":case"project":return!0;default:return!1}}function loadHeaderBySharedId(t){var e=workspace.getHeaders().filter(function(e){return e.pubCurrent&&e.pubId==t})[0];core.showLoading("loadingheader",lf("loading project...")),(e?theEditor.loadHeaderAsync(e,null):workspace.installByIdAsync(t).then(function(t){return theEditor.loadHeaderAsync(t,null)})).catch(core.handleNetworkError).finally(function(){return core.hideLoading("loadingheader")})}function initHashchange(){window.addEventListener("hashchange",function(t){handleHash(parseHash(),!1)})}function initExtensionsAsync(){if(!pxt.appTarget.appTheme||!pxt.appTarget.appTheme.extendEditor)return Promise.resolve();pxt.debug("loading editor extensions...");var t={};return pxt.BrowserUtils.loadScriptAsync("editor.js").then(function(){return pxt.editor.initExtensionsAsync(t)}).then(function(t){t.hexFileImporters&&t.hexFileImporters.forEach(function(t){pxt.debug("\tadded hex importer "+t.id),theEditor.hexFileImporters.push(t)}),t.resourceImporters&&t.resourceImporters.forEach(function(t){pxt.debug("\tadded resource importer "+t.id),theEditor.resourceImporters.push(t)}),t.deployCoreAsync&&(pxt.debug("\tadded custom deploy core async"),pxt.commands.deployCoreAsync=t.deployCoreAsync),t.showUploadInstructionsAsync&&(pxt.debug("\tadded custom upload instructions async"),pxt.commands.showUploadInstructionsAsync=t.showUploadInstructionsAsync),t.beforeCompile&&(theEditor.beforeCompile=t.beforeCompile),t.toolboxOptions&&(t.toolboxOptions.blocklyXml&&pxt.blocks.overrideBaseToolbox(t.toolboxOptions.blocklyXml),t.toolboxOptions.monacoToolbox&&monacoToolbox.overrideToolbox(t.toolboxOptions.monacoToolbox))})}window.E=myexports,pxt.winrt.captureInitialActivation(),$(function(){pxt.setupWebConfig(window.pxtConfig);var t=pxt.webConfig;pxt.options.debug=/dbg=1/i.test(window.location.href),pxt.options.light=/light=1/i.test(window.location.href)||pxt.BrowserUtils.isARM()||pxt.BrowserUtils.isIE(),pxt.options.light&&$("body.main").addClass("light");var e=/wsport=(\d+)/i.exec(window.location.href);if(e?(pxt.options.wsPort=parseInt(e[1])||3233,pxt.BrowserUtils.changeHash(window.location.hash.replace(e[0],""))):pxt.options.wsPort=3233,pkg.setupAppTarget(window.pxtTargetBundle),enableAnalytics(),!pxt.BrowserUtils.isBrowserSupported()&&!/skipbrowsercheck=1/i.exec(window.location.href))return pxt.tickEvent("unsupported"),window.location.href="/browsers",void core.showLoading("browsernotsupported",lf("Sorry, this browser is not supported."));initLogin();var i=parseHash();appcache.init(function(){try{!pxt.BrowserUtils.isIFrame()||"pub"!==i.cmd&&"sandbox"!==i.cmd?theEditor&&!theEditor.home.state.visible&&theEditor.state&&theEditor.state.header&&!theEditor.state.header.isDeleted&&(location.hash="#reload"):location.hash="#"+i.cmd+":"+i.arg,location.reload()}catch(t){pxt.reportException(t),location.reload()}}),pxt.hex.showLoading=function(t){return core.showLoading("hexcloudcompiler",t)},pxt.hex.hideLoading=function(){return core.hideLoading("hexcloudcompiler")},pxt.docs.requireMarked=function(){return require("marked")};var o=function(t,e){return void 0===e&&(e=!1),theEditor.importHex(t,e)},r=/^(https:\/\/[^/]+)/.exec(window.location.href);r&&(Cloud.apiRoot=r[1]+"/api/");var n=/ws=(\w+)/.exec(window.location.href),a=pxt.shell.isSandboxMode()||pxt.shell.isReadOnly();n?workspace.setupWorkspace(n[1]):pxt.appTarget.appTheme.allowParentController?workspace.setupWorkspace("iframe"):a?workspace.setupWorkspace("mem"):pxt.winrt.isWinRT()?workspace.setupWorkspace("uwp"):Cloud.isLocalHost()&&workspace.setupWorkspace("fs"),Promise.resolve().then(function(){var e=/(live)?(force)?lang=([a-z]{2,}(-[A-Z]+)?)/i.exec(window.location.href);e&&window.location.hash.indexOf(e[0])>=0&&pxt.BrowserUtils.changeHash(window.location.hash.replace(e[0],""));var i=e?e[3]:lang.getCookieLang()||pxt.appTarget.appTheme.defaultLocale||navigator.userLanguage||navigator.language,o=!pxt.appTarget.appTheme.disableLiveTranslations||e&&!!e[1],r=!!e&&!!e[2];return Util.updateLocalizationAsync(pxt.appTarget.id,!1,t.commitCdnUrl,i,pxt.appTarget.versions.pxtCrowdinBranch,pxt.appTarget.versions.targetCrowdinBranch,o,r).then(function(){return pxt.Util.isLocaleEnabled(i)?lang.setCookieLang(i):pxt.tickEvent("unavailablelocale."+i+(r?".force":"")),pxt.tickEvent("locale."+pxt.Util.userLanguage()+(o?".live":"")),Util.downloadSimulatorLocalizationAsync(pxt.appTarget.id,t.commitCdnUrl,i,pxt.appTarget.versions.pxtCrowdinBranch,pxt.appTarget.versions.targetCrowdinBranch,o,r)}).then(function(t){t&&simulator.setTranslations(t)})}).then(function(){return pxt.BrowserUtils.initTheme()}).then(function(){return cmds.initCommandsAsync()}).then(function(){return workspace.initAsync()}).then(function(){return render(),workspace.syncAsync()}).then(function(t){return t&&theEditor.setState({editorState:t}),initSerial(),initScreenshots(),initHashchange(),initExtensionsAsync()}).then(function(){return pxt.winrt.initAsync(o)}).then(function(){return pxt.winrt.hasActivationProjectAsync()}).then(function(t){var e=theEditor.settings.fileHistory.filter(function(t){return!!workspace.getHeader(t.id)})[0],o=workspace.getHeaders()[0];return e&&(o=workspace.getHeader(e.id)),theEditor.shouldShowHomeScreen()&&!t?Promise.resolve():(theEditor.setState({home:!1}),i.cmd&&handleHash(i,!0)?Promise.resolve():t?pxt.winrt.loadActivationProject():o?theEditor.loadHeaderAsync(o,theEditor.state.editorState):(theEditor.newProject(),Promise.resolve()))}).done(function(){return $("#loading").remove(),workspace.loadedAsync()}),document.addEventListener("visibilitychange",function(t){theEditor&&theEditor.updateVisibility()}),window.addEventListener("unload",function(t){theEditor&&theEditor.saveSettings()}),window.addEventListener("resize",function(t){theEditor&&theEditor.editor&&theEditor.editor.resize(t)},!1);var s=window.ipcRenderer;s&&s.on("responseFromApp",function(t,e){try{simulator.driver.postMessage(JSON.parse(e))}catch(t){}}),window.addEventListener("message",function(t){var e=t.data;if(e){if("parent"==t.data.__proxy){pxt.debug("received parent proxy message"+t.data),delete t.data.__proxy;var i=window.ipcRenderer;i?i.sendToHost("sendToApp",t.data):window.parent&&window!=window.parent&&window.parent.postMessage(t.data,"*")}"tutorial"!=e.type&&"popoutcomplete"!=e.type||theEditor&&theEditor.editor&&theEditor.handleMessage(e),"sidedocready"===e.type&&Cloud.isLocalHost()&&Cloud.localToken&&(container.SideDocs.notify({type:"localtoken",localToken:Cloud.localToken}),tutorial.TutorialContent.notify({type:"localtoken",localToken:Cloud.localToken}))}},!1)});

},{"./accessibility":1,"./appcache":3,"./blocks":5,"./cmds":9,"./compiler":11,"./container":12,"./core":13,"./data":14,"./debugger":16,"./draganddrop":17,"./editortoolbar":18,"./extensions":20,"./filelist":21,"./hidbridge":24,"./lang":26,"./make":27,"./monaco":29,"./monacoSnippets":30,"./notification":31,"./package":32,"./projects":33,"./pxtjson":34,"./screenshot":35,"./scriptsearch":36,"./serial":37,"./serialindicator":38,"./share":39,"./simtoolbar":40,"./simulator":41,"./sounds":42,"./sui":44,"./tdlegacy":45,"./tutorial":46,"./workspace":47,"marked":115,"react":269,"react-dom":142}],3:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var core=require("./core");function init(e){var t=window.applicationCache;pxt.appTarget.appTheme&&pxt.appTarget.appTheme.noReloadOnUpdate||t.addEventListener("updateready",function(){core.infoNotification(lf("Update download complete. Reloading... ")),setTimeout(function(){pxt.tickEvent("appcache.updated"),e()},3e3)},!1)}exports.init=init;

},{"./core":13}],4:[function(require,module,exports){
"use strict";var _context;function context(){return _context||(_context=freshContext()),_context}function freshContext(){if(window.AudioContext=window.AudioContext||window.webkitAudioContext,window.AudioContext)try{return new window.AudioContext}catch(t){}}function play(t,n){if(void 0===n&&(n=1),t){var e=context();if(e){var o=e.createBufferSource();o.buffer=t;var i=e.createGain();i.gain.value=n,o.connect(i),i.connect(e.destination),o.start(0)}}}function loadAsync(t){var n=context();return new Promise(function(e,o){n.decodeAudioData(t,function(t){return e(t)},function(){e(void 0)})})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.play=play,exports.loadAsync=loadAsync;

},{}],5:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}();Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),pkg=require("./package"),core=require("./core"),srceditor=require("./srceditor"),compiler=require("./compiler"),debug=require("./debugger"),CategoryMode=pxt.toolbox.CategoryMode,Util=pxt.Util,Editor=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isFirstBlocklyLoad=!0,e.showToolboxCategories=CategoryMode.Basic,e}return __extends(e,t),e.prototype.setVisible=function(e){t.prototype.setVisible.call(this,e),this.isVisible=e;var o="#blocksEditor .blocklyToolboxDiv, #blocksEditor .blocklyWidgetDiv, #blocksEditor .blocklyToolboxDiv";this.isVisible?($(o).show(),this.parent.fireResize()):($(o).hide(),this.editor&&Blockly.hideChaff())},e.prototype.saveToTypeScript=function(){var t=this;if(!this.typeScriptSaveable)return Promise.resolve("");this.clearHighlightedStatements();try{return pxt.blocks.compileAsync(this.editor,this.blockInfo).then(function(e){return t.compilationResult=e,pxt.tickActivity("blocks.compile"),t.compilationResult.source})}catch(t){return pxt.reportException(t),core.errorNotification(lf("Sorry, we were not able to convert this program.")),Promise.resolve("")}},e.prototype.updateBlocksInfo=function(t){this.blockInfo=t,this.refreshToolbox()},e.prototype.domUpdate=function(){var t=this;if(this.delayLoadXml){if(this.loadingXml)return;pxt.debug("loading blockly"),this.loadingXml=!0;var e=document.createElement("div");e.className="ui inverted loading";var o=document.getElementById("blocksEditor");o.appendChild(e),this.loadingXmlPromise=this.loadBlocklyAsync().then(function(){return compiler.getBlocksAsync()}).then(function(e){t.blockInfo=e;var o,i=t.showSearch,r=t.getDefaultToolbox(t.showToolboxCategories);t.showToolboxCategories===CategoryMode.Basic&&(o=pxt.blocks.initBlocks(t.blockInfo,r,CategoryMode.All,t.filters,t.extensions));var l=pxt.blocks.initBlocks(t.blockInfo,r,t.showToolboxCategories,t.filters,t.extensions);t.updateToolbox(l,t.showToolboxCategories),t.showToolboxCategories!==CategoryMode.None&&i?pxt.blocks.initSearch(t.editor,l,o||l,function(t){return compiler.apiSearchAsync(t).then(function(t){return t})},function(e){return t.updateToolbox(e,t.showToolboxCategories,!0)}):pxt.blocks.removeSearch(),pxt.blocks.initFlyouts(t.editor),pxt.blocks.initExtensions(t.editor,t.extensions,function(e){var o=t.extensions.filter(function(t){return t.name==e})[0],i=pxt.github.parseRepoId(o.installedVersion);pxt.packagesConfigAsync().then(function(e){var r=pxt.github.repoStatus(i,e),l=i.fullName.substr(i.fullName.indexOf("/")+1),s=pxt.Cloud.isLocalHost()&&/^file:/.test(o.installedVersion)&&o.extension.localUrl,n=pxt.Cloud.isLocalHost()&&/debugExtensions/i.test(window.location.href)?"http://localhost:3232/extension.html":s?o.extension.localUrl:"https://"+i.owner+".github.io/"+l+"/";t.parent.openExtension(o.name,n,0==r)})}),pxt.debug("loading block workspace");var s=t.delayLoadXml;t.delayLoadXml=void 0,t.loadBlockly(s),t.resize(),Blockly.svgResize(t.editor),t.isFirstBlocklyLoad=!1}).finally(function(){t.loadingXml=!1,o.removeChild(e),core.hideLoading("loadingblocks")}),this.isFirstBlocklyLoad?core.showLoadingAsync("loadingblocks",lf("loading..."),this.loadingXmlPromise).done():this.loadingXmlPromise.done(),this.loadingXmlPromise=null}},e.prototype.saveBlockly=function(){return this.delayLoadXml?this.delayLoadXml:this.serializeBlocks()},e.prototype.serializeBlocks=function(t){var e=pxt.blocks.saveWorkspaceXml(this.editor);return t&&(e=e.replace(/(x|y|id)="[^"]*"/g,"")),pxt.debug(e),e},e.prototype.loadBlockly=function(t){if(this.serializeBlocks()==t)return this.typeScriptSaveable=!0,pxt.debug("blocks already loaded..."),!1;this.typeScriptSaveable=!1,this.editor.clear();try{var e=pxt.blocks.importXml(t||'<block type="'+ts.pxtc.ON_START_TYPE+'"></block>',this.blockInfo,!0),o=Blockly.Xml.textToDom(e);Blockly.Xml.domToWorkspace(o,this.editor),this.initLayout(),this.editor.clearUndo(),this.reportDeprecatedBlocks(),this.typeScriptSaveable=!0}catch(t){return pxt.log(t),this.editor.clear(),this.switchToTypeScript(),this.changeCallback(),!1}return this.changeCallback(),!0},e.prototype.initLayout=function(){var t,e,o=!1,i=!this.editor.toolbox_&&this.editor.flyout_;this.editor.getTopComments(!1).forEach(function(i){var r=i.getBoundingRectangle().topLeft;(void 0===t||r.x<t)&&(t=r.x),(void 0===e||r.y<e)&&(e=r.y),o=o||0==r.x&&0==r.y}),this.editor.getTopBlocks(!1).forEach(function(i){var r=i.getBoundingRectangle().topLeft;(void 0===t||r.x<t)&&(t=r.x),(void 0===e||r.y<e)&&(e=r.y),o=o||i.type!=ts.pxtc.ON_START_TYPE&&0==r.x&&0==r.y}),o&&!i?pxt.blocks.layout.flow(this.editor,{useViewWidth:!0}):(this.editor.getTopComments(!1).forEach(function(o){return o.moveBy(-t,-e)}),this.editor.getTopBlocks(!1).forEach(function(o){return o.moveBy(-t,-e)}),this.editor.scrollX=i?this.editor.flyout_.width_+10:10,this.editor.scrollY=10,this.editor.resizeContents())},e.prototype.initPrompts=function(){Blockly.alert=function(t,e){return core.confirmAsync({hideCancel:!0,header:lf("Alert"),agreeLbl:lf("Ok"),agreeClass:"positive",agreeIcon:"checkmark",body:t,size:"tiny"}).then(function(){e&&e()})},Blockly.confirm=function(t,e){return core.confirmAsync({header:lf("Confirm"),body:t,agreeLbl:lf("Yes"),agreeClass:"cancel",agreeIcon:"cancel",disagreeLbl:lf("No"),disagreeClass:"positive",disagreeIcon:"checkmark",size:"tiny"}).then(function(t){e(1==t)})},Blockly.prompt=function(t,e,o){return core.promptAsync({header:t,defaultValue:e,agreeLbl:lf("Ok"),disagreeLbl:lf("Cancel"),size:"tiny"}).then(function(t){o(t)})}},e.prototype.initToolboxPosition=function(){var t=this,e=Blockly.Toolbox.prototype.position;Blockly.Toolbox.prototype.position=function(){e.call(this),t.resizeToolbox()}},e.prototype.reportDeprecatedBlocks=function(){var t={},e=!1;for(var o in this.blockInfo.blocks.forEach(function(e){e.attributes.deprecated&&(t[e.attributes.blockId]=0)}),this.editor.getAllBlocks().forEach(function(o){t[o.type]>=0&&(t[o.type]++,e=!0)}),t)0===t[o]&&delete t[o];e&&pxt.tickEvent("blocks.usingDeprecated",t)},e.prototype.contentSize=function(){return this.editor?pxt.blocks.blocksMetrics(this.editor):void 0},e.prototype.isIncomplete=function(){return!!this.editor&&this.editor.isDragging()},e.prototype.prepare=function(){this.isReady=!0},e.prototype.prepareBlockly=function(t){var e=this,o=document.getElementById("blocksEditor");o.innerHTML="",this.editor=Blockly.inject(o,this.getBlocklyOptions(t));var i=Blockly.Colours;Util.jsonMergeFrom(i,pxt.appTarget.appTheme.blocklyColors||{}),Blockly.Colours=i,this.editor.addChangeListener(function(t){if(Blockly.Events.disableOrphans(t),"ui"!=t.type&&e.changeCallback(),"create"==t.type){var o=t.xml.getAttribute("type");pxt.tickActivity("blocks.create","blocks.create."+o),"SHADOW"==t.xml.tagName&&e.cleanUpShadowBlocks(),e.parent.setState({hideEditorFloats:!1})}if("ui"==t.type&&"category"==t.element){var i=!!t.newValue;i&&pxt.analytics.enableCookies(),e.parent.setState({hideEditorFloats:i}),t.newValue==pxt.toolbox.addPackageTitle()?e.addPackage():t.newValue==pxt.toolbox.advancedTitle()&&(e.showToolboxCategories===CategoryMode.All?e.showToolboxCategories=CategoryMode.Basic:e.showToolboxCategories===CategoryMode.Basic&&(e.showToolboxCategories=CategoryMode.All),e.refreshToolbox())}}),this.initPrompts(),this.initToolboxPosition(),this.resize()},e.prototype.resize=function(t){var e=document.getElementById("blocksArea"),o=document.getElementById("blocksEditor");e&&o&&this.editor&&(o.style.width=e.offsetWidth+"px",o.style.height=e.offsetHeight+"px",Blockly.svgResize(this.editor),this.resizeToolbox())},e.prototype.resizeToolbox=function(){var t=document.getElementById("blocksEditor");if(t){var e=t.getElementsByClassName("blocklyToolboxDiv")[0];if(e){this.parent.updateEditorLogo(e.clientWidth);var o=this.getBlocklyOptions(this.showToolboxCategories),i=t.offsetHeight;o.horizontalLayout||(e.style.height=i+"px")}}},e.prototype.hasUndo=function(){return!!this.editor&&0!=this.editor.undoStack_.length},e.prototype.undo=function(){this.editor&&(this.editor.undo(),this.parent.forceUpdate())},e.prototype.hasRedo=function(){return!!this.editor&&0!=this.editor.redoStack_.length},e.prototype.redo=function(){this.editor&&(this.editor.undo(!0),this.parent.forceUpdate())},e.prototype.zoomIn=function(){this.editor&&this.editor.zoomCenter(2)},e.prototype.zoomOut=function(){this.editor&&this.editor.zoomCenter(-2)},e.prototype.setScale=function(t){this.editor&&t!=this.editor.scale&&this.editor.setScale(t)},e.prototype.closeFlyout=function(){this.editor&&Blockly.hideChaff()},e.prototype.getId=function(){return"blocksArea"},e.prototype.display=function(){var t=this;return React.createElement("div",null,React.createElement("div",{id:"blocksEditor"}),this.parent.state.debugging?React.createElement(debug.DebuggerVariables,{ref:function(e){return t.debugVariables=e},parent:this.parent}):void 0)},e.prototype.addPackage=function(){pxt.tickEvent("blocks.addpackage"),this.editor.toolbox_.clearSelection(),this.parent.addPackage()},e.prototype.getViewState=function(){return{}},e.prototype.setViewState=function(t){},e.prototype.getCurrentSource=function(){return this.editor&&!this.delayLoadXml?this.saveBlockly():this.currSource},e.prototype.acceptsFile=function(t){return"blocks"==t.getExtension()},e.prototype.overrideFile=function(t){this.delayLoadXml?(this.delayLoadXml=t,this.currSource=t):this.loadBlockly(t)},e.prototype.loadBlocklyAsync=function(){var t=this;return this._loadBlocklyPromise||(this._loadBlocklyPromise=pxt.BrowserUtils.loadBlocklyAsync().then(function(){pxt.blocks.openHelpUrl=function(e){pxt.tickEvent("blocks.help",{url:e},{interactiveConsent:!0});var o=/^\/pkg\/([^#]+)#(.+)$/.exec(e);if(o){var i=pkg.mainPkg.deps[o[1]];if(i&&"github"==i.verProtocol())return e="/pkg/"+i.verArgument().replace(/#.*$/,"")+"#"+o[2],void window.open(e,o[1])}/^\//.test(e)?t.parent.setSideDoc(e):window.open(e,"docs")},t.prepareBlockly()}).then(function(){return pxt.appTarget.appTheme&&pxt.appTarget.appTheme.extendFieldEditors?pxt.BrowserUtils.loadScriptAsync("fieldeditors.js").then(function(){return pxt.editor.initFieldExtensionsAsync({})}).then(function(t){t.fieldEditors&&t.fieldEditors.forEach(function(t){pxt.blocks.registerFieldEditor(t.selector,t.editor,t.validator)})}):Promise.resolve()})),this._loadBlocklyPromise},e.prototype.loadFileAsync=function(t){var e=this;return Util.assert(!this.delayLoadXml),Util.assert(!this.loadingXmlPromise),this.loadBlocklyAsync().then(function(){pxt.blocks.cleanBlocks(),e.blockInfo=void 0,e.currSource=t.content,e.typeScriptSaveable=!1,e.setDiagnostics(t),e.delayLoadXml=t.content,e.editor.clear(),e.editor.clearUndo(),e.currFile&&e.currFile!=t&&e.filterToolbox(null),e.parent.state.editorState&&e.parent.state.editorState.filters?e.filterToolbox(e.parent.state.editorState.filters):e.filters=null,e.parent.state.editorState&&void 0!=e.parent.state.editorState.searchBar?e.showSearch=e.parent.state.editorState.searchBar:e.showSearch=!0,e.parent.state.editorState&&void 0!=e.parent.state.editorState.hasCategories?e.showToolboxCategories=e.parent.state.editorState.hasCategories?CategoryMode.Basic:CategoryMode.None:e.showToolboxCategories=CategoryMode.Basic,e.currFile=t;var o=document.getElementById("blocklySearchInputField");o&&o.value&&(o.value=""),e.extensions=pkg.allEditorPkgs().map(function(t){return t.getKsPkg()}).map(function(t){return!!t&&t.config}).filter(function(t){return!!t&&!!t.extension&&/^(file:|github:)/.test(t.installedVersion)})})},e.prototype.switchToTypeScript=function(){pxt.tickEvent("blocks.switchjavascript"),this.parent.closeFlyout(),this.parent.switchTypeScript()},e.prototype.setDiagnostics=function(t){var e=this;if(Util.assert(void 0!=this.editor),this.compilationResult&&!this.delayLoadXml&&!this.loadingXml){this.editor.getAllBlocks().filter(function(t){return!t.disabled}).forEach(function(t){t.setWarningText(null),t.setHighlightWarning(!1)});var o=t.epkg.files[t.getVirtualFileName()];if(o&&o.diagnostics){var i=o.diagnostics.filter(function(t){return t.category==ts.pxtc.DiagnosticCategory.Error}),r=this.compilationResult.sourceMap;i.filter(function(t){return t.category==ts.pxtc.DiagnosticCategory.Error}).forEach(function(t){var o=pxt.blocks.findBlockId(r,{start:t.line,length:0});if(o){var i=e.editor.getBlockById(o);if(i){var l=ts.pxtc.flattenDiagnosticMessageText(t.messageText,"\n");i.setWarningText(l),i.setHighlightWarning(!0)}}})}}},e.prototype.highlightStatement=function(t,e){if(!this.compilationResult||this.delayLoadXml||this.loadingXml)return!1;if(!t)return this.editor.highlightBlock(null),this.updateDebuggerVariables(null),!1;var o=pxt.blocks.findBlockId(this.compilationResult.sourceMap,{start:t.line,length:t.endLine-t.line});return!!o&&(this.editor.highlightBlock(o),e&&this.updateDebuggerVariables(e.globals),!0)},e.prototype.updateDebuggerVariables=function(t){if(this.parent.state.debugging)if(t){var e=this.editor.getAllVariables().map(function(t){return t.name});if(e.length){for(var o in e){var i=e[o],r=l(i);this.debugVariables&&void 0!=r&&this.debugVariables.set(i,r)}this.debugVariables&&this.debugVariables.update()}else this.debugVariables&&this.debugVariables.clear()}else this.debugVariables&&this.debugVariables.clear();function l(e){for(var o=0,i=Object.keys(t);o<i.length;o++){var r=i[o];if(e===r.replace(/___\d+$/,""))return t[r]}}},e.prototype.clearHighlightedStatements=function(){this.editor.highlightBlock(null)},e.prototype.openTypeScript=function(){pxt.tickEvent("blocks.showjavascript"),this.parent.closeFlyout(),this.parent.openTypeScriptAsync().done()},e.prototype.cleanUpShadowBlocks=function(){this.editor.getTopBlocks(!1).filter(function(t){return t.isShadow_}).forEach(function(t){return t.dispose(!1)})},e.prototype.getBlocklyOptions=function(t){var e=this.getDefaultOptions();Util.jsonMergeFrom(e,pxt.appTarget.appTheme.blocklyOptions||{});var o=t?t!==CategoryMode.None:void 0!=e.hasCategories?e.hasCategories:this.showToolboxCategories;e.hasCategories=o;var i=o?document.getElementById("blocklyToolboxDefinitionCategory"):document.getElementById("blocklyToolboxDefinitionFlyout");return e.toolbox=void 0!=e.toolbox?e.toolbox:e.readOnly?void 0:i,e},e.prototype.getDefaultOptions=function(){var t=pxt.shell.isReadOnly();return{scrollbars:!0,media:pxt.webConfig.commitCdnUrl+"blockly/media/",sound:!0,trashcan:!1,collapse:!1,comments:!0,disable:!1,readOnly:t,toolboxOptions:{colour:pxt.appTarget.appTheme.coloredToolbox,inverted:pxt.appTarget.appTheme.invertedToolbox},zoom:{enabled:!1,controls:!1,wheel:!0,maxScale:2.5,minScale:.2,scaleSpeed:1.05,startScale:pxt.BrowserUtils.isMobile()?.7:.8},rtl:Util.isUserLanguageRtl()}},e.prototype.getDefaultToolbox=function(t){return void 0===t&&(t=this.showToolboxCategories),t!==CategoryMode.None?pxt.blocks.getBaseToolboxDom().documentElement:pxt.blocks.getBaseNoCategoryToolboxDom().documentElement},e.prototype.filterToolbox=function(t,e){return void 0===e&&(e=this.showToolboxCategories),this.filters=t,this.showToolboxCategories=e,this.refreshToolbox()},e.prototype.refreshToolbox=function(){if(this.blockInfo){var t,e=this.getDefaultToolbox(this.showToolboxCategories);this.showToolboxCategories!==CategoryMode.All&&(t=pxt.blocks.createToolbox(this.blockInfo,e,CategoryMode.All,this.filters,this.extensions));var o=pxt.blocks.createToolbox(this.blockInfo,e,this.showToolboxCategories,this.filters,this.extensions);return this.updateToolbox(o,this.showToolboxCategories),pxt.blocks.cachedSearchTb=o,pxt.blocks.cachedSearchTbAll=t||o,o}},e.prototype.updateToolbox=function(t,e,o){if(void 0===e&&(e=this.showToolboxCategories),void 0===o&&(o=!1),!pxt.shell.isReadOnly()){pxt.debug("updating toolbox");var i=this.editor;if(i.toolbox_&&e!==CategoryMode.None||i.flyout_&&e===CategoryMode.None){var r=(new XMLSerializer).serializeToString(t);if(r==this.cachedToolbox)return;this.cachedToolbox=r,this.editor.updateToolbox(t),!o&&i.toolbox_&&i.toolbox_.tree_&&i.toolbox_.tree_.setSelectedItem(null)}else this.delayLoadXml=this.getCurrentSource(),this.editor=void 0,this.loadingXml=!1,this.loadingXmlPromise&&(this.loadingXmlPromise.cancel(),this.loadingXmlPromise=null),this.prepareBlockly(e),this.domUpdate(),this.editor.scrollCenter()}},e}(srceditor.Editor);exports.Editor=Editor;

},{"./compiler":11,"./core":13,"./debugger":16,"./package":32,"./srceditor":43,"react":269}],6:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}();Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),ReactDOM=require("react-dom"),BlocksPreview=function(e){function t(t){var r=e.call(this,t)||this;return r.state={},r}return __extends(t,e),t.prototype.renderSvg=function(){var e=$(ReactDOM.findDOMNode(this)),t=pxt.blocks.render(this.props.xml);e.children().remove(),e.append(t)},t.prototype.componentDidMount=function(){this.renderSvg()},t.prototype.componentDidUpdate=function(){this.renderSvg()},t.prototype.render=function(){return React.createElement("div",{style:{width:"100%",minHeight:"10em",direction:"ltr"}})},t}(React.Component);exports.BlocksPreview=BlocksPreview;

},{"react":269,"react-dom":142}],7:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),sui=require("./sui"),OUT_OF_BOUND_MARGIN=300,Carousel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.arrows=[],e.isDragging=!1,e.definitelyDragging=!1,e.currentOffset=0,e.index=0,e.childrenElements=[],e}return __extends(e,t),e.prototype.componentWillReceiveProps=function(t){void 0!=t.selectedIndex&&this.setIndex(t.selectedIndex)},e.prototype.render=function(){var t=this;this.childrenElements=[],this.arrows=[];var e=this.state||{},i=e.rightDisabled,n=e.leftDisabled;return React.createElement("div",{className:"ui carouselouter"},React.createElement("span",{className:"carouselarrow left aligned"+(n?" arrowdisabled":""),tabIndex:n?-1:0,onClick:function(){return t.onArrowClick(!0)},ref:function(e){return t.arrows.push(e)}},React.createElement(sui.Icon,{icon:"circle angle left"})),React.createElement("div",{className:"carouselcontainer",ref:function(e){return t.container=e}},React.createElement("div",{className:"carouselbody",ref:function(e){return t.dragSurface=e}},React.Children.map(this.props.children,function(e,i){return e?React.createElement("div",{className:"carouselitem "+(t.props.selectedIndex==i?"selected":""),ref:function(e){return e&&t.childrenElements.push(e)}},e):void 0}))),React.createElement("span",{className:"carouselarrow right aligned"+(i?" arrowdisabled":""),tabIndex:i?-1:0,onClick:function(){return t.onArrowClick(!1)},ref:function(e){return t.arrows.push(e)}},React.createElement(sui.Icon,{icon:"circle angle right"})))},e.prototype.onArrowClick=function(t){this.setIndex(t?this.index-this.actualPageLength:this.index+this.actualPageLength)},e.prototype.componentDidMount=function(){var t=this;this.initDragSurface(),this.updateDimensions(),window.addEventListener("resize",function(e){t.updateDimensions()})},e.prototype.componentDidUpdate=function(){this.updateDimensions()},e.prototype.updateDimensions=function(){if(this.container){var t=!1;if(this.containerWidth=this.container.getBoundingClientRect().width,this.getArrowWidth(),this.childrenElements.length){var e=this.childrenElements[0].getBoundingClientRect().width;e!==this.childWidth&&(this.childWidth=e,t=!0),this.actualPageLength=Math.floor(this.containerWidth/this.childWidth)}this.dragSurface.style.width=this.totalLength()+"px",this.updateArrows(),this.index>=this.maxIndex()&&(t=!0,this.index=this.maxIndex()),t&&this.setPosition(this.indexToOffset(this.index))}},e.prototype.initDragSurface=function(){var t=this,e=function(e){t.definitelyDragging=!1,t.dragStart(getX(e))},i=function(e){t.isDragging&&(t.dragEnd(),t.definitelyDragging&&(e.preventDefault(),e.stopPropagation()))},n=function(e){t.isDragging&&t.dragEnd()},r=function(e){if(t.isDragging){var i=getX(e);Math.abs(i-t.dragStartX)>3&&(t.definitelyDragging=!0),e.stopPropagation(),e.preventDefault(),window.requestAnimationFrame(function(){t.dragMove(i)})}};this.dragSurface.addEventListener("click",function(e){t.definitelyDragging&&(e.stopPropagation(),e.preventDefault())}),window.PointerEvent?(this.dragSurface.addEventListener("pointerdown",e),this.dragSurface.addEventListener("pointerup",i),this.dragSurface.addEventListener("pointerleave",n),this.dragSurface.addEventListener("pointermove",r)):(this.dragSurface.addEventListener("mousedown",e),this.dragSurface.addEventListener("mouseup",i),this.dragSurface.addEventListener("mouseleave",n),this.dragSurface.addEventListener("mousemove",r),pxt.BrowserUtils.isTouchEnabled()&&(this.dragSurface.addEventListener("touchstart",e),this.dragSurface.addEventListener("touchend",i),this.dragSurface.addEventListener("touchcancel",n),this.dragSurface.addEventListener("touchmove",r)))},e.prototype.dragStart=function(t){this.isDragging=!0,this.dragStartX=t,this.dragStartOffset=this.currentOffset,this.animationId&&(window.cancelAnimationFrame(this.animationId),this.animationId=0)},e.prototype.dragEnd=function(){this.isDragging=!1,this.calculateIndex()},e.prototype.dragMove=function(t){this.dragOffset=t-this.dragStartX;var e=this.dragStartOffset+this.dragOffset;this.setPosition(e)},e.prototype.setPosition=function(t){this.dragSurface&&(t=Math.max(Math.min(t,OUT_OF_BOUND_MARGIN),this.maxScrollOffset()),this.currentOffset=t,this.dragSurface.style.marginLeft=t+"px")},e.prototype.calculateIndex=function(){if(this.dragSurface){var t=Math.abs(Math.floor(this.currentOffset/this.childWidth)),e=void 0;e=this.currentOffset<this.dragStartOffset?t:t-1,this.setIndex(e,100)}},e.prototype.setIndex=function(t,e){var i=Math.max(Math.min(t,this.maxIndex()),0);e||(e=100*Math.abs(i-this.index)),this.index=i,this.updateArrows(),this.animation=new AnimationState(this.currentOffset,this.indexToOffset(this.index),e),this.animationId||(this.animationId=window.requestAnimationFrame(this.easeTowardsIndex.bind(this)))},e.prototype.easeTowardsIndex=function(t){this.dragSurface&&(this.setPosition(this.animation.getPosition(t)),this.animation.isComplete?(this.animation=void 0,this.animationId=0):this.animationId=window.requestAnimationFrame(this.easeTowardsIndex.bind(this)))},e.prototype.indexToOffset=function(t){return t<=0?0:t===this.maxIndex()?-1*(this.totalLength()-this.containerWidth-OUT_OF_BOUND_MARGIN+2*this.arrowWidth):-1*(t*this.childWidth-this.childWidth*this.props.bleedPercent/100)},e.prototype.totalLength=function(){return React.Children.count(this.props.children)*this.childWidth+OUT_OF_BOUND_MARGIN},e.prototype.getArrowWidth=function(){var t=this;this.arrows.length&&(this.arrowWidth=0,this.arrows.forEach(function(e){e&&(t.arrowWidth=Math.max(e.getBoundingClientRect().width,t.arrowWidth))}))},e.prototype.maxScrollOffset=function(){return Math.min(-1*(this.totalLength()-this.actualPageLength*this.childWidth+OUT_OF_BOUND_MARGIN),0)},e.prototype.maxIndex=function(){return Math.max(this.childrenElements.length-this.actualPageLength,0)},e.prototype.updateArrows=function(){var t=this.state||{},e=t.rightDisabled,i=t.leftDisabled,n=this.index===this.maxIndex(),r=0===this.index;n===e&&r===i||this.setState({leftDisabled:r,rightDisabled:n})},e}(React.Component);exports.Carousel=Carousel;var AnimationState=function(){function t(t,e,i){this.start=t,this.end=e,this.millis=i,this.isComplete=!1,this.slope=(e-t)/i}return t.prototype.getPosition=function(t){if(this.isComplete)return this.end;if(void 0===this.startTime)return this.startTime=t,this.start;var e=t-this.startTime;return e>this.millis?(this.isComplete=!0,this.end):this.start+Math.floor(this.slope*e)},t}();function getX(t){return"screenX"in t?t.screenX:t.changedTouches[0].screenX}

},{"./sui":44,"react":269}],8:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var db=require("./db"),core=require("./core"),pkg=require("./package"),data=require("./data"),ws=require("./workspace"),headers=new db.Table("header"),texts=new db.Table("text"),U=pxt.Util,Cloud=pxt.Cloud,lf=U.lf,allScripts=[];function lookup(e){return allScripts.filter(function(t){return t.id==e})[0]}function getHeaders(){return allScripts.map(function(e){return e.header})}function getHeader(e){var t=lookup(e);return t&&!t.header.isDeleted?t.header:null}function initAsync(e){return headers.getAllAsync().then(function(e){allScripts=e.filter(function(e){return e.target||(e.target="microbit"),e.target==pxt.appTarget.id}).map(function(e){return{id:e.id,header:e,text:null}})})}function fetchTextAsync(e){return texts.getAsync(e.id).then(function(t){return e.text||(e.text=ws.fixupFileNames(t.files)),e.textRev=t._rev,e.text})}var headerQ=new U.PromiseQueue;function getTextAsync(e){var t=lookup(e);return t?t.text?Promise.resolve(t.text):headerQ.enqueue(e,function(){return fetchTextAsync(t)}):Promise.resolve(null)}function fetchTextRevAsync(e){return e.textRev?Promise.resolve():fetchTextAsync(e).then(function(){},function(e){})}function saveCoreAsync(e,t){if(e.temporary)return Promise.resolve();var n=lookup(e.id);return U.assert(n.header===e),t&&(e.saveId=null,n.textNeedsSave=!0,n.text=t),headerQ.enqueue(e.id,function(){return(t?fetchTextRevAsync(n).then(function(){return n.textNeedsSave=!1,texts.setAsync({id:n.id,files:n.text,_rev:n.textRev}).then(function(e){n.textRev=e})}):Promise.resolve()).then(function(){return headers.setAsync(n.header)}).then(function(n){e._rev=n,data.invalidate("header:"+e.id),data.invalidate("header:*"),t&&(data.invalidate("text:"+e.id),e.saveId=null)})})}function saveAsync(e,t){return saveCoreAsync(e,t)}function installAsync(e,t){var n=e;n.id=ts.pxtc.Util.guidGen(),n.recentUse=U.nowSeconds(),n.modificationTime=n.recentUse,n.target=pxt.appTarget.id;var r={id:n.id,header:n,text:t};return allScripts.push(r),saveCoreAsync(n,t).then(function(){return n})}function isProject(e){return/prj$/.test(e.editor)}function saveToCloudAsync(e){return Cloud.isLoggedIn()?syncOneUpAsync(e):Promise.resolve()}function syncOneUpAsync(e){var t={},n=lookup(e.id);return getTextAsync(e.id).then(function(){var r="",s=n.text;r=isProject(e)?JSON.stringify(s):s[Object.keys(s)[0]]||"";var i={guid:e.id,name:e.name,scriptId:e.pubId,scriptVersion:{time:e.modificationTime,baseSnapshot:"*"},meta:JSON.stringify(e.meta),status:e.pubCurrent?"published":"unpublished",recentUse:e.recentUse,editor:e.editor,script:r,target:pxt.appTarget.id};return pxt.debug("sync up "+e.id+"; "+i.script.length+" chars"),e.saveId=t,Cloud.privatePostAsync("me/installed",{bodies:[i]})}).then(function(n){var r=n.headers[0];return e.blobId=r.scriptVersion.baseSnapshot,e.saveId===t&&(e.blobCurrent=!0),saveCoreAsync(e)})}function syncAsync(){var e=0,t=0,n="",r={};if(!Cloud.hasAccessToken())return Promise.resolve(void 0);function s(e){pxt.debug("uninstall local "+e.id);var t=lookup(e.id),n=allScripts.indexOf(t);return U.assert(n>=0),allScripts.splice(n,1),e.isDeleted=!0,headerQ.enqueue(e.id,function(){return headers.deleteAsync(e).then(function(){return fetchTextRevAsync(t)}).then(function(){return texts.deleteAsync({id:e.id,_rev:t.textRev})})})}function i(e,i){if("deleted"==i.status)return e?s(e):Promise.resolve();var c=e;c||(c={id:i.guid}),t++,U.assert(c.id==i.guid);var a=i.scriptVersion.baseSnapshot;return pxt.debug("sync down "+c.id+" - "+a),U.httpGetJsonAsync(n+a).catch(core.handleNetworkError).then(function(t){U.assert(t.guid==c.id),c.blobCurrent=!0,c.blobId=a,c.modificationTime=i.scriptVersion.time,c.editor=t.editor,c.name=t.name;var n={_default_:t.script};return isProject(c)&&(n=JSON.parse(t.script)),c.recentUse=i.recentUse,delete c.isDeleted,c.pubId=t.scriptId,c.pubCurrent="published"==t.status,c.saveId=null,c.target=t.target,e||allScripts.push({header:c,text:null,id:c.id}),r[c.id]=1,saveCoreAsync(c,n)}).then(function(){return o(--t)})}function c(e){core.infoNotification(e)}function o(n){var r="";0==t&&0==e?r=lf("All synced"):(r=lf("Syncing")+" (",t&&(r+=lf("{0} down",t)),e&&(r+=(t?", ":"")+lf("{0} up",e)),r+=")"),c(r)}function a(t){return e++,syncOneUpAsync(t).then(function(){return o(--e)})}return Cloud.privateGetAsync("me/installed?format=short").then(function(e){n=e.blobcontainer;var t=U.toDictionary(e.headers,function(e){return e.guid}),r=U.toDictionary(allScripts,function(e){return e.id}),c=allScripts.map(function(e){var n,r,c=e.header;if(t.hasOwnProperty(c.id)){var o=t[c.id];return c.isDeleted?(r={guid:(n=c).id,status:"deleted",scriptVersion:{time:U.nowSeconds(),baseSnapshot:"*"}},Cloud.privatePostAsync("me/installed",{bodies:[r]}).then(function(){return s(n)})):o.scriptVersion.baseSnapshot==c.blobId?c.blobCurrent?c.recentUse!=o.recentUse?(c.recentUse=o.recentUse,saveCoreAsync(c)):Promise.resolve():a(c):c.blobCurrent?i(c,o):a(c)}return c.blobId?s(c):a(c)});return c=c.concat(e.headers.filter(function(e){return!r[e.guid]}).map(function(e){return i(null,e)})),o(),Promise.all(c)}).then(function(){return c(lf("Syncing done"))}).then(function(){return pkg.notifySyncDone(r)}).then(function(){}).catch(core.handleNetworkError)}function resetAsync(){return db.destroyAsync().then(function(){pxt.storage.clearLocal(),data.clearCache()})}function loadedAsync(){return Promise.resolve()}exports.provider={getHeaders:getHeaders,getHeader:getHeader,getTextAsync:getTextAsync,initAsync:initAsync,saveAsync:saveAsync,installAsync:installAsync,saveToCloudAsync:saveToCloudAsync,syncAsync:syncAsync,resetAsync:resetAsync,loadedAsync:loadedAsync};

},{"./core":13,"./data":14,"./db":15,"./package":32,"./workspace":47}],9:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var core=require("./core"),pkg=require("./package"),hidbridge=require("./hidbridge"),Cloud=pxt.Cloud;function browserDownloadAsync(e,n,o){return pxt.BrowserUtils.browserDownloadBinText(e,n,o,void 0,function(e){return core.errorNotification(lf("saving file failed..."))}),Promise.resolve()}function browserDownloadDeployCoreAsync(e){var n="",o=pxt.outputName().replace(/[^.]*/,""),t=e.outfiles[pxt.outputName()],s=pkg.genFileName(o),i=pxt.BrowserUtils.isBrowserDownloadWithinUserContext();return i?n=pxt.BrowserUtils.toDownloadDataUri(pxt.isOutputText()?ts.pxtc.encodeBase64(t):t,pxt.appTarget.compile.hexMimeType):pxt.isOutputText()?(pxt.debug("saving "+s),n=pxt.BrowserUtils.browserDownloadBinText(t,s,pxt.appTarget.compile.hexMimeType,e.userContextWindow,function(e){return core.errorNotification(lf("saving file failed..."))})):(pxt.debug("saving "+s),n=pxt.BrowserUtils.browserDownloadBase64(t,s,"application/x-uf2",e.userContextWindow,function(e){return core.errorNotification(lf("saving file failed..."))})),e.success?e.saveOnly&&i?pxt.commands.showUploadInstructionsAsync(s,n,core.confirmAsync):e.saveOnly||pxt.BrowserUtils.isBrowserDownloadInSameWindow()&&!i?Promise.resolve():pxt.commands.showUploadInstructionsAsync(s,n,core.confirmAsync):core.confirmAsync({header:lf("Compilation failed"),body:lf("Ooops, looks like there are errors in your program."),hideAgree:!0,disagreeLbl:lf("Close")}).then(function(){})}function showUploadInstructionsAsync(e,n,o){var t=pxt.appTarget.appTheme.boardName||lf("device"),s=pxt.appTarget.appTheme.driveDisplayName||pxt.appTarget.compile.driveName||"???",i=pxt.BrowserUtils.isBrowserDownloadWithinUserContext(),r=!pxt.BrowserUtils.isIE()&&!pxt.BrowserUtils.isEdge(),a=pxt.appTarget.appTheme.usbDocs,l=pxt.BrowserUtils.hasSaveAs(),c=pxt.appTarget.compile.useUF2?".uf2":".hex",p=i?lf("Click 'Download' to open the {0} app.",pxt.appTarget.appTheme.boardName):l?lf("Click 'Save As' and save the {0} file to the {1} drive to transfer the code into your {2}.",c,s,t):lf("Move the {0} file to the {1} drive to transfer the code into your {2}.",c,s,t),d=pxt.BrowserUtils.isBrowserDownloadWithinUserContext()?0:1e4;return o({header:i?lf("Download ready..."):lf("Download completed..."),body:p,hasCloseIcon:!0,hideCancel:!0,hideAgree:!0,buttons:[r?{label:i?lf("Download"):e,icon:"download",class:(i?"primary":"lightgrey")+" focused",url:n,fileName:e}:void 0,a?{label:lf("Help"),icon:"help",class:"lightgrey",url:a}:void 0],timeout:d}).then(function(){})}function nativeHostPostMessageFunction(){var e=window.webkit;if(e&&e.messageHandlers&&e.messageHandlers.host&&e.messageHandlers.host.postMessage)return function(n){return e.messageHandlers.host.postMessage(n)};var n=window.android;return n&&n.postMessage?function(e){return n.postMessage(JSON.stringify(e))}:void 0}function isNativeHost(){return!!nativeHostPostMessageFunction()}function nativeHostDeployCoreAsync(e){pxt.debug("native deploy"),core.infoNotification(lf("Flashing device..."));var n=e.outfiles[pxt.outputName()];return nativeHostPostMessageFunction()({name:e.downloadFileBaseName,download:n}),Promise.resolve()}function nativeHostSaveCoreAsync(e){pxt.debug("native save"),core.infoNotification(lf("Flashing device..."));var n=e.outfiles[pxt.outputName()];return nativeHostPostMessageFunction()({name:e.downloadFileBaseName,save:n}),Promise.resolve()}function hidDeployCoreAsync(e){if(pxt.tickEvent("hid.deploy"),!e.success)return browserDownloadDeployCoreAsync(e);core.infoNotification(lf("Downloading..."));var n=e.outfiles[pxtc.BINARY_UF2],o=pxtc.UF2.parseFile(pxt.Util.stringToUint8Array(atob(n)));return hidbridge.initAsync().then(function(e){return e.reflashAsync(o)})}exports.browserDownloadDeployCoreAsync=browserDownloadDeployCoreAsync,exports.nativeHostPostMessageFunction=nativeHostPostMessageFunction,exports.isNativeHost=isNativeHost;var askPairingCount=0;function askWebUSBPairAsync(e){if(pxt.tickEvent("webusb.askpair"),++askPairingCount>3)return pxt.tickEvent("webusb.askpaircancel"),browserDownloadDeployCoreAsync(e);var n=pxt.appTarget.appTheme.boardName||lf("device");return core.confirmAsync({header:lf("No device detected..."),htmlBody:"\n<p><strong>"+lf("Do you want to pair your {0} to the editor?",n)+"</strong>\n"+lf("You will get instant downloads and data logging.")+'</p>\n<p class="ui font small">The pairing experience is a one-time process.</p>\n        '}).then(function(n){return n?showFirmwareUpdateInstructionsAsync(e):browserDownloadDeployCoreAsync(e)})}function showFirmwareUpdateInstructionsAsync(e){return pxt.targetConfigAsync().then(function(n){var o=(n.firmwareUrls||{})[pxt.appTarget.simulator.boardDefinition.id];if(!o)return showWebUSBPairingInstructionsAsync(e);pxt.tickEvent("webusb.upgradefirmware");var t=pxt.appTarget.appTheme.boardName||lf("device"),s=pxt.appTarget.appTheme.driveDisplayName||"DRIVE",i='\n    <div class="ui three column grid stackable">\n        <div class="column">\n            <div class="ui">\n                <div class="content">\n                    <div class="description">\n                        <span class="ui yellow circular label">1</span>\n                        <strong>'+lf("Connect {0} to computer with USB cable",t)+'</strong>\n                        <br/>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class="column">\n            <div class="ui">\n                <div class="content">\n                    <div class="description">\n                        <span class="ui blue circular label">2</span>\n                        <strong>'+lf("Download the latest firmware")+'</strong>\n                        <br/>\n                        <a href="'+o+'" target="_blank">'+lf("Click here to update to latest firmware")+'</a>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class="column">\n            <div class="ui">\n                <div class="content">\n                    <div class="description">\n                        <span class="ui blue circular label">3</span>\n                        '+lf("Move the .uf2 file to your board")+"\n                        <br/>\n                        "+lf("Locate the downloaded .uf2 file and drag it to the {0} drive",s)+"\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>";return core.confirmAsync({header:lf("Upgrade firmware"),htmlBody:i,agreeLbl:lf("Upgraded!")}).then(function(n){return n?showWebUSBPairingInstructionsAsync(e):browserDownloadDeployCoreAsync(e)})})}function showWebUSBPairingInstructionsAsync(e){pxt.tickEvent("webusb.pair");var n=pxt.appTarget.appTheme.boardName||lf("device"),o='\n    <div class="ui three column grid stackable">\n        <div class="column">\n            <div class="ui">\n                <div class="content">\n                    <div class="description">\n                        <span class="ui yellow circular label">1</span>\n                        <strong>'+lf("Connect {0} to computer with USB cable",n)+'</strong>\n                        <br/>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class="column">\n            <div class="ui">\n                <div class="content">\n                    <div class="description">\n                        <span class="ui blue circular label">2</span>\n                        '+lf("Select the device in the pairing dialog")+'\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class="column">\n            <div class="ui">\n                <div class="content">\n                    <div class="description">\n                        <span class="ui blue circular label">3</span>\n                        '+lf('Press "Connect"')+"\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>";return core.confirmAsync({header:lf("Pair your {0}",n),agreeLbl:lf("Let's pair it!"),htmlBody:o}).then(function(n){pxt.usb.pairAsync().then(function(){return pxt.tickEvent("webusb.pair.success"),hidDeployCoreAsync(e)}).catch(function(n){return browserDownloadDeployCoreAsync(e)})})}function webUsbDeployCoreAsync(e){return pxt.tickEvent("webusb.deploy"),hidDeployCoreAsync(e).catch(function(n){return askWebUSBPairAsync(e)})}function localhostDeployCoreAsync(e){pxt.debug("local deployment..."),core.infoNotification(lf("Uploading .hex file..."));return pxt.Util.requestAsync({url:"/api/deploy",headers:{Authorization:Cloud.localToken},method:"POST",data:e,allowHttpErrors:!0}).then(function(e){200!==e.statusCode?core.errorNotification(lf("There was a problem, please try again")):0===e.json.boardCount&&core.warningNotification(lf("Please connect your {0} to your computer and try again",pxt.appTarget.appTheme.boardName))})}function initCommandsAsync(){pxt.commands.browserDownloadAsync=browserDownloadAsync,pxt.commands.saveOnlyAsync=browserDownloadDeployCoreAsync,pxt.commands.showUploadInstructionsAsync=showUploadInstructionsAsync;var e=/forceHexDownload/i.test(window.location.href);return pxt.usb.isAvailable()&&(pxt.appTarget.compile.webUSB||/webusb=1/i.test(window.location.href))&&(pxt.log("enabled webusb"),pxt.usb.setEnabled(!0),pxt.HF2.mkPacketIOAsync=pxt.usb.mkPacketIOAsync),isNativeHost()?(pxt.debug("deploy/save using webkit host"),pxt.commands.deployCoreAsync=nativeHostDeployCoreAsync,pxt.commands.saveOnlyAsync=nativeHostSaveCoreAsync):pxt.usb.isEnabled&&pxt.appTarget.compile.useUF2?pxt.commands.deployCoreAsync=webUsbDeployCoreAsync:pxt.winrt.isWinRT()?(pxt.appTarget.serial&&pxt.appTarget.serial.useHF2?(pxt.winrt.initWinrtHid(function(){return hidbridge.initAsync(!0).then(function(){})},function(){return hidbridge.disconnectWrapperAsync()}),pxt.HF2.mkPacketIOAsync=pxt.winrt.mkPacketIOAsync,pxt.commands.deployCoreAsync=hidDeployCoreAsync):(pxt.winrt.initWinrtHid(null,null),pxt.appTarget.serial&&pxt.appTarget.serial.rawHID&&(pxt.HF2.mkPacketIOAsync=pxt.winrt.mkPacketIOAsync),pxt.commands.deployCoreAsync=pxt.winrt.driveDeployCoreAsync),pxt.commands.browserDownloadAsync=pxt.winrt.browserDownloadAsync,pxt.commands.saveOnlyAsync=function(e){return pxt.winrt.saveOnlyAsync(e).then(function(e){e&&core.infoNotification(lf("file saved!"))}).catch(function(){return core.errorNotification(lf("saving file failed..."))})}):!hidbridge.shouldUse()||pxt.appTarget.serial.noDeploy||e?Cloud.isLocalHost()&&Cloud.localToken&&!e?pxt.commands.deployCoreAsync=localhostDeployCoreAsync:pxt.commands.deployCoreAsync=browserDownloadDeployCoreAsync:pxt.commands.deployCoreAsync=hidDeployCoreAsync,Promise.resolve()}exports.initCommandsAsync=initCommandsAsync;

},{"./core":13,"./hidbridge":24,"./package":32}],10:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])};return function(t,a){function c(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(c.prototype=a.prototype,new c)}}();Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),sui=require("./sui"),blockspreview=require("./blockspreview"),repeat=pxt.Util.repeatMap,CodeCardView=function(e){function t(t){var a=e.call(this,t)||this;return a.state={},a}return __extends(t,e),t.prototype.componentDidUpdate=function(){$(".ui.embed").embed()},t.prototype.render=function(){var e=this,t=this.props,a=t.color||"";a||(t.hardware&&!t.software?a="black":t.software&&!t.hardware&&(a="teal"));var c=t.url?/^[^:]+:\/\//.test(t.url)?t.url:"/"+t.url.replace(/^\.?\/?/,""):void 0,r=c&&/^\//.test(c)?"#doc:"+c:c,n=t.className,i=t.cardType,o=t.onClick?function(e){pxt.analytics.enableCookies(),t.onClick(e)}:void 0,l=t.imageUrl||(t.youTubeId?"https://img.youtube.com/vi/"+t.youTubeId+"/0.jpg":void 0),s=React.createElement("div",{ref:function(t){return e.element=t},className:"ui card "+a+" "+(t.onClick?"link":"")+" "+(n||""),role:t.role,"aria-selected":"option"===t.role?"true":void 0,"aria-label":t.ariaLabel||t.title,title:t.title,onClick:o,tabIndex:t.onClick?t.tabIndex||0:null,onKeyDown:t.onClick?sui.fireClickOnEnter:null},t.header||t.blocks||t.javascript||t.hardware||t.software||t.any?React.createElement("div",{key:"header",className:"ui content "+(t.responsive?" tall desktop only":"")},React.createElement("div",{className:"right floated meta"},t.any?React.createElement(sui.Icon,{key:"costany",icon:"ui grey circular label tiny"},t.any>0?t.any:null," "):null,repeat(t.blocks,function(e){return React.createElement(sui.Icon,{key:"costblocks"+e,icon:"puzzle orange"})}),repeat(t.javascript,function(e){return React.createElement(sui.Icon,{key:"costjs"+e,icon:"align left blue"})}),repeat(t.hardware,function(e){return React.createElement(sui.Icon,{key:"costhardware"+e,icon:"certificate black"})}),repeat(t.software,function(e){return React.createElement(sui.Icon,{key:"costsoftware"+e,icon:"square teal"})})),t.header):null,t.label||t.blocksXml||t.typeScript||l||"file"==i?React.createElement("div",{className:"ui image"},t.label?React.createElement("label",{className:"ui "+(t.labelClass?t.labelClass:"orange right ribbon")+" label"},t.label):void 0,t.blocksXml?React.createElement(blockspreview.BlocksPreview,{key:"promoblocks",xml:t.blocksXml}):void 0,t.typeScript?React.createElement("pre",{key:"promots"},t.typeScript):void 0,l?React.createElement("div",{className:"ui imagewrapper"},React.createElement("div",{className:"ui cardimage",style:{backgroundImage:'url("'+l+'")'}})," "):void 0,"file"==t.cardType?React.createElement("div",{className:"ui fileimage"}):void 0):void 0,t.icon||t.iconContent?React.createElement("div",{className:"ui imagewrapper"},React.createElement("div",{className:"ui button massive fluid "+t.iconColor+" "+(t.iconContent?"iconcontent":"")},t.icon?React.createElement(sui.Icon,{icon:"icon "+t.icon}):void 0,t.iconContent||void 0)):void 0,t.shortName||t.name||t.description?React.createElement("div",{className:"content"},t.shortName||t.name?React.createElement("div",{className:"header"},t.shortName||t.name):null,t.description?React.createElement("div",{className:"description tall"},t.description.replace(/`/g,"")):null):void 0,t.time?React.createElement("div",{className:"meta"},t.time?React.createElement("span",{key:"date",className:"date"},pxt.Util.timeSince(t.time)):null):void 0,t.extracontent?React.createElement("div",{className:"extra content"}," ",t.extracontent," "):void 0);return!t.onClick&&c?React.createElement("div",null,React.createElement("a",{href:c,target:"docs",className:"ui widedesktop hide"},s),React.createElement("a",{href:r,className:"ui widedesktop only"},s)):s},t}(React.Component);exports.CodeCardView=CodeCardView;

},{"./blockspreview":6,"./sui":44,"react":269}],11:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var pkg=require("./package"),core=require("./core"),U=pxt.Util;function setDiagnostics(e){var t=pkg.mainEditorPkg();t.forEachFile(function(e){return e.diagnostics=[]});for(var n="",s=function(e){if(e.fileName){n+=(e.category==ts.pxtc.DiagnosticCategory.Error?lf("error"):e.category==ts.pxtc.DiagnosticCategory.Warning?lf("warning"):lf("message"))+": "+e.fileName+"("+(e.line+1)+","+(e.column+1)+"): ";var s=t.filterFiles(function(t){return t.getTypeScriptName()==e.fileName})[0];s&&s.diagnostics.push(e)}var r=ts.pxtc.DiagnosticCategory[e.category].toLowerCase();n+=r+" TS"+e.code+": "+ts.pxtc.flattenDiagnosticMessageText(e.messageText,"\n")+"\n"},r=0,o=e;r<o.length;r++){s(o[r])}n||(n=U.lf("Everything seems fine!\n")),t.outputPkg.setFile("output.txt",n).numDiagnosticsOverride=e.filter(function(e){return e.category==ts.pxtc.DiagnosticCategory.Error}).length}var firstTypecheck,cachedApis,cachedBlocks,hang=new Promise(function(){});function catchUserErrorAndSetDiags(e){return function(t){return t.isUserError?(core.errorNotification(t.message),pkg.mainEditorPkg().outputPkg.setFile("output.txt",t.message).numDiagnosticsOverride=1,e):Promise.reject(t)}}function compileAsync(e){void 0===e&&(e={});var t=pkg.mainPkg.getTargetOptions();return t.isNative=e.native,t.preferredEditor=e.preferredEditor,pkg.mainPkg.getCompileOptionsAsync(t).then(function(t){return e.debug&&(t.breakpoints=!0,t.justMyCode=!0),e.trace&&(t.breakpoints=!0,t.justMyCode=!0,t.trace=!0),t.computeUsedSymbols=!0,e.forceEmit&&(t.forceEmit=!0),/test=1/i.test(window.location.href)&&(t.testMode=!0),t}).then(compileCoreAsync).then(function(e){var t=pkg.mainEditorPkg().outputPkg.files[pxtc.BINARY_ASM];return t&&!e.outfiles[pxtc.BINARY_ASM]&&(e.outfiles[pxtc.BINARY_ASM]=t.content),pkg.mainEditorPkg().outputPkg.setFiles(e.outfiles),setDiagnostics(e.diagnostics),ensureApisInfoAsync().then(function(){if(!e.usedSymbols)return e;for(var t=0,n=Object.keys(e.usedSymbols);t<n.length;t++){var s=n[t];e.usedSymbols[s]=U.lookup(cachedApis.byQName,s)}return e})}).catch(catchUserErrorAndSetDiags(hang))}function assembleCore(e){return workerOpAsync("assemble",{fileContent:e})}function assembleAsync(e){return assembleCore(".startaddr 536887040\n"+e).then(function(t){return assembleCore(".startaddr "+(536887296-4*(t.words.length+1))+"\n"+e).then(function(e){return U.assert(e.words.length==t.words.length),e})})}function compileCoreAsync(e){return workerOpAsync("compile",{options:e})}function decompileAsync(e,t,n,s){var r=pkg.mainPkg.getTargetOptions();return pkg.mainPkg.getCompileOptionsAsync(r).then(function(t){return t.ast=!0,t.testMode=!0,t.alwaysDecompileOnStart=pxt.appTarget.runtime&&pxt.appTarget.runtime.onStartUnDeletable,decompileCoreAsync(t,e)}).then(function(e){if(e.success&&t&&n&&s){var r=pxt.blocks.layout.patchBlocksFromOldWorkspace(t,n,e.outfiles[s]);e.outfiles[s]=r}return pkg.mainEditorPkg().outputPkg.setFiles(e.outfiles),setDiagnostics(e.diagnostics),e})}function decompileSnippetAsync(e,t){var n=pkg.mainPkg.getTargetOptions();return pkg.mainPkg.getCompileOptionsAsync(n).then(function(t){return t.fileSystem["___snippet.ts"]=e,t.fileSystem["___snippet.blocks"]="",t.sourceFiles.push("___snippet.ts"),t.sourceFiles.push("___snippet.blocks"),t.ast=!0,decompileCoreAsync(t,"___snippet.ts")}).then(function(e){return e.outfiles["___snippet.blocks"]})}function decompileCoreAsync(e,t){return workerOpAsync("decompile",{options:e,fileName:t})}function workerOpAsync(e,t){return pxt.worker.getWorker(pxt.webConfig.workerjs).opAsync(e,t)}exports.compileAsync=compileAsync,exports.assembleAsync=assembleAsync,exports.decompileAsync=decompileAsync,exports.decompileSnippetAsync=decompileSnippetAsync,exports.workerOpAsync=workerOpAsync;var refreshApis=!1;function waitForFirstTypecheckAsync(){return firstTypecheck||typecheckAsync()}function ensureApisInfoAsync(){return refreshApis||!cachedApis?workerOpAsync("apiInfo",{}).then(function(e){return refreshApis=!1,ts.pxtc.localizeApisAsync(e,pkg.mainPkg)}).then(function(e){cachedApis=e}):Promise.resolve()}function apiSearchAsync(e){return ensureApisInfoAsync().then(function(){return e.localizedApis=cachedApis,e.localizedStrings=pxt.Util.getLocalizedStrings(),workerOpAsync("apiSearch",{search:e})})}function formatAsync(e,t){return workerOpAsync("format",{format:{input:e,pos:t}})}function typecheckAsync(){var e=pkg.mainPkg.getCompileOptionsAsync().then(function(e){return e.testMode=!0,workerOpAsync("setOptions",{options:e})}).then(function(){return workerOpAsync("allDiags",{})}).then(setDiagnostics).then(ensureApisInfoAsync).catch(catchUserErrorAndSetDiags(null));return firstTypecheck||(firstTypecheck=e),e}function getApisInfoAsync(){return waitForFirstTypecheckAsync().then(function(){return cachedApis})}function getBlocksAsync(){return cachedBlocks?Promise.resolve(cachedBlocks):getApisInfoAsync().then(function(e){return cachedBlocks=pxtc.getBlocksInfo(e)})}function newProject(){firstTypecheck=null,cachedApis=null,cachedBlocks=null,workerOpAsync("reset",{}).done()}exports.apiSearchAsync=apiSearchAsync,exports.formatAsync=formatAsync,exports.typecheckAsync=typecheckAsync,exports.getApisInfoAsync=getApisInfoAsync,exports.getBlocksAsync=getBlocksAsync,exports.newProject=newProject;

},{"./core":13,"./package":32}],12:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),data=require("./data"),sui=require("./sui"),tutorial=require("./tutorial"),container=require("./container");function openTutorial(e,t){pxt.tickEvent("docs",{path:t},{interactiveConsent:!0}),e.setSideDoc(t)}function openDocs(e,t){pxt.tickEvent("docs",{path:t},{interactiveConsent:!0}),e.setSideDoc(t)}function renderDocItems(e,t){return pxt.appTarget.appTheme.docMenu.map(function(n){return n.tutorial?React.createElement(sui.Item,{key:"docsmenututorial"+n.path,role:"menuitem",ariaLabel:n.name,text:pxt.Util.rlf(n.name),class:"ui "+t,onClick:function(){return openTutorial(e,n.path)}}):/^\//.test(n.path)?React.createElement(sui.Item,{key:"docsmenu"+n.path,role:"menuitem",ariaLabel:n.name,text:pxt.Util.rlf(n.name),class:"ui "+t,onClick:function(){return openDocs(e,n.path)}}):React.createElement("a",{key:"docsmenulink"+n.path,role:"menuitem","aria-label":n.name,title:n.name,className:"ui item link "+t,href:n.path,target:"docs"},pxt.Util.rlf(n.name))})}var DocsMenuItem=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.shouldComponentUpdate=function(e,t,n){return!1},t.prototype.render=function(){return React.createElement(sui.DropdownMenuItem,{icon:"help circle large",class:"ui mobile hide help-dropdown-menuitem",textClass:"landscape only",title:lf("Help")},renderDocItems(this.props.parent,""))},t}(data.Component);exports.DocsMenuItem=DocsMenuItem;var SettingsMenuItem=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.openSettings=function(){pxt.tickEvent("menu.settings",void 0,{interactiveConsent:!0}),this.props.parent.openSettings()},t.prototype.addPackage=function(){pxt.tickEvent("menu.addpackage",void 0,{interactiveConsent:!0}),this.props.parent.addPackage()},t.prototype.removeProject=function(){pxt.tickEvent("menu.removeproject",void 0,{interactiveConsent:!0}),this.props.parent.removeProject()},t.prototype.showReportAbuse=function(){pxt.tickEvent("menu.reportabuse",void 0,{interactiveConsent:!0}),this.props.parent.showReportAbuse()},t.prototype.selectLang=function(){pxt.tickEvent("menu.langpicker",void 0,{interactiveConsent:!0}),this.props.parent.selectLang()},t.prototype.toggleHighContrast=function(){pxt.tickEvent("menu.togglecontrast",void 0,{interactiveConsent:!0}),this.props.parent.toggleHighContrast()},t.prototype.reset=function(){pxt.tickEvent("menu.reset",void 0,{interactiveConsent:!0}),pxt.tickEvent("reset"),this.props.parent.reset()},t.prototype.pair=function(){pxt.tickEvent("menu.pair"),this.props.parent.pair()},t.prototype.about=function(){pxt.tickEvent("menu.about"),this.props.parent.about()},t.prototype.print=function(){this.props.parent.printCode()},t.prototype.componentWillReceiveProps=function(e){var t={};void 0!=e.highContrast&&(t.highContrast=e.highContrast),Object.keys(t).length>0&&this.setState(t)},t.prototype.shouldComponentUpdate=function(e,t,n){return this.state.highContrast!=t.highContrast},t.prototype.render=function(){var e=this,t=this.state.highContrast,n=pxt.appTarget.appTheme,o=pxt.appTarget.cloud&&pxt.appTarget.cloud.packages,i=pxt.appTarget.cloud&&pxt.appTarget.cloud.sharing&&pxt.appTarget.cloud.publishing&&pxt.appTarget.cloud.importing;return React.createElement(sui.DropdownMenuItem,{icon:"setting large",title:lf("More..."),class:"more-dropdown-menuitem"},React.createElement(sui.Item,{role:"menuitem",icon:"options",text:lf("Project Settings"),onClick:function(){return e.openSettings()},tabIndex:-1}),o?React.createElement(sui.Item,{role:"menuitem",icon:"disk outline",text:lf("Extensions"),onClick:function(){return e.addPackage()},tabIndex:-1}):void 0,React.createElement(sui.Item,{role:"menuitem",icon:"print",text:lf("Print..."),onClick:function(){return e.print()},tabIndex:-1}),React.createElement(sui.Item,{role:"menuitem",icon:"trash",text:lf("Delete Project"),onClick:function(){return e.removeProject()},tabIndex:-1}),i?React.createElement(sui.Item,{role:"menuitem",icon:"warning circle",text:lf("Report Abuse..."),onClick:function(){return e.showReportAbuse()},tabIndex:-1}):void 0,React.createElement("div",{className:"ui divider"}),n.selectLanguage?React.createElement(sui.Item,{icon:"xicon globe",role:"menuitem",text:lf("Language"),onClick:function(){return e.selectLang()},tabIndex:-1}):void 0,n.highContrast?React.createElement(sui.Item,{role:"menuitem",text:t?lf("High Contrast Off"):lf("High Contrast On"),onClick:function(){return e.toggleHighContrast()},tabIndex:-1}):void 0,React.createElement(sui.Item,{role:"menuitem",icon:"sign out",text:lf("Reset"),onClick:function(){return e.reset()},tabIndex:-1}),pxt.usb.isEnabled?React.createElement(sui.Item,{role:"menuitem",icon:"usb",text:lf("Pair device"),onClick:function(){return e.pair()},tabIndex:-1}):void 0,React.createElement("div",{className:"ui mobile only divider"}),renderDocItems(this.props.parent,"mobile only"),React.createElement("div",{className:"ui divider"}),n.privacyUrl?React.createElement("a",{className:"ui item",href:n.privacyUrl,role:"menuitem",title:lf("Privacy & Cookies"),target:"_blank",tabIndex:-1},lf("Privacy & Cookies")):void 0,n.termsOfUseUrl?React.createElement("a",{className:"ui item",href:n.termsOfUseUrl,role:"menuitem",title:lf("Terms Of Use"),target:"_blank",tabIndex:-1},lf("Terms Of Use")):void 0,React.createElement(sui.Item,{role:"menuitem",text:lf("About..."),onClick:function(){return e.about()},tabIndex:-1}),n.feedbackUrl?React.createElement("div",{className:"ui divider"}):void 0,n.feedbackUrl?React.createElement("a",{className:"ui item",href:n.feedbackUrl,role:"menuitem",title:lf("Give Feedback"),target:"_blank",rel:"noopener",tabIndex:-1},lf("Give Feedback")):void 0)},t}(data.Component);exports.SettingsMenuItem=SettingsMenuItem;var MainMenu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.brandIconClick=function(){pxt.tickEvent("menu.brand",void 0,{interactiveConsent:!0}),this.props.parent.exitAndSave()},t.prototype.orgIconClick=function(){pxt.tickEvent("menu.org",void 0,{interactiveConsent:!0})},t.prototype.goHome=function(){pxt.tickEvent("menu.home",void 0,{interactiveConsent:!0}),this.props.parent.exitAndSave()},t.prototype.share=function(){pxt.tickEvent("menu.share",void 0,{interactiveConsent:!0}),this.props.parent.share()},t.prototype.launchFullEditor=function(){pxt.tickEvent("sandbox.openfulleditor",void 0,{interactiveConsent:!0}),this.props.parent.launchFullEditor()},t.prototype.openSimView=function(){pxt.tickEvent("menu.simView",void 0,{interactiveConsent:!0}),this.props.parent.openSimView()},t.prototype.openBlocks=function(){pxt.tickEvent("menu.blocks",void 0,{interactiveConsent:!0}),this.props.parent.openBlocks()},t.prototype.openJavaScript=function(e){void 0===e&&(e=!0),pxt.tickEvent("menu.javascript",void 0,{interactiveConsent:!0}),this.props.parent.openJavaScript(e)},t.prototype.exitTutorial=function(){pxt.tickEvent("menu.exitTutorial",void 0,{interactiveConsent:!0}),this.props.parent.exitTutorial()},t.prototype.render=function(){var e=this,t=this.props.parent.state,n=t.home,o=t.header,i=t.highContrast;if(n)return React.createElement("div",null);var a=pxt.appTarget.appTheme,r=pxt.appTarget.cloud&&pxt.appTarget.cloud.sharing,c=pxt.shell.isSandboxMode(),l=this.props.parent.state.tutorialOptions,s=!!l&&!!l.tutorial,p=a.docMenu&&a.docMenu.length&&!c&&!s,u=this.props.parent.state.running,m=!!this.props.parent.state.highContrast,d=(m?a.highContrastLogo:void 0)||a.logo,f=(m?a.highContrastPortraitLogo:void 0)||a.portraitLogo,h=c?a.portraitLogo:a.rightLogo,g=this.props.parent.isEmbedSimActive(),v=this.props.parent.isBlocksActive(),x=this.props.parent.isJavaScriptActive(),E=u?lf("Stop the simulator"):lf("Start the simulator");return React.createElement("div",{id:"mainmenu",className:"ui borderless fixed "+(a.invertedMenu?"inverted":"")+" menu",role:"menubar","aria-label":lf("Main menu")},c?React.createElement("div",{className:"left menu"},React.createElement("span",{id:"logo",className:"ui item logo"},React.createElement("img",{className:"ui mini image",src:h,tabIndex:0,onClick:function(){return e.launchFullEditor()},onKeyDown:sui.fireClickOnEnter,alt:a.boardName+" Logo"}))):React.createElement("div",{className:"left menu"},React.createElement("a",{"aria-label":lf("{0} Logo",a.boardName),role:"menuitem",target:"blank",rel:"noopener",className:"ui item logo brand",tabIndex:0,onClick:function(){return e.brandIconClick()},onKeyDown:sui.fireClickOnEnter},d||f?React.createElement("img",{className:"ui logo "+(d?" portrait hide":""),src:d||f,alt:lf("{0} Logo",a.boardName)}):React.createElement("span",{className:"name"},a.boardName),f?React.createElement("img",{className:"ui mini image portrait only",src:f,alt:lf("{0} Logo",a.boardName)}):null),a.betaUrl?React.createElement("a",{href:""+a.betaUrl,className:"ui red mini corner top left attached label betalabel",role:"menuitem"},lf("Beta")):void 0,s?null:React.createElement(sui.Item,{class:"icon openproject",role:"menuitem",textClass:"landscape only",icon:"home large",ariaLabel:lf("Home screen"),text:lf("Home"),onClick:function(){return e.goHome()}}),!s&&o&&r?React.createElement(sui.Item,{class:"icon shareproject",role:"menuitem",textClass:"widedesktop only",ariaLabel:lf("Share Project"),text:lf("Share"),icon:"share alternate large",onClick:function(){return e.share()}}):null,s?React.createElement(sui.Item,{class:"tutorialname",tabIndex:-1,textClass:"landscape only",text:l.tutorialName}):null),s||a.blocksOnly?void 0:React.createElement("div",{className:"ui item link editor-menuitem"},React.createElement("div",{className:"ui grid padded"},c?React.createElement(sui.Item,{class:"sim-menuitem thin portrait only",role:"menuitem",textClass:"landscape only",text:lf("Simulator"),icon:g&&u?"stop":"play",active:g,onClick:function(){return e.openSimView()},title:g?E:lf("Show Simulator")}):void 0,React.createElement(sui.Item,{class:"blocks-menuitem",role:"menuitem",textClass:"landscape only",text:lf("Blocks"),icon:"xicon blocks",active:v,onClick:function(){return e.openBlocks()},title:lf("Convert code to Blocks")}),React.createElement(sui.Item,{class:"javascript-menuitem",role:"menuitem",textClass:"landscape only",text:lf("JavaScript"),icon:"xicon js",active:x,onClick:function(){return e.openJavaScript(!1)},title:lf("Convert code to JavaScript")}),React.createElement("div",{className:"ui item toggle"}))),s?React.createElement(tutorial.TutorialMenuItem,{parent:this.props.parent}):void 0,React.createElement("div",{className:"right menu"},p?React.createElement(container.DocsMenuItem,{parent:this.props.parent}):void 0,c||s?void 0:React.createElement(container.SettingsMenuItem,{parent:this.props.parent,highContrast:i}),c&&!a.hideEmbedEdit?React.createElement(sui.Item,{role:"menuitem",icon:"external",textClass:"mobile hide",text:lf("Edit"),onClick:function(){return e.launchFullEditor()}}):void 0,s?React.createElement(sui.ButtonMenuItem,{class:"exit-tutorial-btn",role:"menuitem",icon:"external",text:lf("Exit tutorial"),textClass:"landscape only",onClick:function(){return e.exitTutorial()}}):void 0,c?void 0:React.createElement("a",{href:a.organizationUrl,"aria-label":lf("{0} Logo",a.organization),role:"menuitem",target:"blank",rel:"noopener",className:"ui item logo organization",onClick:function(){return e.orgIconClick()}},a.organizationWideLogo||a.organizationLogo?React.createElement("img",{className:"ui logo "+(a.organizationWideLogo?" portrait hide":""),src:a.organizationWideLogo||a.organizationLogo,alt:lf("{0} Logo",a.organization)}):React.createElement("span",{className:"name"},a.organization),a.organizationLogo?React.createElement("img",{className:"ui mini image portrait only",src:a.organizationLogo,alt:lf("{0} Logo",a.organization)}):null)))},t}(data.Component);exports.MainMenu=MainMenu;var SideDocs=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.openingSideDoc=!1,t}return __extends(t,e),t.notify=function(e){var t=document.getElementById("sidedocsframe");t&&t.contentWindow&&t.contentWindow.postMessage(e,"*")},t.prototype.setPath=function(e,t){this.openingSideDoc=!0;var n=(pxt.webConfig.docsUrl||"/--docs")+"#doc:"+e+":"+(t?"blocks":"js")+":"+pxt.Util.localeInfo();this.setUrl(n)},t.prototype.setMarkdown=function(e){var t=pxt.webConfig.docsUrl||"/--docs",n=this.props.parent.isBlocksEditor()?"blocks":"js",o=t+"#md:"+encodeURIComponent(e)+":"+n+":"+pxt.Util.localeInfo();this.setUrl(o)},t.prototype.setUrl=function(e){var t=document.getElementById("sidedocsframe");t?t.src=e:this.props.parent.setState({sideDocsLoadUrl:e,sideDocsCollapsed:!1})},t.prototype.collapse=function(){this.props.parent.setState({sideDocsCollapsed:!0})},t.prototype.popOut=function(){t.notify({type:"popout"})},t.prototype.toggleVisibility=function(){var e=this.props.parent.state;this.props.parent.setState({sideDocsCollapsed:!e.sideDocsCollapsed}),document.getElementById("sidedocstoggle").focus()},t.prototype.componentDidUpdate=function(){this.props.parent.editor.resize();var e=document.getElementById("sidedocstoggle");this.openingSideDoc&&e&&(e.focus(),this.openingSideDoc=!1)},t.prototype.componentWillReceiveProps=function(e){var t={};void 0!=e.sideDocsCollapsed&&(t.sideDocsCollapsed=e.sideDocsCollapsed),void 0!=e.docsUrl&&(t.docsUrl=e.docsUrl),Object.keys(t).length>0&&this.setState(t)},t.prototype.shouldComponentUpdate=function(e,t,n){return this.state.sideDocsCollapsed!=t.sideDocsCollapsed||this.state.docsUrl!=t.docsUrl},t.prototype.renderCore=function(){var e=this,t=this.state,n=t.sideDocsCollapsed,o=t.docsUrl;return o?React.createElement("div",null,React.createElement("button",{id:"sidedocstoggle",role:"button","aria-label":n?lf("Expand the side documentation"):lf("Collapse the side documentation"),className:"ui icon button",onClick:function(){return e.toggleVisibility()}},React.createElement(sui.Icon,{icon:"icon large inverted "+(n?"book":"chevron right")}),n?React.createElement(sui.Icon,{icon:"large inverted chevron left hover"}):void 0),React.createElement("div",{id:"sidedocs"},React.createElement("div",{id:"sidedocsframe-wrapper"},React.createElement("iframe",{id:"sidedocsframe",src:o,title:lf("Documentation"),"aria-atomic":"true","aria-live":"assertive",sandbox:"allow-scripts allow-same-origin allow-forms allow-popups"})),React.createElement("div",{className:"ui app hide",id:"sidedocsbar"},React.createElement("a",{className:"ui icon link",role:"link",tabIndex:0,"data-content":lf("Open documentation in new tab"),"aria-label":lf("Open documentation in new tab"),onClick:function(){return e.popOut()},onKeyDown:sui.fireClickOnEnter},React.createElement(sui.Icon,{icon:"external"}))))):null},t}(data.Component);exports.SideDocs=SideDocs;var SandboxFooter=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.compile=function(){pxt.tickEvent("sandboxfooter.compile",void 0,{interactiveConsent:!0}),this.props.parent.compile()},t.prototype.shouldComponentUpdate=function(e,t,n){return!1},t.prototype.renderCore=function(){var e=this,t=pxt.appTarget.appTheme,n=lf("Download your code to the {0}",t.boardName);return React.createElement("div",{className:"ui horizontal small divided link list sandboxfooter"},t.organizationUrl&&t.organization?React.createElement("a",{className:"item",target:"_blank",rel:"noopener",href:t.organizationUrl},t.organization):void 0,React.createElement("a",{target:"_blank",className:"item",href:t.termsOfUseUrl,rel:"noopener"},lf("Terms of Use")),React.createElement("a",{target:"_blank",className:"item",href:t.privacyUrl,rel:"noopener"},lf("Privacy")),React.createElement("span",{className:"item"},React.createElement("a",{className:"ui thin portrait only",title:n,onClick:function(){return e.compile()}},React.createElement(sui.Icon,{icon:"icon "+(pxt.appTarget.appTheme.downloadIcon||"download")}),pxt.appTarget.appTheme.useUploadMessage?lf("Upload"):lf("Download"))))},t}(data.Component);exports.SandboxFooter=SandboxFooter;

},{"./container":12,"./data":14,"./sui":44,"./tutorial":46,"react":269}],13:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var ReactDOM=require("react-dom"),Cloud=pxt.Cloud,Util=pxt.Util,dimmerInitialized=!1;function isLoading(){return!!$(".ui.loading.dimmer .loadingcontent")[0]}exports.TAB_KEY=9,exports.ENTER_KEY=13,exports.SPACE_KEY=32,exports.isLoading=isLoading;var loadingQueue=[],loadingQueueMsg={};function setHighContrast(e){exports.highContrast=e}function hideLoading(e){if(pxt.debug("hideloading: "+e),void 0!=loadingQueueMsg[e]){var n=loadingQueue.indexOf(e);n>-1&&loadingQueue.splice(n,1),delete loadingQueueMsg[e]}else pxt.debug("Loading not in queue, disregard: "+e);loadingQueue.length>0?displayNextLoading():($(".ui.dimmer.loading .loadingcontent").remove(),$(".ui.dimmer.loading").dimmer("hide"),dimmerInitialized||initializeDimmer(),setTimeout(function(){$(".ui.dimmer.loading").dimmer("hide")},200))}function showLoading(e,n){pxt.debug("showloading: "+e),loadingQueueMsg[e]||(initializeDimmer(),$(".ui.dimmer.loading").dimmer("show"),$(".ui.dimmer.loading").html('\n  <div class="content loadingcontent">\n    <div class="ui text large loader main msg" aria-live="assertive">'+lf("Please wait")+"</div>\n  </div>\n"),loadingQueue.push(e),loadingQueueMsg[e]=n,displayNextLoading())}function displayNextLoading(){if(loadingQueue.length){var e=loadingQueue[loadingQueue.length-1],n=loadingQueueMsg[e];$(".ui.dimmer.loading .msg").text(n)}}function initializeDimmer(){$("#content").dimmer({dimmerName:"loading"}).dimmer({closable:!1}),dimmerInitialized=!0}exports.setHighContrast=setHighContrast,exports.hideLoading=hideLoading,exports.showLoading=showLoading;var asyncLoadingTimeout={};function showLoadingAsync(e,n,i,t){return void 0===t&&(t=700),clearTimeout(asyncLoadingTimeout[e]),asyncLoadingTimeout[e]=setTimeout(function(){showLoading(e,n)},t),i.finally(function(){cancelAsyncLoading(e)})}function cancelAsyncLoading(e){clearTimeout(asyncLoadingTimeout[e]),hideLoading(e)}function navigateInWindow(e){window.location.href=e}function findChild(e,n){var i=$(ReactDOM.findDOMNode(e));return n?i.find(n):i}function parseQueryString(e){var n={};return e.replace(/\+/g," ").replace(/([^&=]+)=?([^&]*)/g,function(e,i,t){return n[decodeURIComponent(i)]=decodeURIComponent(t),""}),n}exports.showLoadingAsync=showLoadingAsync,exports.cancelAsyncLoading=cancelAsyncLoading,exports.navigateInWindow=navigateInWindow,exports.findChild=findChild,exports.parseQueryString=parseQueryString;var lastTime={};function htmlmsg(e,n){var i=Date.now(),t=lastTime[e]||0,o=$("#msg");exports.highContrast?o.children().each(function(e,n){n.classList.contains("hc")||n.classList.add("hc")}):o.children().each(function(e,n){n.classList.contains("hc")&&n.classList.remove("hc")}),i-t<100?$("#"+e+"msg").text(n):(lastTime[e]=i,$("#"+e+"msg").finish().text(n).fadeIn("fast").delay(3e3).fadeOut("slow"))}function errorNotification(e){pxt.tickEvent("notification.error",{message:e}),htmlmsg("err",e)}function warningNotification(e){pxt.log("warning: "+e),htmlmsg("warn",e)}function infoNotification(e){pxt.debug(e),htmlmsg("info",e)}function handleNetworkError(e,n){var i=parseInt(e.statusCode);if(e.isOffline||0===i)warningNotification(lf("Network request failed; you appear to be offline"));else if(!isNaN(i)&&200!==i){if(n&&-1!==n.indexOf(i))return e;warningNotification(lf("Network request failed"))}throw e}function dialogAsync(e){var n=e.buttons?e.buttons.filter(function(e){return!!e}):[],i=(e.logos||[]).filter(function(e){return!!e}).map(function(e){return'<img class="ui logo" src="'+Util.toDataUri(e)+'" />'}).join(" "),t='\n  <div role="dialog" class="ui '+(e.size||"small")+' modal">\n    '+(e.hasCloseIcon?'<i class="close icon"></i>':"")+'\n    <div role="heading" class="header">\n        '+Util.htmlEscape(e.header)+'\n    </div>\n    <div class="content">\n      '+(e.body?"<p>"+Util.htmlEscape(e.body)+"</p>":"")+"\n      "+(e.htmlBody||"")+"\n      "+(e.input?'<div class="ui fluid action input">\n         <input class="userinput focused" spellcheck="false" placeholder="'+Util.htmlEscape(e.input)+'" type="text">\n         </div>':"")+"\n      "+(e.copyable?'<div class="ui fluid action input">\n         <input class="linkinput focused" readonly spellcheck="false" type="text" value="'+Util.htmlEscape(e.copyable)+'">\n         <button class="ui teal right labeled icon button copybtn" data-content="'+lf("Copied!")+'">\n            '+lf("Copy")+'\n            <i class="copy icon"></i>\n         </button>\n      </div>':"")+"\n    </div>";t+='<div class="actions">',t+=i,e.hideCancel||n.push({label:e.disagreeLbl||lf("Cancel"),class:e.disagreeClass||"cancel",icon:e.disagreeIcon||"cancel"});for(var o=0,a=0,s=n;a<s.length;a++){var c=s[a];t+="\n      <"+(c.url?"a":"button")+' class="ui right labeled icon button approve '+(c.class||"positive")+' focused" data-btnid="'+o+++'" '+(c.url?'href="'+c.url+'"':"")+" "+(c.fileName?'download="'+Util.htmlEscape(c.fileName)+'"':"")+' target="_blank">\n        '+Util.htmlEscape(c.label)+"\n        "+(c.icon?'<i class="'+(c.icon||"checkmark")+' icon"></i>':"")+"\n      </"+(c.url?"a":"button")+">"}t+="</div>",t+="</div>";var l=$(t);if(e.copyable&&enableCopyable(l),e.input){var r=l.find(".userinput");r.on("change",function(n){return e.inputValue=r.val()})}var d=!1,u=e.modalContext||"#root";return $(u).append(l),e.onLoaded&&e.onLoaded(l),l.find("img").on("load",function(){l.modal("refresh")}),l.find(".ui.accordion").accordion(),new Promise(function(i,t){var o,a=document.activeElement,s=e.timeout?setTimeout(function(){s=0,o.modal("hide")},e.timeout):0,c=function(e){if(!d){d=!0,s&&clearTimeout(s);var t=e.attr("data-btnid");if(t){var o=n[+t];if(o.onclick)return i(o.onclick())}return i()}};(o=l.modal({observeChanges:!0,closeable:!e.hideCancel,context:u,onHidden:function(){l.remove(),o.remove(),null!=a&&a.focus()},onApprove:c,onDeny:c,onHide:function(){d||(d=!0,s&&clearTimeout(s),i())},onVisible:function(){initializeFocusTabIndex(o.get(0),!0)}})).modal("show")})}function hideDialog(){$(".modal").modal("hide")}function confirmAsync(e){e.buttons||(e.buttons=[]);var n=0;return e.hideAgree||e.buttons.push({label:e.agreeLbl||lf("Go ahead!"),class:e.agreeClass,icon:e.agreeIcon||"checkmark",onclick:function(){n=1}}),e.deleteLbl&&e.buttons.push({label:e.deleteLbl,class:"delete red",icon:"trash",onclick:function(){n=2}}),dialogAsync(e).then(function(){return n})}function confirmDelete(e,n){confirmAsync({header:lf("Would you like to delete '{0}'?",e),body:lf("It will be deleted for good. No undo."),agreeLbl:lf("Delete"),agreeClass:"red",agreeIcon:"trash"}).then(function(e){e&&n().done()}).done()}function promptAsync(e){e.buttons||(e.buttons=[]);var n="";return e.hideAgree||e.buttons.push({label:e.agreeLbl||lf("Go ahead!"),class:e.agreeClass,icon:e.agreeIcon||"checkmark",onclick:function(){var e=document.getElementById("promptDialogInput");n=e.value}}),e.htmlBody='<div class="ui fluid icon input">\n                            <input class="focused" type="text" id="promptDialogInput" value="'+e.defaultValue+'">\n                        </div>',e.onLoaded=function(){var e=document.getElementById("promptDialogInput");e&&(e.setSelectionRange(0,9999),e.onkeyup=function(e){("number"==typeof e.which?e.which:e.keyCode)===exports.ENTER_KEY&&(e.preventDefault(),document.getElementsByClassName("approve positive").item(0).click())})},dialogAsync(e).then(function(){return n})}function shareLinkAsync(e){var n='\n  <div class="ui small modal">\n    <div class="header">\n        '+Util.htmlEscape(e.header)+'\n    </div>\n    <div class="content">\n      <p>'+Util.htmlEscape(e.body||"")+'</p>\n      <div class="ui fluid action input">\n         <input class="linkinput" readonly spellcheck="false" type="text" value="'+Util.htmlEscape(e.link)+'">\n         <button class="ui teal right labeled icon button copybtn" data-content="'+lf("Copied!")+'">\n            '+lf("Copy")+'\n            <i class="copy icon"></i>\n         </button>\n      </div>\n    </div>\n    <div class="actions">\n      <div class="ui approve right labeled icon button '+(e.okClass||"teal")+'">\n        '+Util.htmlEscape(e.okLabel||lf("Ok"))+'\n        <i class="'+(e.okIcon||"checkmark")+' icon"></i>\n      </div>\n    </div>\n  </div>\n  ',i=$(n);enableCopyable(i);var t=!1;return $("body.main").append(i),new Promise(function(e,n){return i.modal({onHidden:function(){i.remove()},onHide:function(){t||(t=!0,e(!1))}}).modal("show")})}function enableCopyable(e){var n=e.find(".copybtn");n.click(function(){try{var i=e.find(".linkinput")[0];i.focus(),i.setSelectionRange(0,i.value.length),document.execCommand("copy"),n.popup({on:"manual",inline:!0}),n.popup("show")}catch(e){}})}function scrollIntoView(e,n){if(void 0===n&&(n=0),e.length){var i=e.offsetParent(),t=Math.max(e.position().top-n,0),o=e.position().top+e.outerHeight(!0)+n,a=$(i).scrollTop(),s=$(i).height(),c=a;t<a?c=t:o>a+s&&(c=o-s),c!=a&&i.scrollTop(c)}}function resetFocus(){var e=document.getElementById("content");e.tabIndex=0,e.focus(),e.blur(),e.tabIndex=-1}function unregisterFocusTracking(e){e&&(e.firstTag.removeEventListener("keydown",e.targetArea.focusDataInfo.giveFocusToLastTagBinding),e.lastTag.removeEventListener("keydown",e.targetArea.focusDataInfo.giveFocusToFirstTagBinding),e.firstTag===e.lastTag&&(e.firstTag.removeEventListener("keydown",e.targetArea.focusDataInfo.giveFocusToFirstTagBinding),e.lastTag.removeEventListener("keydown",e.targetArea.focusDataInfo.giveFocusToLastTagBinding)))}function giveFocusToFirstTag(e){("number"==typeof e.which?e.which:e.keyCode)!==exports.TAB_KEY||e.shiftKey?e.currentTarget.classList.contains("focused")||(unregisterFocusTracking(this),initializeFocusTabIndex(this.targetArea,!0,!1)):(e.preventDefault(),unregisterFocusTracking(this),initializeFocusTabIndex(this.targetArea,!0))}function giveFocusToLastTag(e){("number"==typeof e.which?e.which:e.keyCode)===exports.TAB_KEY&&e.shiftKey?(e.preventDefault(),unregisterFocusTracking(this),initializeFocusTabIndex(this.targetArea,!0,!1),this.lastTag.focus()):e.currentTarget.classList.contains("focused")||(unregisterFocusTracking(this),initializeFocusTabIndex(this.targetArea,!0,!1))}function initializeFocusTabIndex(e,n,i,t){if(void 0===n&&(n=!1),void 0===i&&(i=!0),void 0===t&&(t=!1),(n||e===document.activeElement||!e.contains(document.activeElement))&&(unregisterFocusTracking(e.focusDataInfo),!t)){var o=e.getElementsByClassName("focused");if(0!=o.length){var a=o[0],s=o.length>1?o[o.length-1]:a,c={};c.firstTag=a,c.lastTag=s,c.targetArea=e,c.giveFocusToLastTagBinding=giveFocusToLastTag.bind(c),c.giveFocusToFirstTagBinding=giveFocusToFirstTag.bind(c),e.focusDataInfo=c,a!==s&&a.addEventListener("keydown",c.giveFocusToLastTagBinding),s.addEventListener("keydown",c.giveFocusToFirstTagBinding),i&&a.focus()}}}function apiAsync(e,n){return(n?Cloud.privatePostAsync(e,n):Cloud.privateGetAsync(e)).then(function(n){return console.log("*"),console.log("*******",e,"---\x3e"),console.log("*"),console.log(n),console.log("*"),n},function(e){console.log(e.message)})}exports.errorNotification=errorNotification,exports.warningNotification=warningNotification,exports.infoNotification=infoNotification,exports.handleNetworkError=handleNetworkError,exports.dialogAsync=dialogAsync,exports.hideDialog=hideDialog,exports.confirmAsync=confirmAsync,exports.confirmDelete=confirmDelete,exports.promptAsync=promptAsync,exports.shareLinkAsync=shareLinkAsync,exports.scrollIntoView=scrollIntoView,exports.resetFocus=resetFocus,exports.initializeFocusTabIndex=initializeFocusTabIndex,exports.apiAsync=apiAsync;

},{"react-dom":142}],14:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),core=require("./core"),gallery=require("./gallery"),Cloud=pxt.Cloud,Util=pxt.Util,virtualApis={},targetConfig=void 0;mountVirtualApi("cloud",{getAsync:function(t){return Cloud.privateGetAsync(stripProtocol(t)).catch(core.handleNetworkError)},expirationTime:function(t){return 6e4},isOffline:function(){return!Cloud.isOnline()}}),mountVirtualApi("cloud-search",{getAsync:function(t){return Cloud.privateGetAsync(stripProtocol(t)).catch(function(t){return core.handleNetworkError(t,[404]),{statusCode:404,headers:{},json:{}}})},expirationTime:function(t){return 6e4},isOffline:function(){return!Cloud.isOnline()}}),mountVirtualApi("gallery",{getAsync:function(t){return gallery.loadGalleryAsync(stripProtocol(decodeURIComponent(t))).catch(function(t){return Promise.resolve(t)})},expirationTime:function(t){return 36e5}}),mountVirtualApi("td-cloud",{getAsync:function(t){return Util.httpGetJsonAsync("https://www.touchdevelop.com/api/"+stripProtocol(t)).catch(core.handleNetworkError)},expirationTime:function(t){return 6e4}}),mountVirtualApi("gh-search",{getAsync:function(t){return pxt.targetConfigAsync().then(function(e){return pxt.github.searchAsync(stripProtocol(t),e?e.packages:void 0)}).catch(core.handleNetworkError)},expirationTime:function(t){return 6e4},isOffline:function(){return!Cloud.isOnline()}}),mountVirtualApi("gh-pkgcfg",{getAsync:function(t){return pxt.github.pkgConfigAsync(stripProtocol(t)).catch(core.handleNetworkError)},expirationTime:function(t){return 6e4},isOffline:function(){return!Cloud.isOnline()}}),mountVirtualApi("target-config",{getAsync:function(t){return pxt.targetConfigAsync().catch(core.handleNetworkError)},expirationTime:function(t){return 6e4},isOffline:function(){return!Cloud.isOnline()}});var cachedData={};function subscribe(t,e){var n=lookup(e),r=n.components;r.indexOf(t)<0&&(r.push(t),t.subscriptions.push(n))}function unsubscribe(t){var e=t.subscriptions;0!=e.length&&(t.subscriptions=[],e.forEach(function(e){var n=e.components.indexOf(t);n>=0&&e.components.splice(n,1)}))}function expired(t){return t.api.expirationTime?null==t.data||Date.now()-t.lastRefresh>t.api.expirationTime(t.path):null!=t.data}function shouldCache(t){return!(!t.data||t.data instanceof Error)&&/^cloud:(me\/settings|ptr-pkg-)/.test(t.path)}function clearCache(){cachedData={},saveCache()}function loadCache(){JSON.parse(pxt.storage.getLocal("apiCache2")||"[]").forEach(function(t){lookup(t.path).data=t.data})}function saveCache(){var t=Util.values(cachedData).filter(function(t){return shouldCache(t)}).map(function(t){return{path:t.path,data:t.data}});pxt.storage.setLocal("apiCache2",JSON.stringify(t))}function matches(t,e){return t.path.slice(0,e.length)==e}function notify(t){shouldCache(t)&&saveCache();var e=t.callbackOnce;e.length>0&&(t.callbackOnce=[],Util.nextTick(function(){return e.forEach(function(t){return t()})})),t.components.length>0&&t.components.forEach(function(t){return Util.nextTick(function(){return t.forceUpdate()})})}function getVirtualApi(t){var e=/^([\w\-]+):/.exec(t);return e&&virtualApis[e[1]]||Util.oops("bad data protocol: "+t),virtualApis[e[1]]}function queue(t){if(!(t.queued||t.api.isOffline&&t.api.isOffline())){t.queued=!0;var e=function(e){t.data=e,t.lastRefresh=Date.now(),t.queued=!1,notify(t)};t.api.isSync?e(t.api.getSync(t.path)):t.api.getAsync(t.path).done(e)}}function lookup(t){return cachedData.hasOwnProperty(t)||(cachedData[t]={path:t,data:null,lastRefresh:0,queued:!1,callbackOnce:[],components:[],api:getVirtualApi(t)}),cachedData[t]}function getCached(t,e){subscribe(t,e);var n=lookup(e);return n.api.isSync?n.api.getSync(n.path):((expired(n)||n.data instanceof Error)&&queue(n),n.data)}function mountVirtualApi(t,e){Util.assert(!virtualApis[t]),Util.assert(!!e.getSync||!!e.getAsync),Util.assert(!!e.getSync!=!!e.getAsync),e.isSync=!!e.getSync,virtualApis[t]=e}function stripProtocol(t){var e=/^([\w\-]+):(.*)/.exec(t);return e?e[2]:(Util.oops("protocol missing in: "+t),t)}function invalidate(t){Util.values(cachedData).forEach(function(e){matches(e,t)&&(e.lastRefresh=0,e.components.length>0&&queue(lookup(e.path)))})}function getAsync(t){var e=lookup(t);return e.api.isSync?Promise.resolve(e.api.getSync(e.path)):Cloud.isOnline()&&expired(e)?new Promise(function(t,n){e.callbackOnce.push(function(){t(e.data)}),queue(e)}):Promise.resolve(e.data)}exports.clearCache=clearCache,exports.mountVirtualApi=mountVirtualApi,exports.stripProtocol=stripProtocol,exports.invalidate=invalidate,exports.getAsync=getAsync;var Component=function(t){function e(e){var n=t.call(this,e)||this;return n.subscriptions=[],n.renderCoreOk=!1,n.state={},n}return __extends(e,t),e.prototype.getData=function(t){return this.renderCoreOk||Util.oops("Override renderCore() not render()"),getCached(this,t)},e.prototype.componentWillUnmount=function(){unsubscribe(this)},e.prototype.child=function(t){return core.findChild(this,t)},e.prototype.renderCore=function(){return null},e.prototype.render=function(){return unsubscribe(this),this.renderCoreOk=!0,this.renderCore()},e}(React.Component);function wrapWorkspace(t){return{initAsync:t.initAsync,resetAsync:function(){return t.resetAsync().then(function(){clearCache()})},getHeaders:t.getHeaders,getHeader:t.getHeader,syncAsync:function(){return t.syncAsync().then(function(t){return invalidate("header:*"),invalidate("text:*"),t})},getTextAsync:t.getTextAsync,saveAsync:function(e,n){return t.saveAsync(e,n).then(function(){invalidate("header:"+e.id),invalidate("text:"+e.id)})},saveToCloudAsync:t.saveToCloudAsync,saveScreenshotAsync:t.saveScreenshotAsync,installAsync:t.installAsync,loadedAsync:t.loadedAsync}}exports.Component=Component,exports.wrapWorkspace=wrapWorkspace,loadCache();

},{"./core":13,"./gallery":23,"react":269}],15:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Promise=require("bluebird");window.Promise=Promise;var PouchDB=require("pouchdb");require("pouchdb/extras/memory"),Promise.config({warnings:{wForgottenReturn:!1}});var _db=void 0,inMemory=!1;function memoryDb(){return pxt.debug("db: in memory..."),inMemory=!0,_db=new PouchDB("pxt-"+pxt.storage.storageId(),{adapter:"memory"}),Promise.resolve(_db)}function getDbAsync(){if(_db)return Promise.resolve(_db);if(pxt.shell.isSandboxMode()||pxt.shell.isReadOnly())return memoryDb();var t=new PouchDB("pxt-"+pxt.storage.storageId(),{revs_limit:2});return t.get("pouchdbsupportabletest").catch(function(e){return e&&e.error&&"indexed_db_went_bad"==e.name?memoryDb():(_db=t,Promise.resolve(_db))})}function destroyAsync(){return _db?_db.destroy():Promise.resolve()}exports.getDbAsync=getDbAsync,exports.destroyAsync=destroyAsync;var Table=function(){function t(t){this.name=t}return t.prototype.getAsync=function(t){var e=this;return getDbAsync().then(function(n){return n.get(e.name+"--"+t)}).then(function(e){return e.id=t,e})},t.prototype.getAllAsync=function(){var t=this;return getDbAsync().then(function(e){return e.allDocs({include_docs:!0,startkey:t.name+"--",endkey:t.name+"--￿"})}).then(function(t){return t.rows.map(function(t){return t.doc})})},t.prototype.deleteAsync=function(t){return getDbAsync().then(function(e){return e.remove(t)})},t.prototype.forceSetAsync=function(t){var e=this;return this.getAsync(t.id).then(function(n){return t._rev=n._rev,e.setAsync(t)},function(n){return e.setAsync(t)})},t.prototype.setAsync=function(t){return t.id&&!t._id&&(t._id=this.name+"--"+t.id),getDbAsync().then(function(e){return e.put(t)}).then(function(t){return t.rev})},t}();exports.Table=Table;var TranslationDb=function(){function t(){this.memCache={},this.table=new Table("translations")}return t.prototype.key=function(t,e,n){return t+"-"+e+"-"+(n||"")},t.prototype.getAsync=function(t,e,n){var r=this.key(t,e,n),o=this.memCache[r];return o?(pxt.debug("translation cache live hit "+r),Promise.resolve(o)):(pxt.debug("translation cache: load "+r),this.table.getAsync(r).then(function(t){return pxt.debug("translation cache hit "+r),t},function(t){pxt.debug("translation cache miss "+r)}))},t.prototype.setAsync=function(t,e,n,r,o){var i=this.key(t,e,n),c={id:i,etag:r,strings:o};pxt.debug("translation cache: save "+i+"-"+r);var s=pxt.Util.clone(c);return s.cached=!0,delete s._rev,this.memCache[i]=s,this.table.forceSetAsync(c).then(function(){},function(t){pxt.log("translate cache: conflict for "+i)})},t}();ts.pxtc.Util.translationDb=new TranslationDb;var GithubDb=function(){function t(){this.mem=new pxt.github.MemoryGithubDb,this.table=new Table("github")}return t.prototype.loadConfigAsync=function(t,e){var n=this;if("master"==e)return this.mem.loadConfigAsync(t,e);var r="config-"+t+"-"+e;return this.table.getAsync(r).then(function(t){return pxt.debug("github offline cache hit "+r),t.config},function(o){return pxt.debug("github offline cache miss "+r),n.mem.loadConfigAsync(t,e).then(function(t){return n.table.forceSetAsync({id:r,config:t}).then(function(){return t},function(e){return t})})})},t.prototype.loadPackageAsync=function(t,e){var n=this;if("master"==e)return this.mem.loadPackageAsync(t,e);var r="pkg-"+t+"-"+e;return this.table.getAsync(r).then(function(t){return pxt.debug("github offline cache hit "+r),t.package},function(o){return pxt.debug("github offline cache miss "+r),n.mem.loadPackageAsync(t,e).then(function(t){return n.table.forceSetAsync({id:r,package:t}).then(function(){return t},function(e){return t})})})},t}();pxt.github.db=new GithubDb;

},{"bluebird":50,"pouchdb":127,"pouchdb/extras/memory":125}],16:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),ReactDOM=require("react-dom"),sui=require("./sui"),data=require("./data"),simulator=require("./simulator"),DebuggerVariables=function(e){function t(t){var n=e.call(this,t)||this;return n.nextVariables={},n.state={variables:{}},n}return __extends(t,e),t.prototype.clear=function(){this.nextVariables={},this.setState({variables:{}})},t.prototype.set=function(e,t){this.nextVariables[e]=t},t.prototype.update=function(){var e=this,n=this.state.variables;Object.keys(this.nextVariables).forEach(function(i){var a=e.nextVariables[i],r="",o=typeof a;switch(o){case"number":case"boolean":r=a+"";break;case"string":r=JSON.stringify(a);break;case"object":r=null==a?"null":void 0!==a.id?"(object)":a.text?a.text:"(unknown)"}r=function(e){var n=t.MAX_VARIABLE_CHARS-3,i=!1;0==e.indexOf('"')&&(i=!0,e=e.substring(1,e.length-1));e.length>n&&(e=e.substring(0,n)+"...");i&&(e='"'+e+'"');return e}(r),n[i]={value:r,type:o,prevValue:n[i]&&r!=n[i].value?n[i].value:void 0}}),this.setState({variables:n}),this.nextVariables={}},t.prototype.renderCore=function(){var e=this.state.variables,t=pxt.toolbox.getNamespaceColor("variables");return 0==Object.keys(e).length?React.createElement("div",null):React.createElement("div",{className:"ui segment debugvariables"},React.createElement("div",{className:"ui middle aligned list"},Object.keys(e).map(function(n){var i=e[n];return React.createElement("div",{key:n,className:"item"},React.createElement("div",{className:"ui label image variable "+(void 0!==i.prevValue?"changed":""),style:{backgroundColor:t}},React.createElement("span",{className:"varname"},n),React.createElement("div",{className:"detail"},React.createElement("span",{className:"varval"},i.value+" "),React.createElement("span",{className:"previousval"},i.prevValue?"("+i.prevValue+")":""))))})))},t.MAX_VARIABLE_CHARS=20,t}(data.Component);exports.DebuggerVariables=DebuggerVariables;var DebuggerToolbar=function(e){function t(t){var n=e.call(this,t)||this;return n.cachedMaxWidth=0,n.state={},n}return __extends(t,e),t.prototype.restartSimulator=function(e){pxt.tickEvent("debugger.restart",void 0,{interactiveConsent:!0}),this.props.parent.restartSimulator(e)},t.prototype.exitDebugging=function(){pxt.tickEvent("debugger.exit",void 0,{interactiveConsent:!0}),this.props.parent.toggleDebugging()},t.prototype.dbgPauseResume=function(){pxt.tickEvent("debugger.pauseresume",void 0,{interactiveConsent:!0}),this.props.parent.dbgPauseResume()},t.prototype.dbgStepOver=function(){pxt.tickEvent("debugger.stepover",void 0,{interactiveConsent:!0}),this.props.parent.dbgStepOver()},t.prototype.dbgStepInto=function(){pxt.tickEvent("debugger.stepinto",void 0,{interactiveConsent:!0}),this.props.parent.dbgStepInto()},t.prototype.dbgStepOut=function(){pxt.tickEvent("debugger.stepout",void 0,{interactiveConsent:!0}),simulator.dbgStepOut()},t.prototype.componentDidUpdate=function(e,t){this.state.isDragging&&!t.isDragging?(document.addEventListener("mousemove",this.toolbarHandleMove.bind(this)),document.addEventListener("mouseup",this.toolbarHandleUp.bind(this))):!this.state.isDragging&&t.isDragging&&(document.removeEventListener("mousemove",this.toolbarHandleMove.bind(this)),document.removeEventListener("mouseup",this.toolbarHandleUp.bind(this))),void 0==t.xPos&&e.parent.state.debugging&&(this.centerToolbar(),window.addEventListener("resize",this.centerToolbar.bind(this)))},t.prototype.componentWillUnmount=function(){document.removeEventListener("mousemove",this.toolbarHandleMove.bind(this)),document.removeEventListener("mouseup",this.toolbarHandleUp.bind(this)),window.removeEventListener("resize",this.centerToolbar.bind(this))},t.prototype.toolbarHandleDown=function(e){if(0===e.button){var t=this.getMenuDom(),n=t&&t.clientWidth||0;this.cachedMaxWidth=window.innerWidth-n,this.setState({isDragging:!0,xPos:Math.min(e.pageX,this.cachedMaxWidth)}),e.stopPropagation(),e.preventDefault()}},t.prototype.toolbarHandleMove=function(e){this.state.isDragging&&(this.setState({isDragging:!0,xPos:Math.min(e.pageX,this.cachedMaxWidth)}),e.stopPropagation(),e.preventDefault())},t.prototype.toolbarHandleUp=function(e){this.setState({isDragging:!1}),e.stopPropagation(),e.preventDefault()},t.prototype.getMenuDom=function(){var e=ReactDOM.findDOMNode(this);return e&&e.firstElementChild},t.prototype.centerToolbar=function(){var e=this.getMenuDom(),t=e&&e.clientWidth,n=document.getElementById("maineditor"),i=window.innerWidth-n.clientWidth;this.setState({xPos:i+(n.clientWidth-t)/2})},t.prototype.renderCore=function(){var e=this,t=this.state.xPos,n=this.props.parent.state,i=(pxt.appTarget.simulator,n.running),a=n.debugging;if(!a)return React.createElement("div",null);var r=simulator.driver&&simulator.driver.state==pxsim.SimulatorState.Running,o=this.props.parent.isJavaScriptActive();if(!(o||this.props.parent.isBlocksActive()))return React.createElement("div",null);var s=lf("Restart debugging"),l=(n.debugging?lf("Stop"):lf("Start Debugging"),i?lf("Pause execution"):lf("Continue execution")),c=lf("Step into"),u=lf("Step over"),d=lf("Step out");return React.createElement("aside",{className:"debugtoolbar",style:{left:t},role:"complementary","aria-label":lf("Debugger toolbar")},a?React.createElement("div",{className:"ui compact borderless menu icon mini"},React.createElement("div",{className:"ui item link dbg-btn dbg-handle",key:"toolbarhandle",onMouseDown:this.toolbarHandleDown.bind(this)},React.createElement(sui.Icon,{key:"iconkey",icon:"icon ellipsis vertical"})),React.createElement(sui.Item,{key:"dbgpauseresume",class:"dbg-btn dbg-pause-resume "+(r?"pause":"play"),icon:r?"pause blue":"step forward green",title:l,onClick:function(){return e.dbgPauseResume()}}),o?void 0:React.createElement(sui.Item,{key:"dbgstep",class:"dbg-btn dbg-step",icon:"arrow right "+(r?"disabled":"blue"),title:c,onClick:function(){return e.dbgStepInto()}}),o?React.createElement(sui.Item,{key:"dbgstepover",class:"dbg-btn dbg-step-over",icon:"xicon stepover "+(r?"disabled":"blue"),title:u,onClick:function(){return e.dbgStepOver()}}):void 0,o?React.createElement(sui.Item,{key:"dbgstepinto",class:"dbg-btn dbg-step-into",icon:"xicon stepinto "+(r?"disabled":""),title:c,onClick:function(){return e.dbgStepInto()}}):void 0,o?React.createElement(sui.Item,{key:"dbgstepout",class:"dbg-btn dbg-step-out",icon:"xicon stepout "+(r?"disabled":""),title:d,onClick:function(){return e.dbgStepOut()}}):void 0,React.createElement(sui.Item,{key:"dbgrestart",class:"dbg-btn dbg-restart right",icon:"refresh green",title:s,onClick:function(){return e.restartSimulator(!0)}})):void 0)},t}(data.Component);exports.DebuggerToolbar=DebuggerToolbar;

},{"./data":14,"./simulator":41,"./sui":44,"react":269,"react-dom":142}],17:[function(require,module,exports){
"use strict";function setupDragAndDrop(e,t,r){document&&document.createElement&&document.createElement("span");e.addEventListener("paste",function(e){if(e.clipboardData){var a=pxt.Util.toArray(e.clipboardData.files).filter(t);if(a.length>0)e.stopPropagation(),e.preventDefault(),r(a);else if(e.clipboardData.items&&e.clipboardData.items.length>0){var n=e.clipboardData.items[0].getAsFile();n&&(e.stopPropagation(),e.preventDefault(),r([n]))}}}),e.addEventListener("dragover",function(e){for(var t=e.dataTransfer.types,r=!1,a=0;a<t.length;++a)"Files"==t[a]&&(r=!0);return!r||(e.preventDefault&&e.preventDefault(),e.dataTransfer.dropEffect="copy",!1)},!1),e.addEventListener("drop",function(e){var t=pxt.Util.toArray(e.dataTransfer.files);return t.length>0&&(e.stopPropagation(),e.preventDefault(),r(t)),!1},!1),e.addEventListener("dragend",function(e){return!1},!1)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.setupDragAndDrop=setupDragAndDrop;

},{}],18:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};return function(t,o){function l(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(l.prototype=o.prototype,new l)}}();Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),data=require("./data"),sui=require("./sui"),EditorToolbar=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.saveProjectName=function(e,t){pxt.tickEvent("editortools.projectrename",{view:t},{interactiveConsent:!0}),this.props.parent.updateHeaderName(e)},t.prototype.compile=function(e){pxt.tickEvent("editortools.download",{view:e,collapsed:this.getCollapsedState()},{interactiveConsent:!0}),this.props.parent.compile()},t.prototype.saveFile=function(e){pxt.tickEvent("editortools.save",{view:e,collapsed:this.getCollapsedState()},{interactiveConsent:!0}),this.props.parent.saveAndCompile()},t.prototype.undo=function(e){pxt.tickEvent("editortools.undo",{view:e,collapsed:this.getCollapsedState()},{interactiveConsent:!0}),this.props.parent.editor.undo()},t.prototype.redo=function(e){pxt.tickEvent("editortools.redo",{view:e,collapsed:this.getCollapsedState()},{interactiveConsent:!0}),this.props.parent.editor.redo()},t.prototype.zoomIn=function(e){pxt.tickEvent("editortools.zoomIn",{view:e,collapsed:this.getCollapsedState()},{interactiveConsent:!0}),this.props.parent.editor.zoomIn()},t.prototype.zoomOut=function(e){pxt.tickEvent("editortools.zoomOut",{view:e,collapsed:this.getCollapsedState()},{interactiveConsent:!0}),this.props.parent.editor.zoomOut()},t.prototype.startStopSimulator=function(e){pxt.tickEvent("editortools.startStopSimulator",{view:e,collapsed:this.getCollapsedState(),headless:this.getHeadlessState()},{interactiveConsent:!0}),this.props.parent.startStopSimulator()},t.prototype.restartSimulator=function(e){pxt.tickEvent("editortools.restart",{view:e,collapsed:this.getCollapsedState(),headless:this.getHeadlessState()},{interactiveConsent:!0}),this.props.parent.restartSimulator()},t.prototype.toggleTrace=function(e){pxt.tickEvent("editortools.trace",{view:e,collapsed:this.getCollapsedState(),headless:this.getHeadlessState()},{interactiveConsent:!0}),this.props.parent.toggleTrace()},t.prototype.toggleDebugging=function(e){pxt.tickEvent("editortools.debug",{view:e,collapsed:this.getCollapsedState(),headless:this.getHeadlessState()},{interactiveConsent:!0}),this.props.parent.toggleDebugging()},t.prototype.toggleCollapse=function(e){pxt.tickEvent("editortools.toggleCollapse",{view:e,collapsedTo:""+!this.props.parent.state.collapseEditorTools},{interactiveConsent:!0}),this.props.parent.toggleSimulatorCollapse()},t.prototype.getCollapsedState=function(){return""+this.props.parent.state.collapseEditorTools},t.prototype.getHeadlessState=function(){return pxt.appTarget.simulator.headless?"true":"false"},t.prototype.render=function(){var e=this,t=this.props.parent.state,o=t.home,l=t.tutorialOptions,a=t.hideEditorFloats,n=t.collapseEditorTools,i=t.projectName,c=t.compiling,r=t.isSaving,s=t.running;if(o)return React.createElement("div",null);var u=pxt.shell.isSandboxMode(),d=pxt.shell.isReadOnly(),m=!!l&&l.tutorial,p=(a||n)&&!m;if(!(this.props.parent.isBlocksEditor()||this.props.parent.isTextEditor()))return React.createElement("div",null);var b=pxt.appTarget.appTheme,g=pxt.appTarget.compile,f=g.hasHex||g.saveAsPNG,v=pxt.appTarget.simulator,E=lf("Download your code to the {0}",b.boardName),R=!!c,h=s?lf("Stop the simulator"):lf("Start the simulator"),C=lf("Restart the simulator"),k=p?lf("Show the simulator"):lf("Hide the simulator"),y=v.headless,N=this.props.parent.editor.hasUndo(),w=this.props.parent.editor.hasRedo(),x=!m&&!u,S=!m&&!d,B=!m&&!d,T=!m,D=!v.hideRestart,z=!!v.enableTrace,L=this.props.parent.state.tracing,j=L?lf("Disable Slow-Mo"):lf("Slow-Mo"),I=!z,O=this.props.parent.state.debugging,_=O?lf("Disable Debugging"):lf("Debugging"),U=pxt.appTarget.appTheme.downloadIcon||"download",P=pxt.appTarget.appTheme.useUploadMessage?lf("Upload"):lf("Download"),F="",H="";return r?(F="disabled",H="loading disabled"):R&&(F="loading disabled",H="disabled"),React.createElement("div",{className:"ui equal width grid right aligned padded"},React.createElement("div",{className:"column mobile only"},p?React.createElement("div",{className:"ui equal width grid"},React.createElement("div",{className:"left aligned column"},React.createElement("div",{className:"ui icon small buttons"},React.createElement(sui.Button,{icon:p?"toggle up":"toggle down",class:"collapse-button "+(p?"collapsed":"")+" "+(a?"disabled":""),ariaLabel:lf("{0}, {1}",k,a?lf("Disabled"):""),title:k,onClick:function(){return e.toggleCollapse("mobile")}}),y?React.createElement(sui.Button,{class:"play-button "+(s?"stop":"play"),key:"runmenubtn",icon:s?"stop":"play",title:h,onClick:function(){return e.startStopSimulator("mobile")}}):void 0,y&&D?React.createElement(sui.Button,{key:"restartbtn",class:"restart-button",icon:"refresh",title:C,onClick:function(){return e.restartSimulator("mobile")}}):void 0,y&&z?React.createElement(sui.Button,{key:"tracebtn",class:"trace-button "+(L?"orange":""),icon:"xicon turtle",title:j,onClick:function(){return e.toggleTrace("mobile")}}):void 0,y&&I?React.createElement(sui.Button,{key:"debugbtn",class:"debug-button "+(O?"orange":""),icon:"xicon bug",title:_,onClick:function(){return e.toggleDebugging("mobile")}}):void 0,f?React.createElement(sui.Button,{class:"primary download-button download-button-full "+F,icon:U,title:E,ariaLabel:lf("Download your code"),onClick:function(){return e.compile("mobile")}}):void 0)),React.createElement("div",{className:"right aligned column"},d?void 0:React.createElement("div",{className:"ui icon small buttons"},React.createElement(sui.Button,{icon:"save",class:"editortools-btn save-editortools-btn "+H,title:lf("Save"),ariaLabel:lf("Save the project"),onClick:function(){return e.saveFile("mobile")}}),B?React.createElement(sui.Button,{icon:"xicon undo",class:"editortools-btn undo-editortools-btn} "+(N?"":"disabled"),ariaLabel:lf("{0}, {1}",lf("Undo"),N?"":lf("Disabled")),title:lf("Undo"),onClick:function(){return e.undo("mobile")}}):void 0)),React.createElement("div",{className:"right aligned column"},T?React.createElement("div",{className:"ui icon small buttons"},React.createElement(sui.Button,{icon:"plus circle",class:"editortools-btn zoomin-editortools-btn",title:lf("Zoom In"),onClick:function(){return e.zoomIn("mobile")}}),React.createElement(sui.Button,{icon:"minus circle",class:"editortools-btn zoomout-editortools-btn",title:lf("Zoom Out"),onClick:function(){return e.zoomOut("mobile")}})):void 0)):React.createElement("div",{className:"ui equal width grid"},React.createElement("div",{className:"left aligned two wide column"},React.createElement("div",{className:"ui vertical icon small buttons"},React.createElement(sui.Button,{class:"play-button "+(s?"stop":"play"),key:"runmenubtn",icon:s?"stop":"play",title:h,onClick:function(){return e.startStopSimulator("mobile")}}),D?React.createElement(sui.Button,{key:"restartbtn",class:"restart-button",icon:"refresh",title:C,onClick:function(){return e.restartSimulator("mobile")}}):void 0),x?React.createElement("div",{className:"row",style:{paddingTop:"1rem"}},React.createElement("div",{className:"ui vertical icon small buttons"},React.createElement(sui.Button,{icon:p?"toggle up":"toggle down",class:"collapse-button "+(p?"collapsed":""),title:k,ariaLabel:lf("{0}, {1}",k,p?lf("Collapsed"):"Expanded"),onClick:function(){return e.toggleCollapse("mobile")}}))):void 0),React.createElement("div",{className:"three wide column"}),React.createElement("div",{className:"column"},React.createElement("div",{className:"ui grid"},d||!B?void 0:React.createElement("div",{className:"row"},React.createElement("div",{className:"column"},React.createElement("div",{className:"ui icon large buttons"},React.createElement(sui.Button,{icon:"xicon undo",class:"editortools-btn undo-editortools-btn "+(N?"":"disabled"),ariaLabel:lf("{0}, {1}",lf("Undo"),N?"":lf("Disabled")),title:lf("Undo"),onClick:function(){return e.undo("mobile")}})))),React.createElement("div",{className:"row",style:d||!B?void 0:{paddingTop:0}},React.createElement("div",{className:"column"},React.createElement("div",{className:"ui icon large buttons"},z?React.createElement(sui.Button,{key:"tracebtn",class:"trace-button "+(L?"orange":""),icon:"xicon turtle",title:j,onClick:function(){return e.toggleTrace("mobile")}}):void 0,I?React.createElement(sui.Button,{key:"debugbtn",class:"debug-button "+(O?"orange":""),icon:"xicon bug",title:_,onClick:function(){return e.toggleDebugging("mobile")}}):void 0,f?React.createElement(sui.Button,{class:"primary download-button download-button-full "+F,icon:U,title:E,onClick:function(){return e.compile("mobile")}}):void 0))))))),React.createElement("div",{className:"column tablet only"},p?React.createElement("div",{className:"ui grid seven column"},y?React.createElement("div",{className:"left aligned six wide column"},React.createElement("div",{className:"ui icon buttons"},React.createElement(sui.Button,{icon:p?"toggle up":"toggle down",class:"collapse-button "+(p?"collapsed":"")+" "+(a?"disabled":""),ariaLabel:lf("{0}, {1}",k,a?lf("Disabled"):""),title:k,onClick:function(){return e.toggleCollapse("tablet")}}),React.createElement(sui.Button,{role:"menuitem",class:"play-button "+(s?"stop":"play"),key:"runmenubtn",icon:s?"stop":"play",title:h,onClick:function(){return e.startStopSimulator("tablet")}}),D?React.createElement(sui.Button,{key:"restartbtn",class:"restart-button",icon:"refresh",title:C,onClick:function(){return e.restartSimulator("tablet")}}):void 0,React.createElement(sui.Button,{key:"debug",class:"debug-button "+(O?"orange":""),icon:"xicon bug",title:_,onClick:function(){return e.toggleDebugging("table")}}),f?React.createElement(sui.Button,{class:"primary download-button download-button-full "+F,icon:U,title:E,onClick:function(){return e.compile("tablet")}}):void 0)):React.createElement("div",{className:"left aligned six wide column"},React.createElement("div",{className:"ui icon buttons"},React.createElement(sui.Button,{icon:p?"toggle up":"toggle down",class:"collapse-button "+(p?"collapsed":"")+" "+(a?"disabled":""),ariaLabel:lf("{0}, {1}",k,a?lf("Disabled"):""),title:k,onClick:function(){return e.toggleCollapse("tablet")}}),f?React.createElement(sui.Button,{class:"primary download-button download-button-full "+F,icon:U,text:P,title:E,onClick:function(){return e.compile("tablet")}}):void 0)),React.createElement("div",{className:"column four wide"},d?void 0:React.createElement(sui.Button,{icon:"save",class:"small editortools-btn save-editortools-btn "+H,title:lf("Save"),ariaLabel:lf("Save the project"),onClick:function(){return e.saveFile("tablet")}})),React.createElement("div",{className:"column six wide right aligned"},B?React.createElement("div",{className:"ui icon small buttons"},React.createElement(sui.Button,{icon:"xicon undo",class:"editortools-btn undo-editortools-btn "+(N?"":"disabled"),ariaLabel:lf("{0}, {1}",lf("Undo"),N?"":lf("Disabled")),title:lf("Undo"),onClick:function(){return e.undo("tablet")}}),React.createElement(sui.Button,{icon:"xicon redo",class:"editortools-btn redo-editortools-btn "+(w?"":"disabled"),ariaLabel:lf("{0}, {1}",lf("Red"),w?"":lf("Disabled")),title:lf("Redo"),onClick:function(){return e.redo("tablet")}})):void 0,T?React.createElement("div",{className:"ui icon small buttons"},React.createElement(sui.Button,{icon:"plus circle",class:"editortools-btn zoomin-editortools-btn",title:lf("Zoom In"),onClick:function(){return e.zoomIn("tablet")}}),React.createElement(sui.Button,{icon:"minus circle",class:"editortools-btn zoomout-editortools-btn",title:lf("Zoom Out"),onClick:function(){return e.zoomOut("tablet")}})):void 0)):React.createElement("div",{className:"ui grid"},React.createElement("div",{className:"left aligned two wide column"},React.createElement("div",{className:"ui vertical icon small buttons"},React.createElement(sui.Button,{role:"menuitem",class:"play-button "+(s?"stop":"play"),key:"runmenubtn",icon:s?"stop":"play",title:h,onClick:function(){return e.startStopSimulator("tablet")}}),D?React.createElement(sui.Button,{key:"restartbtn",class:"restart-button",icon:"refresh",title:C,onClick:function(){return e.restartSimulator("tablet")}}):void 0),x?React.createElement("div",{className:"row",style:{paddingTop:"1rem"}},React.createElement("div",{className:"ui vertical icon small buttons"},React.createElement(sui.Button,{icon:p?"toggle up":"toggle down",class:"collapse-button "+(p?"collapsed":""),title:k,ariaLabel:lf("{0}, {1}",k,p?lf("Collapsed"):"Expanded"),onClick:function(){return e.toggleCollapse("tablet")}}))):void 0),React.createElement("div",{className:"three wide column"}),React.createElement("div",{className:"five wide column"},React.createElement("div",{className:"ui grid right aligned"},f?React.createElement("div",{className:"row"},React.createElement("div",{className:"column"},React.createElement(sui.Button,{role:"menuitem",class:"primary large fluid download-button download-button-full "+F,icon:U,text:P,title:E,onClick:function(){return e.compile("tablet")}}))):void 0,S?React.createElement("div",{className:"row",style:f?{paddingTop:0}:{}},React.createElement("div",{className:"column"},React.createElement("div",{className:"ui item large right labeled fluid input projectname-input projectname-tablet",title:lf("Pick a name for your project")},React.createElement("label",{htmlFor:"fileNameInput1",id:"fileNameInputLabel1",className:"accessible-hidden"},lf("Type a name for your project")),React.createElement("input",{id:"fileNameInput1",type:"text","aria-labelledby":"fileNameInputLabel1",placeholder:lf("Pick a name..."),value:i||"",onChange:function(t){return e.saveProjectName(t.target.value,"tablet")}}),React.createElement(sui.Button,{icon:"save",class:"large right attached editortools-btn save-editortools-btn "+H,title:lf("Save"),ariaLabel:lf("Save the project"),onClick:function(){return e.saveFile("tablet")}})))):void 0)),React.createElement("div",{className:"six wide column right aligned"},React.createElement("div",{className:"ui grid right aligned"},B||T?React.createElement("div",{className:"row"},React.createElement("div",{className:"column"},B?React.createElement("div",{className:"ui icon large buttons"},React.createElement(sui.Button,{icon:"xicon undo",class:"editortools-btn undo-editortools-btn} "+(N?"":"disabled"),title:lf("Undo"),ariaLabel:lf("{0}, {1}",lf("Undo"),N?"":lf("Disabled")),onClick:function(){return e.undo()}}),React.createElement(sui.Button,{icon:"xicon redo",class:"editortools-btn redo-editortools-btn} "+(w?"":"disabled"),title:lf("Redo"),ariaLabel:lf("{0}, {1}",lf("Redo"),w?"":lf("Disabled")),onClick:function(){return e.redo()}})):void 0,T?React.createElement("div",{className:"ui icon large buttons"},React.createElement(sui.Button,{icon:"plus circle",class:"editortools-btn zoomin-editortools-btn",title:lf("Zoom In"),onClick:function(){return e.zoomIn()}}),React.createElement(sui.Button,{icon:"minus circle",class:"editortools-btn zoomout-editortools-btn",title:lf("Zoom Out"),onClick:function(){return e.zoomOut()}})):void 0)):void 0,React.createElement("div",{className:"row",style:B||T?{paddingTop:0}:{}},React.createElement("div",{className:"column"},z?React.createElement(sui.Button,{key:"tracebtn",class:"large trace-button "+(L?"orange":""),icon:"xicon turtle",title:j,onClick:function(){return e.toggleTrace("tablet")}}):void 0,I?React.createElement(sui.Button,{key:"debugbtn",class:"large debug-button "+(O?"orange":""),icon:"xicon bug",title:_,onClick:function(){return e.toggleDebugging("tablet")}}):void 0)))))),React.createElement("div",{className:"column computer only"},React.createElement("div",{className:"ui grid equal width"},React.createElement("div",{id:"downloadArea",className:"ui column items"},y?React.createElement("div",{className:"ui item"},React.createElement("div",{className:"ui icon large buttons"},x?React.createElement(sui.Button,{icon:n?"toggle right":"toggle left",class:"large collapse-button "+(p?"collapsed":""),title:k,onClick:function(){return e.toggleCollapse("computer")}}):void 0,React.createElement(sui.Button,{role:"menuitem",class:"large play-button "+(s?"stop":"play"),key:"runmenubtn",icon:s?"stop":"play",title:h,onClick:function(){return e.startStopSimulator("computer")}}),D?React.createElement(sui.Button,{key:"restartbtn",class:"large restart-button",icon:"refresh",title:C,onClick:function(){return e.restartSimulator("computer")}}):void 0,z?React.createElement(sui.Button,{key:"tracebtn",class:"large trace-button "+(L?"orange":""),icon:"xicon trace",title:j,onClick:function(){return e.toggleTrace("computer")}}):void 0,I?React.createElement(sui.Button,{key:"debugbtn",class:"large debug-button "+(O?"orange":""),icon:"xicon bug",title:_,onClick:function(){return e.toggleDebugging("computer")}}):void 0,f?React.createElement(sui.Button,{icon:U,class:"primary large download-button "+F,title:E,onClick:function(){return e.compile("computer")}}):void 0)):React.createElement("div",{className:"ui item"},x?React.createElement(sui.Button,{icon:n?"toggle right":"toggle left",class:"large collapse-button "+(p?"collapsed":""),title:k,onClick:function(){return e.toggleCollapse("computer")}}):void 0,f?React.createElement(sui.Button,{icon:U,class:"primary huge fluid download-button "+F,text:P,title:E,onClick:function(){return e.compile("computer")}}):void 0)),S?React.createElement("div",{className:"column left aligned"},React.createElement("div",{className:"ui right labeled input projectname-input projectname-computer",title:lf("Pick a name for your project")},React.createElement("label",{htmlFor:"fileNameInput2",id:"fileNameInputLabel2",className:"accessible-hidden"},lf("Type a name for your project")),React.createElement("input",{id:"fileNameInput2",type:"text","aria-labelledby":"fileNameInputLabel2",placeholder:lf("Pick a name..."),value:i||"",onChange:function(t){return e.saveProjectName(t.target.value,"computer")}}),React.createElement(sui.Button,{icon:"save",class:"small right attached editortools-btn save-editortools-btn "+H,title:lf("Save"),ariaLabel:lf("Save the project"),onClick:function(){return e.saveFile("computer")}}))):void 0,React.createElement("div",{className:"column right aligned"},B?React.createElement("div",{className:"ui icon small buttons"},React.createElement(sui.Button,{icon:"xicon undo",class:"editortools-btn undo-editortools-btn "+(N?"":"disabled"),ariaLabel:lf("{0}, {1}",lf("Undo"),N?"":lf("Disabled")),title:lf("Undo"),onClick:function(){return e.undo("computer")}}),React.createElement(sui.Button,{icon:"xicon redo",class:"editortools-btn redo-editortools-btn "+(w?"":"disabled"),ariaLabel:lf("{0}, {1}",lf("Redo"),w?"":lf("Disabled")),title:lf("Redo"),onClick:function(){return e.redo("computer")}})):void 0,T?React.createElement("div",{className:"ui icon small buttons"},React.createElement(sui.Button,{icon:"plus circle",class:"editortools-btn zoomin-editortools-btn",title:lf("Zoom In"),onClick:function(){return e.zoomIn("computer")}}),React.createElement(sui.Button,{icon:"minus circle",class:"editortools-btn zoomout-editortools-btn",title:lf("Zoom Out"),onClick:function(){return e.zoomOut("computer")}})):void 0))))},t}(data.Component);exports.EditorToolbar=EditorToolbar;

},{"./data":14,"./sui":44,"react":269}],19:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Permissions,PermissionStatus,e=pxt.editor,pkg=require("./package");!function(e){e[e.Console=0]="Console",e[e.ReadUserCode=1]="ReadUserCode"}(Permissions=exports.Permissions||(exports.Permissions={})),function(e){e[e.Granted=0]="Granted",e[e.Denied=1]="Denied",e[e.NotAvailable=2]="NotAvailable",e[e.NotYetPrompted=3]="NotYetPrompted"}(PermissionStatus=exports.PermissionStatus||(exports.PermissionStatus={}));var ExtensionManager=function(){function e(e){this.host=e,this.statuses={},this.nameToExtId={},this.extIdToName={},this.consent={},this.pendingRequests=[],this.queueLock=!1,this.streams={}}return e.prototype.streamingExtensions=function(){return Object.keys(this.streams)},e.prototype.handleExtensionMessage=function(e){this.handleRequestAsync(e).catch(function(e){})},e.prototype.sendEvent=function(e,s){this.host.send(e,mkEvent(s))},e.prototype.setConsent=function(e,s){this.consent[e]=s},e.prototype.hasConsent=function(e){return this.consent[e]},e.prototype.getExtId=function(e){return this.nameToExtId[e]||(this.nameToExtId[e]=ts.pxtc.Util.guidGen(),this.extIdToName[this.nameToExtId[e]]=e),this.nameToExtId[e]},e.prototype.sendResponse=function(e){this.host.send(this.extIdToName[e.extId],e)},e.prototype.handleRequestAsync=function(e){var s=this,t=mkResponse(e);if(!this.hasConsent(e.extId))return t.success=!1,t.error="",this.sendResponse(t),Promise.reject("No consent");switch(e.action){case"extinit":t.target=pxt.appTarget,this.sendResponse(t);break;case"extdatastream":return this.permissionOperation(e.extId,Permissions.Console,t,function(e,t){return s.handleDataStreamRequest(e,t)});case"extquerypermission":var n=this.getPermissions(e.extId),o=t;o.resp=statusesToResponses(n),this.sendResponse(o);break;case"extrequestpermission":return this.requestPermissionsAsync(e.extId,t,e.body);case"extusercode":return this.permissionOperation(e.extId,Permissions.ReadUserCode,t,handleUserCodeRequest);case"extreadcode":handleReadCodeRequest(this.extIdToName[e.extId],t),this.sendResponse(t);break;case"extwritecode":handleWriteCodeRequestAsync(this.extIdToName[e.extId],t,e.body).done(function(){return s.sendResponse(t)})}return Promise.resolve()},e.prototype.permissionOperation=function(e,s,t,n){var o=this;return this.checkPermissionAsync(e,s).then(function(s){s?(n(o.extIdToName[e],t),o.sendResponse(t)):(t.success=!1,t.error="permission denied",o.sendResponse(t))}).catch(function(e){t.success=!1,t.error=e,o.sendResponse(t)})},e.prototype.getPermissions=function(e){return this.statuses[e]||(this.statuses[e]={console:PermissionStatus.NotYetPrompted,readUserCode:PermissionStatus.NotYetPrompted}),this.statuses[e]},e.prototype.queuePermissionRequest=function(e,s){var t=this;return new Promise(function(n,o){var i={extId:e,permissions:[s],resolver:n};t.pendingRequests.push(i),t.queueLock||1!==t.pendingRequests.length||(t.queueLock=!0,t.nextPermissionRequest())})},e.prototype.nextPermissionRequest=function(){var e=this;if(this.pendingRequests.length){var s=this.pendingRequests.shift();s.permissions=s.permissions.filter(function(t){return e.hasNotBeenPrompted(s.extId,t)}),s.permissions.length?this.host.promptForPermissionAsync(this.extIdToName[s.extId],s.permissions).done(function(t){s.resolver(t),e.nextPermissionRequest()}):this.nextPermissionRequest()}else this.queueLock=!1},e.prototype.checkPermissionAsync=function(e,s){var t,n=this,o=this.getPermissions(e);switch(s){case Permissions.Console:t=o.console;break;case Permissions.ReadUserCode:t=o.readUserCode}return t===PermissionStatus.NotYetPrompted?this.queuePermissionRequest(e,s).then(function(t){var o=t?PermissionStatus.Granted:PermissionStatus.Denied;switch(s){case Permissions.Console:n.statuses[e].console=o;break;case Permissions.ReadUserCode:n.statuses[e].readUserCode=o}return t}):Promise.resolve(t===PermissionStatus.Granted)},e.prototype.requestPermissionsAsync=function(e,s,t){var n=this,o=[];return t.readUserCode&&o.push(this.checkPermissionAsync(e,Permissions.ReadUserCode)),t.console&&o.push(this.checkPermissionAsync(e,Permissions.Console)),Promise.all(o).then(function(){return statusesToResponses(n.getPermissions(e))}).then(function(e){s.resp=e})},e.prototype.hasNotBeenPrompted=function(e,s){var t,n=this.getPermissions(e);switch(s){case Permissions.Console:t=n.console;break;case Permissions.ReadUserCode:t=n.readUserCode}return t===PermissionStatus.NotYetPrompted},e.prototype.handleDataStreamRequest=function(e,s){this.streams[e]=!0},e}();function handleUserCodeRequest(e,s){var t=pkg.mainEditorPkg();s.resp=t.getAllFiles()}function handleReadCodeRequest(e,s){var t=pkg.mainEditorPkg(),n=ts.pxtc.escapeIdentifier(e),o=t.getAllFiles();s.resp={json:o[n+".json"],code:o[n+".ts"],jres:o[n+".jres"],asm:o[n+".asm"]}}function handleWriteCodeRequestAsync(e,s,t){var n=pkg.mainEditorPkg(),o=ts.pxtc.escapeIdentifier(e);function i(e,s){return void 0!==e&&(!n.files[o+s]||n.files[o+s].content!=e)}var r=!1;return i(t.json,".json")&&(r=!0,n.setFile(o+".json",t.json)),i(t.code,".ts")&&(r=!0,n.setFile(o+".ts",t.code)),i(t.jres,".jres")&&(r=!0,n.setFile(o+".jres",t.jres)),i(t.asm,".asm")&&(r=!0,n.setFile(o+".asm",t.asm)),r?n.updateConfigAsync(function(e){return void 0!==t.json&&e.files.indexOf(o+".json")<0&&e.files.push(o+".json"),void 0!==t.code&&e.files.indexOf(o+".ts")<0&&e.files.push(o+".ts"),void 0!==t.jres&&e.files.indexOf(o+".jres")<0&&e.files.push(o+".jres"),void 0!==t.asm&&e.files.indexOf(o+".asm")<0&&e.files.push(o+".asm"),n.savePkgAsync()}):Promise.resolve()}function mkEvent(e){return{type:"pxtpkgext",event:e}}function mkResponse(e,s){return void 0===s&&(s=!0),{type:"pxtpkgext",id:e.id,extId:e.extId,success:s}}function statusesToResponses(e){return{readUserCode:statusToResponse(e.readUserCode),console:statusToResponse(e.console)}}function statusToResponse(s){switch(s){case PermissionStatus.NotYetPrompted:case PermissionStatus.Denied:return e.PermissionResponses.Denied;case PermissionStatus.Granted:return e.PermissionResponses.Granted;case PermissionStatus.NotAvailable:default:return e.PermissionResponses.NotAvailable}}exports.ExtensionManager=ExtensionManager;

},{"./package":32}],20:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function s(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(s.prototype=n.prototype,new s)}}();Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),data=require("./data"),sui=require("./sui"),ext=require("./extensionManager"),CUSTOM_CONTENT_DIV="custom-content",Extensions=function(e){function t(t){var n=e.call(this,t)||this;return n.state={visible:!1,consent:!1},n.manager=new ext.ExtensionManager(n),window.addEventListener("message",n.processMessage.bind(n),!1),n}return __extends(t,e),t.prototype.processMessage=function(e){var t=this,n=e.data;if("serial"===n.type){var s=n,i=this.manager.streamingExtensions();if(i&&i.length){var o=s.data||"",r=s.id||"?";i.forEach(function(e){t.send(e,{type:"pxtpkgext",event:"extconsole",body:{source:r,sim:s.sim,data:o}})})}}},t.prototype.hide=function(){var e=this;this.setState({visible:!1}),t.getFrame(this.state.extension,!0).style.display="none",this.props.parent.reloadHeaderAsync().done(function(){e.send(e.state.extension,{type:"pxtpkgext",event:"exthidden"})})},t.prototype.showExtension=function(e,t,n){var s=this,i=!n||this.manager.hasConsent(this.manager.getExtId(e));this.setState({visible:!0,extension:e,url:t,consent:i},function(){s.send(e,{type:"pxtpkgext",event:"extshown"})})},t.prototype.submitConsent=function(){this.manager.setConsent(this.manager.getExtId(this.state.extension),!0),this.setState({consent:!0})},t.prototype.initializeFrame=function(){this.manager.setConsent(this.manager.getExtId(this.state.extension),!0);var e=t.getFrame(this.state.extension,!0);e.style.display="block",e.src||(e.src=this.state.url+"#"+this.manager.getExtId(this.state.extension))},t.prototype.shouldComponentUpdate=function(e,t,n){return this.state.visible!=t.visible||this.state.extension!=t.extension||this.state.permissionRequest!=t.permissionRequest||this.state.consent!=t.consent},t.prototype.updateDimensions=function(){if(this.extensionWrapper){var e=this.extensionWrapper.getAttribute("data-frame");if(e){var n=t.getFrame(e,!1),s=document.getElementsByClassName("extensiondialog")[0];if(s&&n){var i=s.getBoundingClientRect();n.width=this.extensionWrapper.clientWidth+"px",n.height=this.extensionWrapper.clientHeight+"px",n.style.top=i.top+this.extensionWrapper.offsetTop+"px",n.style.left=i.left+this.extensionWrapper.offsetLeft+"px"}}}},t.prototype.componentDidMount=function(){window.addEventListener("resize",this.updateDimensions)},t.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.updateDimensions)},t.prototype.componentDidUpdate=function(){this.updateDimensions()},t.prototype.handleExtensionRequest=function(e){this.manager.handleExtensionMessage(e)},t.prototype.send=function(e,n){var s=t.getFrame(e,!1);s?s.contentWindow.postMessage(n,"*"):console.warn("Attempting to post message to unloaded extesnion "+e)},t.prototype.promptForPermissionAsync=function(e,t){var n=this;return new Promise(function(s,i){n.permissionCb=s,n.setState({permissionRequest:t,permissionExtName:e})})},t.prototype.onPermissionDecision=function(e){this.permissionCb(e),this.permissionCb=void 0,this.setState({permissionRequest:null,permissionExtName:null})},t.getCustomContent=function(){return document.getElementById(CUSTOM_CONTENT_DIV)},t.getFrame=function(e,t){var n=this.getCustomContent().getElementsByClassName("extension-frame-"+e)[0];return!n&&t&&(n=this.createFrame(e)),n},t.createFrame=function(e){var t=this.getCustomContent(),n=document.createElement("iframe");return n.className="extension-frame extension-frame-"+e,n.allowFullscreen=!0,n.setAttribute("sandbox","allow-same-origin allow-scripts"),n.sandbox.value="allow-scripts allow-same-origin",n.frameBorder="0",n.style.display="none",t.appendChild(n),n},t.prototype.getIconForPermission=function(e){switch(e){case ext.Permissions.Console:return"terminal";case ext.Permissions.ReadUserCode:return"code"}return""},t.prototype.getDisplayNameForPermission=function(e){switch(e){case ext.Permissions.Console:return lf("Console output");case ext.Permissions.ReadUserCode:return lf("Read your code")}return""},t.prototype.getDescriptionForPermission=function(e){switch(e){case ext.Permissions.Console:return lf("The extension will be able to read any console output (including device data) streamed to the editor");case ext.Permissions.ReadUserCode:return lf("The extension will be able to read the code in the current project")}return""},t.prototype.renderCore=function(){var e=this,t=this.state,n=t.visible,s=t.extension,i=t.consent,o=t.permissionRequest,r=t.permissionExtName,a=!i,c=a?lf("Agree"):void 0,l=c?[{label:c,onClick:function(){e.submitConsent()}}]:void 0;return!a&&n&&this.initializeFrame(),React.createElement(sui.Modal,{open:n,className:a?"extensionconsentdialog":"extensiondialog",size:"fullscreen",closeIcon:!1,onClose:function(){return e.hide()},dimmer:!0,actions:l,onPositionChanged:function(){return e.updateDimensions()},closeOnDimmerClick:!0},i?React.createElement("div",{id:"extensionWrapper","data-frame":s,ref:function(t){return e.extensionWrapper=t}},o?React.createElement(sui.Modal,{className:"extensionpermissiondialog basic",size:"fullscreen",closeIcon:!1,dimmer:!0,open:!0,dimmerClassName:"permissiondimmer"},React.createElement("div",{className:"permissiondialoginner"},React.createElement("div",{className:"permissiondialogheader"},lf("Permission Request")),React.createElement("div",{className:"permissiondialogbody"},lf("Extension {0} is requesting the following permission(s):",r)),React.createElement("div",{className:"ui inverted list"},o.map(function(t){return React.createElement("div",{className:"item"},React.createElement(sui.Icon,{icon:e.getIconForPermission(t)+" icon"}),React.createElement("div",{className:"content"},React.createElement("div",{className:"header"},e.getDisplayNameForPermission(t)),React.createElement("div",{className:"description"},e.getDescriptionForPermission(t))))}))),React.createElement("div",{className:"actions"},React.createElement(sui.Button,{text:lf("Deny"),class:"deny inverted",onClick:function(){return e.onPermissionDecision(!1)}}),React.createElement(sui.Button,{text:lf("Approve"),class:"approve inverted green",onClick:function(){return e.onPermissionDecision(!0)}}))):void 0):React.createElement("div",null,React.createElement("div",{className:"ui form"},React.createElement("div",{className:"ui icon violet message"},React.createElement(sui.Icon,{icon:"user"}),React.createElement("div",{className:"content"},React.createElement("h3",{className:"header"},"User-provided content"),React.createElement("p",null,lf("This content is provided by a user, and is not endorsed by Microsoft."),React.createElement("br",null),lf("If you think it's not appropriate, please report abuse through Settings -> Report Abuse.")))))))},t}(data.Component);exports.Extensions=Extensions;

},{"./data":14,"./extensionManager":19,"./sui":44,"react":269}],21:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),data=require("./data"),sui=require("./sui"),pkg=require("./package"),core=require("./core"),customFile="custom.ts",FileList=function(e){function t(t){var n=e.call(this,t)||this;return n.state={expands:{}},n}return __extends(t,e),t.prototype.removePkg=function(e,t){var n=this;e.stopPropagation(),core.confirmAsync({header:lf("Remove {0} package",t.getPkgId()),body:lf("You are about to remove a package from your project. Are you sure?"),agreeClass:"red",agreeIcon:"trash",agreeLbl:lf("Remove it")}).done(function(e){e&&pkg.mainEditorPkg().removeDepAsync(t.getPkgId()).then(function(){return n.props.parent.reloadHeaderAsync()}).done()})},t.prototype.removeFile=function(e,t){e.stopPropagation(),this.props.parent.removeFile(t)},t.prototype.updatePkg=function(e,t){var n=this;e.stopPropagation(),pkg.mainEditorPkg().updateDepAsync(t.getPkgId()).then(function(){return n.props.parent.reloadHeaderAsync()}).done()},t.prototype.filesOf=function(e){var t=this,n="this"==e.getPkgId(),r=this.props.parent;return e.sortedFiles().map(function(o){var a=t.getData("open-meta:"+o.getName());return React.createElement("a",{key:o.getName(),onClick:function(){return r.setSideFile(o)},tabIndex:0,role:"treeitem","aria-label":r.state.currFile==o?lf("{0}, it is the current opened file in the JavaScript editor",o.name):o.name,onKeyDown:sui.fireClickOnEnter,className:(r.state.currFile==o?"active ":"")+(e.isTopLevel()?"":"nested ")+"item"},o.name," ",a.isSaved?"":"*",/\.ts$/.test(o.name)?React.createElement(sui.Icon,{icon:"align left"}):/\.blocks$/.test(o.name)?React.createElement(sui.Icon,{icon:"puzzle"}):void 0,a.isReadonly?React.createElement(sui.Icon,{icon:"lock"}):null,a.numErrors?React.createElement("span",{className:"ui label red"},a.numErrors):null,n&&/\.blocks$/i.test(o.getName())?React.createElement(sui.Button,{class:"primary label",icon:"trash",title:lf("Delete file {0}",o.name),onClick:function(e){return t.removeFile(e,o)},onKeyDown:function(e){return e.stopPropagation()}}):"")})},t.prototype.packageOf=function(e){var t=this,n=this.state.expands,r=e.getPkgId()!=pxt.appTarget.id&&"built"!=e.getPkgId()&&e.getPkgId()!=pxt.appTarget.corepkg&&!e.getKsPkg().config.core&&e.getKsPkg().level<=1,o=e.getKsPkg()&&"github"==e.getKsPkg().verProtocol(),a=this.getData("open-pkg-meta:"+e.getPkgId());return[React.createElement("div",{key:"hd-"+e.getPkgId(),className:"header link item",role:"treeitem","aria-expanded":n[e.getPkgId()],"aria-label":lf("{0}, {1}",e.getPkgId(),n[e.getPkgId()]?lf("expanded"):lf("collapsed")),onClick:function(){return t.togglePkg(e)},tabIndex:0,onKeyDown:sui.fireClickOnEnter},React.createElement(sui.Icon,{icon:"chevron "+(n[e.getPkgId()]?"down":"right")+" icon"}),o?React.createElement(sui.Button,{class:"primary label",icon:"refresh",title:lf("Refresh package {0}",e.getPkgId()),onClick:function(n){return t.updatePkg(n,e)},onKeyDown:function(e){return e.stopPropagation()}}):"",r?React.createElement(sui.Button,{class:"primary label",icon:"trash",title:lf("Delete package {0}",e.getPkgId()),onClick:function(n){return t.removePkg(n,e)},onKeyDown:function(e){return e.stopPropagation()}}):"",a.numErrors?React.createElement("span",{className:"ui label red"},a.numErrors):null,e.getPkgId())].concat(n[e.getPkgId()]?this.filesOf(e):[])},t.prototype.togglePkg=function(e){var t=this.state.expands;t[e.getPkgId()]=!t[e.getPkgId()],this.forceUpdate()},t.prototype.filesWithHeader=function(e){return e.isTopLevel()?this.filesOf(e):this.packageOf(e)},t.prototype.toggleVisibility=function(){this.props.parent.setState({showFiles:!this.props.parent.state.showFiles})},t.prototype.addCustomBlocksFile=function(){var e=this;core.confirmAsync({header:lf("Add custom blocks?"),body:lf("A new JavaScript file, custom.ts, will be added to your project. You can define custom functions and blocks in that file.")}).then(function(t){if(t)return e.props.parent.updateFileAsync(customFile,"\n/**\n * "+lf("Use this file to define custom functions and blocks.")+"\n * "+lf("Read more at {0}",pxt.appTarget.appTheme.homeUrl+"blocks/custom")+'\n */\n\nenum MyEnum {\n    //% block="one"\n    One,\n    //% block="two"\n    Two\n}\n\n/**\n * '+lf("Custom blocks")+'\n */\n//% weight=100 color=#0fbc11 icon=""\nnamespace custom {\n    /**\n     * TODO: '+lf("describe your function here")+"\n     * @param n "+lf("describe parameter here")+", eg: 5\n     * @param s "+lf("describe parameter here")+', eg: "Hello"\n     * @param e '+lf("describe parameter here")+"\n     */\n    //% block\n    export function foo(n: number, s: string, e: MyEnum): void {\n        // Add code here\n    }\n\n    /**\n     * TODO: "+lf("describe your function here")+"\n     * @param value "+lf("describe value here")+", eg: 5\n     */\n    //% block\n    export function fib(value: number): number {\n        return value <= 1 ? value : fib(value -1) + fib(value - 2);\n    }\n}\n",!0)})},t.prototype.renderCore=function(){var e=this,t=!!this.props.parent.state.showFiles,n=pxt.appTarget.appTheme,r=t&&!pkg.mainEditorPkg().files[customFile],o=this.getData("open-pkg-meta:"+pkg.mainEditorPkg().getPkgId());return React.createElement("div",{role:"tree",className:"ui tiny vertical "+(n.invertedMenu?"inverted":"")+" menu filemenu landscape only hidefullscreen"},React.createElement("div",{role:"treeitem","aria-expanded":t,"aria-label":lf("File explorer toolbar"),key:"projectheader",className:"link item",onClick:function(){return e.toggleVisibility()},tabIndex:0,onKeyDown:sui.fireClickOnEnter},lf("Explorer"),React.createElement(sui.Icon,{icon:"chevron "+(t?"down":"right")+" icon"}),r?React.createElement(sui.Button,{class:"primary label",icon:"plus",title:lf("Add custom blocks?"),onClick:function(t){e.addCustomBlocksFile(),t.stopPropagation()},onKeyDown:function(e){return e.stopPropagation()}}):void 0,o.numErrors?React.createElement("span",{className:"ui label red"},o.numErrors):null),t?pxt.Util.concat(pkg.allEditorPkgs().map(function(t){return e.filesWithHeader(t)})):void 0)},t}(data.Component);exports.FileList=FileList;

},{"./core":13,"./data":14,"./package":32,"./sui":44,"react":269}],22:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var currentTarget,db=require("./db"),core=require("./core"),data=require("./data"),U=pxt.Util,Cloud=pxt.Cloud,allScripts=[];function lookup(e){return allScripts.filter(function(t){return t.id==e})[0]}function getHeaders(){return allScripts.map(function(e){return e.header})}function getHeader(e){var t=lookup(e);return t&&!t.header.isDeleted?t.header:null}function apiAsync(e,t){return U.requestAsync({url:"/api/"+e,headers:{Authorization:Cloud.localToken},method:t?"POST":"GET",data:t||void 0}).then(function(e){return e.json}).catch(core.handleNetworkError)}function mergeFsPkg(e){var t=lookup(e.path);t||(t={id:e.path,header:null,text:null,fsText:null},allScripts.push(t));var n=e.files.map(function(e){return e.mtime});n.sort(function(e,t){return t-e});var r=Math.round(n[0]/1e3)||U.nowSeconds(),a={target:currentTarget,name:e.config.name,meta:{},editor:pxt.JAVASCRIPT_PROJECT_NAME,pubId:e.config.installedVersion,pubCurrent:!1,_rev:null,id:e.path,recentUse:r,modificationTime:r,blobId:null,blobCurrent:!1,isDeleted:!1,icon:e.icon};if(t.header){var i=t.header;i.name=a.name,i.pubId=a.pubId,i.modificationTime=a.modificationTime,i.isDeleted=a.isDeleted,i.icon=a.icon}else t.header=a}function initAsync(e){return allScripts=[],currentTarget=e,syncAsync().then(function(){})}function fetchTextAsync(e){return apiAsync("pkg/"+e.id).then(function(t){if(!e.text){e.text={},e.mtime=0;for(var n=0,r=t.files;n<r.length;n++){var a=r[n];e.text[a.name]=a.content,e.mtime=Math.max(e.mtime,a.mtime)}e.fsText=U.flatClone(e.text)}return e.text})}var headerQ=new U.PromiseQueue;function getTextAsync(e){var t=lookup(e);return t?t.text?Promise.resolve(t.text):headerQ.enqueue(e,function(){return fetchTextAsync(t)}):Promise.resolve(null)}function saveCoreAsync(e,t){if(e.temporary)return Promise.resolve();var n=lookup(e.id);return U.assert(n.header===e),t?(e.saveId=null,n.textNeedsSave=!0,n.text=t,headerQ.enqueue(e.id,function(){U.assert(!!n.fsText);for(var r={files:[],config:null,path:e.id},a=0,i=Object.keys(n.text);a<i.length;a++){var s=i[a];n.text[s]!==n.fsText[s]&&r.files.push({name:s,mtime:null,content:n.text[s],prevContent:n.fsText[s]})}var o=U.flatClone(n.text);return 0==r.files.length?Promise.resolve():apiAsync("pkg/"+e.id,r).then(function(r){n.fsText=o,mergeFsPkg(r),data.invalidate("header:"+e.id),data.invalidate("header:*"),t&&(data.invalidate("text:"+e.id),e.saveId=null)}).catch(function(e){return core.errorNotification(lf("Save failed!"))})})):Promise.resolve()}function saveAsync(e,t){return saveCoreAsync(e,t)}function installAsync(e,t){var n=e,r=n.name.replace(/[^a-zA-Z0-9]+/g," ").trim().replace(/ /g,"-");if(lookup(r)){for(var a=2;lookup(r+"-"+a);)a++;r+="-"+a,n.name+=" "+a}n.id=r,n.recentUse=U.nowSeconds(),n.modificationTime=n.recentUse,n.target=currentTarget;var i={id:n.id,header:n,text:t,fsText:{}};return allScripts.push(i),saveCoreAsync(n,t).then(function(){return n})}function saveToCloudAsync(e){return Promise.resolve()}function syncAsync(){return apiAsync("list").then(function(e){e.pkgs.forEach(mergeFsPkg),data.invalidate("header:"),data.invalidate("text:")})}function saveScreenshotAsync(e,t,n){return apiAsync("screenshot/"+e.id,{screenshot:t,icon:n})}function resetAsync(){return db.destroyAsync().then(function(){allScripts=[],pxt.storage.clearLocal(),data.clearCache()})}function loadedAsync(){return Promise.resolve()}exports.provider={getHeaders:getHeaders,getHeader:getHeader,getTextAsync:getTextAsync,initAsync:initAsync,saveAsync:saveAsync,installAsync:installAsync,saveToCloudAsync:saveToCloudAsync,syncAsync:syncAsync,resetAsync:resetAsync,loadedAsync:loadedAsync,saveScreenshotAsync:saveScreenshotAsync};

},{"./core":13,"./data":14,"./db":15}],23:[function(require,module,exports){
"use strict";function parseExampleMarkdown(e,n){if(n){var r=/```(blocks?|typescript)\s+((.|\s)+?)\s*```/i.exec(n);if(r){var t=/```package\s+((.|\s)+?)\s*```/i.exec(n),a=void 0;return t&&(a={},t[1].split("\n").map(function(e){return e.replace(/\s*/g,"")}).filter(function(e){return!!e}).map(function(e){return e.split("=")}).forEach(function(e){return a[e[0]]=e[1]||"*"})),{name:e,filesOverride:{"main.blocks":'<xml xmlns="http://www.w3.org/1999/xhtml"></xml>',"main.ts":r[2]},dependencies:a}}}}function parseGalleryMardown(e){if(!e)return[];var n=[],r=!1,t=void 0,a="";return e.split(/\r?\n/).forEach(function(e){if(/^##/.test(e))t=e.substr(2).trim();else if(/^```codecard$/.test(e))r=!0;else if(/^```$/.test(e)){if(r=!1,t&&a)try{var l=JSON.parse(a);l&&l.length>0&&n.push({name:t,cards:l})}catch(e){pxt.log("invalid card format in gallery")}a="",t=void 0}else r&&(a+=e+"\n")}),n}function loadGalleryAsync(e){return pxt.Cloud.downloadMarkdownAsync(e,pxt.Util.userLanguage(),pxt.Util.localizeLive).then(function(e){return parseGalleryMardown(e)})}function loadExampleAsync(e,n){return pxt.Cloud.downloadMarkdownAsync(n,pxt.Util.userLanguage(),pxt.Util.localizeLive).then(function(n){return parseExampleMarkdown(e,n)})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.loadGalleryAsync=loadGalleryAsync,exports.loadExampleAsync=loadExampleAsync;

},{}],24:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])};return function(r,n){function e(){this.constructor=r}t(r,n),r.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}}();Object.defineProperty(exports,"__esModule",{value:!0});var iface,Cloud=pxt.Cloud,U=pxt.Util,HIDError=function(t){function r(r){var n=t.call(this,r)||this;return n.message=r,n}return __extends(r,t),r}(Error);exports.HIDError=HIDError;var bridgeByPath={};function onOOB(t){var r=U.lookup(bridgeByPath,t.result.path);r?r.onOOB(t):console.error("Dropping data for "+t.result.path)}function init(){if(!iface){if(!Cloud.isLocalHost()||!Cloud.localToken)return;pxt.debug("initializing hid pipe"),iface=pxt.worker.makeWebSocket("ws://localhost:"+pxt.options.wsPort+"/"+Cloud.localToken+"/hid",onOOB)}}function shouldUse(){var t=pxt.appTarget.serial;return t&&t.useHF2&&(Cloud.isLocalHost()&&!!Cloud.localToken||pxt.winrt.isWinRT())}function mkBridgeAsync(){init();var t=!1;pxt.appTarget.serial&&pxt.appTarget.serial.rawHID&&(t=!0);var r=new BridgeIO(t);return r.initAsync().then(function(){return r})}exports.shouldUse=shouldUse,pxt.HF2.mkPacketIOAsync=mkBridgeAsync;var uf2Wrapper,initPromise,serialHandler,BridgeIO=function(){function t(t){void 0===t&&(t=!1);var r=this;this.rawMode=t,this.onData=function(t){},this.onEvent=function(t){},this.onError=function(t){},this.onSerial=function(t,r){},t&&(this.onEvent=function(t){return r.onData(t)})}return t.prototype.onOOB=function(t){"serial"==t.op?this.onSerial(U.fromHex(t.result.data),t.result.isError):(t.op="event")&&this.onEvent(U.fromHex(t.result.data))},t.prototype.talksAsync=function(t){return iface.opAsync("talk",{path:this.dev.path,cmds:t.map(function(t){return{cmd:t.cmd,data:t.data?U.toHex(t.data):""}})}).then(function(t){return t.map(function(t){return U.fromHex(t.data)})})},t.prototype.error=function(t){throw new HIDError(U.lf("USB/HID error on device {0} ({1})",this.dev.product,t))},t.prototype.reconnectAsync=function(){return this.initAsync()},t.prototype.disconnectAsync=function(){return iface.opAsync("disconnect",{path:this.dev.path})},t.prototype.sendPacketAsync=function(t){if(this.rawMode)return iface.opAsync("send",{path:this.dev.path,data:U.toHex(t),raw:!0});throw new Error("should use talksAsync()!")},t.prototype.sendSerialAsync=function(t,r){return iface.opAsync("sendserial",{path:this.dev.path,data:U.toHex(t),isError:r})},t.prototype.initAsync=function(){var t=this;return iface.opAsync("list",{}).then(function(r){var n=r.devices,e=n.filter(function(t){return 16896==(65280&t.release)})[0];if(pxt.appTarget.serial&&pxt.appTarget.serial.rawHID&&(e=n[0]),!e)throw new Error("No device connected");t.dev&&delete bridgeByPath[t.dev.path],t.dev=e,bridgeByPath[t.dev.path]=t}).then(function(){return iface.opAsync("init",{path:t.dev.path,raw:t.rawMode})})},t}();function hf2Async(){return pxt.HF2.mkPacketIOAsync().then(function(t){return uf2Wrapper=new pxt.HF2.Wrapper(t),serialHandler&&(uf2Wrapper.onSerial=serialHandler),uf2Wrapper.reconnectAsync(!0).then(function(){return uf2Wrapper})})}function configureHidSerial(t){serialHandler=t,uf2Wrapper&&(uf2Wrapper.onSerial=serialHandler)}function disconnectWrapperAsync(){return uf2Wrapper?uf2Wrapper.disconnectAsync():Promise.resolve()}function initAsync(t){var r;return void 0===t&&(t=!1),initPromise||(initPromise=hf2Async().catch(function(t){return initPromise=null,Promise.reject(t)})),initPromise.then(function(n){return r=n,t?r.reconnectAsync():Promise.resolve()}).then(function(){return r})}exports.configureHidSerial=configureHidSerial,exports.disconnectWrapperAsync=disconnectWrapperAsync,exports.initAsync=initAsync;

},{}],25:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var data=require("./data"),mem=require("./memoryworkspace");function getHeaders(){return mem.provider.getHeaders()}function getHeader(e){return mem.provider.getHeader(e)}function getTextAsync(e){return mem.provider.getTextAsync(e)}function initAsync(e){return mem.provider.initAsync(e)}function saveAsync(e,t){return mem.provider.saveAsync(e,t).then(function(){return pxt.editor.postHostMessageAsync({type:"pxthost",action:"workspacesave",project:{header:e,text:t},response:!1})}).then(function(){})}function installAsync(e,t){return mem.provider.installAsync(e,t)}function saveToCloudAsync(e){return mem.provider.saveToCloudAsync(e)}function syncAsync(){return pxt.editor.postHostMessageAsync({type:"pxthost",action:"workspacesync",response:!0}).then(function(e){return(e.projects||[]).forEach(mem.merge),data.invalidate("header:"),data.invalidate("text:"),e.editor})}function resetAsync(){return mem.provider.resetAsync().then(function(){return pxt.editor.postHostMessageAsync({type:"pxthost",action:"workspacereset",response:!0})}).then(function(){})}function loadedAsync(){return mem.provider.loadedAsync().then(function(){return pxt.editor.postHostMessageAsync({type:"pxthost",action:"workspaceloaded",response:!0})}).then(function(){})}exports.provider={getHeaders:getHeaders,getHeader:getHeader,getTextAsync:getTextAsync,initAsync:initAsync,saveAsync:saveAsync,installAsync:installAsync,saveToCloudAsync:saveToCloudAsync,syncAsync:syncAsync,resetAsync:resetAsync,loadedAsync:loadedAsync};

},{"./data":14,"./memoryworkspace":28}],26:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,a){e.__proto__=a}||function(e,a){for(var i in a)a.hasOwnProperty(i)&&(e[i]=a[i])};return function(a,i){function n(){this.constructor=a}e(a,i),a.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),sui=require("./sui"),codecard=require("./codecard"),data=require("./data"),allLanguages={af:{englishName:"Afrikaans",localizedName:"Afrikaans"},ar:{englishName:"Arabic",localizedName:"العربية"},bg:{englishName:"Bulgarian",localizedName:"български"},ca:{englishName:"Catalan",localizedName:"Català"},cs:{englishName:"Czech",localizedName:"Čeština"},da:{englishName:"Danish",localizedName:"Dansk"},de:{englishName:"German",localizedName:"Deutsch"},el:{englishName:"Greek",localizedName:"Ελληνικά"},en:{englishName:"English",localizedName:"English"},"es-ES":{englishName:"Spanish (Spain)",localizedName:"Español (España)"},"es-MX":{englishName:"Spanish (Mexico)",localizedName:"Español (México)"},fi:{englishName:"Finnish",localizedName:"Suomi"},fr:{englishName:"French",localizedName:"Français"},"fr-CA":{englishName:"French (Canada)",localizedName:"Français (Canada)"},he:{englishName:"Hebrew",localizedName:"עברית"},hr:{englishName:"Croatian",localizedName:"Hrvatski"},hu:{englishName:"Hungarian",localizedName:"Magyar"},"hy-AM":{englishName:"Armenian (Armenia)",localizedName:"Հայերէն (Հայաստան)"},id:{englishName:"Indonesian",localizedName:"Bahasa Indonesia"},is:{englishName:"Icelandic",localizedName:"Íslenska"},it:{englishName:"Italian",localizedName:"Italiano"},ja:{englishName:"Japanese",localizedName:"日本語"},ko:{englishName:"Korean",localizedName:"한국어"},lt:{englishName:"Lithuanian",localizedName:"Lietuvių"},nl:{englishName:"Dutch",localizedName:"Nederlands"},no:{englishName:"Norwegian",localizedName:"Norsk"},pl:{englishName:"Polish",localizedName:"Polski"},"pt-BR":{englishName:"Portuguese (Brazil)",localizedName:"Português (Brasil)"},"pt-PT":{englishName:"Portuguese (Portugal)",localizedName:"Português (Portugal)"},ro:{englishName:"Romanian",localizedName:"Română"},ru:{englishName:"Russian",localizedName:"Русский"},"si-LK":{englishName:"Sinhala (Sri Lanka)",localizedName:"සිංහල (ශ්රී ලංකා)"},sk:{englishName:"Slovak",localizedName:"Slovenčina"},sl:{englishName:"Slovenian",localizedName:"Slovenski"},sr:{englishName:"Serbian",localizedName:"Srpski"},"sv-SE":{englishName:"Swedish (Sweden)",localizedName:"Svenska (Sverige)"},ta:{englishName:"Tamil",localizedName:"தமிழ்"},tr:{englishName:"Turkish",localizedName:"Türkçe"},uk:{englishName:"Ukrainian",localizedName:"Українська"},vi:{englishName:"Vietnamese",localizedName:"Tiếng việt"},"zh-CN":{englishName:"Chinese (Simplified)",localizedName:"简体中文"},"zh-TW":{englishName:"Chinese (Traditional)",localizedName:"繁体中文"}},pxtLangCookieId="PXT_LANG",langCookieExpirationDays=30,defaultLanguages=["en"];function setInitialLang(e){exports.initialLang=e}function getCookieLang(){var e=new RegExp(pxt.Util.escapeForRegex(pxtLangCookieId)+"=(.*?)(?:;|$)").exec(document.cookie);return e&&e[1]||null}function setCookieLang(e){if(allLanguages[e]&&e!==getCookieLang()){pxt.tickEvent("menu.lang.setcookielang."+e);var a=new Date;a.setTime(a.getTime()+24*langCookieExpirationDays*60*60*1e3),document.cookie=pxtLangCookieId+"="+e+"; expires="+a.toUTCString()}}exports.setInitialLang=setInitialLang,exports.getCookieLang=getCookieLang,exports.setCookieLang=setCookieLang;var LanguagePicker=function(e){function a(a){var i=e.call(this,a)||this;return i.state={visible:!1},i}return __extends(a,e),a.prototype.languageList=function(){return pxt.appTarget.appTheme.selectLanguage&&pxt.appTarget.appTheme.availableLocales&&pxt.appTarget.appTheme.availableLocales.length?pxt.appTarget.appTheme.availableLocales:defaultLanguages},a.prototype.changeLanguage=function(e){var a=this;allLanguages[e]&&(setCookieLang(e),e!==exports.initialLang?(pxt.tickEvent("menu.lang.changelang."+e),pxt.winrt.releaseAllDevicesAsync().then(function(){a.props.parent.reloadEditor()}).done()):(pxt.tickEvent("menu.lang.samelang."+e),this.hide()))},a.prototype.hide=function(){this.setState({visible:!1})},a.prototype.show=function(){this.setState({visible:!0})},a.prototype.renderCore=function(){var e=this;if(!this.state.visible)return React.createElement("div",null);var a=pxt.appTarget.appTheme,i=this.languageList(),n=i.length>4?"large":"small";return React.createElement(sui.Modal,{open:this.state.visible,header:lf("Select Language"),size:n,onClose:function(){return e.hide()},dimmer:!0,closeIcon:!0,allowResetFocus:!0,closeOnDimmerClick:!0,closeOnDocumentClick:!0,closeOnEscape:!0},React.createElement("div",{className:"group"},React.createElement("div",{className:"ui cards centered",role:"listbox"},i.map(function(a){return React.createElement(codecard.CodeCardView,{className:"card-selected focused",key:a,name:allLanguages[a].localizedName,ariaLabel:allLanguages[a].englishName,role:"option",description:allLanguages[a].englishName,onClick:function(){return e.changeLanguage(a)}})}))),React.createElement("p",null,React.createElement("br",null),React.createElement("br",null),React.createElement("a",{href:"https://crowdin.com/project/"+a.crowdinProject,target:"_blank","aria-label":lf("Help us translate")},lf("Help us translate"))))},a}(data.Component);exports.LanguagePicker=LanguagePicker;

},{"./codecard":10,"./data":14,"./sui":44,"react":269}],27:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var pkg=require("./package"),core=require("./core"),compiler=require("./compiler"),FRAME_ID="instructions";function loadMakeFrameAsync(e){return new Promise(function(n,t){window.addEventListener("message",function e(t){var i=t.data;"ready"==i.type&&i.frameid==FRAME_ID&&(window.removeEventListener("message",e),n(r))});var r=document.createElement("iframe");r.frameBorder="0",r.setAttribute("allowfullscreen","true"),r.setAttribute("sandbox","allow-popups allow-forms allow-scripts allow-same-origin allow-modals"),r.setAttribute("style","position:absolute;top:0;left:0;width:100%;height:100%;"),r.src=pxt.webConfig.partsUrl+"#"+FRAME_ID,e.appendChild(r)})}function renderAsync(e){var n;return loadMakeFrameAsync(e).then(function(e){return n=e,compiler.compileAsync({native:!0})}).then(function(e){for(var t=pkg.mainEditorPkg().header.name||lf("Untitled"),r=pxt.appTarget.simulator.boardDefinition,i=ts.pxtc.computeUsedParts(e).sort(),o=pkg.mainPkg.computePartDefinitions(i),a=e.usedArguments,s={},c={},d=0,l=e.configData||[];d<l.length;d++){var u=l[d];s[u.key+""]=u.value,c[u.name]=u.key}var p={cfg:s,cfgKey:c};return n.contentWindow.postMessage({type:"instructions",options:{name:t,boardDef:r,parts:i,partDefinitions:o,fnArgs:a,configData:p}},"*"),n})}function makeAsync(){var e;return core.dialogAsync({hideCancel:!0,header:lf("Make"),size:"large",htmlBody:'\n        <div class="ui container">\n            <div id="makecontainer" style="position:relative;height:0;padding-bottom:40%;overflow:hidden;">\n            </div>\n        </div>',onLoaded:function(n){renderAsync(n.find("#makecontainer")[0]).done(function(n){return e=n})},buttons:[{label:lf("Print"),onclick:function(){e&&e.contentWindow&&e.contentWindow.postMessage({type:"print"},"*")},icon:"print"}]}).then(function(e){})}exports.makeAsync=makeAsync;

},{"./compiler":11,"./core":13,"./package":32}],28:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var U=pxt.Util;exports.projects={};var target="";function merge(e){var t=e.header;t||(e.header=t={id:ts.pxtc.Util.guidGen(),recentUse:U.nowSeconds(),modificationTime:U.nowSeconds(),target:target,_rev:void 0,blobId:void 0,blobCurrent:void 0,isDeleted:!1,name:lf("Untitled"),meta:{},editor:pxt.BLOCKS_PROJECT_NAME,pubId:void 0,pubCurrent:void 0}),exports.projects[e.header.id]=e}function getHeaders(){return pxt.Util.values(exports.projects).map(function(e){return e.header})}function getHeader(e){var t=exports.projects[e];return t?t.header:void 0}function getTextAsync(e){var t=exports.projects[e];return Promise.resolve(t?t.text:void 0)}function initAsync(e){return target=e,Promise.resolve()}function saveAsync(e,t){return exports.projects[e.id]={header:e,text:t},Promise.resolve()}function installAsync(e,t){var r=e;return r.id=ts.pxtc.Util.guidGen(),r.recentUse=U.nowSeconds(),r.modificationTime=r.recentUse,r.target=pxt.appTarget.id,saveAsync(r,t).then(function(){return r})}function saveToCloudAsync(e){return Promise.resolve()}function syncAsync(){return Promise.resolve(void 0)}function resetAsync(){return exports.projects={},target="",Promise.resolve()}function loadedAsync(){return Promise.resolve()}exports.merge=merge,exports.provider={getHeaders:getHeaders,getHeader:getHeader,getTextAsync:getTextAsync,initAsync:initAsync,saveAsync:saveAsync,installAsync:installAsync,saveToCloudAsync:saveToCloudAsync,syncAsync:syncAsync,resetAsync:resetAsync,loadedAsync:loadedAsync};

},{}],29:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),__assign=this&&this.__assign||Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var i in t=arguments[o])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e};Object.defineProperty(exports,"__esModule",{value:!0});var FileType,React=require("react"),pkg=require("./package"),core=require("./core"),srceditor=require("./srceditor"),compiler=require("./compiler"),sui=require("./sui"),data=require("./data"),snippets=require("./monacoSnippets"),Util=pxt.Util,MIN_EDITOR_FONT_SIZE=10,MAX_EDITOR_FONT_SIZE=40;!function(e){e[e.Unknown=0]="Unknown",e[e.TypeScript=1]="TypeScript",e[e.Markdown=2]="Markdown"}(FileType||(FileType={}));var Editor=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.fileType=FileType.Unknown,t.giveFocusOnLoading=!1,t.dragCurrentPos={x:0,y:0},t.onDragBlockThrottled=Util.throttle(function(){var e=t.dragCurrentPos,o=e.x,n=e.y,i=t.editor.getTargetAtClientPoint(o,n);i&&i.position&&t.editor.getPosition()!=i.position&&t.editor.setPosition(i.position),t.editor.focus()},200),t.uniqueBlockId=0,t.highlightDecorations=[],t}return __extends(t,e),t.prototype.hasBlocks=function(){if(!this.currFile)return!0;var e=this.currFile.getVirtualFileName();return e&&null!=pkg.mainEditorPkg().files[e]},t.prototype.openBlocks=function(){var e=this;pxt.tickEvent("typescript.showBlocks");var t=this.parent.state.header;t&&(t.editor=pxt.BLOCKS_PROJECT_NAME,t.pubCurrent=!1);var o=Promise.resolve().then(function(){if(e.hasBlocks()){var t=e.currFile.getVirtualFileName();if(!t){var o=pkg.mainEditorPkg();if(!o||!o.files["main.blocks"])return void(o&&e.parent.setFile(o.files["main.ts"]));e.currFile=o.files["main.ts"],t=e.currFile.getVirtualFileName()}var n,i,r=pkg.mainEditorPkg();return e.parent.saveFileAsync().then(function(){return e.parent.loadBlocklyAsync()}).then(function(){return compiler.getBlocksAsync()}).then(function(o){i=o,pxt.blocks.initBlocks(i);var n=pxt.blocks.loadWorkspaceXml(r.files[t].content);return n?pxt.blocks.compileAsync(n,i).then(function(o){var i=o.source;return compiler.formatAsync(i,0).then(function(o){return compiler.formatAsync(e.editor.getValue(),0).then(function(i){return o.formatted==i.formatted?(pxt.debug("js not changed, skipping decompile"),pxt.tickEvent("typescript.noChanges"),e.parent.setFile(r.files[t]),[n,!1]):[n,!0]})})}):[n,!0]}).then(function(o){if(!o)return Promise.resolve();var a=o[0];return o[1]?compiler.decompileAsync(e.currFile.name,i,a,t).then(function(o){if(!o.success){e.currFile.diagnostics=o.diagnostics;var i=!1;return o.diagnostics.forEach(function(e){return i=i||9266===e.code}),a=t,void 0===(s=i)&&(s=!1),core.cancelAsyncLoading("switchtoblocks"),e.forceDiagnosticsUpdate(),e.showConversionFailedDialog(a,s)}var a,s;return n=o.outfiles[t],Util.assert(!!n),r.setContentAsync(t,n).then(function(){return e.parent.setFile(r.files[t])})}):Promise.resolve()}).catch(function(e){pxt.reportException(e),core.errorNotification(lf("Oops, something went wrong trying to convert your code."))})}});core.showLoadingAsync("switchtoblocks",lf("switching to blocks..."),o).done()},t.prototype.showConversionFailedDialog=function(e,t){var o=this,n=pkg.mainEditorPkg().files[e];return t&&pxt.tickEvent("typescript.programTooLarge"),core.confirmAsync({header:t?lf("Program too large"):lf("Oops, there is a problem converting your code."),body:t?lf("Your program is too large to convert into blocks. You can keep working in JavaScript or discard your changes and go back to the previous Blocks version."):lf("We are unable to convert your JavaScript code back to blocks. You can keep working in JavaScript or discard your changes and go back to the previous Blocks version."),agreeLbl:lf("Discard and go to Blocks"),agreeClass:"cancel",agreeIcon:"cancel",disagreeLbl:lf("Stay in JavaScript"),disagreeClass:"positive",disagreeIcon:"checkmark",size:"medium",hideCancel:!n}).then(function(e){e?(pxt.tickEvent("typescript.discardText",void 0,{interactiveConsent:!0}),o.parent.saveBlocksToTypeScriptAsync().then(function(e){o.overrideFile(e),o.parent.setFile(n)})):pxt.tickEvent("typescript.keepText",void 0,{interactiveConsent:!0})})},t.prototype.decompileAsync=function(e){return compiler.decompileAsync(e)},t.prototype.display=function(){var e=this;return React.createElement("div",{id:"monacoEditorArea",className:"full-abs"},React.createElement(MonacoToolbox,{ref:function(t){return e.monacoToolbox=t},parent:this}),React.createElement("div",{id:"monacoEditorInner"}))},t.prototype.addPackage=function(){pxt.tickEvent("monaco.addpackage",void 0,{interactiveConsent:!0}),this.hideFlyout(),this.parent.addPackage()},t.prototype.defineEditorTheme=function(e,t){var o=this,n=pxt.appTarget.appTheme.invertedMonaco,i=.6,r=[];if(!e&&t){var a={};this.getNamespaces().forEach(function(e){var t=o.getNamespaceAttrs(e),n=snippets.isBuiltin(e)?snippets.getBuiltinCategory(e).blocks.concat(o.nsMap[e]||[]):o.nsMap[e];if(t.color&&n){var i=p(t.color);n.forEach(function(e){r.push({token:"identifier.ts "+e.name,foreground:i})}),r.push({token:"identifier.ts "+e,foreground:i}),a[e]=t.color}}),r.push({token:"identifier.ts if",foreground:"5B80A5"}),r.push({token:"identifier.ts else",foreground:"5B80A5"}),r.push({token:"identifier.ts while",foreground:"5BA55B"}),r.push({token:"identifier.ts for",foreground:"5BA55B"});var s=pxt.appTarget.runtime&&pxt.appTarget.runtime.pauseUntilBlock;if(s){var c=s.callName||"pauseUntil",l=s.color||a[s.category];l&&r.push({token:"identifier.ts "+c,foreground:p(l)})}}var d=pxt.appTarget.appTheme.monacoColors||{};function p(e){return e=pxt.toolbox.convertColor(e),(n?pxt.toolbox.fadeColor(e,i,!0):e).replace("#","")}monaco.editor.defineTheme("pxtTheme",{base:e?"hc-black":n?"vs-dark":"vs",inherit:!0,rules:r,colors:e?{}:d}),monaco.editor.setTheme("pxtTheme")},t.prototype.setHighContrast=function(e){this.defineEditorTheme(e)},t.prototype.beforeCompile=function(){this.editor&&this.editor.getAction("editor.action.formatDocument").run()},t.prototype.isIncomplete=function(){return!(!this.editor||!this.editor._view)&&this.editor._view.contentWidgets._widgets["editor.widget.suggestWidget"].isVisible},t.prototype.resize=function(e){var t=document.getElementById("monacoEditorArea"),o=this.monacoToolbox&&this.monacoToolbox.getElement();if(t&&this.editor){var n=o&&o.offsetWidth||0;this.editor.layout({width:t.offsetWidth-n,height:t.offsetHeight});var i=this.editor._themeService._theme.colors["editor.background"].rgba;this.parent.updateEditorLogo(n,"rgba("+i.r+","+i.g+","+i.b+","+i.a+")");var r=this.editor?this.editor.getLayoutInfo().contentHeight:0;this.monacoToolbox&&this.monacoToolbox.setToolboxHeight(r)}},t.prototype.prepare=function(){this.isReady=!0},t.prototype.loadMonacoAsync=function(){var e=this;if(this.editor||this.loadingMonaco)return Promise.resolve();this.loadingMonaco=!0,this.extraLibs=Object.create(null);var t=document.getElementById("monacoEditorArea"),o=document.getElementById("monacoEditorInner");return pxt.vs.initMonacoAsync(o).then(function(o){if(e.editor=o,e.loadingMonaco=!1,e.editor.updateOptions({fontSize:e.parent.settings.editorFontSize}),e.editor.addAction({id:"save",label:lf("Save"),keybindings:[monaco.KeyMod.CtrlCmd|monaco.KeyCode.KEY_S],keybindingContext:"!editorReadonly",precondition:"!editorReadonly",contextMenuGroupId:"0_pxtnavigation",contextMenuOrder:.2,run:function(){return Promise.resolve(e.parent.typecheckNow())}}),e.editor.addAction({id:"runSimulator",label:lf("Run Simulator"),keybindings:[monaco.KeyMod.CtrlCmd|monaco.KeyCode.Enter],keybindingContext:"!editorReadonly",precondition:"!editorReadonly",contextMenuGroupId:"0_pxtnavigation",contextMenuOrder:.21,run:function(){return Promise.resolve(e.parent.runSimulator())}}),pxt.appTarget.compile&&pxt.appTarget.compile.hasHex&&e.editor.addAction({id:"compileHex",label:lf("Download"),keybindings:[monaco.KeyMod.CtrlCmd|monaco.KeyMod.Alt|monaco.KeyCode.Enter],keybindingContext:"!editorReadonly",precondition:"!editorReadonly",contextMenuGroupId:"0_pxtnavigation",contextMenuOrder:.22,run:function(){return Promise.resolve(e.parent.compile())}}),e.editor.addAction({id:"zoomIn",label:lf("Zoom In"),keybindings:[monaco.KeyMod.CtrlCmd|monaco.KeyCode.NUMPAD_ADD,monaco.KeyMod.CtrlCmd|monaco.KeyCode.US_EQUAL],run:function(){return Promise.resolve(e.zoomIn())}}),e.editor.addAction({id:"zoomOut",label:lf("Zoom Out"),keybindings:[monaco.KeyMod.CtrlCmd|monaco.KeyCode.NUMPAD_SUBTRACT,monaco.KeyMod.CtrlCmd|monaco.KeyCode.US_MINUS],run:function(){return Promise.resolve(e.zoomOut())}}),pxt.appTarget.appTheme.hasReferenceDocs){var n=e.editor.createContextKey("editorHasReference",!1);e.editor.addAction({id:"reference",label:lf("Help"),keybindingContext:"!editorReadonly && editorHasReference",precondition:"!editorReadonly && editorHasReference",contextMenuGroupId:"navigation",contextMenuOrder:.1,run:function(){return Promise.resolve(e.loadReference())}}),e.editor.onDidChangeCursorPosition(function(t){var o=e.editor.getModel().getWordUntilPosition(t.position);o&&""!=o.word?n.set(!0):n.reset()})}var i=Util.isUserLanguageRtl()?monaco.KeyCode.RightArrow:monaco.KeyCode.LeftArrow;e.editor.addAction({id:"jumptoolbox",label:lf("Jump to Toolbox"),keybindings:[monaco.KeyMod.CtrlCmd|i],keybindingContext:"!editorReadonly",precondition:"!editorReadonly",run:function(){return Promise.resolve(e.moveFocusToToolbox())}}),e.editor.onDidLayoutChange(function(t){var o=e.editor.getConfiguration().fontInfo.fontSize;e.parent.settings.editorFontSize!=o&&(e.parent.settings.editorFontSize=o,e.forceDiagnosticsUpdate());var n=document.getElementById("monacoEditorToolbox");n&&(n.style.height=e.editor.getLayoutInfo().contentHeight+"px");var i=document.getElementById("monacoFlyoutWidget");i&&(i.style.height=e.editor.getLayoutInfo().contentHeight+"px")});var r=document.getElementById("monacoEditorInner");r.ondragenter=function(e){e.preventDefault(),e.stopPropagation()},r.ondragover=function(t){t.preventDefault(),t.stopPropagation(),e.dragCurrentPos={x:t.clientX,y:t.clientY},e.onDragBlockThrottled(t)},r.ondrop=function(t){var o=t.dataTransfer.getData("text");if(o){t.preventDefault(),t.stopPropagation();var n=e.editor.getTargetAtClientPoint(t.clientX,t.clientY).position,i=e.editor.getModel(),r=e.editor.getPosition(),a=i.getOffsetAt(r);n||(n=r),(o=r.column>1?"\n"+o:void 0!=i.getWordUntilPosition(r)&&""!=i.getWordUntilPosition(r).word?o+"\n":o).indexOf("{{}}")>-1?(a+=o.indexOf("{{}}"),o=o.replace("{{}}","")):a+=o.length,e.editor.pushUndoStop(),e.editor.executeEdits("",[{identifier:{major:0,minor:0},range:new monaco.Range(n.lineNumber,n.column,n.lineNumber,n.column),text:o,forceMoveMarkers:!0,isAutoWhitespaceEdit:!0}]),e.beforeCompile(),e.editor.pushUndoStop();var s=i.getPositionAt(a);e.editor.setPosition(s),e.editor.focus()}},e.editor.onDidFocusEditorText(function(){e.hideFlyout()}),e.editorViewZones=[],e.setupToolbox(t)})},t.prototype.undo=function(){this.editor&&this.editor.trigger("keyboard","undo",null)},t.prototype.redo=function(){this.editor&&this.editor.trigger("keyboard","redo",null)},t.prototype.zoomIn=function(){if(this.editor&&!(this.parent.settings.editorFontSize>=MAX_EDITOR_FONT_SIZE)){var e=this.editor.getConfiguration().fontInfo.fontSize;this.parent.settings.editorFontSize=e+1,this.editor.updateOptions({fontSize:this.parent.settings.editorFontSize}),this.forceDiagnosticsUpdate()}},t.prototype.zoomOut=function(){if(this.editor&&!(this.parent.settings.editorFontSize<=MIN_EDITOR_FONT_SIZE)){var e=this.editor.getConfiguration().fontInfo.fontSize;this.parent.settings.editorFontSize=e-1,this.editor.updateOptions({fontSize:this.parent.settings.editorFontSize}),this.forceDiagnosticsUpdate()}},t.prototype.loadReference=function(){Util.assert(void 0!=this.editor);var e=this.editor.getPosition(),t=this.editor.getModel().getWordAtPosition(e);if(t){var o=this.editor.getModel().getWordUntilPosition(new monaco.Position(e.lineNumber,t.startColumn-1));if(o&&t){var n=o.word.replace(/([A-Z]+)/g,"-$1"),i=t.word.replace(/([A-Z]+)/g,"-$1");this.parent.setSideDoc("/reference/"+n+"/"+i,!1)}else if(t){i=t.word.replace(/([A-Z]+)/g,"-$1");this.parent.setSideDoc("/reference/"+i,!1)}}},t.prototype.setupToolbox=function(e){var t={getId:function(){return"pxt.flyout.widget"},getDomNode:function(){return this.domNode||(this.domNode=document.createElement("div"),this.domNode.id="monacoFlyoutWidget",this.domNode.style.top="0",this.domNode.className="monacoFlyout",this.domNode.style.display="none",this.domNode.textContent="Flyout"),this.domNode},getPosition:function(){return null}};this.editor.addOverlayWidget(t)},t.prototype.closeFlyout=function(){this.editor&&this.hideFlyout()},t.prototype.hideFlyout=function(){var e=document.getElementById("monacoFlyoutWidget");e.innerHTML="",e.style.display="none",this.monacoToolbox.clearSelection(),this.parent.setState({hideEditorFloats:!1})},t.prototype.showFlyout=function(e,t,o,n,i,r){if(this.editor){var a,s=document.getElementById("monacoFlyoutWidget"),c=this.parent.settings.editorFontSize;if(s.style.left=this.editor.getLayoutInfo().lineNumbersLeft+"px",s.style.height=this.editor.getLayoutInfo().contentHeight+"px",s.style.display="block",s.className="monacoFlyout",s.style.transform="none",s.innerHTML="",snippets.isBuiltin(e)){var l=snippets.getBuiltinCategory(e),d=l.blocks||[];if(d.forEach(function(e){e.noNamespace=!0}),!l.custom&&this.nsMap[e.toLowerCase()]&&(d=d.concat(this.nsMap[e.toLowerCase()].filter(function(e){return!(e.attributes.blockHidden||e.attributes.deprecated)}))),!d||!d.length)return;a=d}else a=this.nsMap[e].filter(function(e){return!(e.attributes.blockHidden||e.attributes.deprecated)});if(!pxt.appTarget.appTheme.hideFlyoutHeadings){var p=document.createElement("div");p.className="monacoFlyoutLabel monacoFlyoutHeading";var u=document.createElement("span"),f=("blocklyTreeIcon"+(o?(e||o).toLowerCase():"Default")).replace(/\s/g,"");u.className="monacoFlyoutHeadingIcon blocklyTreeIcon "+f,u.setAttribute("role","presentation"),u.style.display="inline-block",u.style.color=""+t;var m=document.createElement("div");m.className="monacoFlyoutHeadingText",m.style.display="inline-block",m.style.fontSize=c+5+"px",m.style.lineHeight=c+5+"px",m.textContent=n||""+Util.capitalize(e),p.appendChild(u),p.appendChild(m),s.appendChild(p)}var h={},g=[];i&&(g=i);for(var y=0;y<a.length;++y){var v=a[y];h[x=v.attributes.group||"other"]||(h[x]=[]),h[x].push(v)}Object.keys(h).sort().forEach(function(e){-1==g.indexOf(e)&&g.push(e)});for(var b=0;b<g.length;++b){var x;if("other"!=(x=g[b])){var k=document.createElement("div");k.className="monacoFlyoutLabel blocklyFlyoutGroup";var C=document.createElement("div");C.className="monacoFlyoutLabelText",C.style.display="inline-block",C.style.fontSize=c+"px",C.style.lineHeight=c+5+"px",C.textContent=pxt.Util.rlf("{id:group}"+x),k.appendChild(C),s.appendChild(k);var T=document.createElement("hr");T.className="monacoFlyoutLabelLine",T.align="left",T.style.width=Math.min(r?parseInt(r):C.offsetWidth,350)+"px",k.appendChild(T)}if(h[x]){var E=this.parent.state.editorState?this.parent.state.editorState.filters:void 0,F=E?E.namespaces&&void 0!=E.namespaces[e]?E.namespaces[e]:E.defaultState:void 0;this.createMonacoBlocks(this,s,e,h[x],t,E,F)}}this.parent.setState({hideEditorFloats:!0})}},t.prototype.moveFocusToToolbox=function(){this.monacoToolbox&&this.monacoToolbox.focus()},t.prototype.moveFocusToFlyout=function(){var e=document.getElementById("monacoFlyoutWidget").getElementsByClassName("monacoDraggableBlock")[0];e&&e.focus()},t.prototype.updateToolbox=function(){var e=this;if(pxt.appTarget.appTheme.monacoToolbox&&!pxt.shell.isReadOnly()){this.editor.getLayoutInfo().glyphMarginLeft=200,this.editor.layout();var t=this.getNamespaces().map(function(t){return[t,e.getNamespaceAttrs(t)]});this.monacoToolbox.setState({namespaces:t,showAdvanced:this.showAdvanced})}},t.prototype.getNamespaceAttrs=function(e){var t=snippets.getBuiltinCategory(e);if(t)return t.attributes.color=pxt.toolbox.getNamespaceColor(t.nameid),t.attributes;var o=this.blockInfo.apis.byQName[e];return o&&o.attributes.color?o.attributes:void 0},t.prototype.getNamespaces=function(){var e=this,t=Object.keys(this.nsMap).filter(function(t){return!snippets.isBuiltin(t)&&!!e.getNamespaceAttrs(t)}),o=pxt.appTarget.runtime||{};return o.loopsBlocks&&!snippets.loops.removed&&t.push(snippets.loops.nameid),o.logicBlocks&&!snippets.logic.removed&&t.push(snippets.logic.nameid),o.variablesBlocks&&!snippets.variables.removed&&t.push(snippets.variables.nameid),o.mathBlocks&&!snippets.maths.removed&&t.push(snippets.maths.nameid),o.functionBlocks&&!snippets.functions.removed&&t.push(snippets.functions.nameid),o.listsBlocks&&!snippets.arrays.removed&&t.push(snippets.arrays.nameid),o.textBlocks&&!snippets.text.removed&&t.push(snippets.text.nameid),t},t.prototype.createMonacoBlocks=function(e,t,o,n,i,r,a){var s=this,c=n.sort(function(e,t){return(t.attributes.weight||50)+(t.attributes.advanced?0:1e3)>=(e.attributes.weight||50)+(e.attributes.advanced?0:1e3)?1:-1}).map(function(n){var c,l=r?r.fns&&void 0!=r.fns[n.name]?r.fns[n.name]:void 0!=a?a:r.defaultState:void 0;if(c=l==pxt.editor.FilterState.Disabled,l!=pxt.editor.FilterState.Hidden){var d=n.snippet;if(d){var p=document.createElement("div");p.className="monacoBlock "+(c?"monacoDisabledBlock":""),t.appendChild(p);var u=document.createElement("div");u.className="monacoDraggableBlock",u.tabIndex=0,p.appendChild(u);var f=n.attributes.jsDoc,m=n.noNamespace?"":o,h=!1,g=!1,y="",v=n;if(v.attributes.block)if(v.attributes.defaultInstance)m=v.attributes.defaultInstance;else if(v.namespace){var b=s.blockInfo.apis.byQName[v.namespace];if(b.attributes.fixedInstances){var x=Util.values(s.blockInfo.apis.byQName);y=v.attributes.blockNamespace||b.namespace||"";var k=x.filter(function(e){return e.kind===pxtc.SymbolKind.Variable&&e.attributes.fixedInstance}),C=k.filter(function(e){return e.retType==b.name}).sort(function(e,t){return e.name.localeCompare(t.name)}),T=k.filter(function(e){return-1!==(t=b.name,x.filter(function(e){return e.extendsTypes}).filter(function(e){return e.extendsTypes.reduce(function(e,o){return e||-1!=o.indexOf(t)},!1)}).reduce(function(e,t){return e.concat(t.extendsTypes)},[])).indexOf(e.retType);var t}).sort(function(e,t){return e.name.localeCompare(t.name)});C.length?m=""+C[0].name:T.length&&(m=""+T[0].name),h=!0,g=!0}else if(v.kind==pxtc.SymbolKind.Method||v.kind==pxtc.SymbolKind.Property){var E=pxt.blocks.compileInfo(v);m=E.thisParameter.definitionName,h=!0}else if(b.kind===pxtc.SymbolKind.Class)return}var F=document.createElement("span");if(n.snippetOnly||(F.className="sig"),F.textContent=d.replace(/^[^(]*\(/,"(").replace(/^\s*\{\{\}\}\n/gm,"").replace(/\{\n\}/g,"{}").replace(/(?:\{\{)|(?:\}\})/g,""),u.title=f,!c){u.draggable=!0,u.onclick=function(t){pxt.tickEvent("monaco.toolbox.itemclick",void 0,{interactiveConsent:!0}),e.hideFlyout();var o=e.editor.getModel(),n=e.editor.getPosition(),i=o.getOffsetAt(n),r=m?m+"."+d:d;r=g?firstWord(y)+"."+r:r,(r=n.column>1?"\n"+r:void 0!=o.getWordUntilPosition(n)&&""!=o.getWordUntilPosition(n).word?r+"\n":r).indexOf("{{}}")>-1?(i+=r.indexOf("{{}}"),r=r.replace("{{}}","")):i+=r.length,r=r.replace(/(?:\{\{)|(?:\}\})/g,""),e.editor.pushUndoStop(),e.editor.executeEdits("",[{identifier:{major:0,minor:0},range:new monaco.Range(n.lineNumber,n.column,n.lineNumber,n.column),text:r,forceMoveMarkers:!1}]),e.beforeCompile(),e.editor.pushUndoStop();var a=o.getPositionAt(i);e.editor.setPosition(a),e.editor.focus()},u.ondragstart=function(e){pxt.tickEvent("monaco.toolbox.itemdrag",void 0,{interactiveConsent:!0}),setTimeout(function(){t.style.transform="translateX(-9999px)"});var o=m?m+"."+d:d;o=g?firstWord(y)+"."+o:o,e.dataTransfer.setData("text",o)},u.ondragend=function(o){t.style.transform="none",e.hideFlyout()};var S=function(){u.style.backgroundColor=c?""+pxt.toolbox.fadeColor(i||"#ddd",.8,!1):""+pxt.toolbox.fadeColor(i||"#ddd",.1,!1)},w=function(){u.style.backgroundColor=c?""+pxt.toolbox.fadeColor(i||"#ddd",.8,!1):""+i};u.onmouseenter=function(e){S()},u.onmouseleave=function(e){w()},u.onfocus=function(e){S()},u.onblur=function(e){w()}}if(!n.snippetOnly){if(h){var I=document.createElement("span");I.textContent=m+".",I.className="sigPrefix",u.appendChild(I)}var N=document.createElement("span");N.textContent=n.name,u.appendChild(N)}if(u.appendChild(F),u.style.fontSize=e.parent.settings.editorFontSize+"px",u.style.lineHeight=e.parent.settings.editorFontSize+1+"px",u.style.backgroundColor=c?""+pxt.toolbox.fadeColor(i||"#ddd",.8,!1):""+i,u.style.borderColor=""+pxt.toolbox.fadeColor(i||"#ddd",.2,!1),n.retType&&"boolean"==n.retType){u.style.borderRadius="0px";var R=u.offsetHeight-2,M=e.uniqueBlockId++;u.id="monacoHexBlock"+M,u.className+=" monacoHexBlock";var A=document.createElement("style");A.innerHTML="\n                        #monacoHexBlock"+M+":before,\n                        #monacoHexBlock"+M+":after {\n                            border-top: "+R/2+"px solid transparent;\n                            border-bottom: "+R/2+"px solid transparent;\n                        }\n                        #monacoHexBlock"+M+":before {\n                            border-right: 17px solid "+i+";\n                        }\n                        #monacoHexBlock"+M+":after {\n                            border-left: 17px solid "+i+";\n                        }\n                    ",p.insertBefore(A,u)}else n.retType&&"void"!=n.retType?u.style.borderRadius="40px":u.style.borderRadius="3px";return u}}});c.forEach(function(t,o){var n=Util.isUserLanguageRtl();t.onkeydown=function(t){var i="number"==typeof t.which?t.which:t.keyCode;40==i?o<c.length-1&&c[o+1].focus():38==i?o>0&&c[o-1].focus():37==i&&!n||38==i&&n?e.moveFocusToToolbox():27==i?(e.hideFlyout(),e.moveFocusToToolbox()):sui.fireClickOnEnter.call(s,t)}})},t.prototype.getId=function(){return"monacoEditor"},t.prototype.getViewState=function(){return this.editor?this.editor.getPosition():{}},t.prototype.getCurrentSource=function(){return this.editor?this.editor.getValue():this.currSource},t.prototype.acceptsFile=function(e){return!0},t.prototype.setValue=function(e){this.editor.setValue(e)},t.prototype.overrideFile=function(e){Util.assert(void 0!=this.editor),this.editor.setValue(e)},t.prototype.loadFileAsync=function(e,t){var o=this,n="text";this.currSource=e.content;var i=document.createElement("div");i.className="ui inverted loading dimmer active";var r=document.getElementById("monacoEditorArea"),a=document.getElementById("monacoEditorInner");return r.insertBefore(i,a),this.loadMonacoAsync().then(function(){if(o.editor){var i=e.getExtension(),r={cpp:"cpp",h:"cpp",json:"json",md:"text",ts:"typescript",js:"javascript",svg:"xml",blocks:"xml",asm:"asm"};r.hasOwnProperty(i)&&(n=r[i]);var a=e.isReadonly()||pxt.shell.isReadOnly();o.editor.updateOptions({readOnly:a});var s="pkg:"+e.getName(),c=monaco.editor.getModels().filter(function(e){return e.uri.toString()==s})[0];c||(c=monaco.editor.createModel(pkg.mainPkg.readFile(e.getName()),n,monaco.Uri.parse(s))),c&&o.editor.setModel(c),o.defineEditorTheme(t),"typescript"==n&&o.beginLoadToolbox(e,t),o.currFile=e,o.setValue(e.content),o.setDiagnostics(e,o.snapshotState()),o.fileType="typescript"==n?FileType.TypeScript:"md"==i?FileType.Markdown:FileType.Unknown,o.fileType==FileType.Markdown&&o.parent.setSideMarkdown(e.content),o.currFile.setForceChangeCallback(function(e,t){e!=t&&(pxt.debug("File changed (from "+e+", to "+t+"). Reloading editor"),o.loadFileAsync(o.currFile))}),e.isReadonly()||c.onDidChangeContent(function(e){o.clearHighlightedStatements();var t=o.editorViewZones||[];o.editor.changeViewZones(function(e){t.forEach(function(t){e.removeZone(t)})}),o.editorViewZones=[],e.isRedoing||e.isUndoing||o.editor.getValue()||o.editor.setValue(" "),o.updateDiagnostics(),o.changeCallback()}),"typescript"!=n||e.isReadonly()?o.monacoToolbox.hide():o.monacoToolbox.show(),o.resize(),o.hideFlyout(),o.giveFocusOnLoading&&o.editor.focus()}}).finally(function(){r.removeChild(i)})},t.prototype.beginLoadToolbox=function(e,t){var o=this;compiler.getBlocksAsync().then(function(n){o.blockInfo=n,o.nsMap=o.partitionBlocks(),o.updateToolbox(),o.resize(),pxt.vs.syncModels(pkg.mainPkg,o.extraLibs,e.getName(),e.isReadonly()),o.defineEditorTheme(t,!0)})},t.prototype.unloadFileAsync=function(){return this.currFile&&this.currFile.getName()=="this/"+pxt.CONFIG_NAME?this.parent.reloadHeaderAsync():Promise.resolve()},t.prototype.snapshotState=function(){return this.editor&&this.editor.getModel()?this.editor.getModel().getLinesContent():null},t.prototype.setViewState=function(e){this.editor&&e&&0!==Object.keys(e).length&&(this.editor.setPosition(e),this.editor.setScrollPosition(e))},t.prototype.setDiagnostics=function(e,t){Util.assert(void 0!=this.editor),Util.assert(this.currFile==e),this.diagSnapshot=t,this.forceDiagnosticsUpdate()},t.prototype.updateDiagnostics=function(){this.needsDiagUpdate()&&this.forceDiagnosticsUpdate()},t.prototype.needsDiagUpdate=function(){if(!this.annotationLines)return!1;for(var e=this.editor.getModel().getLinesContent(),t=0,o=this.annotationLines;t<o.length;t++){var n=o[t];if(this.diagSnapshot[n]!==e[n])return!0}return!1},t.prototype.forceDiagnosticsUpdate=function(){if(this.fileType==FileType.TypeScript){var e=this.currFile,t=[];if(e&&e.diagnostics){for(var o=monaco.editor.getModel(monaco.Uri.parse("pkg:"+e.getName())),n=function(e){var n=function(o){t.push({severity:monaco.Severity.Error,message:o,startLineNumber:e.line+1,startColumn:e.column,endLineNumber:void 0==e.endLine?i.lineNumber:e.endLine+1,endColumn:void 0==e.endColumn?i.column:e.endColumn})},i=o.getPositionAt(e.start+e.length);if("string"==typeof e.messageText)n(e.messageText);else for(var r=e.messageText;void 0!=r.next;)n(r.messageText),r=r.next},i=0,r=e.diagnostics;i<r.length;i++){n(r[i])}monaco.editor.setModelMarkers(o,"typescript",t)}}},t.prototype.highlightStatement=function(e){if(e||this.clearHighlightedStatements(),!e||!this.currFile||this.currFile.name!=e.fileName||!this.editor)return!1;var t=this.editor.getModel().getPositionAt(e.start),o=this.editor.getModel().getPositionAt(e.start+e.length);return!(!t||!o)&&(this.highlightDecorations=this.editor.deltaDecorations(this.highlightDecorations,[{range:new monaco.Range(t.lineNumber,t.column,o.lineNumber,o.column),options:{inlineClassName:"highlight-statement"}}]),!0)},t.prototype.clearHighlightedStatements=function(){this.editor&&this.highlightDecorations&&this.editor.deltaDecorations(this.highlightDecorations,[])},t.prototype.partitionBlocks=function(){var e={};if(this.blockInfo.blocks.forEach(function(t){var o=(t.attributes.blockNamespace||t.namespace).split(".")[0];e[o]||(e[o]=[]),e[o].push(t)}),snippets.getPauseUntil()){var t=pxt.appTarget.runtime.pauseUntilBlock.category;e[t]&&e[t].push(snippets.getPauseUntil())}return e},t}(srceditor.Editor);exports.Editor=Editor;var MonacoToolbox=function(e){function t(t){var o=e.call(this,t)||this;return o.state={showAdvanced:!1},o}return __extends(t,e),t.prototype.getElement=function(){return this.rootElement},t.prototype.hide=function(){this.setState({visible:!1})},t.prototype.show=function(){this.setState({visible:!0})},t.prototype.setToolboxHeight=function(e){this.rootElement&&(this.rootElement.style.height=e+"px")},t.prototype.clearSelection=function(){this.setState({selectedNs:void 0}),this.selectedIndex=0},t.prototype.setSelectedItem=function(e){this.selectedItem=e},t.prototype.setPreviousItem=function(){if(this.selectedIndex>0){var e=--this.selectedIndex;this.setSelection(this.items[e],e)}},t.prototype.setNextItem=function(){if(this.items.length-1>this.selectedIndex){var e=++this.selectedIndex;this.setSelection(this.items[e],e)}},t.prototype.setSelection=function(e,t){var o=this.props.parent,n=e.ns,i=e.icon,r=e.color,a=e.category,s=e.groups,c=e.labelLineWidth;pxt.tickEvent("monaco.toolbox.click"),this.state.selectedNs==n?(this.clearSelection(),o.closeFlyout()):(this.setState({selectedNs:n}),this.selectedIndex=t,e.advanced&&!this.state.showAdvanced&&this.showAdvanced(),o.showFlyout(n,r,i,a,s,c))},t.prototype.focus=function(){if(this.rootElement)if(this.selectedItem&&this.selectedItem.getTreeRow())this.selectedItem.getTreeRow().focus();else{var e=this.rootElement.getElementsByClassName("blocklyTreeRow")[0];e&&e.focus()}},t.prototype.moveFocusToFlyout=function(){this.props.parent.moveFocusToFlyout()},t.prototype.closeFlyout=function(){this.props.parent.closeFlyout()},t.prototype.addPackage=function(){this.props.parent.addPackage()},t.prototype.componentDidUpdate=function(e,t){pxt.toolbox.injectToolboxIconCss()},t.prototype.advancedClicked=function(){pxt.tickEvent("monaco.advanced"),this.showAdvanced()},t.prototype.showAdvanced=function(){var e=this.props.parent;this.setState({showAdvanced:!this.state.showAdvanced}),e.resize()},t.prototype.renderCore=function(){var e=this,t=this.props.parent,o=this.state,n=o.namespaces,i=o.showAdvanced,r=o.visible,a=o.selectedNs;if(!n||!r)return React.createElement("div",{style:{display:"none"}});var s=t.parent.state.editorState&&t.parent.state.editorState.filters;function c(e,t){if(!t||!t.length)return!1;var o=s?s.namespaces&&void 0!=s.namespaces[e]?s.namespaces[e]:s.defaultState:void 0,n=!1;return s&&void 0!==o&&t?Object.keys(t).forEach(function(e){var t=s.fns&&void 0!=s.fns[e]?s.fns[e]:void 0!=o?o:s.defaultState;t!=pxt.editor.FilterState.Disabled&&t!=pxt.editor.FilterState.Visible||(n=!0)}):n=!0,!!n}var l=0;function d(e,o){return e.sort(function(e,t){var o=e[1],n=t[1];return(n&&n.weight||50)>=(o&&o.weight||50)?1:-1}).map(function(e){var n=e[0],i=e[1];if(snippets.isBuiltin(n)){var r=snippets.getBuiltinCategory(n),a=r.blocks||[],s=r.name;if(a.forEach(function(e){e.noNamespace=!0}),!r.custom&&t.nsMap[n.toLowerCase()]&&(a=a.concat(t.nsMap[n.toLowerCase()].filter(function(e){return!(e.attributes.blockHidden||e.attributes.deprecated)}))),!c(n,a))return;return{ns:n,category:s,color:i.color,icon:i.icon,groups:i.groups,labelLineWidth:i.labelLineWidth,advanced:o,index:l++}}if(c(n,a=t.nsMap[n].filter(function(e){return!(e.attributes.blockHidden||e.attributes.deprecated)})))return{ns:n,category:s=i.block?i.block:void 0,color:i.color,icon:i.icon,groups:i.groups,labelLineWidth:i.labelLineWidth,injectIconClass:!0,advanced:o,index:l++}}).filter(function(e){return!!e})}var p=n.some(function(e){return e[1].advanced}),u=!pxt.shell.isReadOnly()&&pxt.appTarget.cloud&&pxt.appTarget.cloud.packages,f=d(n.filter(function(e){return!e[1].advanced})),m=p?d(n.filter(function(e){return e[1].advanced}),!0):[];return this.items=f.concat(m),React.createElement("div",{ref:function(t){return e.rootElement=t},id:"monacoEditorToolbox",className:"monacoToolboxDiv"},React.createElement("div",{className:"blocklyTreeRoot"},React.createElement("div",{role:"tree"},f.map(function(t){return React.createElement(CategoryItem,{key:t.ns,toolbox:e,selected:a==t.ns,treeRow:t,onCategoryClick:e.setSelection.bind(e)})}),p?React.createElement(TreeSeparator,{key:"advancedseparator"}):void 0,p?React.createElement(CategoryItem,{toolbox:this,treeRow:{ns:"",category:pxt.toolbox.advancedTitle(),color:pxt.toolbox.getNamespaceColor("advanced"),icon:i?"advancedexpanded":"advancedcollapsed"},onCategoryClick:this.advancedClicked.bind(this)}):void 0,i?m.map(function(t){return React.createElement(CategoryItem,{key:t.ns,toolbox:e,selected:a==t.ns,treeRow:t,onCategoryClick:e.setSelection.bind(e)})}):void 0,u&&i?React.createElement(TreeRow,{treeRow:{ns:"",category:pxt.toolbox.addPackageTitle(),color:"#717171",icon:"addpackage"},onClick:this.addPackage.bind(this)}):void 0)))},t}(data.Component);exports.MonacoToolbox=MonacoToolbox;var CategoryItem=function(e){function t(t){var o=e.call(this,t)||this;return o.handleClick=function(){o.props.onCategoryClick&&o.props.onCategoryClick(o.props.treeRow,o.props.treeRow.index)},o.state={selected:t.selected},o}return __extends(t,e),t.prototype.getTreeRow=function(){return this.treeRowElement},t.prototype.componentWillReceiveProps=function(e){var t={};void 0!=e.selected&&(t.selected=e.selected),Object.keys(t).length>0&&this.setState(t)},t.prototype.componentDidUpdate=function(e,t){this.state.selected&&(this.props.toolbox.setSelectedItem(this),this.treeRowElement.focus())},t.prototype.renderCore=function(){var e=this,t=this.props.toolbox,o=this.state.selected,n=Util.isUserLanguageRtl();return React.createElement(TreeItem,null,React.createElement(TreeRow,__assign({ref:function(t){return e.treeRowElement=t}},this.props,{selected:o,onClick:this.handleClick,onKeyDown:function(o){var i="number"==typeof o.which?o.which:o.keyCode;40==i?(pxt.tickEvent("monaco.toolbox.keyboard.next"),t.setNextItem()):38==i?(pxt.tickEvent("monaco.toolbox.keyboard.prev"),t.setPreviousItem()):39==i&&!n||37==i&&n?t.moveFocusToFlyout():27==i?t.closeFlyout():sui.fireClickOnEnter.call(e,o)}.bind(this)})))},t}(data.Component);exports.CategoryItem=CategoryItem;var TreeRow=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.focus=function(){this.treeRow.focus()},t.prototype.getProperties=function(){return this.props.treeRow},t.prototype.renderCore=function(){var e=this,t=this.props,o=t.selected,n=t.onClick,i=t.onKeyDown,r=this.props.treeRow,a=r.ns,s=r.icon,c=r.color,l=r.category,d=r.injectIconClass,p=pxt.appTarget.appTheme,u=pxt.toolbox.convertColor(c),f=p.blocklyOptions&&p.blocklyOptions.toolboxOptions&&p.blocklyOptions.toolboxOptions.invertedMultiplier||.3,m={paddingLeft:"0px"},h="blocklyTreeRow";p.coloredToolbox?(m.color=""+u,m.borderLeft="8px solid "+u):p.invertedToolbox?(m.backgroundColor=u||"#ddd",m.color="#fff"):m.borderLeft="8px solid "+u,o&&(h+=" blocklyTreeSelected",p.invertedToolbox?m.backgroundColor=""+pxt.toolbox.fadeColor(c,f,!1):m.backgroundColor=u||"#ddd",m.color="#fff");var g=("blocklyTreeIcon"+(s?(a||s).toLowerCase():"Default")).replace(/\s/g,"");return s&&d&&pxt.toolbox.appendToolboxIconCss(g,s),React.createElement("div",{ref:function(t){return e.treeRow=t},className:h,style:m,tabIndex:0,onMouseEnter:function(){p.invertedToolbox&&(e.treeRow.style.backgroundColor=pxt.toolbox.fadeColor(u||"#ddd",f,!1))},onMouseLeave:function(){p.invertedToolbox&&(e.treeRow.style.backgroundColor=u||"#ddd")},onClick:n,onKeyDown:i||sui.fireClickOnEnter},React.createElement("span",{className:"blocklyTreeIcon",role:"presentation"}),React.createElement("span",{style:{display:"inline-block"},className:"blocklyTreeIcon "+g,role:"presentation"}),React.createElement("span",{className:"blocklyTreeLabel"},l||""+Util.capitalize(a)))},t}(data.Component);exports.TreeRow=TreeRow;var TreeSeparator=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.renderCore=function(){return React.createElement(TreeItem,null,React.createElement("div",{className:"blocklyTreeSeparator"}))},t}(data.Component);exports.TreeSeparator=TreeSeparator;var TreeItem=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.renderCore=function(){return React.createElement("div",{role:"treeitem"},this.props.children)},t}(data.Component);function firstWord(e){return/[^\.]+/.exec(e)[0]}exports.TreeItem=TreeItem;

},{"./compiler":11,"./core":13,"./data":14,"./monacoSnippets":30,"./package":32,"./srceditor":43,"./sui":44,"react":269}],30:[function(require,module,exports){
"use strict";var pauseUntil;function getPauseUntil(){if(pauseUntil)return pauseUntil;var e=pxt.appTarget.runtime&&pxt.appTarget.runtime.pauseUntilBlock;if(e){var t=e.callName||"pauseUntil",n=t+"(() => true)";e.namespace&&(n=e.namespace+"."+n),pauseUntil={name:t,snippet:n,attributes:{weight:null==e.weight?0:e.weight,jsDoc:lf("Pause execution of code until the given boolean expression is true"),advanced:!1},noNamespace:!0}}return pauseUntil}function getBuiltinCategory(e){switch(e){case exports.loops.nameid:return exports.loops;case exports.logic.nameid:return exports.logic;case exports.variables.nameid:return exports.variables;case exports.maths.nameid:return exports.maths;case exports.text.nameid:return exports.text;case exports.arrays.nameid:return exports.arrays;case exports.functions.nameid:return exports.functions}}function isBuiltin(e){switch(e){case exports.loops.nameid:case exports.logic.nameid:case exports.variables.nameid:case exports.maths.nameid:case exports.text.nameid:case exports.arrays.nameid:case exports.functions.nameid:return!0}return!1}function overrideCategory(e,t){var n=getBuiltinCategory(e);if(t&&n&&(t.name&&(n.name=t.name),void 0!==t.weight&&(n.attributes.weight=t.weight),void 0!==t.advanced&&(n.attributes.advanced=t.advanced),void 0!==t.removed&&(n.removed=t.removed),t.blocks)){var i=100;t.appendBlocks?(i=50,t.blocks.forEach(function(e,t){e.weight?i=e.weight:i--;var a={name:e.name,snippet:e.snippet,snippetOnly:e.snippetOnly,attributes:{weight:i,advanced:e.advanced,jsDoc:e.jsDoc,group:e.group},noNamespace:!0,retType:e.retType};n.blocks.push(a)})):n.blocks=t.blocks.map(function(e,t){return e.weight?i=e.weight:i--,{name:e.name,snippet:e.snippet,snippetOnly:e.snippetOnly,attributes:{weight:i,advanced:e.advanced,jsDoc:e.jsDoc,group:e.group},noNamespace:!0,retType:e.retType}})}}function overrideToolbox(e){overrideCategory(exports.loops.nameid,e.loops),overrideCategory(exports.logic.nameid,e.logic),overrideCategory(exports.variables.nameid,e.variables),overrideCategory(exports.maths.nameid,e.maths),overrideCategory(exports.text.nameid,e.text),overrideCategory(exports.arrays.nameid,e.arrays),overrideCategory(exports.functions.nameid,e.functions)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.loops={name:lf("{id:category}Loops"),nameid:"loops",blocks:[{name:"while",snippet:"while(true) {\n\n}",attributes:{jsDoc:lf("Repeat code while condition is true")}},{name:"for",snippet:"for(let i = 0; i < 5; i++) {\n\n}",attributes:{jsDoc:lf("Repeat code a number of times in a loop")}}],attributes:{callingConvention:ts.pxtc.ir.CallingConvention.Plain,icon:"loops",weight:50.09,paramDefl:{}}},exports.logic={name:lf("{id:category}Logic"),nameid:"logic",blocks:[{name:"if",snippet:"if (true) {\n\n}",attributes:{jsDoc:lf("Runs code if the condition is true")}},{name:"if",snippet:"if (true) {\n\n} else {\n\n}",attributes:{jsDoc:lf("Runs code if the condition is true; else run other code")}},{name:"switch",snippet:"switch(item) {\n    case 0:\n        break;\n    case 1:\n        break;\n}",attributes:{jsDoc:lf("Runs different code based on a value")}}],attributes:{callingConvention:ts.pxtc.ir.CallingConvention.Plain,weight:50.08,icon:"logic",paramDefl:{}}},exports.variables={name:lf("{id:category}Variables"),nameid:"variables",blocks:[{name:"let",snippet:"let item: number",snippetOnly:!0,attributes:{jsDoc:lf("Declares a variable named 'item'")}},{name:"equals",snippet:"item = 0",snippetOnly:!0,attributes:{jsDoc:lf("Assigns a value to a variable")}},{name:"change",snippet:"item += 1",snippetOnly:!0,attributes:{jsDoc:lf("Changes the value of item by 1")}}],attributes:{callingConvention:ts.pxtc.ir.CallingConvention.Plain,weight:50.07,icon:"variables",paramDefl:{}}},exports.maths={name:lf("{id:category}Math"),nameid:"math",blocks:[{name:"plus",snippet:"1 + 1",snippetOnly:!0,attributes:{jsDoc:lf("Adds two numbers together")},retType:"number"},{name:"minus",snippet:"1 - 1",snippetOnly:!0,attributes:{jsDoc:lf("Subtracts the value of one number from another")},retType:"number"},{name:"multiply",snippet:"1 * 1",snippetOnly:!0,attributes:{jsDoc:lf("Multiplies two numbers together")},retType:"number"},{name:"divide",snippet:"1 / 1",snippetOnly:!0,attributes:{jsDoc:lf("Returns the quotient of one number divided by another")},retType:"number"},{name:"remainder",snippet:"1 % 2",snippetOnly:!0,attributes:{jsDoc:lf("Returns the remainder of one number divided by another")},retType:"number"},{name:"max",snippet:"Math.max(1, 2)",attributes:{jsDoc:lf("Returns the largest of two numbers")},retType:"number"},{name:"min",snippet:"Math.min(1, 2)",attributes:{jsDoc:lf("Returns the smallest of two numbers")},retType:"number"},{name:"abs",snippet:"Math.abs(-1)",attributes:{jsDoc:lf("Returns the absolute value of a number")},retType:"number"},{name:"randomRange",snippet:"Math.randomRange(0, 10)",attributes:{jsDoc:lf("Returns a random number between min and max")},retType:"number"},{name:"randomBoolean",snippet:"Math.randomBoolean()",attributes:{jsDoc:lf("Randomly returns either true or false")},retType:"boolean"}],attributes:{callingConvention:ts.pxtc.ir.CallingConvention.Plain,weight:50.06,icon:"math",paramDefl:{}}},exports.functions={name:lf("{id:category}Functions"),nameid:"functions",blocks:[{name:"function doSomething",snippet:"function doSomething() {\n\n}",attributes:{jsDoc:lf("Define a function")}},{name:"doSomething",snippet:"doSomething()",attributes:{jsDoc:lf("Call a function")}}],attributes:{advanced:!0,weight:50.08,callingConvention:ts.pxtc.ir.CallingConvention.Plain,color:pxt.toolbox.blockColors.functions.toString(),icon:"functions",paramDefl:{}}},exports.arrays={name:lf("{id:category}Arrays"),nameid:"arrays",custom:!0,blocks:[{name:"create",snippet:"let "+lf("{id:snippets}list")+" = [1, 2, 3];",snippetOnly:!0,attributes:{weight:100,jsDoc:lf("Creates a new Array")},retType:"array"},{name:"length",snippet:lf("{id:snippets}list")+".length",snippetOnly:!0,attributes:{weight:99,jsDoc:lf("Returns the number of values in an Array")},retType:"number"},{name:"get",snippet:lf("{id:snippets}list")+"[0]",snippetOnly:!0,attributes:{weight:98,jsDoc:lf("Returns the value in the Array at the given index")}},{name:"set",snippet:lf("{id:snippets}list")+"[0] = 1",snippetOnly:!0,attributes:{weight:97,jsDoc:lf("Overwrites the value in an Array at the given index")}},{name:"push",snippet:lf("{id:snippets}list")+".push(1)",attributes:{weight:96,jsDoc:lf("Adds a value to the end of an Array")}},{name:"pop",snippet:lf("{id:snippets}list")+".pop()",attributes:{weight:95,jsDoc:lf("Removes and returns the value at the end of an Array")},retType:"object"},{name:"insertAt",snippet:lf("{id:snippets}list")+".insertAt(0, 0)",attributes:{weight:50,jsDoc:lf("Inserts a value into the Array at the given index"),advanced:!0}},{name:"removeAt",snippet:lf("{id:snippets}list")+".removeAt(0)",attributes:{weight:49,jsDoc:lf("Removes a value from the Array at the given index and returns it"),advanced:!0},retType:"object"},{name:"shift",snippet:lf("{id:snippets}list")+".shift()",attributes:{weight:48,jsDoc:lf("Removes and returns the value at the front of an Array"),advanced:!0}},{name:"unshift",snippet:lf("{id:snippets}list")+".unshift(0)",attributes:{weight:47,jsDoc:lf("Inserts a value at the beginning of an Array"),advanced:!0}},{name:"indexOf",snippet:'["A", "B", "C"].indexOf("B")',attributes:{weight:46,jsDoc:lf("Returns the first index in the Array that contains the given value or -1 if it does not exist in the Array"),advanced:!0},retType:"number"},{name:"reverse",snippet:lf("{id:snippets}list")+".reverse()",attributes:{weight:45,jsDoc:lf("Reverses the contents of an Array"),advanced:!0}}],attributes:{advanced:!0,weight:50.07,color:pxt.toolbox.blockColors.arrays.toString(),icon:"arrays",callingConvention:ts.pxtc.ir.CallingConvention.Plain,paramDefl:{}}},exports.text={name:lf("{id:category}Text"),nameid:"text",custom:!0,blocks:[{name:"length",snippet:'"".length',snippetOnly:!0,attributes:{jsDoc:lf("Returns the number of characters in a string")},retType:"number"},{name:"concat",snippet:'"" + 5',snippetOnly:!0,attributes:{jsDoc:lf("Combines a string with a number, boolean, string, or other object into one string")},retType:"string"},{name:"compare",snippet:'"".compare("")',attributes:{jsDoc:lf("Compares one string against another alphabetically and returns a number")},retType:"number"},{name:"parseInt",snippet:'parseInt("5")',attributes:{jsDoc:lf("Converts a number written as text into a number")},retType:"number"},{name:"substr",snippet:'"".substr(0, 0)',attributes:{jsDoc:lf("Returns the part of a string starting at a given index with the given length")},retType:"string"},{name:"charAt",snippet:'"".charAt(0)',attributes:{jsDoc:lf("Returns the character at the given index")},retType:"string"}],attributes:{advanced:!0,weight:50.06,icon:"text",callingConvention:ts.pxtc.ir.CallingConvention.Plain,paramDefl:{}}},exports.getPauseUntil=getPauseUntil,exports.getBuiltinCategory=getBuiltinCategory,exports.isBuiltin=isBuiltin,exports.overrideCategory=overrideCategory,exports.overrideToolbox=overrideToolbox;

},{}],31:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),data=require("./data"),sui=require("./sui"),Cloud=pxt.Cloud,GenericBanner=function(e){function t(t){var n=e.call(this,t)||this;return n.delayTime=n.props.delayTime||0,n.doneSleeping=n.sleepDone(),n.bannerType=n.props.bannerType||"default",n}return __extends(t,e),t.prototype.componentDidMount=function(){var e=this;this.doneSleeping&&(this.timer=setTimeout(function(){return e.show()},this.delayTime))},t.prototype.componentWillUnmount=function(){clearTimeout(this.timer)},t.prototype.sleepDone=function(){if(!this.props.sleepTime)return!0;var e=parseInt(pxt.storage.getLocal("lastBannerClosedTime")||"0");return pxt.Util.nowSeconds()-e>this.props.sleepTime},t.prototype.show=function(){var e=this;pxt.tickEvent("notificationBanner.show"),this.props.displayTime&&(this.timer=setTimeout(function(){return e.hide("automatic")},this.delayTime+this.props.displayTime)),this.props.parent.setBanner(!0),this.renderCore()},t.prototype.hide=function(e){pxt.tickEvent("notificationBanner."+e+"Close"),pxt.storage.setLocal("lastBannerClosedTime",pxt.Util.nowSeconds().toString()),this.props.parent.setBanner(!1),this.renderCore()},t.prototype.renderCore=function(){var e=this;return this.props.parent.state.bannerVisible&&this.doneSleeping?React.createElement("div",{id:"notificationBanner",className:"ui attached "+this.bannerType+" message"},React.createElement("div",{className:"bannerLeft"},React.createElement("div",{className:"content"},this.props.children)),React.createElement("div",{className:"bannerRight"},React.createElement(sui.Icon,{icon:"close",tabIndex:0,onClick:function(){e.hide("manual"),clearTimeout(e.timer)}}))):React.createElement("div",null)},t}(data.Component);exports.GenericBanner=GenericBanner;var NotificationBanner=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.renderCore=function(){if(pxt.analytics.isCookieBannerVisible())return React.createElement("div",null);var e=pxt.appTarget.appTheme,t=pxt.winrt.isWinRT(),n="localhost"===location.hostname,i="/"!==location.pathname&&-1===(e.appPathNames||[]).indexOf(location.pathname),a=!n&&t&&i,r=pxt.BrowserUtils.isWindows10(),o=this.getData("target-config:");if(r&&Cloud.isOnline()&&o&&o.windowsStoreLink&&!t&&!pxt.shell.isSandboxMode())return React.createElement(GenericBanner,{parent:this.props.parent,delayTime:1e4,displayTime:45e3,sleepTime:604800},React.createElement(sui.Link,{class:"link",target:"_blank",ariaLabel:lf("View app in the Windows store"),href:o.windowsStoreLink,onClick:function(){return pxt.tickEvent("banner.linkClicked",void 0,{interactiveConsent:!0})}},React.createElement("img",{className:"bannerIcon",src:pxt.Util.pathJoin(pxt.webConfig.commitCdnUrl,"images/windowsstorebag.png")})),React.createElement(sui.Link,{class:"link",target:"_blank",ariaLabel:lf("View app in the Windows store"),href:o.windowsStoreLink,onClick:function(){return pxt.tickEvent("banner.linkClicked",void 0,{interactiveConsent:!0})}},lf("Want a faster download? Get the app!")));if(a){var s=pxt.appTarget.appTheme.homeUrl+location.search+location.hash;return React.createElement(GenericBanner,{parent:this.props.parent,bannerType:"negative"},React.createElement(sui.Icon,{icon:"warning circle"}),React.createElement("div",{className:"header"},lf("You are viewing an experimental version of the editor")),React.createElement(sui.Link,{class:"link",ariaLabel:lf("Go back to live editor"),href:s},lf("Take me back")))}return React.createElement("div",null)},t}(data.Component);exports.NotificationBanner=NotificationBanner;

},{"./data":14,"./sui":44,"react":269}],32:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var workspace=require("./workspace"),data=require("./data"),core=require("./core"),db=require("./db"),Util=pxt.Util,hostCache=new db.Table("hostcache"),extWeight={ts:10,blocks:20,json:30,md:40};function setupAppTarget(t){pxt.setAppTarget(t)}exports.setupAppTarget=setupAppTarget;var File=function(){function t(t,e,n){this.epkg=t,this.name=e,this.content=n,this.inSyncWithEditor=!0,this.inSyncWithDisk=!0}return t.prototype.isReadonly=function(){return!this.epkg.header},t.prototype.getName=function(){return this.epkg.getPkgId()+"/"+this.name},t.prototype.getTypeScriptName=function(){return this.epkg.isTopLevel()?this.name:"pxt_modules/"+this.epkg.getPkgId()+"/"+this.name},t.prototype.getExtension=function(){var t=/\.([^\.]+)$/.exec(this.name);return t?t[1]:""},t.prototype.getVirtualFileName=function(){return t.blocksFileNameRx.test(this.name)?this.name.replace(t.blocksFileNameRx,".ts"):t.tsFileNameRx.test(this.name)?this.name.replace(t.tsFileNameRx,".blocks"):void 0},t.prototype.weight=function(){return/^main\./.test(this.name)?5:extWeight.hasOwnProperty(this.getExtension())?extWeight[this.getExtension()]:60},t.prototype.markDirty=function(){this.inSyncWithEditor=!1,this.updateStatus()},t.prototype.updateStatus=function(){data.invalidate("open-meta:"+this.getName())},t.prototype.setContentAsync=function(t,e){var n=this;if(Util.assert(void 0!==t),this.inSyncWithEditor=!0,t!=this.content){var r=this.content;return this.inSyncWithDisk=!1,this.content=t,this.updateStatus(),this.epkg.saveFilesAsync().then(function(){n.content==t&&(n.inSyncWithDisk=!0,n.updateStatus()),e&&n.forceChangeCallback&&n.forceChangeCallback(r,t)})}return this.updateStatus(),Promise.resolve()},t.prototype.setForceChangeCallback=function(t){this.forceChangeCallback=t},t.tsFileNameRx=/\.ts$/,t.blocksFileNameRx=/\.blocks$/,t}();exports.File=File;var EditorPackage=function(){function t(t,e){this.ksPkg=t,this.topPkg=e,this.files={},this.onupdate=function(){},this.saveScheduled=!1,this.savingNow=0,t&&"workspace"==t.verProtocol()&&(this.header=workspace.getHeader(t.verArgument()))}return t.prototype.getTopHeader=function(){return this.topPkg.header},t.prototype.makeTopLevel=function(){this.topPkg=this,this.outputPkg=new t(null,this),this.outputPkg.id="built"},t.prototype.updateConfigAsync=function(t){var e=this.files[pxt.CONFIG_NAME];if(e)try{var n=JSON.parse(e.content);return t(n),e.setContentAsync(JSON.stringify(n,null,4)+"\n")}catch(t){}return null},t.prototype.updateDepAsync=function(t){var e=this,n=this.ksPkg.resolveDep(t);if(!n||"github"!=n.verProtocol())return Promise.resolve();var r=pxt.github.parseRepoId(n.verArgument());return pxt.targetConfigAsync().then(function(t){return pxt.github.latestVersionAsync(r.fullName,t.packages)}).then(function(t){r.tag=t}).then(function(){return pxt.github.pkgConfigAsync(r.fullName,r.tag)}).catch(core.handleNetworkError).then(function(t){return e.addDepAsync(t.name,pxt.github.stringifyRepo(r))})},t.prototype.removeDepAsync=function(t){var e=this;return this.updateConfigAsync(function(e){return delete e.dependencies[t]}).then(function(){return e.saveFilesAsync(!0)})},t.prototype.addDepAsync=function(t,e){var n=this;return this.updateConfigAsync(function(n){return n.dependencies[t]=e}).then(function(){return n.saveFilesAsync(!0)})},t.prototype.getKsPkg=function(){return this.ksPkg},t.prototype.getPkgId=function(){return this.ksPkg?this.ksPkg.id:this.id},t.prototype.isTopLevel=function(){return this.ksPkg&&0==this.ksPkg.level},t.prototype.setFile=function(t,e){var n=new File(this,t,e);return this.files[t]=n,data.invalidate("open-meta:"),n},t.prototype.removeFileAsync=function(t){return delete this.files[t],data.invalidate("open-meta:"),this.updateConfigAsync(function(e){return e.files=e.files.filter(function(e){return e!=t})})},t.prototype.setContentAsync=function(t,e){var n=this.files[t];return n||(n=this.setFile(t,e)),n.setContentAsync(e)},t.prototype.setFiles=function(t){var e=this;this.files=Util.mapMap(t,function(t,n){return new File(e,t,n)}),data.invalidate("open-meta:")},t.prototype.updateStatus=function(){data.invalidate("pkg-status:"+this.header.id)},t.prototype.savePkgAsync=function(){var t=this;return this.header.blobCurrent?Promise.resolve():(this.savingNow++,this.updateStatus(),workspace.saveToCloudAsync(this.header).then(function(){t.savingNow--,t.updateStatus(),t.header.blobCurrent||t.scheduleSave()}))},t.prototype.scheduleSave=function(){var t=this;this.saveScheduled||(this.saveScheduled=!0,setTimeout(function(){t.saveScheduled=!1,t.savePkgAsync().done()},5e3))},t.prototype.getAllFiles=function(){var t=Util.mapMap(this.files,function(t,e){return e.content});return delete t[pxt.SERIAL_EDITOR_FILE],t},t.prototype.saveFilesAsync=function(t){var e=this;if(!this.header)return Promise.resolve();var n=this.files[pxt.CONFIG_NAME];if(n)try{var r=JSON.parse(n.content);this.header.name=r.name}catch(t){}return workspace.saveAsync(this.header,this.getAllFiles()).then(function(){return t?e.savePkgAsync():e.scheduleSave()})},t.prototype.sortedFiles=function(){var t=Util.values(this.files);return t.sort(function(t,e){return t.weight()-e.weight()||Util.strcmp(t.name,e.name)}),t},t.prototype.forEachFile=function(t){this.pkgAndDeps().forEach(function(e){Util.values(e.files).forEach(t)})},t.prototype.getMainFile=function(){return this.sortedFiles()[0]},t.prototype.pkgAndDeps=function(){return this.topPkg!=this?this.topPkg.pkgAndDeps():Util.values(this.ksPkg.deps).map(getEditorPkg).concat([this.outputPkg])},t.prototype.filterFiles=function(t){return Util.concat(this.pkgAndDeps().map(function(e){return Util.values(e.files).filter(t)}))},t.prototype.lookupFile=function(t){return this.filterFiles(function(e){return e.getName()==t})[0]},t}();exports.EditorPackage=EditorPackage;var Host=function(){function t(){}return t.prototype.readFile=function(t,e){var n=getEditorPkg(t).files[e];return n?n.content:null},t.prototype.writeFile=function(t,e,n,r){if(e!=pxt.CONFIG_NAME&&!r)throw Util.oops("trying to write "+t+" / "+e);getEditorPkg(t).files[e].setContentAsync(n,r).done()},t.prototype.getHexInfoAsync=function(t){return pxt.hex.getHexInfoAsync(this,t).catch(core.handleNetworkError)},t.prototype.cacheStoreAsync=function(t,e){return hostCache.forceSetAsync({id:t,val:e}).then(function(){},function(e){pxt.tickEvent("cache.store.failed",{error:e.name}),pxt.log("cache store failed for "+t+": "+e.name)})},t.prototype.cacheGetAsync=function(t){return hostCache.getAsync(t).then(function(t){return t.val},function(t){return null})},t.prototype.downloadPackageAsync=function(t){var e=t.verProtocol(),n=getEditorPkg(t);if("pub"==e)return workspace.getPublishedScriptAsync(t.verArgument()).then(function(t){return n.setFiles(t)});if("github"==e)return workspace.getPublishedScriptAsync(t.version()).then(function(t){return n.setFiles(t)});if("workspace"==e)return workspace.getTextAsync(t.verArgument()).then(function(t){return n.setFiles(t)});if("file"==e){var r=t.verArgument();return"."==r[0]&&(r=resolvePath(t.parent.verArgument()+"/"+r)),workspace.getTextAsync(r).then(function(t){return n.setFiles(t)})}return"embed"==e?(n.setFiles(pxt.getEmbeddedScript(t.verArgument())),Promise.resolve()):Promise.reject("Cannot download "+t.version()+"; unknown protocol")},t}();function resolvePath(t){return t.replace(/\/+/g,"/").replace(/[^\/]+\/\.\.\//g,"").replace(/\/\.\//g,"/")}var theHost=new Host;function getEditorPkg(t){var e=t._editorPkg;if(e)return e;var n=null;t!=exports.mainPkg&&(n=getEditorPkg(exports.mainPkg));var r=new EditorPackage(t,n);return t==exports.mainPkg&&r.makeTopLevel(),t._editorPkg=r,r}function mainEditorPkg(){return getEditorPkg(exports.mainPkg)}function genFileName(t){var e=mainEditorPkg().header.name.replace(/[\\\/.,?*^:<>!;'#$%^&|"\x00-\x1F ]/g,"-");return(pxt.appTarget.nickname||pxt.appTarget.id)+"-"+e+t}function allEditorPkgs(){return getEditorPkg(exports.mainPkg).pkgAndDeps()}function notifySyncDone(t){Util.values(exports.mainPkg.deps).filter(function(e){return"workspace"==e.verProtocol()&&t.hasOwnProperty(e.verArgument())}).length>0&&getEditorPkg(exports.mainPkg).onupdate()}function loadPkgAsync(t){return exports.mainPkg=new pxt.MainPackage(theHost),exports.mainPkg._verspec="workspace:"+t,theHost.downloadPackageAsync(exports.mainPkg).catch(core.handleNetworkError).then(function(){return theHost.readFile(exports.mainPkg,pxt.CONFIG_NAME)}).then(function(t){return t?exports.mainPkg.installAllAsync().catch(function(t){core.errorNotification(lf("Cannot load package: {0}",t.message))}):Promise.resolve()})}exports.mainPkg=new pxt.MainPackage(theHost),exports.getEditorPkg=getEditorPkg,exports.mainEditorPkg=mainEditorPkg,exports.genFileName=genFileName,exports.allEditorPkgs=allEditorPkgs,exports.notifySyncDone=notifySyncDone,exports.loadPkgAsync=loadPkgAsync,data.mountVirtualApi("open-meta",{getSync:function(t){t=data.stripProtocol(t);var e=getEditorPkg(exports.mainPkg).lookupFile(t);if(!e)return{};var n={isReadonly:e.isReadonly(),isSaved:e.inSyncWithEditor&&e.inSyncWithDisk,numErrors:e.numDiagnosticsOverride};return null==n.numErrors&&(n.numErrors=e.diagnostics?e.diagnostics.length:0),n}}),data.mountVirtualApi("open-pkg-meta",{getSync:function(t){t=data.stripProtocol(t);var e=allEditorPkgs().filter(function(e){return e.getPkgId()==t})[0];return e&&"built"!=e.getPkgId()?{numErrors:e.sortedFiles().reduce(function(t,e){return t+(e.numDiagnosticsOverride||(e.diagnostics?e.diagnostics.length:0)||0)},0)}:{}}}),data.mountVirtualApi("pkg-status",{getSync:function(t){t=data.stripProtocol(t);var e=allEditorPkgs().filter(function(e){return e.header&&e.header.id==t})[0];return e&&e.savingNow?"saving":""}});

},{"./core":13,"./data":14,"./db":15,"./workspace":47}],33:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])};return function(t,a){function r(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(r.prototype=a.prototype,new r)}}();Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),ReactDOM=require("react-dom"),data=require("./data"),sui=require("./sui"),core=require("./core"),compiler=require("./compiler"),codecard=require("./codecard"),gallery=require("./gallery"),carousel=require("./carousel"),Projects=function(e){function t(t){var a=e.call(this,t)||this;return a.state={visible:!1},a}return __extends(t,e),t.prototype.shouldComponentUpdate=function(e,t,a){return this.state.visible!=t.visible||this.state.searchFor!=t.searchFor||this.state.selectedCategory!=t.selectedCategory||this.state.selectedIndex!=t.selectedIndex},t.prototype.setSelected=function(e,t){void 0==t||this.state.selectedCategory==e&&this.state.selectedIndex==t?this.setState({selectedCategory:void 0,selectedIndex:void 0}):this.setState({selectedCategory:e,selectedIndex:t})},t.prototype.componentDidUpdate=function(e,t){this.state.selectedCategory!==t.selectedCategory&&this.ensureSelectedItemVisible()},t.prototype.ensureSelectedItemVisible=function(){var e=this.refs.activeCarousel;if(e){var t=e.getCarouselDOM();this.scrollElementIntoViewIfNeeded(t)}},t.prototype.scrollElementIntoViewIfNeeded=function(e){var t=ReactDOM.findDOMNode(this.refs.homeContainer),a=e.getBoundingClientRect().top;t.parentElement.scrollTop=t.parentElement.scrollTop+a-30},t.prototype.renderCore=function(){var e=this,t=this.state,a=t.selectedCategory,r=t.selectedIndex,o=pxt.appTarget.appTheme,n=this.getData("target-config:"),i=pxt.Util.userLanguage(),c={};n&&n.localizedGalleries&&n.localizedGalleries[i]&&pxt.Util.jsonCopyFrom(c,n.localizedGalleries[i]),n&&n.galleries&&pxt.Util.jsonCopyFrom(c,n.galleries);var l=function(t,a,r){core.showLoading("changingcode",lf("loading..."));var o=t.name.toLowerCase().replace(/\W/,"");gallery.loadExampleAsync(o,t.url).done(function(t){if(t)return r&&(t.prj=r),a?e.props.parent.createProjectAsync(t).then(function(){return compiler.getBlocksAsync().then(function(e){return compiler.decompileAsync("main.ts",e)}).then(function(t){pxt.debug("example decompilation: "+t.success),t.success&&e.props.parent.overrideBlocksFile(t.outfiles["main.blocks"])})}).done(function(){core.hideLoading("changingcode")}):(t.tsOnly=!0,e.props.parent.createProjectAsync(t).then(function(){return Promise.delay(500)}).done(function(){return core.hideLoading("changingcode")}));core.hideLoading("changingcode")})},s=!!o.homeScreenHero,p=sui.cx(["ui segment bottom attached tab active tabsegment"]);return React.createElement("div",{ref:"homeContainer",className:p},s?React.createElement("div",{className:"ui segment getting-started-segment",style:{backgroundImage:"url("+encodeURI(o.homeScreenHero)+")"}}):void 0,React.createElement("div",{key:"mystuff_gallerysegment",className:"ui segment gallerysegment mystuff-segment"},React.createElement("div",{className:"ui grid equal width padded heading"},React.createElement("div",{className:"column"},React.createElement("h2",{className:"ui header"},lf("My Projects")," ")),React.createElement("div",{className:"column right aligned"},pxt.appTarget.compile||pxt.appTarget.cloud&&pxt.appTarget.cloud.sharing&&pxt.appTarget.cloud.publishing&&pxt.appTarget.cloud.importing?React.createElement(sui.Button,{key:"import",icon:"upload",class:"mini import-dialog-btn",textClass:"landscape only",text:lf("Import"),title:lf("Import a project"),onClick:function(){return pxt.tickEvent("projects.importdialog",void 0,{interactiveConsent:!0}),void e.props.parent.importProjectDialog()}}):void 0)),React.createElement("div",{className:"content"},React.createElement(ProjectsCarousel,{key:"mystuff_carousel",parent:this.props.parent,name:"recent",onClick:function(t){return a=t,pxt.tickEvent("projects.header"),core.showLoading("changeheader",lf("loading...")),void e.props.parent.loadHeaderAsync(a).done(function(){core.hideLoading("changeheader")});var a}}))),Object.keys(c).map(function(t){return React.createElement("div",{key:t+"_gallerysegment",className:"ui segment gallerysegment"},React.createElement("h2",{className:"ui header heading"},pxt.Util.rlf(t)," "),React.createElement("div",{className:"content"},React.createElement(ProjectsCarousel,{ref:a==t?"activeCarousel":"",key:t+"_carousel",parent:e.props.parent,name:t,path:c[t],onClick:function(t){return function(t){switch(pxt.tickEvent("projects.gallery",{name:t.name}),t.cardType){case"template":var a=pxt.Util.clone(pxt.appTarget.blocksprj);a.config.dependencies={},l(t,!0,a);break;case"example":l(t,!0);break;case"codeExample":l(t,!1);break;case"side":e.props.parent.newEmptyProject(t.name,t.url);break;case"tutorial":e.props.parent.startTutorial(t.url,t.name);break;default:var r=/^\/#tutorial:([a-z0A-Z0-9\-\/]+)$/.exec(t.url);r?e.props.parent.startTutorial(r[1]):t.youTubeId&&!t.url?window.open("https://youtu.be/"+t.youTubeId,"yt"):/^https:\/\//i.test(t.url)?window.open(t.url,"_blank"):t.url?/^\//i.test(t.url)?window.open(t.url,"_blank"):core.errorNotification(lf("Sorry, the project url looks invalid.")):e.props.parent.newEmptyProject(t.name.toLowerCase())}}(t)},setSelected:function(a){return e.setSelected(t,a)},selectedIndex:a==t?r:void 0})))}),o.organizationUrl||o.organizationUrl||o.privacyUrl?React.createElement("div",{className:"ui horizontal small divided link list homefooter"},o.organizationUrl&&o.organization?React.createElement("a",{className:"item focused",target:"_blank",rel:"noopener",href:o.organizationUrl},o.organization):void 0,o.selectLanguage?React.createElement(sui.Link,{class:"item focused",text:lf("Language"),onClick:function(){return pxt.tickEvent("projects.langpicker"),void e.props.parent.selectLang()},onKeyDown:sui.fireClickOnEnter}):void 0,o.termsOfUseUrl?React.createElement("a",{target:"_blank",className:"item focused",href:o.termsOfUseUrl,rel:"noopener"},lf("Terms of Use")):void 0,o.privacyUrl?React.createElement("a",{target:"_blank",className:"item focused",href:o.privacyUrl,rel:"noopener"},lf("Privacy")):void 0):void 0)},t}(data.Component);exports.Projects=Projects;var ProjectsMenu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.brandIconClick=function(){pxt.tickEvent("projects.brand",void 0,{interactiveConsent:!0})},t.prototype.orgIconClick=function(){pxt.tickEvent("projects.org",void 0,{interactiveConsent:!0})},t.prototype.shouldComponentUpdate=function(e,t,a){return!1},t.prototype.render=function(){var e=this,t=pxt.appTarget.appTheme;return React.createElement("div",{id:"homemenu",className:"ui borderless fixed "+(t.invertedMenu?"inverted":"")+" menu",role:"menubar"},React.createElement("div",{className:"left menu"},React.createElement("a",{href:t.logoUrl,"aria-label":lf("{0} Logo",t.boardName),role:"menuitem",target:"blank",rel:"noopener",className:"ui item logo brand",onClick:function(){return e.brandIconClick()}},t.logo||t.portraitLogo?React.createElement("img",{className:"ui logo "+(t.logo?" portrait hide":""),src:t.logo||t.portraitLogo,alt:lf("{0} Logo",t.boardName)}):React.createElement("span",{className:"name"},t.boardName),t.portraitLogo?React.createElement("img",{className:"ui mini image portrait only",src:t.portraitLogo,alt:lf("{0} Logo",t.boardName)}):null)),React.createElement("div",{className:"ui item"},React.createElement(sui.Icon,{icon:"icon home large"})," ",lf("Home")),React.createElement("div",{className:"right menu"},React.createElement("a",{href:t.organizationUrl,target:"blank",rel:"noopener",className:"ui item logo organization",onClick:function(){return e.orgIconClick()}},t.organizationWideLogo||t.organizationLogo?React.createElement("img",{className:"ui logo "+(t.organizationWideLogo?" portrait hide":""),src:t.organizationWideLogo||t.organizationLogo,alt:lf("{0} Logo",t.organization)}):React.createElement("span",{className:"name"},t.organization),t.organizationLogo?React.createElement("img",{className:"ui mini image portrait only",src:t.organizationLogo,alt:lf("{0} Logo",t.organization)}):null)),t.betaUrl?React.createElement("a",{href:""+t.betaUrl,className:"ui red mini corner top left attached label betalabel",role:"menuitem"},lf("Beta")):void 0)},t}(data.Component);exports.ProjectsMenu=ProjectsMenu;var ProjectsCarousel=function(e){function t(t){var a=e.call(this,t)||this;return a.prevGalleries=[],a.hasFetchErrors=!1,a.state={},a}return __extends(t,e),t.prototype.componentDidMount=function(){this.props.parent.state.header&&this.latestProject&&this.latestProject.element&&this.latestProject.element.focus()},t.prototype.fetchGallery=function(e){var t=this.getData("gallery:"+encodeURIComponent(e));return t&&(t instanceof Error?this.hasFetchErrors=!0:this.prevGalleries=pxt.Util.concat(t.map(function(e){return e.cards}))),this.prevGalleries||[]},t.prototype.fetchLocalData=function(){return this.getData("header:*")},t.prototype.newProject=function(){pxt.tickEvent("projects.new",void 0,{interactiveConsent:!0}),this.props.parent.newProject()},t.prototype.closeDetail=function(){pxt.tickEvent("projects.detail.close"),this.props.setSelected(void 0)},t.prototype.getCarouselDOM=function(){return ReactDOM.findDOMNode(this.refs.carousel)},t.prototype.getDetailDOM=function(){return ReactDOM.findDOMNode(this.refs.detailView)},t.prototype.renderCore=function(){var e=this,t=this.props,a=t.path,r=t.selectedIndex,o=function(t,a){e.props.setSelected?(pxt.tickEvent("projects.detail.open"),e.props.setSelected(a)):e.props.onClick(t)};if(a){this.hasFetchErrors=!1;var n=this.fetchGallery(a);return this.hasFetchErrors?React.createElement("div",{className:"ui carouselouter"},React.createElement("div",{className:"carouselcontainer",tabIndex:0,onClick:function(){return e.setState({})}},React.createElement("p",{className:"ui grey inverted segment"},lf("Oops, please connect to the Internet and try again.")))):React.createElement("div",null,React.createElement(carousel.Carousel,{ref:"carousel",bleedPercent:20,selectedIndex:r},n.map(function(e,t){return React.createElement("div",{key:a+e.name},React.createElement(codecard.CodeCardView,{className:"example",key:"gallery"+e.name,name:e.name,url:e.url,imageUrl:e.imageUrl,youTubeId:e.youTubeId,label:e.label,labelClass:e.labelClass,onClick:function(){return o(e,t)}}))})),React.createElement("div",{ref:"detailView",className:"detailview "+(n.filter(function(e,t){return t==r}).length>0?"visible":"")},n.filter(function(e,t){return t==r}).length>0?React.createElement("div",{tabIndex:0,className:"close"},React.createElement(sui.Icon,{icon:"remove circle",onClick:function(){return e.closeDetail()}})," "):void 0,n.filter(function(e,t){return t==r}).map(function(t){return React.createElement(ProjectsDetail,{parent:e.props.parent,name:t.name,key:"detail"+t.name,description:t.description,url:t.url,imageUrl:t.imageUrl,largeImageUrl:t.largeImageUrl,youTubeId:t.youTubeId,onClick:function(){return e.props.onClick(t)},cardType:t.cardType})})))}var i=this.fetchLocalData(),c=pxt.appTarget.appTheme&&!pxt.appTarget.appTheme.hideNewProjectButton;return React.createElement(carousel.Carousel,{bleedPercent:20},c?React.createElement("div",{className:"ui card link newprojectcard focused",tabIndex:0,title:lf("Creates a new empty project"),onClick:function(){return e.newProject()},onKeyDown:sui.fireClickOnEnter},React.createElement("div",{className:"content"},React.createElement(sui.Icon,{icon:"huge add circle"}),React.createElement("span",{className:"header"},lf("New Project")))):void 0,i.map(function(t,a){return React.createElement("div",{key:"local"+t.id+t.recentUse},React.createElement(codecard.CodeCardView,{ref:function(t){1===a&&(e.latestProject=t)},cardType:"file",className:"file",name:t.name,time:t.recentUse,url:t.pubId&&t.pubCurrent?"/"+t.pubId:"",onClick:function(){return o(t)}}))}))},t}(data.Component);exports.ProjectsCarousel=ProjectsCarousel;var ProjectsDetail=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.renderCore=function(){var e=this.props,t=e.name,a=e.description,r=e.imageUrl,o=e.largeImageUrl,n=e.youTubeId,i=e.onClick,c=e.cardType,l=o||r||(n?"https://img.youtube.com/vi/"+n+"/0.jpg":void 0),s=lf("Show Instructions");"tutorial"==c?s=lf("Start Tutorial"):"codeExample"==c||"example"==c?s=lf("Open Example"):"template"==c?s=lf("New Project"):n&&(s=lf("Play Video"));var p=[{label:s,onClick:i,icon:"",className:"huge positive"}];return React.createElement("div",{className:"ui grid stackable padded"},l?React.createElement("div",{className:"imagewrapper"},React.createElement("div",{className:"image",style:{backgroundImage:'url("'+l+'")'}})):void 0,React.createElement("div",{className:"column eight wide"},React.createElement("div",{className:"segment"},React.createElement("div",{className:"header"}," ",t," "),React.createElement("p",{className:"detail"},a),React.createElement("div",{className:"actions"},p.map(function(e){return React.createElement(sui.Button,{key:"action_"+e.label,icon:e.icon,text:e.label,class:"approve "+(e.icon?"icon right labeled":"")+" "+(e.className||""),onClick:function(){e.onClick()},onKeyDown:sui.fireClickOnEnter})})))))},t}(data.Component);exports.ProjectsDetail=ProjectsDetail;var ImportDialog=function(e){function t(t){var a=e.call(this,t)||this;return a.state={visible:!1},a}return __extends(t,e),t.prototype.hide=function(){this.setState({visible:!1})},t.prototype.close=function(){this.setState({visible:!1})},t.prototype.show=function(){this.setState({visible:!0})},t.prototype.renderCore=function(){var e=this,t=this.state.visible;return React.createElement(sui.Modal,{open:t,className:"importdialog",header:lf("Import"),size:"small",onClose:function(){return e.close()},dimmer:!0,closeIcon:!0,closeOnDimmerClick:!0,closeOnDocumentClick:!0,closeOnEscape:!0},React.createElement("div",{className:"ui cards"},pxt.appTarget.compile?React.createElement(codecard.CodeCardView,{ariaLabel:lf("Open files from your computer"),className:"focused",role:"button",key:"import",icon:"upload",iconColor:"secondary",name:lf("Import File..."),description:lf("Open files from your computer"),onClick:function(){return pxt.tickEvent("projects.import",void 0,{interactiveConsent:!0}),e.hide(),void e.props.parent.importFileDialog()}}):void 0,pxt.appTarget.cloud&&pxt.appTarget.cloud.sharing&&pxt.appTarget.cloud.publishing&&pxt.appTarget.cloud.importing?React.createElement(codecard.CodeCardView,{ariaLabel:lf("Open a shared project URL"),className:"focused",role:"button",key:"importurl",icon:"cloud download",iconColor:"secondary",name:lf("Import URL..."),description:lf("Open a shared project URL"),onClick:function(){return pxt.tickEvent("projects.importurl",void 0,{interactiveConsent:!0}),e.hide(),void e.props.parent.importUrlDialog()}}):void 0))},t}(data.Component);exports.ImportDialog=ImportDialog;var ExitAndSaveDialog=function(e){function t(t){var a=e.call(this,t)||this;return a.state={visible:!1},a}return __extends(t,e),t.prototype.hide=function(){this.setState({visible:!1})},t.prototype.show=function(){this.setState({visible:!0})},t.prototype.componentDidUpdate=function(){if(this.state.visible){var e=document.getElementById("projectNameInput");e&&(e.setSelectionRange(0,9999),e.onkeyup=function(e){("number"==typeof e.which?e.which:e.keyCode)===core.ENTER_KEY&&(e.preventDefault(),document.getElementsByClassName("approve positive").item(0).click())})}},t.prototype.renderCore=function(){var e=this,t=this.state.visible,a=this.props.parent.state.projectName,r=a,o=[{label:lf("Done"),onClick:function(){e.hide(),e.props.parent.state.projectName!=r&&pxt.tickEvent("exitandsave.projectrename",void 0,{interactiveConsent:!0}),e.props.parent.updateHeaderNameAsync(r).done(function(){e.props.parent.openHome()})},icon:"check",className:"positive"},{label:lf("Cancel"),icon:"cancel",onClick:function(){pxt.tickEvent("exitandsave.cancel",void 0,{interactiveConsent:!0}),e.hide()}}];return React.createElement(sui.Modal,{open:t,className:"exitandsave",header:lf("Exit Project"),size:"tiny",onClose:function(){return e.hide()},dimmer:!0,actions:o,closeIcon:!0,closeOnDimmerClick:!0,closeOnDocumentClick:!0,closeOnEscape:!0},React.createElement("div",{className:"ui form"},React.createElement(sui.Input,{id:"projectNameInput",class:"focused",label:lf("Project Name"),ariaLabel:lf("Type a name for your project"),value:a,onChange:function(e){r=e}})))},t}(data.Component);exports.ExitAndSaveDialog=ExitAndSaveDialog;

},{"./carousel":7,"./codecard":10,"./compiler":11,"./core":13,"./data":14,"./gallery":23,"./sui":44,"react":269,"react-dom":142}],34:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),pkg=require("./package"),srceditor=require("./srceditor"),sui=require("./sui"),core=require("./core"),Util=pxt.Util,Editor=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.config={},e.changeMade=!1,e}return __extends(e,t),e.prototype.prepare=function(){this.isReady=!0},e.prototype.getId=function(){return"pxtJsonEditor"},e.prototype.hasEditorToolbar=function(){return!1},e.prototype.display=function(){var t=this,e=this.config,n=function(){if(t.isSaving=!0,!e.name)return core.errorNotification(lf("Please choose a project name. It can't be blank.")),void(t.isSaving=!1);pkg.mainEditorPkg().lookupFile("this/"+pxt.CONFIG_NAME).setContentAsync(JSON.stringify(t.config,null,4)+"\n").then(function(){pkg.mainPkg.config.name=e.name,t.parent.setState({projectName:e.name}),t.parent.forceUpdate(),Util.nextTick(t.changeCallback),t.isSaving=!1,t.changeMade=!0,t.parent.openPreviousEditor(),core.resetFocus()})},o=[];pkg.allEditorPkgs().map(function(t){return t.getKsPkg()}).filter(function(t){return!!t&&t.isLoaded&&!!t.config&&!!t.config.yotta&&!!t.config.yotta.userConfigs}).forEach(function(t){return o=o.concat(t.config.yotta.userConfigs)});var r=function(e){var n=Util.jsonFlatten(t.config.yotta?t.config.yotta.config:{}),o=Util.jsonFlatten(e.config);return!Object.keys(o).some(function(t){return null===o[t]?!!n[t]:n[t]!==o[t]})};return React.createElement("div",{className:"ui content"},React.createElement("h3",{className:"ui small header"},React.createElement("div",{className:"content"},lf("Project Settings"))),React.createElement("div",{className:"ui segment form text"},React.createElement(sui.Input,{ref:function(e){return t.nameInput=e},id:"fileNameInput",label:lf("Name"),ariaLabel:lf("Type a name for your project"),value:e.name,onChange:function(n){e.name=n,t.parent.forceUpdate()}}),o.map(function(e){return React.createElement(sui.Checkbox,{key:"userconfig-"+e.description,inputLabel:e.description,checked:r(e),onChange:function(){return function(e){var o=Util.jsonFlatten(t.config.yotta?t.config.yotta.config:{}),i=Util.jsonFlatten(e.config);r(e)?Object.keys(i).forEach(function(t){return delete o[t]}):Object.keys(i).forEach(function(t){return o[t]=i[t]}),Object.keys(o).length?(t.config.yotta||(t.config.yotta={}),Object.keys(o).filter(function(t){return null===o[t]}).forEach(function(t){return delete o[t]}),t.config.yotta.config=Util.jsonUnFlatten(o)):t.config.yotta&&(delete t.config.yotta.config,Object.keys(t.config.yotta).length||delete t.config.yotta),n()}(e)}})}),React.createElement(sui.Field,null,React.createElement(sui.Button,{text:lf("Save"),class:"green "+(this.isSaving?"disabled":""),onClick:function(){return n()}}),React.createElement(sui.Button,{text:lf("Edit Settings As text"),onClick:function(){return t.editSettingsText()}}))))},e.prototype.isIncomplete=function(){return!this.changeMade},e.prototype.editSettingsText=function(){this.changeMade=!1,this.parent.editText()},e.prototype.getCurrentSource=function(){return JSON.stringify(this.config,null,4)+"\n"},e.prototype.acceptsFile=function(t){if(t.name!=pxt.CONFIG_NAME)return!1;if(t.isReadonly())return!1;try{JSON.parse(t.content);return!0}catch(t){return!1}},e.prototype.loadFileAsync=function(t){return this.config=JSON.parse(t.content),this.nameInput&&this.nameInput.clearValue(),this.setDiagnostics(t,this.snapshotState()),this.changeMade=!1,Promise.resolve()},e.prototype.unloadFileAsync=function(){return this.changeMade?this.parent.reloadHeaderAsync():Promise.resolve()},e}(srceditor.Editor);exports.Editor=Editor;

},{"./core":13,"./package":32,"./srceditor":43,"./sui":44,"react":269}],35:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var workspace=require("./workspace"),data=require("./data");function renderIcon(e){var t=null;if(e&&e.width>0&&e.height>0){var n=document.createElement("canvas");n.width=305,n.height=200;var a=0,r=0,i=0,o=0;e.height>e.width?(a=0,o=(i=e.width)/n.width*n.height,r=(e.height-o)/2):(r=0,i=(o=e.height)/n.height*n.width,a=(e.width-i)/2),n.getContext("2d").drawImage(e,a,r,i,o,0,0,n.width,n.height),t=n.toDataURL("image/jpeg",85)}return t}function saveAsync(e,t){return pxt.BrowserUtils.loadImageAsync(t).then(function(n){var a=renderIcon(n);return workspace.saveScreenshotAsync(e,t,a).then(function(){data.invalidate("header:"+e.id),data.invalidate("header:*")})})}function loadImageAsync(e){return new Promise(function(t,n){var a=new Image;a.src=e,a.onload=function(){var e=document.createElement("canvas");e.width=a.width,e.height=a.height,e.getContext("2d").drawImage(a,0,0),t(e)},a.onerror=function(){n(new Error(lf("Cannot load image")))}})}exports.saveAsync=saveAsync,exports.loadImageAsync=loadImageAsync;var imageMagic=1496611453,imageHeaderSize=36;function decodeBlobAsync(e){return loadImageAsync(e).then(function(e){var t=e.getContext("2d").getImageData(0,0,e.width,e.height).data,n=1&t[0]|(1&t[1])<<1|(1&t[2])<<2;if(n>5)return Promise.reject(new Error(lf("Invalid encoded PNG format")));function a(e,n,a){for(var r=0,i=0,o=0,d=(1<<n)-1;i<a.length;)o|=(t[e++]&d)<<r,3==(3&e)&&e++,(r+=n)>=8&&(a[i++]=255&o,o>>=8,r-=8);return e}var r=new Uint8Array(imageHeaderSize),i=a(4,n,r),o=pxt.HF2.decodeU32LE(r);if(o[0]!=imageMagic)return Promise.reject(new Error(lf("Invalid magic in encoded PNG")));var d=new Uint8Array(o[1]),c=o[2];if(c>0){var h=(e.height-c)*e.width,g=new Uint8Array((3*(h-1)*n>>3)-imageHeaderSize);a(i,n,g),d.set(g);var s=new Uint8Array(d.length-g.length);a(4*h,8,s),d.set(s,g.length)}else a(i,n,d);return d})}function encodeBlobAsync(e,t){return loadImageAsync(e).then(function(e){for(var n=imageHeaderSize+t.length,a=3*(e.width*e.height-1),r=1;r<4&&!(a*r>=8*n);)r++;var i=a*r>>3,o=n-i,d=0,c=e.width*e.height*4;if(o>0){var h=3*e.width;d=Math.ceil(o/h);var g=document.createElement("canvas");g.width=e.width,g.height=e.height+d,g.getContext("2d").drawImage(e,0,0),e=g}var s=pxt.HF2.encodeU32LE([imageMagic,t.length,d,0,0,0,0,0,0]);function l(e,t,n,a){for(var r=0,i=0,o=a[i++],d=(1<<n)-1,c=!0;c;){var h=o>>r&d,g=8-r;if(g<=n){if(i>=a.length){if(0==g)break;c=!1}h|=(o=a[i++])<<g&d,r=n-g}else r+=n;e[t]=255&(e[t]&~d|h),3==(3&++t)&&(e[t++]=255)}return t}pxt.Util.assert(s.length==imageHeaderSize);var u=e.getContext("2d"),m=u.getImageData(0,0,e.width,e.height);l(m.data,0,1,[r]);var v=4;if(v=l(m.data,v,r,s),pxt.Util.assert(0==(3&v)),0==d)v=l(m.data,v,r,t);else{var f=i-s.length;v=l(m.data,v,r,t.slice(0,f)),v=l(m.data,c,8,t.slice(f))}for(v|=3;v<m.data.length;)m.data[v]=255,v+=4;return u.putImageData(m,0,0),e.toDataURL("image/png")})}function testBlobEncodeAsync(e,t){void 0===t&&(t=1e4);var n=new Uint8Array(t);return pxt.Util.getRandomBuf(n),encodeBlobAsync(e,n).then(function(e){var t=document.createElement("img");return t.src=e,document.getElementById("msg").appendChild(t),decodeBlobAsync(e)}).then(function(e){pxt.Util.assert(e.length==n.length);for(var t=0;t<n.length;++t)pxt.Util.assert(e[t]==n[t])})}exports.decodeBlobAsync=decodeBlobAsync,exports.encodeBlobAsync=encodeBlobAsync,exports.testBlobEncodeAsync=testBlobEncodeAsync;

},{"./data":14,"./workspace":47}],36:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),ReactDOM=require("react-dom"),data=require("./data"),sui=require("./sui"),pkg=require("./package"),core=require("./core"),codecard=require("./codecard"),ScriptSearch=function(e){function t(t){var r=e.call(this,t)||this;return r.prevGhData=[],r.prevUrlData=[],r.state={searchFor:"",visible:!1},r}return __extends(t,e),t.prototype.hide=function(){this.setState({visible:!1})},t.prototype.showAddPackages=function(){this.setState({visible:!0,searchFor:""})},t.prototype.fetchUrlData=function(){if(!this.state.searchFor)return[];var e=pxt.Cloud.parseScriptId(this.state.searchFor);if(e){var t=this.getData("cloud-search:"+e);t&&(404!==t.statusCode?this.prevUrlData=[t]:this.prevUrlData=[])}else this.prevUrlData=[];return this.prevUrlData},t.prototype.fetchGhData=function(){var e=pxt.appTarget.cloud||{};if(!e.packages)return[];var t=e.githubPackages?this.state.searchFor:void 0,r=void 0;if(!t){var n=this.getData("target-config:");r=n&&n.packages?n.packages.preferredRepos:void 0}var a=t||r?this.getData("gh-search:"+(t||r.join("|"))):null;return a&&(this.prevGhData=a),this.prevGhData||[]},t.prototype.fetchBundled=function(){var e=this.state.searchFor,t=pxt.appTarget.bundledpkgs;return Object.keys(t).filter(function(e){return!/prj$/.test(e)}).map(function(e){return JSON.parse(t[e]["pxt.json"])}).filter(function(t){return!e||t.name.toLowerCase().indexOf(e.toLowerCase())>-1}).filter(function(e){return!pkg.mainPkg.deps[e.name]})},t.prototype.shouldComponentUpdate=function(e,t,r){return this.state.visible!=t.visible||this.state.searchFor!=t.searchFor},t.prototype.componentDidUpdate=function(){var e=ReactDOM.findDOMNode(this.refs.searchInput);e&&e.focus()},t.prototype.renderCore=function(){var e=this;if(!this.state.visible)return React.createElement("div",null);var t=this.fetchBundled(),r=this.fetchGhData(),n=this.fetchUrlData();t.sort(function(e,t){return e.core!=t.core?e.core?-1:1:pxt.Util.strcmp(e.name,t.name)});var a=function(t){var r=ReactDOM.findDOMNode(e.refs.searchInput).value,n=/^\/@(.*)$/.exec(r),a=n&&n[1];if(a){var i=pxt.appTarget.appTheme.homeUrl;/\/$/.test(i)||(i+="/"),a=a.replace(/^\//,""),pxt.winrt.releaseAllDevicesAsync().then(function(){window.location.href=i+a}).done()}else e.setState({searchFor:r})},i=function(t){pxt.tickEvent("packages.github",{name:t.fullName}),e.hide(),core.showLoading("downloadingpackage",lf("downloading package...")),pxt.packagesConfigAsync().then(function(e){return pxt.github.latestVersionAsync(t.fullName,e)}).then(function(e){return pxt.github.pkgConfigAsync(t.fullName,e).then(function(e){return core.hideLoading("downloadingpackage"),e}).then(function(r){return o(r,"github:"+t.fullName+"#"+e)})}).catch(core.handleNetworkError).finally(function(){return core.hideLoading("downloadingpackage")})},o=function(t,r){return pkg.mainPkg.findConflictsAsync(t,r).then(function(n){var a=t.core?[]:n.filter(function(e){return pkg.mainPkg.isPackageInUse(e.pkg0.id)}),i=Promise.resolve(!0);if(a.length)i=i.then(function(){return core.confirmAsync({header:lf("Cannot add {0} package",t.name),hideCancel:!0,agreeLbl:lf("Ok"),body:lf("Remove all the blocks from the {0} package and try again.",a[0].pkg0.id)})}).then(function(){return!1});else if(n.length){var o=1===n.length?lf("Package {0} is incompatible with {1}. Remove {0} and add {1}?",n[0].pkg0.id,t.name):lf("Packages {0} and {1} are incompatible with {2}. Remove them and add {2}?",n.slice(0,-1).map(function(e){return e.pkg0.id}).join(", "),n.slice(-1)[0].pkg0.id,t.name);i=i.then(function(){return core.confirmAsync({header:lf("Some packages will be removed"),agreeLbl:lf("Remove package(s) and add {0}",t.name),agreeClass:"pink focused",body:o})}).then(function(e){if(0!==e){var t=pkg.mainEditorPkg();return Promise.all(n.map(function(e){return t.removeDepAsync(e.pkg0.id)})).then(function(){return!0})}return Promise.resolve(!1)})}return i.then(function(n){return n?pkg.mainEditorPkg().addDepAsync(t.name,r).then(function(){return e.props.parent.reloadHeaderAsync()}):Promise.resolve()})})},c=lf("Extensions");return React.createElement(sui.Modal,{open:this.state.visible,dimmer:!0,header:c,className:"searchdialog",longer:!0,size:"fullscreen",onClose:function(){return e.setState({visible:!1})},closeIcon:!0,helpUrl:"/packages",closeOnDimmerClick:!0,closeOnEscape:!0,description:lf("Add a package to the project")},React.createElement("div",{className:"ui vertical segment"},React.createElement("div",{className:"ui search"},React.createElement("div",{className:"ui fluid action input",role:"search"},React.createElement("div",{"aria-live":"polite",className:"accessible-hidden"},lf("{0} result matching '{1}'",t.length+r.length+n.length,this.state.searchFor)),React.createElement("input",{ref:"searchInput",className:"focused",type:"text",placeholder:lf("Search or enter project URL..."),onKeyUp:function(e){13==e.keyCode&&a()}}),React.createElement("button",{title:lf("Search"),className:"ui right icon button",onClick:a},React.createElement(sui.Icon,{icon:"search"})))),React.createElement("div",{className:"ui cards",role:"listbox"},n.map(function(t){return React.createElement(codecard.CodeCardView,{key:"url"+t.id,name:t.name,description:t.description,url:"/"+t.id,onClick:function(){return function(t){return e.hide(),pkg.mainEditorPkg().addDepAsync(t.name,"pub:"+t.id).then(function(){return e.props.parent.reloadHeaderAsync()})}(t)},color:"red",role:"option"})}),t.map(function(t){return React.createElement(codecard.CodeCardView,{key:"bundled"+t.name,name:t.name,description:t.description,url:"/"+t.installedVersion,imageUrl:t.icon,onClick:function(){return function(t){pxt.tickEvent("packages.bundled",{name:t.name}),e.hide(),o(t,"*").done()}(t)},label:/\bbeta\b/i.test(t.description)?lf("Beta"):void 0,role:"option"})}),r.filter(function(e){return e.status==pxt.github.GitRepoStatus.Approved}).map(function(e){return React.createElement(codecard.CodeCardView,{name:e.name.replace(/^pxt-/,""),description:e.description,key:"gha"+e.fullName,onClick:function(){return i(e)},url:"github:"+e.fullName,color:"blue",imageUrl:pxt.github.repoIconUrl(e),label:/\bbeta\b/i.test(e.description)?lf("Beta"):void 0,role:"option"})}),r.filter(function(e){return e.status!=pxt.github.GitRepoStatus.Approved}).map(function(e){return React.createElement(codecard.CodeCardView,{name:e.name.replace(/^pxt-/,""),description:e.description||"",extracontent:lf("User provided package, not endorsed by Microsoft."),key:"ghd"+e.fullName,onClick:function(){return i(e)},imageUrl:pxt.github.repoIconUrl(e),url:"github:"+e.fullName,color:"red",role:"option"})})),e.state.searchFor&&!(t.length||r.length||n.length)?React.createElement("div",{className:"ui items"},React.createElement("div",{className:"ui item"},lf("We couldn't find any packages matching '{0}'",this.state.searchFor))):void 0))},t}(data.Component);exports.ScriptSearch=ScriptSearch;

},{"./codecard":10,"./core":13,"./data":14,"./package":32,"./sui":44,"react":269,"react-dom":142}],37:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}();Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),core=require("./core"),srceditor=require("./srceditor"),sui=require("./sui"),data=require("./data"),Util=pxt.Util,maxEntriesPerChart=4e3,Editor=function(t){function e(e){var o=t.call(this,e)||this;o.parent=e,o.savedMessageQueue=[],o.maxSavedMessages=1e3,o.charts=[],o.chartIdx=0,o.sourceMap={},o.consoleBuffer="",o.isSim=!0,o.maxConsoleLineLength=255,o.maxConsoleEntries=500,o.active=!0,o.rawDataBuffer="",o.maxBufferLength=1e4,o.csvHeaders=[],o.lineColors=["#f00","#00f","#0f0","#ff0"],o.hcLineColors=["000"],o.currentLineColors=o.lineColors,o.highContrast=!1,window.addEventListener("message",o.processEvent.bind(o),!1);var r=pxt.appTarget.serial&&pxt.appTarget.serial.editorTheme;return o.lineColors=r&&r.lineColors||o.lineColors,o}return __extends(e,t),e.prototype.getId=function(){return"serialEditor"},e.prototype.hasHistory=function(){return!1},e.prototype.hasEditorToolbar=function(){return!1},e.prototype.setVisible=function(t){this.parent.state.highContrast!==this.highContrast&&this.setHighContrast(this.parent.state.highContrast),this.isVisible=t,this.isVisible?(this.processQueuedMessages(),this.startRecording()):(this.pauseRecording(),this.clear())},e.prototype.setHighContrast=function(t){t!==this.highContrast&&(this.highContrast=t,this.currentLineColors=t?this.hcLineColors:this.lineColors,this.clear())},e.prototype.acceptsFile=function(t){return t.name===pxt.SERIAL_EDITOR_FILE},e.prototype.setSim=function(t){this.isSim!=t&&(this.isSim=t,this.clear())},e.prototype.loadSmoothieChartsAsync=function(){return this.loadSmoothieChartsPromise||(this.loadSmoothieChartsPromise=pxt.BrowserUtils.loadScriptAsync("smoothie/smoothie_compressed.js")),this.loadSmoothieChartsPromise},e.prototype.saveMessageForLater=function(t){this.savedMessageQueue.push(t),this.savedMessageQueue.length>this.maxSavedMessages&&this.savedMessageQueue.shift()},e.prototype.processQueuedMessages=function(){var t=this;this.savedMessageQueue.forEach(function(e){return t.processMessage(e)}),this.savedMessageQueue=[]},e.prototype.processEvent=function(t){var e=t.data;if("serial"===e.type){var o=e;o.receivedTime=o.receivedTime||Util.now(),this.active?this.processMessage(o):this.saveMessageForLater(o)}},e.prototype.processMessage=function(t){var e=this;if(!!t.sim==this.isSim){var o=t.data||"",r=t.id||"?",i=t.receivedTime||Util.now();if(this.appendRawData(o),!this.sourceMap[r]){var s=Object.keys(this.sourceMap).length+1;this.sourceMap[r]=lf("source")+s.toString()}var a=this.sourceMap[r];if(/^\s*(-?\d+(\.\d*)?)(\s*,\s*(-?\d+(\.\d*)?))+\s*,?\s*$/.test(o))o.split(/\s*,\s*/).map(function(t){return parseFloat(t)}).filter(function(t){return!isNaN(t)}).forEach(function(t,o){var r="data."+(e.csvHeaders[o]||o);e.appendGraphEntry(a,r,t,i)});else if(/^\s*[\s\w]+(\s*,\s*[\w\s]+)+\s*,?\s*$/.test(o))this.csvHeaders=o.split(/\s*,\s*/).map(function(t){return t.trim()});else{var n=/^\s*(([^:]+):)?\s*(-?\d+(\.\d*)?)/i.exec(o);if(n){var c=n[2]||"",l=parseFloat(n[3]);isNaN(l)||this.appendGraphEntry(a,c,l,i)}}this.appendConsoleEntry(o)}},e.prototype.appendRawData=function(t){this.rawDataBuffer+=t,this.rawDataBuffer.length>this.maxBufferLength&&this.rawDataBuffer.slice(this.rawDataBuffer.length/4)},e.prototype.appendGraphEntry=function(t,e,o,r){var i=this;this.loadSmoothieChartsAsync().then(function(){for(var s=void 0,a=0;a<i.charts.length;++a){var n=i.charts[a];if(n.shouldContain(t,e)){s=n;break}}s||(s=new Chart(t,e,i.chartIdx,i.currentLineColors),i.chartIdx++,i.charts.push(s),i.chartRoot.appendChild(s.getElement())),s.addPoint(e,o,r)})},e.prototype.appendConsoleEntry=function(t){for(var e=0;e<t.length;++e){var o=t[e];if(this.consoleBuffer+=o,!("\n"!==o&&this.consoleBuffer.length<this.maxConsoleLineLength)){if("\n"===o){var r=this.consoleRoot.lastChild,i=document.createElement("div");if(r&&r.lastChild.textContent==this.consoleBuffer)if(2==r.childNodes.length){var s=parseInt(r.firstChild.textContent);r.firstChild.textContent=(s+1).toString()}else{var a=document.createElement("a");a.className="ui horizontal label",a.textContent="2",r.insertBefore(a,r.lastChild)}else i.appendChild(document.createTextNode(this.consoleBuffer)),this.consoleRoot.appendChild(i)}else{(i=document.createElement("span")).appendChild(document.createTextNode(this.consoleBuffer)),this.consoleRoot.appendChild(i)}this.consoleBuffer="",this.consoleRoot.scrollTop=this.consoleRoot.scrollHeight,this.consoleRoot.childElementCount>this.maxConsoleEntries&&this.consoleRoot.removeChild(this.consoleRoot.firstChild),this.consoleRoot&&this.consoleRoot.childElementCount>0&&(this.chartRoot&&this.chartRoot.classList.remove("noconsole"),this.consoleRoot&&this.consoleRoot.classList.remove("noconsole"))}}},e.prototype.pauseRecording=function(){this.active=!1,this.startPauseButton&&this.startPauseButton.setState({active:this.active}),this.charts.forEach(function(t){return t.stop()})},e.prototype.startRecording=function(){this.active=!0,this.startPauseButton&&this.startPauseButton.setState({active:this.active}),this.charts.forEach(function(t){return t.start()})},e.prototype.toggleRecording=function(){pxt.tickEvent("serial.toggleRecording",void 0,{interactiveConsent:!0}),this.active?this.pauseRecording():this.startRecording()},e.prototype.clearNode=function(t){for(;t.hasChildNodes();)t.removeChild(t.firstChild)},e.prototype.clear=function(){this.chartRoot&&(this.clearNode(this.chartRoot),this.chartRoot.classList.add("noconsole")),this.consoleRoot&&(this.clearNode(this.consoleRoot),this.consoleRoot.classList.add("noconsole")),this.charts=[],this.consoleBuffer="",this.rawDataBuffer="",this.savedMessageQueue=[],this.sourceMap={},this.csvHeaders=[]},e.prototype.isCSV=function(t,e){if(e.length<2)return!1;for(var o=0;o<e.length;++o)if(e[o].length!=t)return!1;for(var r=0;r<t;++r)for(var i=e[0][r][0],s=1;s<e.length;++s)if(e[s][r][0]!=i)return!1;return!0},e.prototype.downloadCSV=function(){var t=this,e=lf("{id:csvseparator}\t"),o=[];this.charts.forEach(function(r){var i=[];Object.keys(r.datas).forEach(function(t){return i.push({name:t,line:r.datas[t]})});var s=i.map(function(t){return t.line}),a=s.length>0?s.map(function(t){return t.length}).reduce(function(t,e){return Math.max(t,e)}):0;if(t.isCSV(a,s)){var n="time ("+r.source+")"+e+i.map(function(t){return t.name}).join(e)+e;o[0]=o[0]?o[0]+e+n:n;for(var c=function(t){var r=(s[0][t][0]-s[0][0][0])/1e3+e+s.map(function(e){return e[t][1]}).join(e)+e;o[t+1]=o[t+1]?o[t+1]+e+r:r},l=0;l<a;++l)c(l)}else{n=i.map(function(t){return"time ("+r.source+")"+e+t.name}).join(e);o[0]=o[0]?o[0]+e+n:n;var h=function(t){var r=s.map(function(o){return t<o.length?""+(o[t][0]-o[0][0])/1e3+e+o[t][1]:e}).join(e);o[t+1]=o[t+1]?o[t+1]+e+r:r};for(l=0;l<a;++l)h(l)}}),o.unshift("sep="+e);var r=o.join("\r\n");core.infoNotification(lf("Exporting data...."));var i=new Date(Date.now()).toString().replace(/[^\d]+/g,"-").replace(/(^-|-$)/g,"");pxt.commands.browserDownloadAsync(r,pxt.appTarget.id+"-"+lf("{id:csvfilename}data")+"-"+i+".csv","text/csv")},e.prototype.downloadRaw=function(){core.infoNotification(lf("Exporting text...."));var t=new Date(Date.now()).toString().replace(/[^\d]+/g,"-").replace(/(^-|-$)/g,"");pxt.commands.browserDownloadAsync(this.rawDataBuffer,pxt.appTarget.id+"-"+lf("{id:csvfilename}console")+"-"+t+".txt","text/plain")},e.prototype.goBack=function(){pxt.tickEvent("serial.backButton",void 0,{interactiveConsent:!0}),this.parent.openPreviousEditor()},e.prototype.display=function(){var t=this;return React.createElement("div",{id:"serialArea"},React.createElement("div",{id:"serialHeader",className:"ui serialHeader"},React.createElement("div",{className:"leftHeaderWrapper"},React.createElement("div",{className:"leftHeader"},React.createElement(sui.Button,{text:lf("Go back"),title:lf("Go back to the previous editor"),class:"icon circular small editorBack left labeled",ariaLabel:lf("Go back"),onClick:this.goBack.bind(this)},React.createElement(sui.Icon,{icon:"arrow left"})))),React.createElement("div",{className:"rightHeader"},React.createElement(sui.Button,{title:lf("Export data"),class:"ui icon blue button editorExport",ariaLabel:lf("Export data"),onClick:function(){return t.downloadCSV()}},React.createElement(sui.Icon,{icon:"download"})),React.createElement(StartPauseButton,{ref:function(e){return t.startPauseButton=e},active:this.active,toggle:this.toggleRecording.bind(this)}),React.createElement("span",{className:"ui small header"},this.isSim?lf("Simulator"):lf("Device")))),React.createElement("div",{id:"serialCharts",ref:function(e){return t.chartRoot=e}}),React.createElement("div",{id:"consoleHeader",className:"ui serialHeader"},React.createElement("div",{className:"rightHeader"},React.createElement(sui.Button,{title:lf("Copy text"),class:"ui icon button editorExport",ariaLabel:lf("Copy text"),onClick:function(){return t.downloadRaw()}},React.createElement(sui.Icon,{icon:"copy"})))),React.createElement("div",{id:"serialConsole",ref:function(e){return t.consoleRoot=e}}))},e.prototype.domUpdate=function(){},e}(srceditor.Editor);exports.Editor=Editor;var StartPauseButton=function(t){function e(e){var o=t.call(this,e)||this;return o.state={active:o.props.active},o}return __extends(e,t),e.prototype.renderCore=function(){var t=this.props.toggle,e=this.state.active;return React.createElement(sui.Button,{title:e?lf("Pause recording"):lf("Start recording"),class:"ui left floated icon button "+(e?"green":"red circular")+" toggleRecord",onClick:t},React.createElement(sui.Icon,{icon:e?"pause icon":"circle icon"}))},e}(data.Component);exports.StartPauseButton=StartPauseButton;var Chart=function(){function t(t,e,o,r){var i=this;this.rootElement=document.createElement("div"),this.lines={},this.datas={};var s=pxt.appTarget.serial&&pxt.appTarget.serial.editorTheme,a={interpolation:"bezier",labels:{disabled:!1,fillStyle:"black",fontSize:14},responsive:!0,millisPerPixel:20,grid:{verticalSections:0,borderVisible:!1,millisPerLine:5e3,fillStyle:s&&s.gridFillStyle||"transparent",strokeStyle:s&&s.gridStrokeStyle||"#fff"},tooltip:!0,tooltipFormatter:function(t,e){return i.tooltip(t,e)}};this.lineColors=r,this.chartIdx=o,this.chart=new SmoothieChart(a),this.rootElement.className="ui segment",this.source=t,this.variable=e.replace(/\..*$/,""),this.rootElement.appendChild(this.makeLabel()),this.rootElement.appendChild(this.makeCanvas())}return t.prototype.tooltip=function(t,e){return e.map(function(t){var e=t.series.timeSeries.__name;return"<span>"+(e?e+": ":"")+t.value+"</span>"}).join("<br/>")},t.prototype.getLine=function(t){var e=this.lines[t];if(!e){var o=this.lineColors[this.chartIdx++%this.lineColors.length];this.lines[t]=e=new TimeSeries,e.__name=Util.htmlEscape(t.substring(this.variable.length+1)),this.chart.addTimeSeries(e,{strokeStyle:o,lineWidth:3}),this.datas[t]=[]}return e},t.prototype.makeLabel=function(){return this.label=document.createElement("div"),this.label.className="ui orange bottom left attached no-select label seriallabel",this.label.innerText=this.variable||"...",this.label},t.prototype.makeCanvas=function(){var t=document.createElement("canvas");return this.chart.streamTo(t),this.canvas=t,t},t.prototype.getCanvas=function(){return this.canvas},t.prototype.getElement=function(){return this.rootElement},t.prototype.shouldContain=function(t,e){return this.source==t&&this.variable==e.replace(/\..*$/,"")},t.prototype.addPoint=function(t,e,o){if(this.getLine(t).append(o,e),1==Object.keys(this.lines).length){var r=Number(Math.round(Number(e+"e+2"))+"e-2").toString();this.label.innerText=this.variable?this.variable+": "+r:r}else this.label.innerText=this.variable||"";var i=this.datas[t];i.push([o,e]),i.length>maxEntriesPerChart&&i.splice(0,i.length/4)},t.prototype.start=function(){this.chart.start()},t.prototype.stop=function(){this.chart.stop()},t}(),ResourceImporter=function(){function t(){}return t.prototype.canImport=function(t){return"text/plain"==t.type},t.prototype.importAsync=function(t,e){return ts.pxtc.Util.fileReadAsTextAsync(e).then(function(t){if(t){var o=t.split(/\n/g).map(function(t){var o=/^\s*(\d+)>/.exec(t);return o&&(t=t.substr(o[0].length)),{type:"serial",data:t+"\n",id:e.name,receivedTime:o?parseFloat(o[1]):void 0}});if(o.length){var r=Util.now(),i=o.filter(function(t){return!!t.receivedTime});if(i.length){var s=i[i.length-1].receivedTime||0;i.forEach(function(t){return t.receivedTime+=r-s})}o.forEach(function(t){return window.postMessage(t,"*")})}}else core.errorNotification(lf("Ooops, could not read file"))})},t}();exports.ResourceImporter=ResourceImporter;

},{"./core":13,"./data":14,"./srceditor":43,"./sui":44,"react":269}],38:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),sui=require("./sui"),SerialIndicator=function(t){function e(e){var i=t.call(this,e)||this;return i.state={active:!1},i}return __extends(e,t),e.prototype.componentDidMount=function(){window.addEventListener("message",this.setActive.bind(this))},e.prototype.componentWillUnmount=function(){window.addEventListener("message",this.setActive.bind(this))},e.prototype.setActive=function(t){var e=t.data;this.state.active||"serial"!==e.type||!!e.sim===this.props.isSim&&this.setState({active:!0})},e.prototype.clear=function(){this.setState({active:!1})},e.prototype.render=function(){return this.state.active?React.createElement("div",{title:lf("Open console"),className:"ui label circular",tabIndex:0,onClick:this.props.onClick,onKeyDown:sui.fireClickOnEnter},React.createElement("div",{className:"detail"},React.createElement("img",{alt:lf("Animated bar chart"),className:"barcharticon",src:pxt.Util.pathJoin(pxt.webConfig.commitCdnUrl,"images/Bars_black.gif")})),lf("Show console"),React.createElement("div",{className:"detail"},this.props.isSim?lf("Simulator"):lf("Device"))):React.createElement("div",null)},e}(React.Component);exports.SerialIndicator=SerialIndicator;

},{"./sui":44,"react":269}],39:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])};return function(t,a){function r(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(r.prototype=a.prototype,new r)}}();Object.defineProperty(exports,"__esModule",{value:!0});var ShareMode,React=require("react"),data=require("./data"),sui=require("./sui");!function(e){e[e.Code=0]="Code",e[e.Url=1]="Url",e[e.Editor=2]="Editor",e[e.Simulator=3]="Simulator"}(ShareMode=exports.ShareMode||(exports.ShareMode={}));var ShareEditor=function(e){function t(t){var a=e.call(this,t)||this;return a.state={currentPubId:void 0,pubCurrent:!1,visible:!1,advancedMenu:!1},a}return __extends(t,e),t.prototype.hide=function(){this.setState({visible:!1})},t.prototype.show=function(e){this.setState({visible:!0,mode:ShareMode.Code,pubCurrent:e.pubCurrent,sharingError:!1})},t.prototype.shouldComponentUpdate=function(e,t,a){return this.state.visible!=t.visible||this.state.advancedMenu!=t.advancedMenu||this.state.mode!=t.mode||this.state.pubCurrent!=t.pubCurrent||this.state.currentPubId!=t.currentPubId||this.state.sharingError!=t.sharingError},t.prototype.renderCore=function(){var e=this,t=this.state.visible,a=pxt.appTarget.appTheme,r=this.props.parent.state.header,o=!!this.state.advancedMenu,n=!!a.hideShareEmbed,i=!!a.socialOptions&&!pxt.BrowserUtils.isUwpEdge(),s=!1,c=this.state.mode,l="",d="";if(r){var u=pxt.appTarget.appTheme.shareUrl||"https://makecode.com/";/\/$/.test(u)||(u+="/");var p=pxt.appTarget.appTheme.embedUrl;/\/$/.test(p)||(p+="/");var h=(r?r.pubId:void 0)||this.state.currentPubId;if(s=!!h&&r.pubCurrent){l=""+u+h;var m=p+"#pub:"+h;switch(c){case ShareMode.Code:d=pxt.docs.codeEmbedUrl(p,r.pubId);break;case ShareMode.Editor:d=pxt.docs.embedUrl(p,"pub",r.pubId);break;case ShareMode.Simulator:var b="81.97%";pxt.appTarget.simulator&&(b=(100/pxt.appTarget.simulator.aspectRatio).toPrecision(4)+"%");var v=p+(pxt.webConfig.runUrl||"--run").replace(/^\//,"");d=pxt.docs.runUrl(v,b,r.pubId);break;case ShareMode.Url:d=m}}}var f=[{mode:ShareMode.Code,label:lf("Code")},{mode:ShareMode.Editor,label:lf("Editor")},{mode:ShareMode.Simulator,label:lf("Simulator")}],E=s?void 0:lf("Publish project"),C=this.props.parent.state.publishing&&!this.state.sharingError,w="",g="";if(i){var S=lf("Check out what I made!"),k=pxt.appTarget.appTheme.socialOptions;k.twitterHandle&&k.orgTwitterHandle?S=lf("Check out what I made with @{0} and @{1}!",k.twitterHandle,k.orgTwitterHandle):k.twitterHandle?S=lf("Check out what I made with @{0}!",k.twitterHandle):k.orgTwitterHandle&&(S=lf("Check out what I made with @{0}!",k.orgTwitterHandle)),w="https://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(l),g="https://twitter.com/intent/tweet?url="+encodeURIComponent(l)+"&text="+encodeURIComponent(S)+(k.hashtags?"&hashtags="+encodeURIComponent(k.hashtags):""),k.related&&encodeURIComponent(k.related)}var y=[];return E&&y.push({label:E,onClick:function(){pxt.tickEvent("menu.embed.publish",void 0,{interactiveConsent:!0}),e.setState({sharingError:!1}),e.props.parent.anonymousPublishAsync().catch(function(t){e.setState({sharingError:!0})}).done(function(){e.setState({pubCurrent:!0}),e.forceUpdate()}),e.forceUpdate()},icon:"share alternate",loading:C,className:"primary"}),React.createElement(sui.Modal,{open:t,className:"sharedialog",header:lf("Share Project"),size:"small",onClose:function(){return e.setState({visible:!1})},dimmer:!0,actions:y,closeIcon:!0,closeOnDimmerClick:!0,closeOnDocumentClick:!0,closeOnEscape:!0},React.createElement("div",{className:"ui form"},E?React.createElement("div",null,React.createElement("p",null,lf("You need to publish your project to share it or embed it in other web pages.")+" "+lf("You acknowledge having consent to publish this project.")),this.state.sharingError?React.createElement("p",{className:"ui red inverted segment"},lf("Oops! There was an error. Please ensure you are connected to the Internet and try again.")):void 0):void 0,l&&s?React.createElement("div",null,React.createElement("p",null,lf("Your project is ready! Use the address below to share your projects.")),React.createElement(sui.Input,{id:"projectUri",class:"focused mini",readOnly:!0,lines:1,value:l,copy:!0,selectOnClick:!0,"aria-describedby":"projectUriLabel"}),React.createElement("label",{htmlFor:"projectUri",id:"projectUriLabel",className:"accessible-hidden"},lf("This is the read-only internet address of your project.")),i?React.createElement("div",{className:"social-icons"},React.createElement("a",{className:"ui button large icon facebook",tabIndex:0,"aria-label":"Facebook",onClick:function(e){return pxt.tickEvent("share.facebook",void 0,{interactiveConsent:!0}),sui.popupWindow(w,lf("Share on Facebook"),600,600),e.preventDefault(),!1}},React.createElement(sui.Icon,{icon:"facebook"})),React.createElement("a",{className:"ui button large icon twitter",tabIndex:0,"aria-label":"Twitter",onClick:function(e){return pxt.tickEvent("share.twitter",void 0,{interactiveConsent:!0}),sui.popupWindow(g,lf("Share on Twitter"),600,600),e.preventDefault(),!1}},React.createElement(sui.Icon,{icon:"twitter"}))):void 0):void 0,s&&!n?React.createElement("div",null,React.createElement("div",{className:"ui divider"}),React.createElement(sui.Link,{class:"focused",icon:"chevron "+(o?"down":"right"),text:lf("Embed"),ariaExpanded:o,onClick:function(){return e.setState({advancedMenu:!o})}}),o?React.createElement(sui.Menu,{pointing:!0,secondary:!0},f.map(function(t){return React.createElement(sui.MenuItem,{key:"tab"+t.label,id:"tab"+t.mode,active:c==t.mode,name:t.label,onClick:function(){return e.setState({mode:t.mode})}})})):void 0,o?React.createElement(sui.Field,null,React.createElement(sui.Input,{id:"embedCode",class:"mini",readOnly:!0,lines:4,value:d,copy:s,disabled:!s,selectOnClick:!0}),React.createElement("label",{htmlFor:"embedCode",id:"embedCodeLabel",className:"accessible-hidden"},lf("This is the read-only code for the selected tab."))):null):void 0))},t}(data.Component);exports.ShareEditor=ShareEditor;

},{"./data":14,"./sui":44,"react":269}],40:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),data=require("./data"),sui=require("./sui"),SimulatorToolbar=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.openInstructions=function(){pxt.tickEvent("simulator.make",void 0,{interactiveConsent:!0}),this.props.parent.openInstructions()},e.prototype.startStopSimulator=function(){pxt.tickEvent("simulator.startstop",void 0,{interactiveConsent:!0}),this.props.parent.startStopSimulator()},e.prototype.restartSimulator=function(){pxt.tickEvent("simulator.restart",void 0,{interactiveConsent:!0}),this.props.parent.restartSimulator()},e.prototype.toggleTrace=function(){pxt.tickEvent("simulator.trace",void 0,{interactiveConsent:!0}),this.props.parent.toggleTrace()},e.prototype.toggleDebug=function(){pxt.tickEvent("simulator.debug",void 0,{interactiveConsent:!0}),this.props.parent.toggleDebugging()},e.prototype.toggleMute=function(){pxt.tickEvent("simulator.mute",{view:"computer",muteTo:""+!this.props.parent.state.mute},{interactiveConsent:!0}),this.props.parent.toggleMute()},e.prototype.toggleSimulatorFullscreen=function(){pxt.tickEvent("simulator.fullscreen",{view:"computer",fullScreenTo:""+!this.props.parent.state.fullscreen},{interactiveConsent:!0}),this.props.parent.toggleSimulatorFullscreen()},e.prototype.renderCore=function(){var t=this,e=this.props.parent.state,o=pxt.appTarget.appTheme,n=pxt.appTarget.simulator,r=!pxt.shell.isSandboxMode()&&e.showParts&&n&&(n.instructions||n.parts&&pxt.options.debug),i=e.running,a=e.fullscreen,s=e.mute,l=!!e.tutorialOptions&&!!e.tutorialOptions.tutorial,u=!n.hideRestart,c=!!n.enableTrace,p=this.props.parent.state.tracing,m=p?lf("Disable Slow-Mo"):lf("Slow-Mo"),f=!c,g=e.debugging,d=!l&&!n.hideFullscreen,v=!l&&o.hasAudio;if(n.headless)return React.createElement("div",null);var b=i?lf("Stop the simulator"):lf("Start the simulator"),y=lf("Open assembly instructions"),h=lf("Restart the simulator"),S=g?lf("Disable Debugging"):lf("Debugging"),k=a?lf("Exit fullscreen mode"):lf("Launch in fullscreen"),x=s?lf("Unmute audio"):lf("Mute audio");return React.createElement("aside",{className:"ui item grid centered portrait hide simtoolbar",role:"complementary","aria-label":lf("Simulator toolbar")},React.createElement("div",{className:"ui icon tiny buttons "+(a?"massive":""),style:{padding:"0"}},r?React.createElement(sui.Button,{disabled:g,icon:"configure",class:"secondary",title:y,onClick:function(){return t.openInstructions()}}):void 0,React.createElement(sui.Button,{disabled:g,key:"runbtn",class:"play-button "+(i?"stop":"play"),icon:i?"stop":"play green",title:b,onClick:function(){return t.startStopSimulator()}}),u?React.createElement(sui.Button,{disabled:g,key:"restartbtn",class:"restart-button",icon:"refresh",title:h,onClick:function(){return t.restartSimulator()}}):void 0,c?React.createElement(sui.Button,{key:"trace",class:"trace-button "+(p?"orange":""),icon:"xicon turtle",title:m,onClick:function(){return t.toggleTrace()}}):void 0,f?React.createElement(sui.Button,{key:"debug",class:"debug-button "+(g?"orange":""),icon:"xicon bug",title:S,onClick:function(){return t.toggleDebug()}}):void 0),React.createElement("div",{className:"ui icon tiny buttons "+(a?"massive":""),style:{padding:"0"}},v?React.createElement(sui.Button,{key:"mutebtn",class:"mute-button "+(s?"red":""),icon:s?"volume off":"volume up",title:x,onClick:function(){return t.toggleMute()}}):void 0,d?React.createElement(sui.Button,{key:"fullscreenbtn",class:"fullscreen-button",icon:"xicon "+(a?"fullscreencollapse":"fullscreen"),title:k,onClick:function(){return t.toggleSimulatorFullscreen()}}):void 0))},e}(data.Component);exports.SimulatorToolbar=SimulatorToolbar;

},{"./data":14,"./sui":44,"react":269}],41:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var core=require("./core"),U=pxt.U;exports.FAST_TRACE_INTERVAL=100,exports.SLOW_TRACE_INTERVAL=500;var config,lastCompileResult,tutorialMode,$debugger,nextFrameId=0,themes=["blue","red","green","yellow"],displayedModals={},dirty=!1;function setTranslations(e){exports.simTranslations=e}function init(e,t){$(e).html('\n        <div id="simulators" class=\'simulator\'>\n        </div>\n        <div id="debugger" class="ui item landscape only">\n        </div>\n        '),$debugger=$("#debugger");var r={revealElement:function(e){pxt.options.light||$(e).transition({animation:pxt.appTarget.appTheme.simAnimationEnter||"fly right in",duration:"0.5s"})},removeElement:function(e,t){if(pxt.appTarget.simulator.headless)$(e).addClass("simHeadless"),t&&t();else{if(pxt.options.light)return t&&t(),void $(e).remove();$(e).transition({animation:pxt.appTarget.appTheme.simAnimationExit||"fly right out",duration:"0.5s",onComplete:function(){t&&t(),$(e).remove()}}).on("error",function(){t&&t(),$(e).remove()})}},unhideElement:function(e){$(e).removeClass("simHeadless")},onDebuggerBreakpoint:function(e){if(updateDebuggerButtons(e),e.exceptionMessage&&core.errorNotification(lf("Program Error: {0}",e.exceptionMessage)),config){var t=lastCompileResult.breakpoints[e.breakpointId];if(!config.highlightStatement(t,e)&&!e.exceptionMessage)return void exports.driver.resume(pxsim.SimulatorDebuggerCommand.StepInto)}postSimEditorEvent("stopped",e.exceptionMessage)},onTraceMessage:function(e){var t=lastCompileResult.breakpoints[e.breakpointId];config&&config.highlightStatement(t)},onDebuggerWarning:function(e){for(var t=0,r=e.breakpointIds;t<r.length;t++){var i=r[t],o=lastCompileResult.breakpoints[i];if(o&&!U.startsWith("pxt_modules/",o.fileName)){config&&config.highlightStatement(o);break}}},onDebuggerResume:function(){postSimEditorEvent("resumed"),config&&config.highlightStatement(null),updateDebuggerButtons()},onStateChanged:function(e){e===pxsim.SimulatorState.Stopped?postSimEditorEvent("stopped"):e===pxsim.SimulatorState.Running&&this.onDebuggerResume(),updateDebuggerButtons(),t.onStateChanged(e)},onSimulatorCommand:function(e){switch(e.command){case"restart":t.restartSimulator();break;case"reload":stop(!0),t.restartSimulator();break;case"modal":if(stop(),!(pxt.shell.isSandboxMode()||e.displayOnceId&&displayedModals[e.displayOnceId])){var r={header:e.header,body:e.body,size:"large",copyable:e.copyable,disagreeLbl:lf("Close"),modalContext:e.modalContext},i=pxt.appTarget.simulator.trustedUrls,o=e.linkButtonHref&&i&&-1!==i.indexOf(e.linkButtonHref);o?r.agreeLbl=e.linkButtonLabel:r.hideAgree=!0,displayedModals[e.displayOnceId]=!0,core.confirmAsync(r).then(function(t){o&&1==t&&window.open(e.linkButtonHref,"_blank")}).done()}}},onTopLevelCodeEnd:function(){postSimEditorEvent("toplevelfinished")},stoppedClass:getStoppedClass()};exports.driver=new pxsim.SimulatorDriver($("#simulators")[0],r),config=t,updateDebuggerButtons()}function postSimEditorEvent(e,t){pxt.appTarget.appTheme.allowParentController&&pxt.BrowserUtils.isIFrame()&&pxt.editor.postHostMessageAsync({type:"pxthost",action:"simevent",subtype:e,exception:t})}function setState(e,t){config&&config.editor!=e&&(config.editor=e,config.highlightStatement(null),updateDebuggerButtons()),tutorialMode=t}function makeDirty(){pxsim.U.addClass(exports.driver.container,getInvalidatedClass()),dirty=!0}function isDirty(){return dirty}function run(e,t,r,i,o,n){makeClean();var s=r.outfiles[pxtc.BINARY_JS],a=pxt.appTarget.simulator.boardDefinition,p=pxtc.computeUsedParts(r,!0),u=r.usedArguments;lastCompileResult=r;var d={boardDefinition:a,mute:i,parts:p,debug:t,fnArgs:u,highContrast:o,light:n,aspectRatio:p.length?pxt.appTarget.simulator.partsAspectRatio:pxt.appTarget.simulator.aspectRatio,partDefinitions:e.computePartDefinitions(p),cdnUrl:pxt.webConfig.commitCdnUrl,localizedStrings:exports.simTranslations,refCountingDebug:pxt.options.debug,version:e.version()};postSimEditorEvent("started"),exports.driver.run(s,d)}function mute(e){exports.driver.mute(e),$debugger.empty()}function stop(e){exports.driver&&(makeClean(),exports.driver.stop(e),$debugger.empty())}function hide(e){pxt.appTarget.simulator.headless||makeDirty(),exports.driver.hide(e),$debugger.empty()}function unhide(){exports.driver.unhide()}function setTraceInterval(e){exports.driver.setTraceInterval(e)}function proxy(e){exports.driver&&(exports.driver.postMessage(e),$debugger.empty())}function dbgPauseResume(){exports.driver.state==pxsim.SimulatorState.Paused?exports.driver.resume(pxsim.SimulatorDebuggerCommand.Resume):exports.driver.state==pxsim.SimulatorState.Running&&exports.driver.resume(pxsim.SimulatorDebuggerCommand.Pause)}function dbgStepOver(){exports.driver.state==pxsim.SimulatorState.Paused&&exports.driver.resume(pxsim.SimulatorDebuggerCommand.StepOver)}function dbgStepInto(){exports.driver.state==pxsim.SimulatorState.Paused&&exports.driver.resume(pxsim.SimulatorDebuggerCommand.StepInto)}function dbgStepOut(){exports.driver.state==pxsim.SimulatorState.Paused&&exports.driver.resume(pxsim.SimulatorDebuggerCommand.StepOut)}function makeClean(){pxsim.U.removeClass(exports.driver.container,getInvalidatedClass()),dirty=!1}function getInvalidatedClass(){return pxt.appTarget.simulator&&pxt.appTarget.simulator.invalidatedClass?pxt.appTarget.simulator.invalidatedClass:"sepia"}function getStoppedClass(){if(pxt.appTarget.simulator&&pxt.appTarget.simulator.stoppedClass)return pxt.appTarget.simulator.stoppedClass}function updateDebuggerButtons(e){void 0===e&&(e=null)}function updateDebuggerButtonsInternal(e){function t(e,t,r,i){var o=$('<button class="ui mini button teal" title="'+pxt.Util.htmlEscape(r)+'"></button>');return e&&o.addClass("icon").append('<i class="'+e+' icon"></i>'),t&&o.append(pxt.Util.htmlEscape(t)),o.click(i)}if(void 0===e&&(e=null),$debugger.empty(),exports.driver.runOptions.debug){var r="tsprj"==config.editor;if(exports.driver.state==pxsim.SimulatorState.Paused){var i=t("play",lf("Resume"),lf("Resume execution"),function(){return exports.driver.resume(pxsim.SimulatorDebuggerCommand.Resume)}),o=t("xicon stepover",lf("Step over"),lf("Step over next function call"),function(){return exports.driver.resume(pxsim.SimulatorDebuggerCommand.StepOver)}),n=t("xicon stepinto",lf("Step into"),lf("Step into next function call"),function(){return exports.driver.resume(pxsim.SimulatorDebuggerCommand.StepInto)});$debugger.append(i).append(o),r&&$debugger.append(n)}else if(exports.driver.state==pxsim.SimulatorState.Running){var s=t("pause",lf("Pause"),lf("Pause execution on the next instruction"),function(){return exports.driver.resume(pxsim.SimulatorDebuggerCommand.Pause)});$debugger.append(s)}if(e&&r){var a=$('<div class="ui segment debuggerview"></div>');a.append(p(U.lf("globals"),e.globals)),e.stackframes.forEach(function(e){var t=e.funcInfo;a.append(p(t.functionName,e.locals))}),$("#debugger").append(a)}}function p(e,t){for(var r=$("<div><h4>"+U.htmlEscape(e)+"</h4></div>"),i=0,o=Object.keys(t);i<o.length;i++){var n=o[i],s=t[n],a="";switch(typeof s){case"number":a=s+"";break;case"string":a=JSON.stringify(s);break;case"object":a=null==s?"null":void 0!==s.id?"(object)":s.text?s.text:"(unknown)";break;default:U.oops()}var p=n.replace(/___\d+$/,"");r.append("<div>"+U.htmlEscape(p)+": "+U.htmlEscape(a)+"</div>")}return r}}exports.setTranslations=setTranslations,exports.init=init,exports.setState=setState,exports.makeDirty=makeDirty,exports.isDirty=isDirty,exports.run=run,exports.mute=mute,exports.stop=stop,exports.hide=hide,exports.unhide=unhide,exports.setTraceInterval=setTraceInterval,exports.proxy=proxy,exports.dbgPauseResume=dbgPauseResume,exports.dbgStepOver=dbgStepOver,exports.dbgStepInto=dbgStepInto,exports.dbgStepOut=dbgStepOut;

},{"./core":13}],42:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var audio=require("./audio"),sounds={},volume=.2;function loadSoundAsync(t){var o=(pxt.appTarget.appTheme.sounds||{})[t];if(pxt.options.light||!o)return Promise.resolve(void 0);var n=sounds[o];if(n)return Promise.resolve(n);var e=pxt.webConfig.commitCdnUrl+"sounds/"+o;return pxt.Util.requestAsync({url:e,headers:{Accept:"audio/"+o.slice(-3)},responseArrayBuffer:!0}).then(function(t){return audio.loadAsync(t.buffer)}).then(function(t){return sounds[o]=t})}function playSound(t){pxt.options.light||loadSoundAsync(t).done(function(t){return t?audio.play(t,volume):void 0})}function tutorialStep(){playSound("tutorialStep")}function tutorialNext(){playSound("tutorialNext")}function click(){playSound("click")}function initTutorial(){pxt.options.light||Promise.all([loadSoundAsync("tutorialStep"),loadSoundAsync("tutorialNext"),loadSoundAsync("click")]).done()}exports.tutorialStep=tutorialStep,exports.tutorialNext=tutorialNext,exports.click=click,exports.initTutorial=initTutorial;

},{"./audio":4}],43:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),Editor=function(){function t(t){this.parent=t,this.isVisible=!1,this.changeCallback=function(){},this.isReady=!1}return t.prototype.setVisible=function(t){this.isVisible=t},t.prototype.acceptsFile=function(t){return!1},t.prototype.getViewState=function(){return{}},t.prototype.getCurrentSource=function(){return this.currSource},t.prototype.getId=function(){return"editor"},t.prototype.displayOuter=function(){return React.createElement("div",{className:"full-abs",key:this.getId(),id:this.getId(),style:{display:this.isVisible?"block":"none"}},this.display())},t.prototype.display=function(){return null},t.prototype.beforeCompile=function(){},t.prototype.prepare=function(){this.isReady=!0},t.prototype.resize=function(t){},t.prototype.snapshotState=function(){return null},t.prototype.unloadFileAsync=function(){return Promise.resolve()},t.prototype.isIncomplete=function(){return!1},t.prototype.hasHistory=function(){return!0},t.prototype.hasUndo=function(){return!0},t.prototype.hasRedo=function(){return!0},t.prototype.undo=function(){},t.prototype.redo=function(){},t.prototype.zoomIn=function(){},t.prototype.zoomOut=function(){},t.prototype.setScale=function(t){},t.prototype.closeFlyout=function(){},t.prototype.loadFileAsync=function(t,o){return this.currSource=t.content,this.setDiagnostics(t,this.snapshotState()),Promise.resolve()},t.prototype.domUpdate=function(){},t.prototype.setDiagnostics=function(t,o){},t.prototype.setViewState=function(t){},t.prototype.saveToTypeScript=function(){return Promise.resolve("")},t.prototype.highlightStatement=function(t,o){return!1},t.prototype.clearHighlightedStatements=function(){},t.prototype.filterToolbox=function(t,o){return void 0===o&&(o=pxt.toolbox.CategoryMode.All),null},t.prototype.setHighContrast=function(t){},t.prototype.hasEditorToolbar=function(){return!0},t}();exports.Editor=Editor;

},{"react":269}],44:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),ReactDOM=require("react-dom"),data=require("./data"),core=require("./core");function cx(e){return e.filter(function(e){return!!e&&""!=e.trim()}).join(" ")}function genericClassName(e,t,n){return void 0===n&&(n=!1),e+" "+(n?"":t.icon&&t.text?"icon icon-and-text":t.icon?"icon":"")+" "+(t.class||"")}function genericContent(e){var t=[e.icon?React.createElement(Icon,{key:"iconkey",icon:e.icon+(e.text?" icon-and-text ":"")+(e.iconClass?" "+e.iconClass:"")}):null,e.text?React.createElement("span",{key:"textkey",className:"ui text"+(e.textClass?" "+e.textClass:"")},e.text):null];return e.icon&&e.rightIcon&&(t=t.reverse()),t}function popupWindow(e,t,n,o){return window.open(e,t,"resizable=no, copyhistory=no, width="+n+", height="+o+", top="+(screen.height/2-o/2)+", left="+(screen.width/2-n/2))}function removeClass(e,t){e.classList?e.classList.remove(t):e.className.indexOf(t)>=0&&e.className.replace(new RegExp("(?:^|\\s)"+t+"(?:\\s|$)")," ")}function fireClickOnEnter(e){var t="number"==typeof e.which?e.which:e.keyCode;t!==core.ENTER_KEY&&t!==core.SPACE_KEY||(e.preventDefault(),e.currentTarget.click())}exports.cx=cx,exports.popupWindow=popupWindow,exports.fireClickOnEnter=fireClickOnEnter;var UiElement=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.popup=function(){if(this.props.popup){var e=this.child("");e.popup({content:this.props.popup}),e.data("hasPopupHide")||(e.data("hasPopupHide","yes"),e.on("click",function(){e.popup("hide")}))}},t.prototype.componentDidMount=function(){this.popup()},t.prototype.componentDidUpdate=function(){this.popup()},t}(data.Component);exports.UiElement=UiElement;var DropdownMenuItem=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isOpened=!1,t.preventHide=!1,t.menuItemKeyDown=function(e){var n="number"==typeof e.which?e.which:e.keyCode;n===core.TAB_KEY?t.close():n!==core.ENTER_KEY&&n!==core.SPACE_KEY||t.child("").focus()},t.dropDownKeyDown=function(e){var n="number"==typeof e.which?e.which:e.keyCode;n!==core.ENTER_KEY&&n!==core.SPACE_KEY||(t.isOpened?t.child("").dropdown("hide"):t.child("").dropdown("show"))},t}return __extends(t,e),t.prototype.close=function(){this.preventHide=!1,this.child("").dropdown("hide")},t.prototype.componentDidMount=function(){var e=this;this.popup();var t=this.child("");t.on("keydown",this.dropDownKeyDown),t.dropdown({action:function(t,n,o){e.close(),"function"==typeof o.get&&"a"===o.get(0).tagName.toLowerCase()&&window.open(o.get(0).href,"_blank")},fullTextSearch:!0,onChange:function(t,n,o){e.preventHide=!0,o.get(0).focus(),e.props.onChange&&t!=e.props.value&&e.props.onChange(t)},onShow:function(){e.isOpened=!0,e.forceUpdate(),e.child(".item").each(function(t,n){n.onkeydown=e.menuItemKeyDown})},onHide:function(){return e.preventHide?(e.preventHide=!1,!1):(e.isOpened=!1,e.forceUpdate(),!0)}})},t.prototype.componentDidUpdate=function(){this.child("").dropdown("refresh"),this.popup()},t.prototype.renderCore=function(){return React.createElement("div",{className:genericClassName("ui dropdown item",this.props),role:"menuitem",title:this.props.title,tabIndex:this.props.tabIndex,"aria-haspopup":"true"},genericContent(this.props),React.createElement("div",{className:"menu",role:"menu","aria-expanded":this.isOpened,"aria-label":lf("Dropdown menu {0}",this.props.title),"aria-hidden":!this.isOpened},this.props.children))},t}(UiElement);exports.DropdownMenuItem=DropdownMenuItem;var Icon=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.renderCore=function(){return React.createElement("i",{className:"icon "+this.props.icon,onClick:this.props.onClick,"aria-hidden":!0,role:"presentation"},this.props.children)},t}(data.Component);exports.Icon=Icon;var Item=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.renderCore=function(){var e=this.props,t=e.text,n=e.title,o=e.ariaLabel;return React.createElement("div",{className:genericClassName("ui item link",this.props,!0)+" "+(this.props.active?"active":""),role:this.props.role,"aria-label":o||n||t,title:n||t,tabIndex:this.props.tabIndex||0,key:this.props.value,"data-value":this.props.value,onClick:this.props.onClick,onKeyDown:this.props.onKeyDown||fireClickOnEnter},genericContent(this.props),this.props.children)},t}(data.Component);exports.Item=Item;var ButtonMenuItem=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.renderCore=function(){return React.createElement("div",{className:genericClassName("ui item link",this.props,!0)+" "+(this.props.active?"active":""),role:this.props.role,title:this.props.title||this.props.text,tabIndex:this.props.tabIndex||0,key:this.props.value,"data-value":this.props.value,onClick:this.props.onClick,onKeyDown:this.props.onKeyDown||fireClickOnEnter},React.createElement("div",{className:genericClassName("ui button",this.props)},genericContent(this.props),this.props.children))},t}(UiElement);exports.ButtonMenuItem=ButtonMenuItem;var Button=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.renderCore=function(){return React.createElement("button",{className:genericClassName("ui button",this.props)+" "+(this.props.disabled?"disabled":""),id:this.props.id,role:this.props.role,title:this.props.title,tabIndex:this.props.tabIndex||0,"aria-label":this.props.ariaLabel,"aria-expanded":this.props.ariaExpanded,onClick:this.props.onClick,onKeyDown:this.props.onKeyDown},genericContent(this.props),this.props.children)},t}(UiElement);exports.Button=Button;var Link=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.renderCore=function(){return React.createElement("a",{className:genericClassName("ui",this.props)+" "+(this.props.disabled?"disabled":""),id:this.props.id,href:this.props.href,target:this.props.target,role:this.props.role,title:this.props.title,tabIndex:this.props.tabIndex||0,"aria-label":this.props.ariaLabel,"aria-expanded":this.props.ariaExpanded,onClick:this.props.onClick,onKeyDown:this.props.onKeyDown},genericContent(this.props),this.props.children)},t}(UiElement);exports.Link=Link;var Popup=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.componentDidMount=function(){this.child(".popup-button").popup({position:"bottom right",on:"click",hoverable:!0,delay:{show:50,hide:1e3}})},t.prototype.componentDidUpdate=function(){this.child(".popup-button").popup("refresh")},t.prototype.renderCore=function(){return React.createElement("div",{role:this.props.role},React.createElement("div",{className:genericClassName("ui button popup-button",this.props)},genericContent(this.props)),React.createElement("div",{className:"ui popup transition hidden"},this.props.children))},t}(data.Component);exports.Popup=Popup;var Field=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.renderCore=function(){return React.createElement("div",{className:"field"},this.props.label?React.createElement("label",{htmlFor:this.props.ariaLabel?void 0:this.props.htmlFor},this.props.label):null,this.props.ariaLabel&&this.props.htmlFor?React.createElement("label",{htmlFor:this.props.htmlFor,className:"accessible-hidden"},this.props.ariaLabel):"",this.props.children)},t}(data.Component);exports.Field=Field;var Input=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.clearValue=function(){this.setState({value:void 0})},t.prototype.copy=function(){var e,t=this.props,n=ReactDOM.findDOMNode(this);t.lines&&1!=t.lines?((e=n.getElementsByTagName("textarea")[0]).focus(),e.setSelectionRange(0,9999)):((e=n.getElementsByTagName("input")[0]).focus(),e.setSelectionRange(0,9999));try{var o=document.execCommand("copy");pxt.debug("copy: "+o)}catch(e){}},t.prototype.renderCore=function(){var e=this,t=this.props,n=t.copy&&document.queryCommandSupported("copy")?React.createElement(Button,{class:"ui right labeled primary icon button",text:lf("Copy"),icon:"copy",onClick:function(){return e.copy()}}):null,o=this.state&&void 0!==this.state.value?this.state.value:t.value,i=function(n){t.readOnly||e.state&&e.state.value===n||e.setState({value:n}),t.onChange&&t.onChange(n)};return React.createElement(Field,{ariaLabel:t.ariaLabel,htmlFor:t.id,label:t.label},React.createElement("div",{className:"ui input"+(t.inputLabel?" labelled":"")+(t.copy?" action fluid":"")+(t.disabled?" disabled":"")},t.inputLabel?React.createElement("div",{className:"ui label"},t.inputLabel):"",t.lines&&1!=t.lines?React.createElement("textarea",{id:t.id,className:"ui input "+(t.class||"")+(t.inputLabel?" labelled":""),rows:t.lines,placeholder:t.placeholder,value:o,readOnly:!!t.readOnly,onClick:function(e){return t.selectOnClick?e.target.setSelectionRange(0,9999):void 0},onChange:function(e){return i(e.target.value)}}):React.createElement("input",{id:t.id,className:t.class||"",type:t.type||"text",placeholder:t.placeholder,value:o,readOnly:!!t.readOnly,onClick:function(e){return t.selectOnClick?e.target.setSelectionRange(0,9999):void 0},onChange:function(e){return i(e.target.value)}}),n))},t}(data.Component);exports.Input=Input;var Checkbox=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.renderCore=function(){var e=this.props;return React.createElement(Field,{label:e.label},React.createElement("div",{className:"ui toggle checkbox"},React.createElement("input",{type:"checkbox",checked:e.checked,onChange:function(t){return e.onChange(t.target.value)}}),e.inputLabel?React.createElement("label",null,e.inputLabel):void 0))},t}(data.Component);exports.Checkbox=Checkbox;var Segment=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.renderCore=function(){var e=this.props,t=e.attached,n=e.basic,o=e.children,i=e.circular,r=e.className,a=e.clearing,s=e.color,l=e.compact,c=e.disabled,p=e.floated,d=e.inverted,u=e.loading,h=e.padded,m=e.piled,f=e.raised,v=e.secondary,g=e.size,y=e.stacked,C=e.tertiary,b=e.textAlign,x=e.vertical,N=cx(["ui",s,g,n?"basic":"",i?"circular":"",a?"clearing":"",l?"compact":"",c?"disabled":"",d?"inverted":"",u?"loading":"",m?"piled":"",f?"raised":"",v?"secondary":"",y?"stacked":"",C?"tertiary":"",x?"vertical":"",t?t+" attached":"",h?h+" padded":"",b?"justified"==b?"justified":b+" aligned":"",p?p+" floated":"","segment",r]);return React.createElement("div",{className:N},o)},t}(data.Component);exports.Segment=Segment;var MenuItem=function(e){function t(t){var n=e.call(this,t)||this;return n.handleClick=function(e){var t=n.props.onClick;t&&t(e,n.props)},n}return __extends(t,e),t.prototype.renderCore=function(){var e=this.props,t=e.active,n=e.children,o=e.className,i=e.color,r=e.content,a=e.fitted,s=e.header,l=e.icon,c=e.link,p=e.name,d=e.onClick,u=e.position,h=e.ariaControls,m=e.id,f=cx([i,u,t?"active":"",!0===l||l&&!p&&!r?"icon":"",s?"header":"",c||d?"link":"",a?1==a?""+a:"fitted "+a:"","item",o]);return n?React.createElement("div",{className:f,onClick:this.handleClick},n):React.createElement("div",{id:m,tabIndex:t?0:-1,className:f,onClick:this.handleClick,role:"tab","aria-controls":h,"aria-selected":t,"aria-label":r||p},l?React.createElement(Icon,{icon:l}):void 0,r||p)},t}(data.Component);exports.MenuItem=MenuItem;var Menu=function(e){function t(t){var n=e.call(this,t)||this;return n.handleKeyboardNavigation=function(e){var t="number"==typeof e.which?e.which:e.keyCode,o=37===t||38===t,i=39===t||40===t;if(o||i){for(var r,a=n.child(".link"),s=-1,l=0;-1===s&&l<a.length;)a.get(l).classList.contains("active")&&(s=l),l++;if(-1!==s)o&&!pxt.Util.isUserLanguageRtl()||i&&pxt.Util.isUserLanguageRtl()?r=0===s?a.get(a.length-1):a.get(s-1):(i&&!pxt.Util.isUserLanguageRtl()||o&&pxt.Util.isUserLanguageRtl())&&(r=s===a.length-1?a.get(0):a.get(s+1)),void 0!==r&&(r.click(),r.focus())}},n}return __extends(t,e),t.prototype.componentDidMount=function(){var e=this;this.child(".link").each(function(t,n){n.onkeydown=e.handleKeyboardNavigation})},t.prototype.renderCore=function(){var e=this.props,t=e.attached,n=e.borderless,o=e.children,i=e.className,r=e.color,a=e.compact,s=e.fixed,l=e.floated,c=e.fluid,p=e.icon,d=e.inverted,u=e.pagination,h=e.pointing,m=e.secondary,f=e.size,v=e.stackable,g=e.tabular,y=e.text,C=e.vertical,b=cx(["ui",r,f,n?"borderless":"",a?"compact":"",c?"fluid":"",d?"inverted":"",u?"pagination":"",h?"pointing":"",m?"secondary":"",v?"stackable":"",y?"text":"",C?"vertical":"",t?1==t?"attached":t+" attached ":"",l?1==l?"floated":l+" floated":"",p?1==p?"icon":p+" icon":"",g?1==g?"tabular":g+" tabular":"",s?"tabular "+g:"",i,"menu"]);return React.createElement("div",{className:b,role:"tablist"},o)},t}(data.Component);exports.Menu=Menu;var Modal=function(e){function t(t){var n=e.call(this,t)||this;return n.getMountNode=function(){return n.props.mountNode||document.body},n.handleClose=function(e){0!=n.state.open&&n.setState({open:!1});var t=n.props.onClose;t&&t(e,n.props)},n.handleOpen=function(e){var t=n.props.onOpen;t&&t(e,n.props),1!=n.state.open&&n.setState({open:!0,scrolling:!1})},n.setPosition=function(){if(n.ref){var e=n.props.dimmer,t=n.getMountNode(),o=void 0;o=n.ref.parentElement?n.ref.getBoundingClientRect().height:0,e&&(t.classList.add("dimmable"),t.classList.add("dimmed"));var i=-Math.round(o/2),r="home"==n.props.size||o>=window.innerHeight,a={};n.state.marginTop!==i&&(a.marginTop=i),n.state.scrolling!==r&&(a.scrolling=r,r?t.classList.add("scrolling"):t.classList.remove("scrolling")),Object.keys(a).length>0&&(n.setState(a),n.props.onPositionChanged&&n.props.onPositionChanged(n.props))}n.animationId=requestAnimationFrame(n.setPosition)},n.handlePortalMount=function(){var e=n.props.dimmer,t=n.getMountNode();e&&(t.classList.add("dimmable"),t.classList.add("dimmed"),"blurring"!==e||pxt.options.light||t.classList.add("blurring")),n.setPosition()},n.handleRef=function(e){return n.ref=e},n.handlePortalUnmount=function(){var e=n.getMountNode();e.classList.remove("blurring"),e.classList.remove("dimmable"),e.classList.remove("dimmed"),e.classList.remove("scrolling"),n.animationId&&cancelAnimationFrame(n.animationId)},n.id=ts.pxtc.Util.guidGen(),n.state={open:n.props.open,scrolling:!1},n}return __extends(t,e),t.prototype.componentWillUnmount=function(){this.handlePortalUnmount()},t.prototype.componentWillMount=function(){var e=this.props.open;this.setState({open:e})},t.prototype.componentWillReceiveProps=function(e){var t={};void 0!=e.open&&(t.open=e.open,t.scrolling=!1),Object.keys(t).length>0&&this.setState(t)},t.prototype.renderCore=function(){var e=this,t=this.state.open,n=this.props,o=n.basic,i=n.children,r=n.className,a=n.closeIcon,s=n.closeOnDimmerClick,l=n.closeOnDocumentClick,c=n.closeOnEscape,p=n.dimmer,d=n.dimmerClassName,u=n.size,h=n.longer,m=n.allowResetFocus,f=this.state,v=f.marginTop,g=f.scrolling,y=cx(["ui",u,h?"longer":"",o?"basic":"",g?"scrolling":"","modal transition visible active",r]),C=!0===a?"close":a,b=React.createElement("div",{className:y,style:{marginTop:v},ref:this.handleRef,role:"dialog","aria-labelledby":this.props.header?this.id+"title":void 0,"aria-describedby":this.props.description?this.id+"description":this.id+"desc"},this.props.header?React.createElement("div",{id:this.id+"title",className:"header "+(this.props.headerClass||"")},this.props.header,this.props.helpUrl?React.createElement("a",{className:"ui huge icon clear focused",href:this.props.helpUrl,target:"_docs",role:"button","aria-label":lf("Help on {0} dialog",this.props.header)},React.createElement(Icon,{icon:"help"})):void 0):void 0,this.props.description?React.createElement("label",{id:this.id+"description",className:"accessible-hidden"},this.props.description):void 0,React.createElement("div",{id:this.id+"desc",className:(h?"scrolling":"")+" content"},i),this.props.actions&&this.props.actions.length>0?React.createElement("div",{className:"actions"},this.props.actions.map(function(e){return React.createElement(Button,{key:"action_"+e.label,icon:e.icon,text:e.label,class:"approve "+(e.icon?"icon right labeled":"")+" "+(e.className||"")+" "+(e.loading?"loading disabled":"")+" focused",onClick:function(){e.onClick()},onKeyDown:fireClickOnEnter})})):void 0,a?React.createElement(Button,{icon:C,class:"huge clear right floated closeIcon focused",onClick:function(){return e.handleClose(null)},tabIndex:0,ariaLabel:lf("Close dialog")}):void 0),x=p?cx([core.highContrast?"hc":"","ui",u,"inverted"===p?"inverted":"",pxt.options.light?"":"transition","page modals dimmer visible active",d]):null;return React.createElement(Portal,{closeOnRootNodeClick:s,closeOnDocumentClick:l,closeOnEscape:c,className:x,mountNode:this.getMountNode(),onMount:this.handlePortalMount,onUnmount:this.handlePortalUnmount,onClose:this.handleClose,onOpen:this.handleOpen,open:t,allowResetFocus:m},b)},t}(data.Component);exports.Modal=Modal;var Portal=function(e){function t(t){var n=e.call(this,t)||this;return n.handleDocumentClick=function(e){var t=n.props,o=t.closeOnDocumentClick,i=t.closeOnRootNodeClick;if(n.rootNode&&n.portalNode&&!n.portalNode.contains(e.target)){var r=n.rootNode.contains(e.target);(o&&!r||i&&r)&&n.close(e)}},n.handleEscape=function(e){27===("number"==typeof e.which?e.which:e.keyCode)&&(n.props.closeOnEscape&&(e.preventDefault(),n.close(e)))},n.close=function(e){0!=n.state.open&&n.setState({open:!1});var t=n.props.onClose;t&&t(e)},n.open=function(e){var t=n.props.onOpen;t&&t(e),1!=n.state.open&&n.setState({open:!0})},n.mountPortal=function(){if(!n.rootNode){var e=n.props.mountNode,t=void 0===e?document.body:e;n.rootNode=document.createElement("div"),t.appendChild(n.rootNode),document.addEventListener("click",n.handleDocumentClick),document.addEventListener("keydown",n.handleEscape,!0);var o=n.props.onMount;o&&o()}},n.unmountPortal=function(){if(n.rootNode){ReactDOM.unmountComponentAtNode(n.rootNode),n.rootNode.parentNode.removeChild(n.rootNode),n.rootNode=null,n.portalNode=null,document.removeEventListener("click",n.handleDocumentClick),document.removeEventListener("keydown",n.handleEscape,!0);var e=n.props.onUnmount;e&&e(),null!==n.focusedNodeBeforeOpening&&(n.focusedNodeBeforeOpening.focus(),n.focusedNodeBeforeOpening=null)}},n.focusedNodeBeforeOpening=null,n}return __extends(t,e),t.prototype.componentDidMount=function(){this.state.open&&this.renderPortal()},t.prototype.componentDidUpdate=function(e,t){this.state.open&&this.renderPortal(),t.open&&!this.state.open&&this.unmountPortal()},t.prototype.componentWillUnmount=function(){this.unmountPortal()},t.prototype.componentWillMount=function(){var e=this.props.open;this.setState({open:e})},t.prototype.componentWillReceiveProps=function(e){var t={};void 0!=e.open&&(t.open=e.open),Object.keys(t).length>0&&this.setState(t)},t.prototype.renderPortal=function(){var e=this.props,t=e.children,n=e.className,o=e.allowResetFocus;this.mountPortal(),this.rootNode.className=n||"",ReactDOM.unstable_renderSubtreeIntoContainer(this,React.Children.only(t),this.rootNode),null===this.focusedNodeBeforeOpening&&(this.focusedNodeBeforeOpening=document.activeElement),this.portalNode=this.rootNode.firstElementChild,core.initializeFocusTabIndex(this.portalNode,o)},t.prototype.renderCore=function(){return React.createElement("div",null)},t}(data.Component);exports.Portal=Portal;

},{"./core":13,"./data":14,"react":269,"react-dom":142}],45:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var iface,pkg=require("./package"),compiler=require("./compiler");function td2tsAsync(e){return iface||(iface=pxt.worker.makeWebWorker(pxt.webConfig.tdworkerjs)),pkg.mainPkg.getCompileOptionsAsync().then(function(e){return e.ast=!0,compiler.workerOpAsync("compileTd",{options:e})}).then(function(t){var r={text:e,useExtensions:!0,apiInfo:t};return iface.opAsync("td2ts",r)}).then(function(e){return pxt.debug(e),e.text})}exports.td2tsAsync=td2tsAsync;

},{"./compiler":11,"./package":32}],46:[function(require,module,exports){
"use strict";var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(exports,"__esModule",{value:!0});var React=require("react"),data=require("./data"),sui=require("./sui"),sounds=require("./sounds"),core=require("./core"),TutorialMenuItem=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e.prototype.openTutorialStep=function(t){var e=this.props.parent.state.tutorialOptions;e.tutorialStep=t,pxt.tickEvent("tutorial.step",{tutorial:e.tutorial,step:t},{interactiveConsent:!0}),this.props.parent.setTutorialStep(t)},e.prototype.render=function(){var t=this,e=this.props.parent.state.tutorialOptions,o=e.tutorialReady,n=e.tutorialStepInfo,i=e.tutorialStep;return o?React.createElement("div",{className:"ui item"},React.createElement("div",{className:"ui item tutorial-menuitem",role:"menubar"},n.map(function(e,n){return n==i?React.createElement("span",{className:"step-label",key:"tutorialStep"+n},React.createElement("a",{className:"ui circular label "+(i==n?"blue selected":"inverted")+" "+(o?"":"disabled"),role:"menuitem","aria-label":lf("Tutorial step {0}. This is the current step",n+1),tabIndex:0,onClick:function(){return t.openTutorialStep(n)},onKeyDown:sui.fireClickOnEnter},n+1)):React.createElement("span",{className:"step-label",key:"tutorialStep"+n,"data-tooltip":""+(n+1),"data-inverted":"","data-position":"bottom center"},React.createElement("a",{className:"ui empty circular label "+(o?"":"disabled")+" clear",role:"menuitem","aria-label":lf("Tutorial step {0}",n+1),tabIndex:0,onClick:function(){return t.openTutorialStep(n)},onKeyDown:sui.fireClickOnEnter}))}))):React.createElement("div",null)},e}(data.Component);exports.TutorialMenuItem=TutorialMenuItem;var TutorialContent=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e.notify=function(t){var e=document.getElementById("tutorialcontent");e&&e.contentWindow&&e.contentWindow.postMessage(t,"*")},e.prototype.setPath=function(t){var e=(pxt.webConfig.docsUrl||"/--docs")+"#tutorial:"+t+":"+(this.props.parent.isBlocksEditor()?"blocks":"js")+":"+pxt.Util.localeInfo();this.setUrl(e)},e.prototype.setUrl=function(t){var e=document.getElementById("tutorialcontent");e?e.src=t:this.setState({tutorialUrl:t})},e.prototype.shouldComponentUpdate=function(t,e,o){return this.state.tutorialUrl!=e.tutorialUrl},e.refresh=function(){sounds.tutorialStep(),$("#root").dimmer({closable:!0,onShow:function(){document.getElementById("tutorialOkButton").focus()}}).dimmer("show")},e.prototype.renderCore=function(){var t=this.state.tutorialUrl;return t?React.createElement("iframe",{id:"tutorialcontent",style:{width:"1px",height:"1px"},src:t,role:"complementary",sandbox:"allow-scripts allow-same-origin allow-popups allow-forms"}):null},e}(data.Component);exports.TutorialContent=TutorialContent;var TutorialHint=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e.prototype.showHint=function(){this.setState({visible:!0})},e.prototype.renderCore=function(){var t=this,e=this.state.visible,o=this.props.parent.state.tutorialOptions,n=o.tutorialReady,i=o.tutorialStepInfo,r=o.tutorialStep,a=o.tutorialName;if(!n)return React.createElement("div",null);var l=i[r],s=l.content,u=l.fullscreen,c=!!l.unplugged&&r<i.length-1,p=u?l.titleContent||a:lf("Hint"),d=function(){return t.setState({visible:!1})},h=[c?{label:lf("Next"),onClick:function(){var e=r+1;o.tutorialStep=e,pxt.tickEvent("tutorial.hint.next",{tutorial:o.tutorial,step:e}),t.props.parent.setTutorialStep(e)},icon:"check",className:"green"}:{label:lf("Ok"),onClick:d,icon:"check",className:"green"}];return React.createElement(sui.Modal,{open:e,className:"hintdialog",size:"",longer:!0,header:p,closeIcon:!0,onClose:d,dimmer:!0,actions:h,closeOnDimmerClick:!0,closeOnDocumentClick:!0,closeOnEscape:!0},React.createElement("div",{dangerouslySetInnerHTML:{__html:s}}))},e}(data.Component);exports.TutorialHint=TutorialHint;var TutorialCard=function(t){function e(e){var o=t.call(this,e)||this;return o.closeLightboxOnEscape=function(t){27===("number"==typeof t.which?t.which:t.keyCode)&&o.closeLightbox()},o}return __extends(e,t),e.prototype.previousTutorialStep=function(){var t=this.props.parent.state.tutorialOptions,e=t.tutorialStep-1;t.tutorialStep=e,pxt.tickEvent("tutorial.previous",{tutorial:t.tutorial,step:e},{interactiveConsent:!0}),this.props.parent.setTutorialStep(e)},e.prototype.nextTutorialStep=function(){var t=this.props.parent.state.tutorialOptions,e=t.tutorialStep+1;t.tutorialStep=e,pxt.tickEvent("tutorial.next",{tutorial:t.tutorial,step:e},{interactiveConsent:!0}),this.props.parent.setTutorialStep(e)},e.prototype.finishTutorial=function(){this.closeLightbox(),this.props.parent.completeTutorial()},e.prototype.closeLightbox=function(){sounds.tutorialNext(),document.documentElement.removeEventListener("keydown",this.closeLightboxOnEscape),core.initializeFocusTabIndex($("#tutorialcard").get(0),!0,void 0,!0);var t=document.getElementsByClassName("tutorialmessage");t.length>0&&t.item(0).focus(),$("#root").dimmer("hide")},e.prototype.componentWillUpdate=function(){$("#tutorialhint").modal("attach events","#tutorialcard .ui.button.hintbutton","show"),document.documentElement.addEventListener("keydown",this.closeLightboxOnEscape)},e.prototype.componentDidUpdate=function(){if(!this.focusInitialized){var t=document.getElementById("tutorialcard");null!==t&&(this.focusInitialized=!0,core.initializeFocusTabIndex(t,!0,!1))}},e.prototype.showHint=function(){this.closeLightbox(),this.props.parent.showTutorialHint()},e.prototype.render=function(){var t=this,e=this.props.parent.state.tutorialOptions,o=e.tutorialReady,n=e.tutorialStepInfo,i=e.tutorialStep;if(!o)return React.createElement("div",null);var r=n[i].headerContent,a=n[i].ariaLabel,l=i,s=n.length,u=o&&l!=s-1,c=l==s-1,p=n[i].hasHint;return p&&(a+=lf("Press Space or Enter to show a hint.")),React.createElement("div",{id:"tutorialcard",className:"ui "+(o?"tutorialReady":"")},React.createElement("div",{className:"ui buttons"},React.createElement("div",{className:"ui segment attached tutorialsegment"},React.createElement("div",{className:"avatar-image",onClick:function(){return t.showHint()},onKeyDown:sui.fireClickOnEnter}),p?React.createElement(sui.Button,{class:"mini blue hintbutton hidelightbox",text:lf("Hint"),tabIndex:-1,onClick:function(){return t.showHint()},onKeyDown:sui.fireClickOnEnter}):void 0,React.createElement("div",{className:"tutorialmessage "+(p?"focused":void 0),role:"alert","aria-label":a,tabIndex:p?0:-1,onClick:function(){p&&t.showHint()},onKeyDown:sui.fireClickOnEnter},React.createElement("div",{className:"content",dangerouslySetInnerHTML:{__html:r}})),React.createElement(sui.Button,{id:"tutorialOkButton",class:"large green okbutton showlightbox focused",text:lf("Ok"),onClick:function(){return t.closeLightbox()},onKeyDown:sui.fireClickOnEnter})),u?React.createElement(sui.Button,{icon:"right chevron",rightIcon:!0,class:"nextbutton right attached green "+(u?"":"disabled"),text:lf("Next"),ariaLabel:lf("Go to the next step of the tutorial."),onClick:function(){return t.nextTutorialStep()},onKeyDown:sui.fireClickOnEnter}):void 0,c?React.createElement(sui.Button,{icon:"left checkmark",class:"orange right attached "+(o?"focused":"disabled"),text:lf("Finish"),ariaLabel:lf("Finish the tutorial."),onClick:function(){return t.finishTutorial()},onKeyDown:sui.fireClickOnEnter}):void 0))},e}(data.Component);exports.TutorialCard=TutorialCard;

},{"./core":13,"./data":14,"./sounds":42,"./sui":44,"react":269}],47:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var impl,sessionID,db=require("./db"),core=require("./core"),data=require("./data"),cloudworkspace=require("./cloudworkspace"),fileworkspace=require("./fileworkspace"),memoryworkspace=require("./memoryworkspace"),iframeworkspace=require("./iframeworkspace"),scripts=new db.Table("script"),U=pxt.Util,Cloud=pxt.Cloud;function setupWorkspace(e){switch(U.assert(!impl,"workspace set twice"),pxt.debug("workspace: "+e),e){case"fs":case"file":impl=fileworkspace.provider;break;case"mem":case"memory":impl=memoryworkspace.provider;break;case"iframe":impl=iframeworkspace.provider;break;case"uwp":impl=data.wrapWorkspace(pxt.winrt.workspace.provider);break;case"cloud":default:impl=cloudworkspace.provider}}function getHeaders(e){void 0===e&&(e=!1),checkSession();var s=impl.getHeaders();return e||(s=s.filter(function(e){return!e.isDeleted})),s.sort(function(e,s){return s.recentUse-e.recentUse}),s}function getHeader(e){checkSession();var s=impl.getHeader(e);return s&&!s.isDeleted?s:null}function isSessionOutdated(){return pxt.storage.getLocal("pxt_workspace_session_id")!=sessionID}function checkSession(){isSessionOutdated()&&pxt.Util.assert(!1,"trying to access outdated session")}function initAsync(){return impl||(impl=cloudworkspace.provider),sessionID=ts.pxtc.Util.guidGen(),pxt.storage.setLocal("pxt_workspace_session_id",sessionID),pxt.debug("workspace session: "+sessionID),impl.initAsync(pxt.appTarget.id)}function getTextAsync(e){return checkSession(),impl.getTextAsync(e)}function anonymousPublishAsync(e,s,t){var n={};e.saveId=n;var r=JSON.stringify(s,null,2)+"\n",i={name:e.name,target:e.target,description:t.description,editor:e.editor,text:s,meta:{versions:pxt.appTarget.versions,blocksHeight:t.blocksHeight,blocksWidth:t.blocksWidth}};return pxt.debug("publishing script; "+r.length+" bytes"),Cloud.privatePostAsync("scripts",i).then(function(s){return s.shortid&&(s.id=s.shortid),e.pubId=s.shortid,e.pubCurrent=e.saveId===n,e.meta=s.meta,pxt.debug("published; id /"+e.pubId),saveAsync(e).then(function(){return s})})}function saveAsync(e,s){return checkSession(),(s||e.isDeleted)&&(e.pubCurrent=!1,e.blobCurrent=!1,e.modificationTime=U.nowSeconds()),e.recentUse=U.nowSeconds(),impl.saveAsync(e,s)}function installAsync(e,s){return checkSession(),impl.installAsync(e,s)}function saveScreenshotAsync(e,s,t){return checkSession(),impl.saveScreenshotAsync?impl.saveScreenshotAsync(e,s,t):Promise.resolve()}function fixupFileNames(e){if(!e)return e;for(var s in["kind.json","yelm.json"])!e[pxt.CONFIG_NAME]&&e[s]&&(e[pxt.CONFIG_NAME]=e[s],delete e[s]);return e}exports.setupWorkspace=setupWorkspace,exports.getHeaders=getHeaders,exports.getHeader=getHeader,exports.isSessionOutdated=isSessionOutdated,exports.initAsync=initAsync,exports.getTextAsync=getTextAsync,exports.anonymousPublishAsync=anonymousPublishAsync,exports.saveAsync=saveAsync,exports.installAsync=installAsync,exports.saveScreenshotAsync=saveScreenshotAsync,exports.fixupFileNames=fixupFileNames;var scriptDlQ=new U.PromiseQueue;function getPublishedScriptAsync(e){checkSession(),pxt.github.isGithubId(e)&&(e=pxt.github.noramlizeRepoId(e));var s=encodeURIComponent(e);return pxt.packagesConfigAsync().then(function(t){return scriptDlQ.enqueue(e,function(){return scripts.getAsync(s).then(function(e){return e.files},function(n){return(pxt.github.isGithubId(e)?pxt.github.downloadPackageAsync(e,t).then(function(e){return e.files}):Cloud.downloadScriptFilesAsync(e)).catch(core.handleNetworkError).then(function(e){return scripts.setAsync({id:s,files:e}).then(function(){return e})})}).then(fixupFileNames)})})}function installByIdAsync(e){return Cloud.privateGetAsync(e).then(function(s){return getPublishedScriptAsync(s.id).then(function(t){return installAsync({name:s.name,pubId:e,pubCurrent:!0,meta:s.meta,editor:s.editor,target:s.target},t)})})}function saveToCloudAsync(e){return checkSession(),impl.saveToCloudAsync(e)}function syncAsync(){return checkSession(),impl.syncAsync()}function resetAsync(){return checkSession(),impl.resetAsync()}function loadedAsync(){return checkSession(),impl.loadedAsync()}exports.getPublishedScriptAsync=getPublishedScriptAsync,exports.installByIdAsync=installByIdAsync,exports.saveToCloudAsync=saveToCloudAsync,exports.syncAsync=syncAsync,exports.resetAsync=resetAsync,exports.loadedAsync=loadedAsync,data.mountVirtualApi("header",{getSync:function(e){return"*"==(e=data.stripProtocol(e))?getHeaders():getHeader(e)}}),data.mountVirtualApi("text",{getAsync:function(e){var s=/^[\w\-]+:([^\/]+)(\/(.*))?/.exec(e);return getTextAsync(s[1]).then(function(e){return s[3]?e[s[3]]:e})}});

},{"./cloudworkspace":8,"./core":13,"./data":14,"./db":15,"./fileworkspace":22,"./iframeworkspace":25,"./memoryworkspace":28}],48:[function(require,module,exports){
"use strict";function argsArray(r){return function(){var t=arguments.length;if(t){for(var a=[],n=-1;++n<t;)a[n]=arguments[n];return r.call(this,a)}return r.call(this,[])}}module.exports=argsArray;

},{}],49:[function(require,module,exports){
"use strict";exports.byteLength=byteLength,exports.toByteArray=toByteArray,exports.fromByteArray=fromByteArray;for(var lookup=[],revLookup=[],Arr="undefined"!=typeof Uint8Array?Uint8Array:Array,code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,len=code.length;i<len;++i)lookup[i]=code[i],revLookup[code.charCodeAt(i)]=i;function placeHoldersCount(o){var r=o.length;if(r%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===o[r-2]?2:"="===o[r-1]?1:0}function byteLength(o){return 3*o.length/4-placeHoldersCount(o)}function toByteArray(o){var r,e,t,u,n,p=o.length;u=placeHoldersCount(o),n=new Arr(3*p/4-u),e=u>0?p-4:p;var a=0;for(r=0;r<e;r+=4)t=revLookup[o.charCodeAt(r)]<<18|revLookup[o.charCodeAt(r+1)]<<12|revLookup[o.charCodeAt(r+2)]<<6|revLookup[o.charCodeAt(r+3)],n[a++]=t>>16&255,n[a++]=t>>8&255,n[a++]=255&t;return 2===u?(t=revLookup[o.charCodeAt(r)]<<2|revLookup[o.charCodeAt(r+1)]>>4,n[a++]=255&t):1===u&&(t=revLookup[o.charCodeAt(r)]<<10|revLookup[o.charCodeAt(r+1)]<<4|revLookup[o.charCodeAt(r+2)]>>2,n[a++]=t>>8&255,n[a++]=255&t),n}function tripletToBase64(o){return lookup[o>>18&63]+lookup[o>>12&63]+lookup[o>>6&63]+lookup[63&o]}function encodeChunk(o,r,e){for(var t,u=[],n=r;n<e;n+=3)t=(o[n]<<16&16711680)+(o[n+1]<<8&65280)+(255&o[n+2]),u.push(tripletToBase64(t));return u.join("")}function fromByteArray(o){for(var r,e=o.length,t=e%3,u="",n=[],p=0,a=e-t;p<a;p+=16383)n.push(encodeChunk(o,p,p+16383>a?a:p+16383));return 1===t?(r=o[e-1],u+=lookup[r>>2],u+=lookup[r<<4&63],u+="=="):2===t&&(r=(o[e-2]<<8)+o[e-1],u+=lookup[r>>10],u+=lookup[r>>4&63],u+=lookup[r<<2&63],u+="="),n.push(u),n.join("")}revLookup["-".charCodeAt(0)]=62,revLookup["_".charCodeAt(0)]=63;

},{}],50:[function(require,module,exports){
(function (process,global){
!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.Promise=t()}}(function(){var t,e,n;return function t(e,n,r){function i(s,a){if(!n[s]){if(!e[s]){var c="function"==typeof _dereq_&&_dereq_;if(!a&&c)return c(s,!0);if(o)return o(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var u=n[s]={exports:{}};e[s][0].call(u.exports,function(t){var n=e[s][1][t];return i(n||t)},u,u.exports,t,e,n,r)}return n[s].exports}for(var o="function"==typeof _dereq_&&_dereq_,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(t,e,n){"use strict";e.exports=function(t){var e=t._SomePromiseArray;function n(t){var n=new e(t),r=n.promise();return n.setHowMany(1),n.setUnwrap(),n.init(),r}t.any=function(t){return n(t)},t.prototype.any=function(){return n(this)}}},{}],2:[function(t,e,n){"use strict";var r;try{throw new Error}catch(t){r=t}var i=t("./schedule"),o=t("./queue"),s=t("./util");function a(){this._customScheduler=!1,this._isTickUsed=!1,this._lateQueue=new o(16),this._normalQueue=new o(16),this._haveDrainedQueues=!1,this._trampolineEnabled=!0;var t=this;this.drainQueues=function(){t._drainQueues()},this._schedule=i}function c(t,e,n){this._lateQueue.push(t,e,n),this._queueTick()}function l(t,e,n){this._normalQueue.push(t,e,n),this._queueTick()}function u(t){this._normalQueue._pushOne(t),this._queueTick()}a.prototype.setScheduler=function(t){var e=this._schedule;return this._schedule=t,this._customScheduler=!0,e},a.prototype.hasCustomScheduler=function(){return this._customScheduler},a.prototype.enableTrampoline=function(){this._trampolineEnabled=!0},a.prototype.disableTrampolineIfNecessary=function(){s.hasDevTools&&(this._trampolineEnabled=!1)},a.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues},a.prototype.fatalError=function(t,e){e?(process.stderr.write("Fatal "+(t instanceof Error?t.stack:t)+"\n"),process.exit(2)):this.throwLater(t)},a.prototype.throwLater=function(t,e){if(1===arguments.length&&(e=t,t=function(){throw e}),"undefined"!=typeof setTimeout)setTimeout(function(){t(e)},0);else try{this._schedule(function(){t(e)})}catch(t){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}},s.hasDevTools?(a.prototype.invokeLater=function(t,e,n){this._trampolineEnabled?c.call(this,t,e,n):this._schedule(function(){setTimeout(function(){t.call(e,n)},100)})},a.prototype.invoke=function(t,e,n){this._trampolineEnabled?l.call(this,t,e,n):this._schedule(function(){t.call(e,n)})},a.prototype.settlePromises=function(t){this._trampolineEnabled?u.call(this,t):this._schedule(function(){t._settlePromises()})}):(a.prototype.invokeLater=c,a.prototype.invoke=l,a.prototype.settlePromises=u),a.prototype._drainQueue=function(t){for(;t.length()>0;){var e=t.shift();if("function"==typeof e){var n=t.shift(),r=t.shift();e.call(n,r)}else e._settlePromises()}},a.prototype._drainQueues=function(){this._drainQueue(this._normalQueue),this._reset(),this._haveDrainedQueues=!0,this._drainQueue(this._lateQueue)},a.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},a.prototype._reset=function(){this._isTickUsed=!1},e.exports=a,e.exports.firstLineError=r},{"./queue":26,"./schedule":29,"./util":36}],3:[function(t,e,n){"use strict";e.exports=function(t,e,n,r){var i=!1,o=function(t,e){this._reject(e)},s=function(t,e){e.promiseRejectionQueued=!0,e.bindingPromise._then(o,o,null,this,t)},a=function(t,e){0==(50397184&this._bitField)&&this._resolveCallback(e.target)},c=function(t,e){e.promiseRejectionQueued||this._reject(t)};t.prototype.bind=function(o){i||(i=!0,t.prototype._propagateFrom=r.propagateFromFunction(),t.prototype._boundValue=r.boundValueFunction());var l=n(o),u=new t(e);u._propagateFrom(this,1);var p=this._target();if(u._setBoundTo(l),l instanceof t){var h={promiseRejectionQueued:!1,promise:u,target:p,bindingPromise:l};p._then(e,s,void 0,u,h),l._then(a,c,void 0,u,h),u._setOnCancel(l)}else u._resolveCallback(p);return u},t.prototype._setBoundTo=function(t){void 0!==t?(this._bitField=2097152|this._bitField,this._boundTo=t):this._bitField=-2097153&this._bitField},t.prototype._isBound=function(){return 2097152==(2097152&this._bitField)},t.bind=function(e,n){return t.resolve(n).bind(e)}}},{}],4:[function(t,e,n){"use strict";var r;"undefined"!=typeof Promise&&(r=Promise);var i=t("./promise")();i.noConflict=function(){try{Promise===i&&(Promise=r)}catch(t){}return i},e.exports=i},{"./promise":22}],5:[function(t,e,n){"use strict";var r=Object.create;if(r){var i=r(null),o=r(null);i[" size"]=o[" size"]=0}e.exports=function(e){var n,r=t("./util"),i=r.canEvaluate;r.isIdentifier;function o(t,n){var i;if(null!=t&&(i=t[n]),"function"!=typeof i){var o="Object "+r.classString(t)+" has no method '"+r.toString(n)+"'";throw new e.TypeError(o)}return i}function s(t){return o(t,this.pop()).apply(t,this)}function a(t){return t[this]}function c(t){var e=+this;return e<0&&(e=Math.max(0,e+t.length)),t[e]}e.prototype.call=function(t){var e=[].slice.call(arguments,1);return e.push(t),this._then(s,void 0,void 0,e,void 0)},e.prototype.get=function(t){var e;if("number"==typeof t)e=c;else if(i){var r=n(t);e=null!==r?r:a}else e=a;return this._then(e,void 0,void 0,t,void 0)}}},{"./util":36}],6:[function(t,e,n){"use strict";e.exports=function(e,n,r,i){var o=t("./util"),s=o.tryCatch,a=o.errorObj,c=e._async;e.prototype.break=e.prototype.cancel=function(){if(!i.cancellation())return this._warn("cancellation is disabled");for(var t=this,e=t;t._isCancellable();){if(!t._cancelBy(e)){e._isFollowing()?e._followee().cancel():e._cancelBranched();break}var n=t._cancellationParent;if(null==n||!n._isCancellable()){t._isFollowing()?t._followee().cancel():t._cancelBranched();break}t._isFollowing()&&t._followee().cancel(),t._setWillBeCancelled(),e=t,t=n}},e.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--},e.prototype._enoughBranchesHaveCancelled=function(){return void 0===this._branchesRemainingToCancel||this._branchesRemainingToCancel<=0},e.prototype._cancelBy=function(t){return t===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):(this._branchHasCancelled(),!!this._enoughBranchesHaveCancelled()&&(this._invokeOnCancel(),!0))},e.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()},e.prototype._cancel=function(){this._isCancellable()&&(this._setCancelled(),c.invoke(this._cancelPromises,this,void 0))},e.prototype._cancelPromises=function(){this._length()>0&&this._settlePromises()},e.prototype._unsetOnCancel=function(){this._onCancelField=void 0},e.prototype._isCancellable=function(){return this.isPending()&&!this._isCancelled()},e.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()},e.prototype._doInvokeOnCancel=function(t,e){if(o.isArray(t))for(var n=0;n<t.length;++n)this._doInvokeOnCancel(t[n],e);else if(void 0!==t)if("function"==typeof t){if(!e){var r=s(t).call(this._boundValue());r===a&&(this._attachExtraTrace(r.e),c.throwLater(r.e))}}else t._resultCancelled(this)},e.prototype._invokeOnCancel=function(){var t=this._onCancel();this._unsetOnCancel(),c.invoke(this._doInvokeOnCancel,this,t)},e.prototype._invokeInternalOnCancel=function(){this._isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())},e.prototype._resultCancelled=function(){this.cancel()}}},{"./util":36}],7:[function(t,e,n){"use strict";e.exports=function(e){var n=t("./util"),r=t("./es5").keys,i=n.tryCatch,o=n.errorObj;return function(t,s,a){return function(c){var l=a._boundValue();t:for(var u=0;u<t.length;++u){var p=t[u];if(p===Error||null!=p&&p.prototype instanceof Error){if(c instanceof p)return i(s).call(l,c)}else if("function"==typeof p){var h=i(p).call(l,c);if(h===o)return h;if(h)return i(s).call(l,c)}else if(n.isObject(c)){for(var f=r(p),_=0;_<f.length;++_){var d=f[_];if(p[d]!=c[d])continue t}return i(s).call(l,c)}}return e}}}},{"./es5":13,"./util":36}],8:[function(t,e,n){"use strict";e.exports=function(t){var e=!1,n=[];function r(){this._trace=new r.CapturedTrace(i())}function i(){var t=n.length-1;if(t>=0)return n[t]}return t.prototype._promiseCreated=function(){},t.prototype._pushContext=function(){},t.prototype._popContext=function(){return null},t._peekContext=t.prototype._peekContext=function(){},r.prototype._pushContext=function(){void 0!==this._trace&&(this._trace._promiseCreated=null,n.push(this._trace))},r.prototype._popContext=function(){if(void 0!==this._trace){var t=n.pop(),e=t._promiseCreated;return t._promiseCreated=null,e}return null},r.CapturedTrace=null,r.create=function(){if(e)return new r},r.deactivateLongStackTraces=function(){},r.activateLongStackTraces=function(){var n=t.prototype._pushContext,o=t.prototype._popContext,s=t._peekContext,a=t.prototype._peekContext,c=t.prototype._promiseCreated;r.deactivateLongStackTraces=function(){t.prototype._pushContext=n,t.prototype._popContext=o,t._peekContext=s,t.prototype._peekContext=a,t.prototype._promiseCreated=c,e=!1},e=!0,t.prototype._pushContext=r.prototype._pushContext,t.prototype._popContext=r.prototype._popContext,t._peekContext=t.prototype._peekContext=i,t.prototype._promiseCreated=function(){var t=this._peekContext();t&&null==t._promiseCreated&&(t._promiseCreated=this)}},r}},{}],9:[function(t,e,n){"use strict";e.exports=function(e,n){var r,i,o,s=e._getDomain,a=e._async,c=t("./errors").Warning,l=t("./util"),u=l.canAttachTrace,p=/[\\\/]bluebird[\\\/]js[\\\/](release|debug|instrumented)/,h=/\((?:timers\.js):\d+:\d+\)/,f=/[\/<\(](.+?):(\d+):(\d+)\)?\s*$/,_=null,d=null,v=!1,y=!(0==l.env("BLUEBIRD_DEBUG")),m=!(0==l.env("BLUEBIRD_WARNINGS")||!y&&!l.env("BLUEBIRD_WARNINGS")),g=!(0==l.env("BLUEBIRD_LONG_STACK_TRACES")||!y&&!l.env("BLUEBIRD_LONG_STACK_TRACES")),b=0!=l.env("BLUEBIRD_W_FORGOTTEN_RETURN")&&(m||!!l.env("BLUEBIRD_W_FORGOTTEN_RETURN"));e.prototype.suppressUnhandledRejections=function(){var t=this._target();t._bitField=-1048577&t._bitField|524288},e.prototype._ensurePossibleRejectionHandled=function(){if(0==(524288&this._bitField)){this._setRejectionIsUnhandled();var t=this;setTimeout(function(){t._notifyUnhandledRejection()},1)}},e.prototype._notifyUnhandledRejectionIsHandled=function(){M("rejectionHandled",r,void 0,this)},e.prototype._setReturnedNonUndefined=function(){this._bitField=268435456|this._bitField},e.prototype._returnedNonUndefined=function(){return 0!=(268435456&this._bitField)},e.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var t=this._settledValue();this._setUnhandledRejectionIsNotified(),M("unhandledRejection",i,t,this)}},e.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=262144|this._bitField},e.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-262145&this._bitField},e.prototype._isUnhandledRejectionNotified=function(){return(262144&this._bitField)>0},e.prototype._setRejectionIsUnhandled=function(){this._bitField=1048576|this._bitField},e.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-1048577&this._bitField,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},e.prototype._isRejectionUnhandled=function(){return(1048576&this._bitField)>0},e.prototype._warn=function(t,e,n){return H(t,e,n||this)},e.onPossiblyUnhandledRejection=function(t){var e=s();i="function"==typeof t?null===e?t:l.domainBind(e,t):void 0},e.onUnhandledRejectionHandled=function(t){var e=s();r="function"==typeof t?null===e?t:l.domainBind(e,t):void 0};var w=function(){};e.longStackTraces=function(){if(a.haveItemsQueued()&&!K.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");if(!K.longStackTraces&&Q()){var t=e.prototype._captureStackTrace,r=e.prototype._attachExtraTrace;K.longStackTraces=!0,w=function(){if(a.haveItemsQueued()&&!K.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");e.prototype._captureStackTrace=t,e.prototype._attachExtraTrace=r,n.deactivateLongStackTraces(),a.enableTrampoline(),K.longStackTraces=!1},e.prototype._captureStackTrace=I,e.prototype._attachExtraTrace=L,n.activateLongStackTraces(),a.disableTrampolineIfNecessary()}},e.hasLongStackTraces=function(){return K.longStackTraces&&Q()};var C=function(){try{if("function"==typeof CustomEvent){var t=new CustomEvent("CustomEvent");return l.global.dispatchEvent(t),function(t,e){var n=new CustomEvent(t.toLowerCase(),{detail:e,cancelable:!0});return!l.global.dispatchEvent(n)}}if("function"==typeof Event){t=new Event("CustomEvent");return l.global.dispatchEvent(t),function(t,e){var n=new Event(t.toLowerCase(),{cancelable:!0});return n.detail=e,!l.global.dispatchEvent(n)}}return(t=document.createEvent("CustomEvent")).initCustomEvent("testingtheevent",!1,!0,{}),l.global.dispatchEvent(t),function(t,e){var n=document.createEvent("CustomEvent");return n.initCustomEvent(t.toLowerCase(),!1,!0,e),!l.global.dispatchEvent(n)}}catch(t){}return function(){return!1}}(),j=l.isNode?function(){return process.emit.apply(process,arguments)}:l.global?function(t){var e="on"+t.toLowerCase(),n=l.global[e];return!!n&&(n.apply(l.global,[].slice.call(arguments,1)),!0)}:function(){return!1};function E(t,e){return{promise:e}}var k={promiseCreated:E,promiseFulfilled:E,promiseRejected:E,promiseResolved:E,promiseCancelled:E,promiseChained:function(t,e,n){return{promise:e,child:n}},warning:function(t,e){return{warning:e}},unhandledRejection:function(t,e,n){return{reason:e,promise:n}},rejectionHandled:E},F=function(t){var e=!1;try{e=j.apply(null,arguments)}catch(t){a.throwLater(t),e=!0}var n=!1;try{n=C(t,k[t].apply(null,arguments))}catch(t){a.throwLater(t),n=!0}return n||e};function x(){return!1}function T(t,e,n){var r=this;try{t(e,n,function(t){if("function"!=typeof t)throw new TypeError("onCancel must be a function, got: "+l.toString(t));r._attachCancellationCallback(t)})}catch(t){return t}}function P(t){if(!this._isCancellable())return this;var e=this._onCancel();void 0!==e?l.isArray(e)?e.push(t):this._setOnCancel([e,t]):this._setOnCancel(t)}function R(){return this._onCancelField}function S(t){this._onCancelField=t}function O(){this._cancellationParent=void 0,this._onCancelField=void 0}function A(t,e){if(0!=(1&e)){this._cancellationParent=t;var n=t._branchesRemainingToCancel;void 0===n&&(n=0),t._branchesRemainingToCancel=n+1}0!=(2&e)&&t._isBound()&&this._setBoundTo(t._boundTo)}e.config=function(t){if("longStackTraces"in(t=Object(t))&&(t.longStackTraces?e.longStackTraces():!t.longStackTraces&&e.hasLongStackTraces()&&w()),"warnings"in t){var n=t.warnings;K.warnings=!!n,b=K.warnings,l.isObject(n)&&"wForgottenReturn"in n&&(b=!!n.wForgottenReturn)}if("cancellation"in t&&t.cancellation&&!K.cancellation){if(a.haveItemsQueued())throw new Error("cannot enable cancellation after promises are in use");e.prototype._clearCancellationData=O,e.prototype._propagateFrom=A,e.prototype._onCancel=R,e.prototype._setOnCancel=S,e.prototype._attachCancellationCallback=P,e.prototype._execute=T,D=A,K.cancellation=!0}return"monitoring"in t&&(t.monitoring&&!K.monitoring?(K.monitoring=!0,e.prototype._fireEvent=F):!t.monitoring&&K.monitoring&&(K.monitoring=!1,e.prototype._fireEvent=x)),e},e.prototype._fireEvent=x,e.prototype._execute=function(t,e,n){try{t(e,n)}catch(t){return t}},e.prototype._onCancel=function(){},e.prototype._setOnCancel=function(t){},e.prototype._attachCancellationCallback=function(t){},e.prototype._captureStackTrace=function(){},e.prototype._attachExtraTrace=function(){},e.prototype._clearCancellationData=function(){},e.prototype._propagateFrom=function(t,e){};var D=function(t,e){0!=(2&e)&&t._isBound()&&this._setBoundTo(t._boundTo)};function V(){var t=this._boundTo;return void 0!==t&&t instanceof e?t.isFulfilled()?t.value():void 0:t}function I(){this._trace=new X(this._peekContext())}function L(t,e){if(u(t)){var n=this._trace;if(void 0!==n&&e&&(n=n._parent),void 0!==n)n.attachExtraTrace(t);else if(!t.__stackCleaned__){var r=U(t);l.notEnumerableProp(t,"stack",r.message+"\n"+r.stack.join("\n")),l.notEnumerableProp(t,"__stackCleaned__",!0)}}}function H(t,n,r){if(K.warnings){var i,o=new c(t);if(n)r._attachExtraTrace(o);else if(K.longStackTraces&&(i=e._peekContext()))i.attachExtraTrace(o);else{var s=U(o);o.stack=s.message+"\n"+s.stack.join("\n")}F("warning",o)||B(o,"",!0)}}function N(t){for(var e=[],n=0;n<t.length;++n){var r=t[n],i="    (No stack trace)"===r||_.test(r),o=i&&$(r);i&&!o&&(v&&" "!==r.charAt(0)&&(r="    "+r),e.push(r))}return e}function U(t){var e=t.stack,n=t.toString();return e="string"==typeof e&&e.length>0?function(t){for(var e=t.stack.replace(/\s+$/g,"").split("\n"),n=0;n<e.length;++n){var r=e[n];if("    (No stack trace)"===r||_.test(r))break}return n>0&&"SyntaxError"!=t.name&&(e=e.slice(n)),e}(t):["    (No stack trace)"],{message:n,stack:"SyntaxError"==t.name?e:N(e)}}function B(t,e,n){if("undefined"!=typeof console){var r;if(l.isObject(t)){var i=t.stack;r=e+d(i,t)}else r=e+String(t);"function"==typeof o?o(r,n):"function"!=typeof console.log&&"object"!=typeof console.log||console.log(r)}}function M(t,e,n,r){var i=!1;try{"function"==typeof e&&(i=!0,"rejectionHandled"===t?e(r):e(n,r))}catch(t){a.throwLater(t)}"unhandledRejection"===t?F(t,n,r)||i||B(n,"Unhandled rejection "):F(t,r)}function q(t){var e;if("function"==typeof t)e="[function "+(t.name||"anonymous")+"]";else{e=t&&"function"==typeof t.toString?t.toString():l.toString(t);if(/\[object [a-zA-Z0-9$_]+\]/.test(e))try{e=JSON.stringify(t)}catch(t){}0===e.length&&(e="(empty array)")}return"(<"+function(t){if(t.length<41)return t;return t.substr(0,38)+"..."}(e)+">, no stack trace)"}function Q(){return"function"==typeof W}var $=function(){return!1},z=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;function G(t){var e=t.match(z);if(e)return{fileName:e[1],line:parseInt(e[2],10)}}function X(t){this._parent=t,this._promisesCreated=0;var e=this._length=1+(void 0===t?0:t._length);W(this,X),e>32&&this.uncycle()}l.inherits(X,Error),n.CapturedTrace=X,X.prototype.uncycle=function(){var t=this._length;if(!(t<2)){for(var e=[],n={},r=0,i=this;void 0!==i;++r)e.push(i),i=i._parent;for(r=(t=this._length=r)-1;r>=0;--r){var o=e[r].stack;void 0===n[o]&&(n[o]=r)}for(r=0;r<t;++r){var s=n[e[r].stack];if(void 0!==s&&s!==r){s>0&&(e[s-1]._parent=void 0,e[s-1]._length=1),e[r]._parent=void 0,e[r]._length=1;var a=r>0?e[r-1]:this;s<t-1?(a._parent=e[s+1],a._parent.uncycle(),a._length=a._parent._length+1):(a._parent=void 0,a._length=1);for(var c=a._length+1,l=r-2;l>=0;--l)e[l]._length=c,c++;return}}}},X.prototype.attachExtraTrace=function(t){if(!t.__stackCleaned__){this.uncycle();for(var e=U(t),n=e.message,r=[e.stack],i=this;void 0!==i;)r.push(N(i.stack.split("\n"))),i=i._parent;!function(t){for(var e=t[0],n=1;n<t.length;++n){for(var r=t[n],i=e.length-1,o=e[i],s=-1,a=r.length-1;a>=0;--a)if(r[a]===o){s=a;break}for(a=s;a>=0;--a){var c=r[a];if(e[i]!==c)break;e.pop(),i--}e=r}}(r),function(t){for(var e=0;e<t.length;++e)(0===t[e].length||e+1<t.length&&t[e][0]===t[e+1][0])&&(t.splice(e,1),e--)}(r),l.notEnumerableProp(t,"stack",function(t,e){for(var n=0;n<e.length-1;++n)e[n].push("From previous event:"),e[n]=e[n].join("\n");return n<e.length&&(e[n]=e[n].join("\n")),t+"\n"+e.join("\n")}(n,r)),l.notEnumerableProp(t,"__stackCleaned__",!0)}};var W=function(){var t=/^\s*at\s*/,e=function(t,e){return"string"==typeof t?t:void 0!==e.name&&void 0!==e.message?e.toString():q(e)};if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){Error.stackTraceLimit+=6,_=t,d=e;var n=Error.captureStackTrace;return $=function(t){return p.test(t)},function(t,e){Error.stackTraceLimit+=6,n(t,e),Error.stackTraceLimit-=6}}var r,i=new Error;if("string"==typeof i.stack&&i.stack.split("\n")[0].indexOf("stackDetection@")>=0)return _=/@/,d=e,v=!0,function(t){t.stack=(new Error).stack};try{throw new Error}catch(t){r="stack"in t}return"stack"in i||!r||"number"!=typeof Error.stackTraceLimit?(d=function(t,e){return"string"==typeof t?t:"object"!=typeof e&&"function"!=typeof e||void 0===e.name||void 0===e.message?q(e):e.toString()},null):(_=t,d=e,function(t){Error.stackTraceLimit+=6;try{throw new Error}catch(e){t.stack=e.stack}Error.stackTraceLimit-=6})}();"undefined"!=typeof console&&void 0!==console.warn&&(o=function(t){console.warn(t)},l.isNode&&process.stderr.isTTY?o=function(t,e){var n=e?"[33m":"[31m";console.warn(n+t+"[0m\n")}:l.isNode||"string"!=typeof(new Error).stack||(o=function(t,e){console.warn("%c"+t,e?"color: darkorange":"color: red")}));var K={warnings:m,longStackTraces:!1,cancellation:!1,monitoring:!1};return g&&e.longStackTraces(),{longStackTraces:function(){return K.longStackTraces},warnings:function(){return K.warnings},cancellation:function(){return K.cancellation},monitoring:function(){return K.monitoring},propagateFromFunction:function(){return D},boundValueFunction:function(){return V},checkForgottenReturns:function(t,e,n,r,i){if(void 0===t&&null!==e&&b){if(void 0!==i&&i._returnedNonUndefined())return;if(0==(65535&r._bitField))return;n&&(n+=" ");var o="",s="";if(e._trace){for(var a=e._trace.stack.split("\n"),c=N(a),l=c.length-1;l>=0;--l){var u=c[l];if(!h.test(u)){var p=u.match(f);p&&(o="at "+p[1]+":"+p[2]+":"+p[3]+" ");break}}if(c.length>0){var _=c[0];for(l=0;l<a.length;++l)if(a[l]===_){l>0&&(s="\n"+a[l-1]);break}}}var d="a promise was created in a "+n+"handler "+o+"but was not returned from it, see http://goo.gl/rRqMUw"+s;r._warn(d,!0,e)}},setBounds:function(t,e){if(Q()){for(var n,r,i=t.stack.split("\n"),o=e.stack.split("\n"),s=-1,a=-1,c=0;c<i.length;++c)if(l=G(i[c])){n=l.fileName,s=l.line;break}for(c=0;c<o.length;++c){var l;if(l=G(o[c])){r=l.fileName,a=l.line;break}}s<0||a<0||!n||!r||n!==r||s>=a||($=function(t){if(p.test(t))return!0;var e=G(t);return!!(e&&e.fileName===n&&s<=e.line&&e.line<=a)})}},warn:H,deprecated:function(t,e){var n=t+" is deprecated and will be removed in a future version.";return e&&(n+=" Use "+e+" instead."),H(n)},CapturedTrace:X,fireDomEvent:C,fireGlobalEvent:j}}},{"./errors":12,"./util":36}],10:[function(t,e,n){"use strict";e.exports=function(t){function e(){return this.value}function n(){throw this.reason}t.prototype.return=t.prototype.thenReturn=function(n){return n instanceof t&&n.suppressUnhandledRejections(),this._then(e,void 0,void 0,{value:n},void 0)},t.prototype.throw=t.prototype.thenThrow=function(t){return this._then(n,void 0,void 0,{reason:t},void 0)},t.prototype.catchThrow=function(t){if(arguments.length<=1)return this._then(void 0,n,void 0,{reason:t},void 0);var e=arguments[1];return this.caught(t,function(){throw e})},t.prototype.catchReturn=function(n){if(arguments.length<=1)return n instanceof t&&n.suppressUnhandledRejections(),this._then(void 0,e,void 0,{value:n},void 0);var r=arguments[1];r instanceof t&&r.suppressUnhandledRejections();return this.caught(n,function(){return r})}}},{}],11:[function(t,e,n){"use strict";e.exports=function(t,e){var n=t.reduce,r=t.all;function i(){return r(this)}t.prototype.each=function(t){return n(this,t,e,0)._then(i,void 0,void 0,this,void 0)},t.prototype.mapSeries=function(t){return n(this,t,e,e)},t.each=function(t,r){return n(t,r,e,0)._then(i,void 0,void 0,t,void 0)},t.mapSeries=function(t,r){return n(t,r,e,e)}}},{}],12:[function(t,e,n){"use strict";var r,i,o=t("./es5"),s=o.freeze,a=t("./util"),c=a.inherits,l=a.notEnumerableProp;function u(t,e){function n(r){if(!(this instanceof n))return new n(r);l(this,"message","string"==typeof r?r:e),l(this,"name",t),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this)}return c(n,Error),n}var p=u("Warning","warning"),h=u("CancellationError","cancellation error"),f=u("TimeoutError","timeout error"),_=u("AggregateError","aggregate error");try{r=TypeError,i=RangeError}catch(t){r=u("TypeError","type error"),i=u("RangeError","range error")}for(var d="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),v=0;v<d.length;++v)"function"==typeof Array.prototype[d[v]]&&(_.prototype[d[v]]=Array.prototype[d[v]]);o.defineProperty(_.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),_.prototype.isOperational=!0;var y=0;function m(t){if(!(this instanceof m))return new m(t);l(this,"name","OperationalError"),l(this,"message",t),this.cause=t,this.isOperational=!0,t instanceof Error?(l(this,"message",t.message),l(this,"stack",t.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}_.prototype.toString=function(){var t=Array(4*y+1).join(" "),e="\n"+t+"AggregateError of:\n";y++,t=Array(4*y+1).join(" ");for(var n=0;n<this.length;++n){for(var r=this[n]===this?"[Circular AggregateError]":this[n]+"",i=r.split("\n"),o=0;o<i.length;++o)i[o]=t+i[o];e+=(r=i.join("\n"))+"\n"}return y--,e},c(m,Error);var g=Error.__BluebirdErrorTypes__;g||(g=s({CancellationError:h,TimeoutError:f,OperationalError:m,RejectionError:m,AggregateError:_}),o.defineProperty(Error,"__BluebirdErrorTypes__",{value:g,writable:!1,enumerable:!1,configurable:!1})),e.exports={Error:Error,TypeError:r,RangeError:i,CancellationError:g.CancellationError,OperationalError:g.OperationalError,TimeoutError:g.TimeoutError,AggregateError:g.AggregateError,Warning:p}},{"./es5":13,"./util":36}],13:[function(t,e,n){var r=function(){"use strict";return void 0===this}();if(r)e.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:r,propertyIsWritable:function(t,e){var n=Object.getOwnPropertyDescriptor(t,e);return!(n&&!n.writable&&!n.set)}};else{var i={}.hasOwnProperty,o={}.toString,s={}.constructor.prototype,a=function(t){var e=[];for(var n in t)i.call(t,n)&&e.push(n);return e};e.exports={isArray:function(t){try{return"[object Array]"===o.call(t)}catch(t){return!1}},keys:a,names:a,defineProperty:function(t,e,n){return t[e]=n.value,t},getDescriptor:function(t,e){return{value:t[e]}},freeze:function(t){return t},getPrototypeOf:function(t){try{return Object(t).constructor.prototype}catch(t){return s}},isES5:r,propertyIsWritable:function(){return!0}}}},{}],14:[function(t,e,n){"use strict";e.exports=function(t,e){var n=t.map;t.prototype.filter=function(t,r){return n(this,t,r,e)},t.filter=function(t,r,i){return n(t,r,i,e)}}},{}],15:[function(t,e,n){"use strict";e.exports=function(e,n,r){var i=t("./util"),o=e.CancellationError,s=i.errorObj,a=t("./catch_filter")(r);function c(t,e,n){this.promise=t,this.type=e,this.handler=n,this.called=!1,this.cancelPromise=null}function l(t){this.finallyHandler=t}function u(t,e){return null!=t.cancelPromise&&(arguments.length>1?t.cancelPromise._reject(e):t.cancelPromise._cancel(),t.cancelPromise=null,!0)}function p(){return f.call(this,this.promise._target()._settledValue())}function h(t){if(!u(this,t))return s.e=t,s}function f(t){var i=this.promise,a=this.handler;if(!this.called){this.called=!0;var c=this.isFinallyHandler()?a.call(i._boundValue()):a.call(i._boundValue(),t);if(c===r)return c;if(void 0!==c){i._setReturnedNonUndefined();var f=n(c,i);if(f instanceof e){if(null!=this.cancelPromise){if(f._isCancelled()){var _=new o("late cancellation observer");return i._attachExtraTrace(_),s.e=_,s}f.isPending()&&f._attachCancellationCallback(new l(this))}return f._then(p,h,void 0,this,void 0)}}}return i.isRejected()?(u(this),s.e=t,s):(u(this),t)}return c.prototype.isFinallyHandler=function(){return 0===this.type},l.prototype._resultCancelled=function(){u(this.finallyHandler)},e.prototype._passThrough=function(t,e,n,r){return"function"!=typeof t?this.then():this._then(n,r,void 0,new c(this,e,t),void 0)},e.prototype.lastly=e.prototype.finally=function(t){return this._passThrough(t,0,f,f)},e.prototype.tap=function(t){return this._passThrough(t,1,f)},e.prototype.tapCatch=function(t){var n=arguments.length;if(1===n)return this._passThrough(t,1,void 0,f);var r,o=new Array(n-1),s=0;for(r=0;r<n-1;++r){var c=arguments[r];if(!i.isObject(c))return e.reject(new TypeError("tapCatch statement predicate: expecting an object but got "+i.classString(c)));o[s++]=c}o.length=s;var l=arguments[r];return this._passThrough(a(o,l,this),1,void 0,f)},c}},{"./catch_filter":7,"./util":36}],16:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o,s){var a=t("./errors").TypeError,c=t("./util"),l=c.errorObj,u=c.tryCatch,p=[];function h(t,n,i,o){if(s.cancellation()){var a=new e(r),c=this._finallyPromise=new e(r);this._promise=a.lastly(function(){return c}),a._captureStackTrace(),a._setOnCancel(this)}else{(this._promise=new e(r))._captureStackTrace()}this._stack=o,this._generatorFunction=t,this._receiver=n,this._generator=void 0,this._yieldHandlers="function"==typeof i?[i].concat(p):p,this._yieldedPromise=null,this._cancellationPhase=!1}c.inherits(h,o),h.prototype._isResolved=function(){return null===this._promise},h.prototype._cleanup=function(){this._promise=this._generator=null,s.cancellation()&&null!==this._finallyPromise&&(this._finallyPromise._fulfill(),this._finallyPromise=null)},h.prototype._promiseCancelled=function(){if(!this._isResolved()){var t;if(void 0!==this._generator.return)this._promise._pushContext(),t=u(this._generator.return).call(this._generator,void 0),this._promise._popContext();else{var n=new e.CancellationError("generator .return() sentinel");e.coroutine.returnSentinel=n,this._promise._attachExtraTrace(n),this._promise._pushContext(),t=u(this._generator.throw).call(this._generator,n),this._promise._popContext()}this._cancellationPhase=!0,this._yieldedPromise=null,this._continue(t)}},h.prototype._promiseFulfilled=function(t){this._yieldedPromise=null,this._promise._pushContext();var e=u(this._generator.next).call(this._generator,t);this._promise._popContext(),this._continue(e)},h.prototype._promiseRejected=function(t){this._yieldedPromise=null,this._promise._attachExtraTrace(t),this._promise._pushContext();var e=u(this._generator.throw).call(this._generator,t);this._promise._popContext(),this._continue(e)},h.prototype._resultCancelled=function(){if(this._yieldedPromise instanceof e){var t=this._yieldedPromise;this._yieldedPromise=null,t.cancel()}},h.prototype.promise=function(){return this._promise},h.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._promiseFulfilled(void 0)},h.prototype._continue=function(t){var n=this._promise;if(t===l)return this._cleanup(),this._cancellationPhase?n.cancel():n._rejectCallback(t.e,!1);var r=t.value;if(!0===t.done)return this._cleanup(),this._cancellationPhase?n.cancel():n._resolveCallback(r);var o=i(r,this._promise);if(o instanceof e||null!==(o=function(t,n,r){for(var o=0;o<n.length;++o){r._pushContext();var s=u(n[o])(t);if(r._popContext(),s===l){r._pushContext();var a=e.reject(l.e);return r._popContext(),a}var c=i(s,r);if(c instanceof e)return c}return null}(o,this._yieldHandlers,this._promise))){var s=(o=o._target())._bitField;0==(50397184&s)?(this._yieldedPromise=o,o._proxy(this,null)):0!=(33554432&s)?e._async.invoke(this._promiseFulfilled,this,o._value()):0!=(16777216&s)?e._async.invoke(this._promiseRejected,this,o._reason()):this._promiseCancelled()}else this._promiseRejected(new a("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/MqrFmX\n\n".replace("%s",String(r))+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n")))},e.coroutine=function(t,e){if("function"!=typeof t)throw new a("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var n=Object(e).yieldHandler,r=h,i=(new Error).stack;return function(){var e=t.apply(this,arguments),o=new r(void 0,void 0,n,i),s=o.promise();return o._generator=e,o._promiseFulfilled(void 0),s}},e.coroutine.addYieldHandler=function(t){if("function"!=typeof t)throw new a("expecting a function but got "+c.classString(t));p.push(t)},e.spawn=function(t){if(s.deprecated("Promise.spawn()","Promise.coroutine()"),"function"!=typeof t)return n("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var r=new h(t,this),i=r.promise();return r._run(e.spawn),i}}},{"./errors":12,"./util":36}],17:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o,s){var a=t("./util");a.canEvaluate,a.tryCatch,a.errorObj;e.join=function(){var t,e=arguments.length-1;e>0&&"function"==typeof arguments[e]&&(t=arguments[e]);var r=[].slice.call(arguments);t&&r.pop();var i=new n(r).promise();return void 0!==t?i.spread(t):i}}},{"./util":36}],18:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o,s){var a=e._getDomain,c=t("./util"),l=c.tryCatch,u=c.errorObj,p=e._async;function h(t,e,n,r){this.constructor$(t),this._promise._captureStackTrace();var i=a();this._callback=null===i?e:c.domainBind(i,e),this._preservedValues=r===o?new Array(this.length()):null,this._limit=n,this._inFlight=0,this._queue=[],p.invoke(this._asyncInit,this,void 0)}function f(t,n,i,o){if("function"!=typeof n)return r("expecting a function but got "+c.classString(n));var s=0;if(void 0!==i){if("object"!=typeof i||null===i)return e.reject(new TypeError("options argument must be an object but it is "+c.classString(i)));if("number"!=typeof i.concurrency)return e.reject(new TypeError("'concurrency' must be a number but it is "+c.classString(i.concurrency)));s=i.concurrency}return new h(t,n,s="number"==typeof s&&isFinite(s)&&s>=1?s:0,o).promise()}c.inherits(h,n),h.prototype._asyncInit=function(){this._init$(void 0,-2)},h.prototype._init=function(){},h.prototype._promiseFulfilled=function(t,n){var r=this._values,o=this.length(),a=this._preservedValues,c=this._limit;if(n<0){if(r[n=-1*n-1]=t,c>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return!0}else{if(c>=1&&this._inFlight>=c)return r[n]=t,this._queue.push(n),!1;null!==a&&(a[n]=t);var p=this._promise,h=this._callback,f=p._boundValue();p._pushContext();var _=l(h).call(f,t,n,o),d=p._popContext();if(s.checkForgottenReturns(_,d,null!==a?"Promise.filter":"Promise.map",p),_===u)return this._reject(_.e),!0;var v=i(_,this._promise);if(v instanceof e){var y=(v=v._target())._bitField;if(0==(50397184&y))return c>=1&&this._inFlight++,r[n]=v,v._proxy(this,-1*(n+1)),!1;if(0==(33554432&y))return 0!=(16777216&y)?(this._reject(v._reason()),!0):(this._cancel(),!0);_=v._value()}r[n]=_}return++this._totalResolved>=o&&(null!==a?this._filter(r,a):this._resolve(r),!0)},h.prototype._drainQueue=function(){for(var t=this._queue,e=this._limit,n=this._values;t.length>0&&this._inFlight<e;){if(this._isResolved())return;var r=t.pop();this._promiseFulfilled(n[r],r)}},h.prototype._filter=function(t,e){for(var n=e.length,r=new Array(n),i=0,o=0;o<n;++o)t[o]&&(r[i++]=e[o]);r.length=i,this._resolve(r)},h.prototype.preservedValues=function(){return this._preservedValues},e.prototype.map=function(t,e){return f(this,t,e,null)},e.map=function(t,e,n,r){return f(t,e,n,r)}}},{"./util":36}],19:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o){var s=t("./util"),a=s.tryCatch;e.method=function(t){if("function"!=typeof t)throw new e.TypeError("expecting a function but got "+s.classString(t));return function(){var r=new e(n);r._captureStackTrace(),r._pushContext();var i=a(t).apply(this,arguments),s=r._popContext();return o.checkForgottenReturns(i,s,"Promise.method",r),r._resolveFromSyncValue(i),r}},e.attempt=e.try=function(t){if("function"!=typeof t)return i("expecting a function but got "+s.classString(t));var r,c=new e(n);if(c._captureStackTrace(),c._pushContext(),arguments.length>1){o.deprecated("calling Promise.try with more than 1 argument");var l=arguments[1],u=arguments[2];r=s.isArray(l)?a(t).apply(u,l):a(t).call(u,l)}else r=a(t)();var p=c._popContext();return o.checkForgottenReturns(r,p,"Promise.try",c),c._resolveFromSyncValue(r),c},e.prototype._resolveFromSyncValue=function(t){t===s.errorObj?this._rejectCallback(t.e,!1):this._resolveCallback(t,!0)}}},{"./util":36}],20:[function(t,e,n){"use strict";var r=t("./util"),i=r.maybeWrapAsError,o=t("./errors").OperationalError,s=t("./es5");var a=/^(?:name|message|stack|cause)$/;function c(t){var e;if(function(t){return t instanceof Error&&s.getPrototypeOf(t)===Error.prototype}(t)){(e=new o(t)).name=t.name,e.message=t.message,e.stack=t.stack;for(var n=s.keys(t),i=0;i<n.length;++i){var c=n[i];a.test(c)||(e[c]=t[c])}return e}return r.markAsOriginatingFromRejection(t),t}e.exports=function(t,e){return function(n,r){if(null!==t){if(n){var o=c(i(n));t._attachExtraTrace(o),t._reject(o)}else if(e){var s=[].slice.call(arguments,1);t._fulfill(s)}else t._fulfill(r);t=null}}}},{"./errors":12,"./es5":13,"./util":36}],21:[function(t,e,n){"use strict";e.exports=function(e){var n=t("./util"),r=e._async,i=n.tryCatch,o=n.errorObj;function s(t,e){if(!n.isArray(t))return a.call(this,t,e);var s=i(e).apply(this._boundValue(),[null].concat(t));s===o&&r.throwLater(s.e)}function a(t,e){var n=this._boundValue(),s=void 0===t?i(e).call(n,null):i(e).call(n,null,t);s===o&&r.throwLater(s.e)}function c(t,e){if(!t){var n=new Error(t+"");n.cause=t,t=n}var s=i(e).call(this._boundValue(),t);s===o&&r.throwLater(s.e)}e.prototype.asCallback=e.prototype.nodeify=function(t,e){if("function"==typeof t){var n=a;void 0!==e&&Object(e).spread&&(n=s),this._then(n,c,void 0,this,t)}return this}}},{"./util":36}],22:[function(t,e,n){"use strict";e.exports=function(){var n=function(){return new f("circular promise resolution chain\n\n    See http://goo.gl/MqrFmX\n")},r=function(){return new T.PromiseInspection(this._target())},i=function(t){return T.reject(new f(t))};function o(){}var s,a={},c=t("./util");s=c.isNode?function(){var t=process.domain;return void 0===t&&(t=null),t}:function(){return null},c.notEnumerableProp(T,"_getDomain",s);var l=t("./es5"),u=t("./async"),p=new u;l.defineProperty(T,"_async",{value:p});var h=t("./errors"),f=T.TypeError=h.TypeError;T.RangeError=h.RangeError;var _=T.CancellationError=h.CancellationError;T.TimeoutError=h.TimeoutError,T.OperationalError=h.OperationalError,T.RejectionError=h.OperationalError,T.AggregateError=h.AggregateError;var d=function(){},v={},y={},m=t("./thenables")(T,d),g=t("./promise_array")(T,d,m,i,o),b=t("./context")(T),w=b.create,C=t("./debuggability")(T,b),j=(C.CapturedTrace,t("./finally")(T,m,y)),E=t("./catch_filter")(y),k=t("./nodeback"),F=c.errorObj,x=c.tryCatch;function T(t){t!==d&&function(t,e){if(null==t||t.constructor!==T)throw new f("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/MqrFmX\n");if("function"!=typeof e)throw new f("expecting a function but got "+c.classString(e))}(this,t),this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._resolveFromExecutor(t),this._promiseCreated(),this._fireEvent("promiseCreated",this)}function P(t){this.promise._resolveCallback(t)}function R(t){this.promise._rejectCallback(t,!1)}function S(t){var e=new T(d);e._fulfillmentHandler0=t,e._rejectionHandler0=t,e._promise0=t,e._receiver0=t}return T.prototype.toString=function(){return"[object Promise]"},T.prototype.caught=T.prototype.catch=function(t){var e=arguments.length;if(e>1){var n,r=new Array(e-1),o=0;for(n=0;n<e-1;++n){var s=arguments[n];if(!c.isObject(s))return i("Catch statement predicate: expecting an object but got "+c.classString(s));r[o++]=s}return r.length=o,t=arguments[n],this.then(void 0,E(r,t,this))}return this.then(void 0,t)},T.prototype.reflect=function(){return this._then(r,r,void 0,this,void 0)},T.prototype.then=function(t,e){if(C.warnings()&&arguments.length>0&&"function"!=typeof t&&"function"!=typeof e){var n=".then() only accepts functions but was passed: "+c.classString(t);arguments.length>1&&(n+=", "+c.classString(e)),this._warn(n)}return this._then(t,e,void 0,void 0,void 0)},T.prototype.done=function(t,e){this._then(t,e,void 0,void 0,void 0)._setIsFinal()},T.prototype.spread=function(t){return"function"!=typeof t?i("expecting a function but got "+c.classString(t)):this.all()._then(t,void 0,void 0,v,void 0)},T.prototype.toJSON=function(){var t={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(t.fulfillmentValue=this.value(),t.isFulfilled=!0):this.isRejected()&&(t.rejectionReason=this.reason(),t.isRejected=!0),t},T.prototype.all=function(){return arguments.length>0&&this._warn(".all() was passed arguments but it does not take any"),new g(this).promise()},T.prototype.error=function(t){return this.caught(c.originatesFromRejection,t)},T.getNewLibraryCopy=e.exports,T.is=function(t){return t instanceof T},T.fromNode=T.fromCallback=function(t){var e=new T(d);e._captureStackTrace();var n=arguments.length>1&&!!Object(arguments[1]).multiArgs,r=x(t)(k(e,n));return r===F&&e._rejectCallback(r.e,!0),e._isFateSealed()||e._setAsyncGuaranteed(),e},T.all=function(t){return new g(t).promise()},T.cast=function(t){var e=m(t);return e instanceof T||((e=new T(d))._captureStackTrace(),e._setFulfilled(),e._rejectionHandler0=t),e},T.resolve=T.fulfilled=T.cast,T.reject=T.rejected=function(t){var e=new T(d);return e._captureStackTrace(),e._rejectCallback(t,!0),e},T.setScheduler=function(t){if("function"!=typeof t)throw new f("expecting a function but got "+c.classString(t));return p.setScheduler(t)},T.prototype._then=function(t,e,n,r,i){var o=void 0!==i,a=o?i:new T(d),l=this._target(),u=l._bitField;o||(a._propagateFrom(this,3),a._captureStackTrace(),void 0===r&&0!=(2097152&this._bitField)&&(r=0!=(50397184&u)?this._boundValue():l===this?void 0:this._boundTo),this._fireEvent("promiseChained",this,a));var h=s();if(0!=(50397184&u)){var f,v,y=l._settlePromiseCtx;0!=(33554432&u)?(v=l._rejectionHandler0,f=t):0!=(16777216&u)?(v=l._fulfillmentHandler0,f=e,l._unsetRejectionIsUnhandled()):(y=l._settlePromiseLateCancellationObserver,v=new _("late cancellation observer"),l._attachExtraTrace(v),f=e),p.invoke(y,l,{handler:null===h?f:"function"==typeof f&&c.domainBind(h,f),promise:a,receiver:r,value:v})}else l._addCallbacks(t,e,a,r,h);return a},T.prototype._length=function(){return 65535&this._bitField},T.prototype._isFateSealed=function(){return 0!=(117506048&this._bitField)},T.prototype._isFollowing=function(){return 67108864==(67108864&this._bitField)},T.prototype._setLength=function(t){this._bitField=-65536&this._bitField|65535&t},T.prototype._setFulfilled=function(){this._bitField=33554432|this._bitField,this._fireEvent("promiseFulfilled",this)},T.prototype._setRejected=function(){this._bitField=16777216|this._bitField,this._fireEvent("promiseRejected",this)},T.prototype._setFollowing=function(){this._bitField=67108864|this._bitField,this._fireEvent("promiseResolved",this)},T.prototype._setIsFinal=function(){this._bitField=4194304|this._bitField},T.prototype._isFinal=function(){return(4194304&this._bitField)>0},T.prototype._unsetCancelled=function(){this._bitField=-65537&this._bitField},T.prototype._setCancelled=function(){this._bitField=65536|this._bitField,this._fireEvent("promiseCancelled",this)},T.prototype._setWillBeCancelled=function(){this._bitField=8388608|this._bitField},T.prototype._setAsyncGuaranteed=function(){p.hasCustomScheduler()||(this._bitField=134217728|this._bitField)},T.prototype._receiverAt=function(t){var e=0===t?this._receiver0:this[4*t-4+3];if(e!==a)return void 0===e&&this._isBound()?this._boundValue():e},T.prototype._promiseAt=function(t){return this[4*t-4+2]},T.prototype._fulfillmentHandlerAt=function(t){return this[4*t-4+0]},T.prototype._rejectionHandlerAt=function(t){return this[4*t-4+1]},T.prototype._boundValue=function(){},T.prototype._migrateCallback0=function(t){t._bitField;var e=t._fulfillmentHandler0,n=t._rejectionHandler0,r=t._promise0,i=t._receiverAt(0);void 0===i&&(i=a),this._addCallbacks(e,n,r,i,null)},T.prototype._migrateCallbackAt=function(t,e){var n=t._fulfillmentHandlerAt(e),r=t._rejectionHandlerAt(e),i=t._promiseAt(e),o=t._receiverAt(e);void 0===o&&(o=a),this._addCallbacks(n,r,i,o,null)},T.prototype._addCallbacks=function(t,e,n,r,i){var o=this._length();if(o>=65531&&(o=0,this._setLength(0)),0===o)this._promise0=n,this._receiver0=r,"function"==typeof t&&(this._fulfillmentHandler0=null===i?t:c.domainBind(i,t)),"function"==typeof e&&(this._rejectionHandler0=null===i?e:c.domainBind(i,e));else{var s=4*o-4;this[s+2]=n,this[s+3]=r,"function"==typeof t&&(this[s+0]=null===i?t:c.domainBind(i,t)),"function"==typeof e&&(this[s+1]=null===i?e:c.domainBind(i,e))}return this._setLength(o+1),o},T.prototype._proxy=function(t,e){this._addCallbacks(void 0,void 0,e,t,null)},T.prototype._resolveCallback=function(t,e){if(0==(117506048&this._bitField)){if(t===this)return this._rejectCallback(n(),!1);var r=m(t,this);if(!(r instanceof T))return this._fulfill(t);e&&this._propagateFrom(r,2);var i=r._target();if(i!==this){var o=i._bitField;if(0==(50397184&o)){var s=this._length();s>0&&i._migrateCallback0(this);for(var a=1;a<s;++a)i._migrateCallbackAt(this,a);this._setFollowing(),this._setLength(0),this._setFollowee(i)}else if(0!=(33554432&o))this._fulfill(i._value());else if(0!=(16777216&o))this._reject(i._reason());else{var c=new _("late cancellation observer");i._attachExtraTrace(c),this._reject(c)}}else this._reject(n())}},T.prototype._rejectCallback=function(t,e,n){var r=c.ensureErrorObject(t),i=r===t;if(!i&&!n&&C.warnings()){var o="a promise was rejected with a non-error: "+c.classString(t);this._warn(o,!0)}this._attachExtraTrace(r,!!e&&i),this._reject(t)},T.prototype._resolveFromExecutor=function(t){if(t!==d){var e=this;this._captureStackTrace(),this._pushContext();var n=!0,r=this._execute(t,function(t){e._resolveCallback(t)},function(t){e._rejectCallback(t,n)});n=!1,this._popContext(),void 0!==r&&e._rejectCallback(r,!0)}},T.prototype._settlePromiseFromHandler=function(t,e,n,r){var i=r._bitField;if(0==(65536&i)){var o;r._pushContext(),e===v?n&&"number"==typeof n.length?o=x(t).apply(this._boundValue(),n):(o=F).e=new f("cannot .spread() a non-array: "+c.classString(n)):o=x(t).call(e,n);var s=r._popContext();0==(65536&(i=r._bitField))&&(o===y?r._reject(n):o===F?r._rejectCallback(o.e,!1):(C.checkForgottenReturns(o,s,"",r,this),r._resolveCallback(o)))}},T.prototype._target=function(){for(var t=this;t._isFollowing();)t=t._followee();return t},T.prototype._followee=function(){return this._rejectionHandler0},T.prototype._setFollowee=function(t){this._rejectionHandler0=t},T.prototype._settlePromise=function(t,e,n,i){var s=t instanceof T,a=this._bitField,c=0!=(134217728&a);0!=(65536&a)?(s&&t._invokeInternalOnCancel(),n instanceof j&&n.isFinallyHandler()?(n.cancelPromise=t,x(e).call(n,i)===F&&t._reject(F.e)):e===r?t._fulfill(r.call(n)):n instanceof o?n._promiseCancelled(t):s||t instanceof g?t._cancel():n.cancel()):"function"==typeof e?s?(c&&t._setAsyncGuaranteed(),this._settlePromiseFromHandler(e,n,i,t)):e.call(n,i,t):n instanceof o?n._isResolved()||(0!=(33554432&a)?n._promiseFulfilled(i,t):n._promiseRejected(i,t)):s&&(c&&t._setAsyncGuaranteed(),0!=(33554432&a)?t._fulfill(i):t._reject(i))},T.prototype._settlePromiseLateCancellationObserver=function(t){var e=t.handler,n=t.promise,r=t.receiver,i=t.value;"function"==typeof e?n instanceof T?this._settlePromiseFromHandler(e,r,i,n):e.call(r,i,n):n instanceof T&&n._reject(i)},T.prototype._settlePromiseCtx=function(t){this._settlePromise(t.promise,t.handler,t.receiver,t.value)},T.prototype._settlePromise0=function(t,e,n){var r=this._promise0,i=this._receiverAt(0);this._promise0=void 0,this._receiver0=void 0,this._settlePromise(r,t,i,e)},T.prototype._clearCallbackDataAtIndex=function(t){var e=4*t-4;this[e+2]=this[e+3]=this[e+0]=this[e+1]=void 0},T.prototype._fulfill=function(t){var e=this._bitField;if(!((117506048&e)>>>16)){if(t===this){var r=n();return this._attachExtraTrace(r),this._reject(r)}this._setFulfilled(),this._rejectionHandler0=t,(65535&e)>0&&(0!=(134217728&e)?this._settlePromises():p.settlePromises(this))}},T.prototype._reject=function(t){var e=this._bitField;if(!((117506048&e)>>>16)){if(this._setRejected(),this._fulfillmentHandler0=t,this._isFinal())return p.fatalError(t,c.isNode);(65535&e)>0?p.settlePromises(this):this._ensurePossibleRejectionHandled()}},T.prototype._fulfillPromises=function(t,e){for(var n=1;n<t;n++){var r=this._fulfillmentHandlerAt(n),i=this._promiseAt(n),o=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(i,r,o,e)}},T.prototype._rejectPromises=function(t,e){for(var n=1;n<t;n++){var r=this._rejectionHandlerAt(n),i=this._promiseAt(n),o=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(i,r,o,e)}},T.prototype._settlePromises=function(){var t=this._bitField,e=65535&t;if(e>0){if(0!=(16842752&t)){var n=this._fulfillmentHandler0;this._settlePromise0(this._rejectionHandler0,n,t),this._rejectPromises(e,n)}else{var r=this._rejectionHandler0;this._settlePromise0(this._fulfillmentHandler0,r,t),this._fulfillPromises(e,r)}this._setLength(0)}this._clearCancellationData()},T.prototype._settledValue=function(){var t=this._bitField;return 0!=(33554432&t)?this._rejectionHandler0:0!=(16777216&t)?this._fulfillmentHandler0:void 0},T.defer=T.pending=function(){return C.deprecated("Promise.defer","new Promise"),{promise:new T(d),resolve:P,reject:R}},c.notEnumerableProp(T,"_makeSelfResolutionError",n),t("./method")(T,d,m,i,C),t("./bind")(T,d,m,C),t("./cancel")(T,g,i,C),t("./direct_resolve")(T),t("./synchronous_inspection")(T),t("./join")(T,g,m,d,p,s),T.Promise=T,T.version="3.5.1",t("./map.js")(T,g,i,m,d,C),t("./call_get.js")(T),t("./using.js")(T,i,m,w,d,C),t("./timers.js")(T,d,C),t("./generators.js")(T,i,d,m,o,C),t("./nodeify.js")(T),t("./promisify.js")(T,d),t("./props.js")(T,g,m,i),t("./race.js")(T,d,m,i),t("./reduce.js")(T,g,i,m,d,C),t("./settle.js")(T,g,C),t("./some.js")(T,g,i),t("./filter.js")(T,d),t("./each.js")(T,d),t("./any.js")(T),c.toFastProperties(T),c.toFastProperties(T.prototype),S({a:1}),S({b:2}),S({c:3}),S(1),S(function(){}),S(void 0),S(!1),S(new T(d)),C.setBounds(u.firstLineError,c.lastLineError),T}},{"./any.js":1,"./async":2,"./bind":3,"./call_get.js":5,"./cancel":6,"./catch_filter":7,"./context":8,"./debuggability":9,"./direct_resolve":10,"./each.js":11,"./errors":12,"./es5":13,"./filter.js":14,"./finally":15,"./generators.js":16,"./join":17,"./map.js":18,"./method":19,"./nodeback":20,"./nodeify.js":21,"./promise_array":23,"./promisify.js":24,"./props.js":25,"./race.js":27,"./reduce.js":28,"./settle.js":30,"./some.js":31,"./synchronous_inspection":32,"./thenables":33,"./timers.js":34,"./using.js":35,"./util":36}],23:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o){var s=t("./util");s.isArray;function a(t){var r=this._promise=new e(n);t instanceof e&&r._propagateFrom(t,3),r._setOnCancel(this),this._values=t,this._length=0,this._totalResolved=0,this._init(void 0,-2)}return s.inherits(a,o),a.prototype.length=function(){return this._length},a.prototype.promise=function(){return this._promise},a.prototype._init=function t(n,o){var a=r(this._values,this._promise);if(a instanceof e){var c=(a=a._target())._bitField;if(this._values=a,0==(50397184&c))return this._promise._setAsyncGuaranteed(),a._then(t,this._reject,void 0,this,o);if(0==(33554432&c))return 0!=(16777216&c)?this._reject(a._reason()):this._cancel();a=a._value()}if(null!==(a=s.asArray(a)))0!==a.length?this._iterate(a):-5===o?this._resolveEmptyArray():this._resolve(function(t){switch(t){case-2:return[];case-3:return{};case-6:return new Map}}(o));else{var l=i("expecting an array or an iterable object but got "+s.classString(a)).reason();this._promise._rejectCallback(l,!1)}},a.prototype._iterate=function(t){var n=this.getActualLength(t.length);this._length=n,this._values=this.shouldCopyValues()?new Array(n):this._values;for(var i=this._promise,o=!1,s=null,a=0;a<n;++a){var c=r(t[a],i);s=c instanceof e?(c=c._target())._bitField:null,o?null!==s&&c.suppressUnhandledRejections():null!==s?0==(50397184&s)?(c._proxy(this,a),this._values[a]=c):o=0!=(33554432&s)?this._promiseFulfilled(c._value(),a):0!=(16777216&s)?this._promiseRejected(c._reason(),a):this._promiseCancelled(a):o=this._promiseFulfilled(c,a)}o||i._setAsyncGuaranteed()},a.prototype._isResolved=function(){return null===this._values},a.prototype._resolve=function(t){this._values=null,this._promise._fulfill(t)},a.prototype._cancel=function(){!this._isResolved()&&this._promise._isCancellable()&&(this._values=null,this._promise._cancel())},a.prototype._reject=function(t){this._values=null,this._promise._rejectCallback(t,!1)},a.prototype._promiseFulfilled=function(t,e){return this._values[e]=t,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},a.prototype._promiseCancelled=function(){return this._cancel(),!0},a.prototype._promiseRejected=function(t){return this._totalResolved++,this._reject(t),!0},a.prototype._resultCancelled=function(){if(!this._isResolved()){var t=this._values;if(this._cancel(),t instanceof e)t.cancel();else for(var n=0;n<t.length;++n)t[n]instanceof e&&t[n].cancel()}},a.prototype.shouldCopyValues=function(){return!0},a.prototype.getActualLength=function(t){return t},a}},{"./util":36}],24:[function(t,e,n){"use strict";e.exports=function(e,n){var r={},i=t("./util"),o=t("./nodeback"),s=i.withAppended,a=i.maybeWrapAsError,c=i.canEvaluate,l=t("./errors").TypeError,u={__isPromisified__:!0},p=new RegExp("^(?:"+["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"].join("|")+")$"),h=function(t){return i.isIdentifier(t)&&"_"!==t.charAt(0)&&"constructor"!==t};function f(t){return!p.test(t)}function _(t){try{return!0===t.__isPromisified__}catch(t){return!1}}function d(t,e,n){var r=i.getDataPropertyOrDefault(t,e+n,u);return!!r&&_(r)}function v(t,e,n,r){for(var o=i.inheritedDataKeys(t),s=[],a=0;a<o.length;++a){var c=o[a],u=t[c],p=r===h||h(c,u,t);"function"!=typeof u||_(u)||d(t,c,e)||!r(c,u,t,p)||s.push(c,u)}return function(t,e,n){for(var r=0;r<t.length;r+=2){var i=t[r];if(n.test(i))for(var o=i.replace(n,""),s=0;s<t.length;s+=2)if(t[s]===o)throw new l("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/MqrFmX\n".replace("%s",e))}}(s,e,n),s}var y,m=function(t){return t.replace(/([$])/,"\\$")};var g=c?y:function(t,c,l,u,p,h){var f=function(){return this}(),_=t;function d(){var i=c;c===r&&(i=this);var l=new e(n);l._captureStackTrace();var u="string"==typeof _&&this!==f?this[_]:t,p=o(l,h);try{u.apply(i,s(arguments,p))}catch(t){l._rejectCallback(a(t),!0,!0)}return l._isFateSealed()||l._setAsyncGuaranteed(),l}return"string"==typeof _&&(t=u),i.notEnumerableProp(d,"__isPromisified__",!0),d};function b(t,e,n,o,s){for(var a=new RegExp(m(e)+"$"),c=v(t,e,a,n),l=0,u=c.length;l<u;l+=2){var p=c[l],h=c[l+1],f=p+e;if(o===g)t[f]=g(p,r,p,h,e,s);else{var _=o(h,function(){return g(p,r,p,h,e,s)});i.notEnumerableProp(_,"__isPromisified__",!0),t[f]=_}}return i.toFastProperties(t),t}e.promisify=function(t,e){if("function"!=typeof t)throw new l("expecting a function but got "+i.classString(t));if(_(t))return t;var n=function(t,e,n){return g(t,e,void 0,t,null,n)}(t,void 0===(e=Object(e)).context?r:e.context,!!e.multiArgs);return i.copyDescriptors(t,n,f),n},e.promisifyAll=function(t,e){if("function"!=typeof t&&"object"!=typeof t)throw new l("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/MqrFmX\n");var n=!!(e=Object(e)).multiArgs,r=e.suffix;"string"!=typeof r&&(r="Async");var o=e.filter;"function"!=typeof o&&(o=h);var s=e.promisifier;if("function"!=typeof s&&(s=g),!i.isIdentifier(r))throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/MqrFmX\n");for(var a=i.inheritedDataKeys(t),c=0;c<a.length;++c){var u=t[a[c]];"constructor"!==a[c]&&i.isClass(u)&&(b(u.prototype,r,o,s,n),b(u,r,o,s,n))}return b(t,r,o,s,n)}}},{"./errors":12,"./nodeback":20,"./util":36}],25:[function(t,e,n){"use strict";e.exports=function(e,n,r,i){var o,s=t("./util"),a=s.isObject,c=t("./es5");"function"==typeof Map&&(o=Map);var l=function(){var t=0,e=0;function n(n,r){this[t]=n,this[t+e]=r,t++}return function(r){e=r.size,t=0;var i=new Array(2*r.size);return r.forEach(n,i),i}}();function u(t){var e,n=!1;if(void 0!==o&&t instanceof o)e=l(t),n=!0;else{var r=c.keys(t),i=r.length;e=new Array(2*i);for(var s=0;s<i;++s){var a=r[s];e[s]=t[a],e[s+i]=a}}this.constructor$(e),this._isMap=n,this._init$(void 0,n?-6:-3)}function p(t){var n,o=r(t);return a(o)?(n=o instanceof e?o._then(e.props,void 0,void 0,void 0,void 0):new u(o).promise(),o instanceof e&&n._propagateFrom(o,2),n):i("cannot await properties of a non-object\n\n    See http://goo.gl/MqrFmX\n")}s.inherits(u,n),u.prototype._init=function(){},u.prototype._promiseFulfilled=function(t,e){if(this._values[e]=t,++this._totalResolved>=this._length){var n;if(this._isMap)n=function(t){for(var e=new o,n=t.length/2|0,r=0;r<n;++r){var i=t[n+r],s=t[r];e.set(i,s)}return e}(this._values);else{n={};for(var r=this.length(),i=0,s=this.length();i<s;++i)n[this._values[i+r]]=this._values[i]}return this._resolve(n),!0}return!1},u.prototype.shouldCopyValues=function(){return!1},u.prototype.getActualLength=function(t){return t>>1},e.prototype.props=function(){return p(this)},e.props=function(t){return p(t)}}},{"./es5":13,"./util":36}],26:[function(t,e,n){"use strict";function r(t){this._capacity=t,this._length=0,this._front=0}r.prototype._willBeOverCapacity=function(t){return this._capacity<t},r.prototype._pushOne=function(t){var e=this.length();this._checkCapacity(e+1),this[this._front+e&this._capacity-1]=t,this._length=e+1},r.prototype.push=function(t,e,n){var r=this.length()+3;if(this._willBeOverCapacity(r))return this._pushOne(t),this._pushOne(e),void this._pushOne(n);var i=this._front+r-3;this._checkCapacity(r);var o=this._capacity-1;this[i+0&o]=t,this[i+1&o]=e,this[i+2&o]=n,this._length=r},r.prototype.shift=function(){var t=this._front,e=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length--,e},r.prototype.length=function(){return this._length},r.prototype._checkCapacity=function(t){this._capacity<t&&this._resizeTo(this._capacity<<1)},r.prototype._resizeTo=function(t){var e=this._capacity;this._capacity=t,function(t,e,n,r,i){for(var o=0;o<i;++o)n[o+r]=t[o+e],t[o+e]=void 0}(this,0,this,e,this._front+this._length&e-1)},e.exports=r},{}],27:[function(t,e,n){"use strict";e.exports=function(e,n,r,i){var o=t("./util"),s=function(t){return t.then(function(e){return a(e,t)})};function a(t,a){var c=r(t);if(c instanceof e)return s(c);if(null===(t=o.asArray(t)))return i("expecting an array or an iterable object but got "+o.classString(t));var l=new e(n);void 0!==a&&l._propagateFrom(a,3);for(var u=l._fulfill,p=l._reject,h=0,f=t.length;h<f;++h){var _=t[h];(void 0!==_||h in t)&&e.cast(_)._then(u,p,void 0,l,null)}return l}e.race=function(t){return a(t,void 0)},e.prototype.race=function(){return a(this,void 0)}}},{"./util":36}],28:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o,s){var a=e._getDomain,c=t("./util"),l=c.tryCatch;function u(t,n,r,i){this.constructor$(t);var s=a();this._fn=null===s?n:c.domainBind(s,n),void 0!==r&&(r=e.resolve(r))._attachCancellationCallback(this),this._initialValue=r,this._currentCancellable=null,this._eachValues=i===o?Array(this._length):0===i?null:void 0,this._promise._captureStackTrace(),this._init$(void 0,-5)}function p(t,e){this.isFulfilled()?e._resolve(t):e._reject(t)}function h(t,e,n,i){return"function"!=typeof e?r("expecting a function but got "+c.classString(e)):new u(t,e,n,i).promise()}function f(t){this.accum=t,this.array._gotAccum(t);var n=i(this.value,this.array._promise);return n instanceof e?(this.array._currentCancellable=n,n._then(_,void 0,void 0,this,void 0)):_.call(this,n)}function _(t){var n,r=this.array,i=r._promise,o=l(r._fn);i._pushContext(),(n=void 0!==r._eachValues?o.call(i._boundValue(),t,this.index,this.length):o.call(i._boundValue(),this.accum,t,this.index,this.length))instanceof e&&(r._currentCancellable=n);var a=i._popContext();return s.checkForgottenReturns(n,a,void 0!==r._eachValues?"Promise.each":"Promise.reduce",i),n}c.inherits(u,n),u.prototype._gotAccum=function(t){void 0!==this._eachValues&&null!==this._eachValues&&t!==o&&this._eachValues.push(t)},u.prototype._eachComplete=function(t){return null!==this._eachValues&&this._eachValues.push(t),this._eachValues},u.prototype._init=function(){},u.prototype._resolveEmptyArray=function(){this._resolve(void 0!==this._eachValues?this._eachValues:this._initialValue)},u.prototype.shouldCopyValues=function(){return!1},u.prototype._resolve=function(t){this._promise._resolveCallback(t),this._values=null},u.prototype._resultCancelled=function(t){if(t===this._initialValue)return this._cancel();this._isResolved()||(this._resultCancelled$(),this._currentCancellable instanceof e&&this._currentCancellable.cancel(),this._initialValue instanceof e&&this._initialValue.cancel())},u.prototype._iterate=function(t){var n,r;this._values=t;var i=t.length;if(void 0!==this._initialValue?(n=this._initialValue,r=0):(n=e.resolve(t[0]),r=1),this._currentCancellable=n,!n.isRejected())for(;r<i;++r){var o={accum:null,value:t[r],index:r,length:i,array:this};n=n._then(f,void 0,void 0,o,void 0)}void 0!==this._eachValues&&(n=n._then(this._eachComplete,void 0,void 0,this,void 0)),n._then(p,p,void 0,n,this)},e.prototype.reduce=function(t,e){return h(this,t,e,null)},e.reduce=function(t,e,n,r){return h(t,e,n,r)}}},{"./util":36}],29:[function(t,e,n){"use strict";var r,i=t("./util"),o=i.getNativePromise();if(i.isNode&&"undefined"==typeof MutationObserver){var s=global.setImmediate,a=process.nextTick;r=i.isRecentNode?function(t){s.call(global,t)}:function(t){a.call(process,t)}}else if("function"==typeof o&&"function"==typeof o.resolve){var c=o.resolve();r=function(t){c.then(t)}}else r="undefined"==typeof MutationObserver||"undefined"!=typeof window&&window.navigator&&(window.navigator.standalone||window.cordova)?"undefined"!=typeof setImmediate?function(t){setImmediate(t)}:"undefined"!=typeof setTimeout?function(t){setTimeout(t,0)}:function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}:function(){var t=document.createElement("div"),e={attributes:!0},n=!1,r=document.createElement("div");new MutationObserver(function(){t.classList.toggle("foo"),n=!1}).observe(r,e);return function(i){var o=new MutationObserver(function(){o.disconnect(),i()});o.observe(t,e),n||(n=!0,r.classList.toggle("foo"))}}();e.exports=r},{"./util":36}],30:[function(t,e,n){"use strict";e.exports=function(e,n,r){var i=e.PromiseInspection;function o(t){this.constructor$(t)}t("./util").inherits(o,n),o.prototype._promiseResolved=function(t,e){return this._values[t]=e,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},o.prototype._promiseFulfilled=function(t,e){var n=new i;return n._bitField=33554432,n._settledValueField=t,this._promiseResolved(e,n)},o.prototype._promiseRejected=function(t,e){var n=new i;return n._bitField=16777216,n._settledValueField=t,this._promiseResolved(e,n)},e.settle=function(t){return r.deprecated(".settle()",".reflect()"),new o(t).promise()},e.prototype.settle=function(){return e.settle(this)}}},{"./util":36}],31:[function(t,e,n){"use strict";e.exports=function(e,n,r){var i=t("./util"),o=t("./errors").RangeError,s=t("./errors").AggregateError,a=i.isArray,c={};function l(t){this.constructor$(t),this._howMany=0,this._unwrap=!1,this._initialized=!1}function u(t,e){if((0|e)!==e||e<0)return r("expecting a positive integer\n\n    See http://goo.gl/MqrFmX\n");var n=new l(t),i=n.promise();return n.setHowMany(e),n.init(),i}i.inherits(l,n),l.prototype._init=function(){if(this._initialized)if(0!==this._howMany){this._init$(void 0,-5);var t=a(this._values);!this._isResolved()&&t&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}else this._resolve([])},l.prototype.init=function(){this._initialized=!0,this._init()},l.prototype.setUnwrap=function(){this._unwrap=!0},l.prototype.howMany=function(){return this._howMany},l.prototype.setHowMany=function(t){this._howMany=t},l.prototype._promiseFulfilled=function(t){return this._addFulfilled(t),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),1===this.howMany()&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values),!0)},l.prototype._promiseRejected=function(t){return this._addRejected(t),this._checkOutcome()},l.prototype._promiseCancelled=function(){return this._values instanceof e||null==this._values?this._cancel():(this._addRejected(c),this._checkOutcome())},l.prototype._checkOutcome=function(){if(this.howMany()>this._canPossiblyFulfill()){for(var t=new s,e=this.length();e<this._values.length;++e)this._values[e]!==c&&t.push(this._values[e]);return t.length>0?this._reject(t):this._cancel(),!0}return!1},l.prototype._fulfilled=function(){return this._totalResolved},l.prototype._rejected=function(){return this._values.length-this.length()},l.prototype._addRejected=function(t){this._values.push(t)},l.prototype._addFulfilled=function(t){this._values[this._totalResolved++]=t},l.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},l.prototype._getRangeError=function(t){var e="Input array must contain at least "+this._howMany+" items but contains only "+t+" items";return new o(e)},l.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},e.some=function(t,e){return u(t,e)},e.prototype.some=function(t){return u(this,t)},e._SomePromiseArray=l}},{"./errors":12,"./util":36}],32:[function(t,e,n){"use strict";e.exports=function(t){function e(t){void 0!==t?(t=t._target(),this._bitField=t._bitField,this._settledValueField=t._isFateSealed()?t._settledValue():void 0):(this._bitField=0,this._settledValueField=void 0)}e.prototype._settledValue=function(){return this._settledValueField};var n=e.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},r=e.prototype.error=e.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},i=e.prototype.isFulfilled=function(){return 0!=(33554432&this._bitField)},o=e.prototype.isRejected=function(){return 0!=(16777216&this._bitField)},s=e.prototype.isPending=function(){return 0==(50397184&this._bitField)},a=e.prototype.isResolved=function(){return 0!=(50331648&this._bitField)};e.prototype.isCancelled=function(){return 0!=(8454144&this._bitField)},t.prototype.__isCancelled=function(){return 65536==(65536&this._bitField)},t.prototype._isCancelled=function(){return this._target().__isCancelled()},t.prototype.isCancelled=function(){return 0!=(8454144&this._target()._bitField)},t.prototype.isPending=function(){return s.call(this._target())},t.prototype.isRejected=function(){return o.call(this._target())},t.prototype.isFulfilled=function(){return i.call(this._target())},t.prototype.isResolved=function(){return a.call(this._target())},t.prototype.value=function(){return n.call(this._target())},t.prototype.reason=function(){var t=this._target();return t._unsetRejectionIsUnhandled(),r.call(t)},t.prototype._value=function(){return this._settledValue()},t.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()},t.PromiseInspection=e}},{}],33:[function(t,e,n){"use strict";e.exports=function(e,n){var r=t("./util"),i=r.errorObj,o=r.isObject;var s={}.hasOwnProperty;return function(t,a){if(o(t)){if(t instanceof e)return t;var c=function(t){try{return function(t){return t.then}(t)}catch(t){return i.e=t,i}}(t);if(c===i){a&&a._pushContext();var l=e.reject(c.e);return a&&a._popContext(),l}if("function"==typeof c)return function(t){try{return s.call(t,"_promise0")}catch(t){return!1}}(t)?(l=new e(n),t._then(l._fulfill,l._reject,void 0,l,null),l):function(t,o,s){var a=new e(n),c=a;s&&s._pushContext(),a._captureStackTrace(),s&&s._popContext();var l=!0,u=r.tryCatch(o).call(t,function(t){a&&(a._resolveCallback(t),a=null)},function(t){a&&(a._rejectCallback(t,l,!0),a=null)});return l=!1,a&&u===i&&(a._rejectCallback(u.e,!0,!0),a=null),c}(t,c,a)}return t}}},{"./util":36}],34:[function(t,e,n){"use strict";e.exports=function(e,n,r){var i=t("./util"),o=e.TimeoutError;function s(t){this.handle=t}s.prototype._resultCancelled=function(){clearTimeout(this.handle)};var a=function(t){return c(+this).thenReturn(t)},c=e.delay=function(t,i){var o,c;return void 0!==i?(o=e.resolve(i)._then(a,null,null,t,void 0),r.cancellation()&&i instanceof e&&o._setOnCancel(i)):(o=new e(n),c=setTimeout(function(){o._fulfill()},+t),r.cancellation()&&o._setOnCancel(new s(c)),o._captureStackTrace()),o._setAsyncGuaranteed(),o};e.prototype.delay=function(t){return c(t,this)};function l(t){return clearTimeout(this.handle),t}function u(t){throw clearTimeout(this.handle),t}e.prototype.timeout=function(t,e){var n,a;t=+t;var c=new s(setTimeout(function(){n.isPending()&&function(t,e,n){var r;r="string"!=typeof e?e instanceof Error?e:new o("operation timed out"):new o(e),i.markAsOriginatingFromRejection(r),t._attachExtraTrace(r),t._reject(r),null!=n&&n.cancel()}(n,e,a)},t));return r.cancellation()?(a=this.then(),(n=a._then(l,u,void 0,c,void 0))._setOnCancel(c)):n=this._then(l,u,void 0,c,void 0),n}}},{"./util":36}],35:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o,s){var a=t("./util"),c=t("./errors").TypeError,l=t("./util").inherits,u=a.errorObj,p=a.tryCatch,h={};function f(t){setTimeout(function(){throw t},0)}function _(t,n){var i=0,s=t.length,a=new e(o);return function o(){if(i>=s)return a._fulfill();var c=function(t){var e=r(t);return e!==t&&"function"==typeof t._isDisposable&&"function"==typeof t._getDisposer&&t._isDisposable()&&e._setDisposable(t._getDisposer()),e}(t[i++]);if(c instanceof e&&c._isDisposable()){try{c=r(c._getDisposer().tryDispose(n),t.promise)}catch(t){return f(t)}if(c instanceof e)return c._then(o,f,null,null,null)}o()}(),a}function d(t,e,n){this._data=t,this._promise=e,this._context=n}function v(t,e,n){this.constructor$(t,e,n)}function y(t){return d.isDisposer(t)?(this.resources[this.index]._setDisposable(t),t.promise()):t}function m(t){this.length=t,this.promise=null,this[t-1]=null}d.prototype.data=function(){return this._data},d.prototype.promise=function(){return this._promise},d.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():h},d.prototype.tryDispose=function(t){var e=this.resource(),n=this._context;void 0!==n&&n._pushContext();var r=e!==h?this.doDispose(e,t):null;return void 0!==n&&n._popContext(),this._promise._unsetDisposable(),this._data=null,r},d.isDisposer=function(t){return null!=t&&"function"==typeof t.resource&&"function"==typeof t.tryDispose},l(v,d),v.prototype.doDispose=function(t,e){return this.data().call(t,t,e)},m.prototype._resultCancelled=function(){for(var t=this.length,n=0;n<t;++n){var r=this[n];r instanceof e&&r.cancel()}},e.using=function(){var t=arguments.length;if(t<2)return n("you must pass at least 2 arguments to Promise.using");var i,o=arguments[t-1];if("function"!=typeof o)return n("expecting a function but got "+a.classString(o));var c=!0;2===t&&Array.isArray(arguments[0])?(t=(i=arguments[0]).length,c=!1):(i=arguments,t--);for(var l=new m(t),h=0;h<t;++h){var f=i[h];if(d.isDisposer(f)){var v=f;(f=f.promise())._setDisposable(v)}else{var g=r(f);g instanceof e&&(f=g._then(y,null,null,{resources:l,index:h},void 0))}l[h]=f}var b=new Array(l.length);for(h=0;h<b.length;++h)b[h]=e.resolve(l[h]).reflect();var w=e.all(b).then(function(t){for(var e=0;e<t.length;++e){var n=t[e];if(n.isRejected())return u.e=n.error(),u;if(!n.isFulfilled())return void w.cancel();t[e]=n.value()}C._pushContext(),o=p(o);var r=c?o.apply(void 0,t):o(t),i=C._popContext();return s.checkForgottenReturns(r,i,"Promise.using",C),r}),C=w.lastly(function(){var t=new e.PromiseInspection(w);return _(l,t)});return l.promise=C,C._setOnCancel(l),C},e.prototype._setDisposable=function(t){this._bitField=131072|this._bitField,this._disposer=t},e.prototype._isDisposable=function(){return(131072&this._bitField)>0},e.prototype._getDisposer=function(){return this._disposer},e.prototype._unsetDisposable=function(){this._bitField=-131073&this._bitField,this._disposer=void 0},e.prototype.disposer=function(t){if("function"==typeof t)return new v(t,this,i());throw new c}}},{"./errors":12,"./util":36}],36:[function(t,e,n){"use strict";var r=t("./es5"),i="undefined"==typeof navigator,o={e:{}},s,a="undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:void 0!==this?this:null;function c(){try{var t=s;return s=null,t.apply(this,arguments)}catch(t){return o.e=t,o}}function l(t){return s=t,c}var u=function(t,e){var n={}.hasOwnProperty;function r(){for(var r in this.constructor=t,this.constructor$=e,e.prototype)n.call(e.prototype,r)&&"$"!==r.charAt(r.length-1)&&(this[r+"$"]=e.prototype[r])}return r.prototype=e.prototype,t.prototype=new r,t.prototype};function p(t){return null==t||!0===t||!1===t||"string"==typeof t||"number"==typeof t}function h(t){return"function"==typeof t||"object"==typeof t&&null!==t}function f(t){return p(t)?new Error(k(t)):t}function _(t,e){var n,r=t.length,i=new Array(r+1);for(n=0;n<r;++n)i[n]=t[n];return i[n]=e,i}function d(t,e,n){if(!r.isES5)return{}.hasOwnProperty.call(t,e)?t[e]:void 0;var i=Object.getOwnPropertyDescriptor(t,e);return null!=i?null==i.get&&null==i.set?i.value:n:void 0}function v(t,e,n){if(p(t))return t;var i={value:n,configurable:!0,enumerable:!1,writable:!0};return r.defineProperty(t,e,i),t}function y(t){throw t}var m=function(){var t=[Array.prototype,Object.prototype,Function.prototype],e=function(e){for(var n=0;n<t.length;++n)if(t[n]===e)return!0;return!1};if(r.isES5){var n=Object.getOwnPropertyNames;return function(t){for(var i=[],o=Object.create(null);null!=t&&!e(t);){var s;try{s=n(t)}catch(t){return i}for(var a=0;a<s.length;++a){var c=s[a];if(!o[c]){o[c]=!0;var l=Object.getOwnPropertyDescriptor(t,c);null!=l&&null==l.get&&null==l.set&&i.push(c)}}t=r.getPrototypeOf(t)}return i}}var i={}.hasOwnProperty;return function(n){if(e(n))return[];var r=[];t:for(var o in n)if(i.call(n,o))r.push(o);else{for(var s=0;s<t.length;++s)if(i.call(t[s],o))continue t;r.push(o)}return r}}(),g=/this\s*\.\s*\S+\s*=/;function b(t){try{if("function"==typeof t){var e=r.names(t.prototype),n=r.isES5&&e.length>1,i=e.length>0&&!(1===e.length&&"constructor"===e[0]),o=g.test(t+"")&&r.names(t).length>0;if(n||i||o)return!0}return!1}catch(t){return!1}}function w(t){function e(){}e.prototype=t;for(var n=8;n--;)new e;return t}var C=/^[a-z$_][a-z$_0-9]*$/i;function j(t){return C.test(t)}function E(t,e,n){for(var r=new Array(t),i=0;i<t;++i)r[i]=e+i+n;return r}function k(t){try{return t+""}catch(t){return"[no string representation]"}}function F(t){return t instanceof Error||null!==t&&"object"==typeof t&&"string"==typeof t.message&&"string"==typeof t.name}function x(t){try{v(t,"isOperational",!0)}catch(t){}}function T(t){return null!=t&&(t instanceof Error.__BluebirdErrorTypes__.OperationalError||!0===t.isOperational)}function P(t){return F(t)&&r.propertyIsWritable(t,"stack")}var R="stack"in new Error?function(t){return P(t)?t:new Error(k(t))}:function(t){if(P(t))return t;try{throw new Error(k(t))}catch(t){return t}};function S(t){return{}.toString.call(t)}function O(t,e,n){for(var i=r.names(t),o=0;o<i.length;++o){var s=i[o];if(n(s))try{r.defineProperty(e,s,r.getDescriptor(t,s))}catch(t){}}}var A=function(t){return r.isArray(t)?t:null};if("undefined"!=typeof Symbol&&Symbol.iterator){var D="function"==typeof Array.from?function(t){return Array.from(t)}:function(t){for(var e,n=[],r=t[Symbol.iterator]();!(e=r.next()).done;)n.push(e.value);return n};A=function(t){return r.isArray(t)?t:null!=t&&"function"==typeof t[Symbol.iterator]?D(t):null}}var V="undefined"!=typeof process&&"[object process]"===S(process).toLowerCase(),I="undefined"!=typeof process&&void 0!==process.env;function L(t){return I?process.env[t]:void 0}function H(){if("function"==typeof Promise)try{var t=new Promise(function(){});if("[object Promise]"==={}.toString.call(t))return Promise}catch(t){}}function N(t,e){return t.bind(e)}var U={isClass:b,isIdentifier:j,inheritedDataKeys:m,getDataPropertyOrDefault:d,thrower:y,isArray:r.isArray,asArray:A,notEnumerableProp:v,isPrimitive:p,isObject:h,isError:F,canEvaluate:i,errorObj:o,tryCatch:l,inherits:u,withAppended:_,maybeWrapAsError:f,toFastProperties:w,filledRange:E,toString:k,canAttachTrace:P,ensureErrorObject:R,originatesFromRejection:T,markAsOriginatingFromRejection:x,classString:S,copyDescriptors:O,hasDevTools:"undefined"!=typeof chrome&&chrome&&"function"==typeof chrome.loadTimes,isNode:V,hasEnvVariables:I,env:L,global:a,getNativePromise:H,domainBind:N},B;U.isRecentNode=U.isNode&&(B=process.versions.node.split(".").map(Number),0===B[0]&&B[1]>10||B[0]>0),U.isNode&&U.toFastProperties(process);try{throw new Error}catch(t){U.lastLineError=t}e.exports=U},{"./es5":13}]},{},[4])(4)}),"undefined"!=typeof window&&null!==window?window.P=window.Promise:"undefined"!=typeof self&&null!==self&&(self.P=self.Promise);

}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"_process":140}],51:[function(require,module,exports){

},{}],52:[function(require,module,exports){
(function (global){
"use strict";var base64=require("base64-js"),ieee754=require("ieee754"),isArray=require("isarray");function typedArraySupport(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}function kMaxLength(){return Buffer.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function createBuffer(t,e){if(kMaxLength()<e)throw new RangeError("Invalid typed array length");return Buffer.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=Buffer.prototype:(null===t&&(t=new Buffer(e)),t.length=e),t}function Buffer(t,e,r){if(!(Buffer.TYPED_ARRAY_SUPPORT||this instanceof Buffer))return new Buffer(t,e,r);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return allocUnsafe(this,t)}return from(this,t,e,r)}function from(t,e,r,n){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?fromArrayBuffer(t,e,r,n):"string"==typeof e?fromString(t,e,r):fromObject(t,e)}function assertSize(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function alloc(t,e,r,n){return assertSize(e),e<=0?createBuffer(t,e):void 0!==r?"string"==typeof n?createBuffer(t,e).fill(r,n):createBuffer(t,e).fill(r):createBuffer(t,e)}function allocUnsafe(t,e){if(assertSize(e),t=createBuffer(t,e<0?0:0|checked(e)),!Buffer.TYPED_ARRAY_SUPPORT)for(var r=0;r<e;++r)t[r]=0;return t}function fromString(t,e,r){if("string"==typeof r&&""!==r||(r="utf8"),!Buffer.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|byteLength(e,r),f=(t=createBuffer(t,n)).write(e,r);return f!==n&&(t=t.slice(0,f)),t}function fromArrayLike(t,e){var r=e.length<0?0:0|checked(e.length);t=createBuffer(t,r);for(var n=0;n<r;n+=1)t[n]=255&e[n];return t}function fromArrayBuffer(t,e,r,n){if(e.byteLength,r<0||e.byteLength<r)throw new RangeError("'offset' is out of bounds");if(e.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");return e=void 0===r&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,r):new Uint8Array(e,r,n),Buffer.TYPED_ARRAY_SUPPORT?(t=e).__proto__=Buffer.prototype:t=fromArrayLike(t,e),t}function fromObject(t,e){if(Buffer.isBuffer(e)){var r=0|checked(e.length);return 0===(t=createBuffer(t,r)).length?t:(e.copy(t,0,0,r),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||isnan(e.length)?createBuffer(t,0):fromArrayLike(t,e);if("Buffer"===e.type&&isArray(e.data))return fromArrayLike(t,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function checked(t){if(t>=kMaxLength())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+kMaxLength().toString(16)+" bytes");return 0|t}function SlowBuffer(t){return+t!=t&&(t=0),Buffer.alloc(+t)}function byteLength(t,e){if(Buffer.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var r=t.length;if(0===r)return 0;for(var n=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return utf8ToBytes(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return base64ToBytes(t).length;default:if(n)return utf8ToBytes(t).length;e=(""+e).toLowerCase(),n=!0}}function slowToString(t,e,r){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return hexSlice(this,e,r);case"utf8":case"utf-8":return utf8Slice(this,e,r);case"ascii":return asciiSlice(this,e,r);case"latin1":case"binary":return latin1Slice(this,e,r);case"base64":return base64Slice(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function swap(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function bidirectionalIndexOf(t,e,r,n,f){if(0===t.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=f?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(f)return-1;r=t.length-1}else if(r<0){if(!f)return-1;r=0}if("string"==typeof e&&(e=Buffer.from(e,n)),Buffer.isBuffer(e))return 0===e.length?-1:arrayIndexOf(t,e,r,n,f);if("number"==typeof e)return e&=255,Buffer.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?f?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):arrayIndexOf(t,[e],r,n,f);throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(t,e,r,n,f){var i,o=1,u=t.length,s=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;o=2,u/=2,s/=2,r/=2}function a(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(f){var h=-1;for(i=r;i<u;i++)if(a(t,i)===a(e,-1===h?0:i-h)){if(-1===h&&(h=i),i-h+1===s)return h*o}else-1!==h&&(i-=i-h),h=-1}else for(r+s>u&&(r=u-s),i=r;i>=0;i--){for(var c=!0,l=0;l<s;l++)if(a(t,i+l)!==a(e,l)){c=!1;break}if(c)return i}return-1}function hexWrite(t,e,r,n){r=Number(r)||0;var f=t.length-r;n?(n=Number(n))>f&&(n=f):n=f;var i=e.length;if(i%2!=0)throw new TypeError("Invalid hex string");n>i/2&&(n=i/2);for(var o=0;o<n;++o){var u=parseInt(e.substr(2*o,2),16);if(isNaN(u))return o;t[r+o]=u}return o}function utf8Write(t,e,r,n){return blitBuffer(utf8ToBytes(e,t.length-r),t,r,n)}function asciiWrite(t,e,r,n){return blitBuffer(asciiToBytes(e),t,r,n)}function latin1Write(t,e,r,n){return asciiWrite(t,e,r,n)}function base64Write(t,e,r,n){return blitBuffer(base64ToBytes(e),t,r,n)}function ucs2Write(t,e,r,n){return blitBuffer(utf16leToBytes(e,t.length-r),t,r,n)}function base64Slice(t,e,r){return 0===e&&r===t.length?base64.fromByteArray(t):base64.fromByteArray(t.slice(e,r))}function utf8Slice(t,e,r){r=Math.min(t.length,r);for(var n=[],f=e;f<r;){var i,o,u,s,a=t[f],h=null,c=a>239?4:a>223?3:a>191?2:1;if(f+c<=r)switch(c){case 1:a<128&&(h=a);break;case 2:128==(192&(i=t[f+1]))&&(s=(31&a)<<6|63&i)>127&&(h=s);break;case 3:i=t[f+1],o=t[f+2],128==(192&i)&&128==(192&o)&&(s=(15&a)<<12|(63&i)<<6|63&o)>2047&&(s<55296||s>57343)&&(h=s);break;case 4:i=t[f+1],o=t[f+2],u=t[f+3],128==(192&i)&&128==(192&o)&&128==(192&u)&&(s=(15&a)<<18|(63&i)<<12|(63&o)<<6|63&u)>65535&&s<1114112&&(h=s)}null===h?(h=65533,c=1):h>65535&&(h-=65536,n.push(h>>>10&1023|55296),h=56320|1023&h),n.push(h),f+=c}return decodeCodePointsArray(n)}exports.Buffer=Buffer,exports.SlowBuffer=SlowBuffer,exports.INSPECT_MAX_BYTES=50,Buffer.TYPED_ARRAY_SUPPORT=void 0!==global.TYPED_ARRAY_SUPPORT?global.TYPED_ARRAY_SUPPORT:typedArraySupport(),exports.kMaxLength=kMaxLength(),Buffer.poolSize=8192,Buffer._augment=function(t){return t.__proto__=Buffer.prototype,t},Buffer.from=function(t,e,r){return from(null,t,e,r)},Buffer.TYPED_ARRAY_SUPPORT&&(Buffer.prototype.__proto__=Uint8Array.prototype,Buffer.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&Buffer[Symbol.species]===Buffer&&Object.defineProperty(Buffer,Symbol.species,{value:null,configurable:!0})),Buffer.alloc=function(t,e,r){return alloc(null,t,e,r)},Buffer.allocUnsafe=function(t){return allocUnsafe(null,t)},Buffer.allocUnsafeSlow=function(t){return allocUnsafe(null,t)},Buffer.isBuffer=function(t){return!(null==t||!t._isBuffer)},Buffer.compare=function(t,e){if(!Buffer.isBuffer(t)||!Buffer.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var r=t.length,n=e.length,f=0,i=Math.min(r,n);f<i;++f)if(t[f]!==e[f]){r=t[f],n=e[f];break}return r<n?-1:n<r?1:0},Buffer.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function(t,e){if(!isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return Buffer.alloc(0);var r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var n=Buffer.allocUnsafe(e),f=0;for(r=0;r<t.length;++r){var i=t[r];if(!Buffer.isBuffer(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(n,f),f+=i.length}return n},Buffer.byteLength=byteLength,Buffer.prototype._isBuffer=!0,Buffer.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)swap(this,e,e+1);return this},Buffer.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)swap(this,e,e+3),swap(this,e+1,e+2);return this},Buffer.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)swap(this,e,e+7),swap(this,e+1,e+6),swap(this,e+2,e+5),swap(this,e+3,e+4);return this},Buffer.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?utf8Slice(this,0,t):slowToString.apply(this,arguments)},Buffer.prototype.equals=function(t){if(!Buffer.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===Buffer.compare(this,t)},Buffer.prototype.inspect=function(){var t="",e=exports.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,e).match(/.{2}/g).join(" "),this.length>e&&(t+=" ... ")),"<Buffer "+t+">"},Buffer.prototype.compare=function(t,e,r,n,f){if(!Buffer.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===f&&(f=this.length),e<0||r>t.length||n<0||f>this.length)throw new RangeError("out of range index");if(n>=f&&e>=r)return 0;if(n>=f)return-1;if(e>=r)return 1;if(e>>>=0,r>>>=0,n>>>=0,f>>>=0,this===t)return 0;for(var i=f-n,o=r-e,u=Math.min(i,o),s=this.slice(n,f),a=t.slice(e,r),h=0;h<u;++h)if(s[h]!==a[h]){i=s[h],o=a[h];break}return i<o?-1:o<i?1:0},Buffer.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},Buffer.prototype.indexOf=function(t,e,r){return bidirectionalIndexOf(this,t,e,r,!0)},Buffer.prototype.lastIndexOf=function(t,e,r){return bidirectionalIndexOf(this,t,e,r,!1)},Buffer.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var f=this.length-e;if((void 0===r||r>f)&&(r=f),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var i=!1;;)switch(n){case"hex":return hexWrite(this,t,e,r);case"utf8":case"utf-8":return utf8Write(this,t,e,r);case"ascii":return asciiWrite(this,t,e,r);case"latin1":case"binary":return latin1Write(this,t,e,r);case"base64":return base64Write(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,t,e,r);default:if(i)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),i=!0}},Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var MAX_ARGUMENTS_LENGTH=4096;function decodeCodePointsArray(t){var e=t.length;if(e<=MAX_ARGUMENTS_LENGTH)return String.fromCharCode.apply(String,t);for(var r="",n=0;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=MAX_ARGUMENTS_LENGTH));return r}function asciiSlice(t,e,r){var n="";r=Math.min(t.length,r);for(var f=e;f<r;++f)n+=String.fromCharCode(127&t[f]);return n}function latin1Slice(t,e,r){var n="";r=Math.min(t.length,r);for(var f=e;f<r;++f)n+=String.fromCharCode(t[f]);return n}function hexSlice(t,e,r){var n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);for(var f="",i=e;i<r;++i)f+=toHex(t[i]);return f}function utf16leSlice(t,e,r){for(var n=t.slice(e,r),f="",i=0;i<n.length;i+=2)f+=String.fromCharCode(n[i]+256*n[i+1]);return f}function checkOffset(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function checkInt(t,e,r,n,f,i){if(!Buffer.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>f||e<i)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}function objectWriteUInt16(t,e,r,n){e<0&&(e=65535+e+1);for(var f=0,i=Math.min(t.length-r,2);f<i;++f)t[r+f]=(e&255<<8*(n?f:1-f))>>>8*(n?f:1-f)}function objectWriteUInt32(t,e,r,n){e<0&&(e=4294967295+e+1);for(var f=0,i=Math.min(t.length-r,4);f<i;++f)t[r+f]=e>>>8*(n?f:3-f)&255}function checkIEEE754(t,e,r,n,f,i){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function writeFloat(t,e,r,n,f){return f||checkIEEE754(t,e,r,4,3.4028234663852886e38,-3.4028234663852886e38),ieee754.write(t,e,r,n,23,4),r+4}function writeDouble(t,e,r,n,f){return f||checkIEEE754(t,e,r,8,1.7976931348623157e308,-1.7976931348623157e308),ieee754.write(t,e,r,n,52,8),r+8}Buffer.prototype.slice=function(t,e){var r,n=this.length;if(t=~~t,e=void 0===e?n:~~e,t<0?(t+=n)<0&&(t=0):t>n&&(t=n),e<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t),Buffer.TYPED_ARRAY_SUPPORT)(r=this.subarray(t,e)).__proto__=Buffer.prototype;else{var f=e-t;r=new Buffer(f,void 0);for(var i=0;i<f;++i)r[i]=this[i+t]}return r},Buffer.prototype.readUIntLE=function(t,e,r){t|=0,e|=0,r||checkOffset(t,e,this.length);for(var n=this[t],f=1,i=0;++i<e&&(f*=256);)n+=this[t+i]*f;return n},Buffer.prototype.readUIntBE=function(t,e,r){t|=0,e|=0,r||checkOffset(t,e,this.length);for(var n=this[t+--e],f=1;e>0&&(f*=256);)n+=this[t+--e]*f;return n},Buffer.prototype.readUInt8=function(t,e){return e||checkOffset(t,1,this.length),this[t]},Buffer.prototype.readUInt16LE=function(t,e){return e||checkOffset(t,2,this.length),this[t]|this[t+1]<<8},Buffer.prototype.readUInt16BE=function(t,e){return e||checkOffset(t,2,this.length),this[t]<<8|this[t+1]},Buffer.prototype.readUInt32LE=function(t,e){return e||checkOffset(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},Buffer.prototype.readUInt32BE=function(t,e){return e||checkOffset(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},Buffer.prototype.readIntLE=function(t,e,r){t|=0,e|=0,r||checkOffset(t,e,this.length);for(var n=this[t],f=1,i=0;++i<e&&(f*=256);)n+=this[t+i]*f;return n>=(f*=128)&&(n-=Math.pow(2,8*e)),n},Buffer.prototype.readIntBE=function(t,e,r){t|=0,e|=0,r||checkOffset(t,e,this.length);for(var n=e,f=1,i=this[t+--n];n>0&&(f*=256);)i+=this[t+--n]*f;return i>=(f*=128)&&(i-=Math.pow(2,8*e)),i},Buffer.prototype.readInt8=function(t,e){return e||checkOffset(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},Buffer.prototype.readInt16LE=function(t,e){e||checkOffset(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},Buffer.prototype.readInt16BE=function(t,e){e||checkOffset(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},Buffer.prototype.readInt32LE=function(t,e){return e||checkOffset(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},Buffer.prototype.readInt32BE=function(t,e){return e||checkOffset(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},Buffer.prototype.readFloatLE=function(t,e){return e||checkOffset(t,4,this.length),ieee754.read(this,t,!0,23,4)},Buffer.prototype.readFloatBE=function(t,e){return e||checkOffset(t,4,this.length),ieee754.read(this,t,!1,23,4)},Buffer.prototype.readDoubleLE=function(t,e){return e||checkOffset(t,8,this.length),ieee754.read(this,t,!0,52,8)},Buffer.prototype.readDoubleBE=function(t,e){return e||checkOffset(t,8,this.length),ieee754.read(this,t,!1,52,8)},Buffer.prototype.writeUIntLE=function(t,e,r,n){(t=+t,e|=0,r|=0,n)||checkInt(this,t,e,r,Math.pow(2,8*r)-1,0);var f=1,i=0;for(this[e]=255&t;++i<r&&(f*=256);)this[e+i]=t/f&255;return e+r},Buffer.prototype.writeUIntBE=function(t,e,r,n){(t=+t,e|=0,r|=0,n)||checkInt(this,t,e,r,Math.pow(2,8*r)-1,0);var f=r-1,i=1;for(this[e+f]=255&t;--f>=0&&(i*=256);)this[e+f]=t/i&255;return e+r},Buffer.prototype.writeUInt8=function(t,e,r){return t=+t,e|=0,r||checkInt(this,t,e,1,255,0),Buffer.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},Buffer.prototype.writeUInt16LE=function(t,e,r){return t=+t,e|=0,r||checkInt(this,t,e,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):objectWriteUInt16(this,t,e,!0),e+2},Buffer.prototype.writeUInt16BE=function(t,e,r){return t=+t,e|=0,r||checkInt(this,t,e,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):objectWriteUInt16(this,t,e,!1),e+2},Buffer.prototype.writeUInt32LE=function(t,e,r){return t=+t,e|=0,r||checkInt(this,t,e,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):objectWriteUInt32(this,t,e,!0),e+4},Buffer.prototype.writeUInt32BE=function(t,e,r){return t=+t,e|=0,r||checkInt(this,t,e,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):objectWriteUInt32(this,t,e,!1),e+4},Buffer.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e|=0,!n){var f=Math.pow(2,8*r-1);checkInt(this,t,e,r,f-1,-f)}var i=0,o=1,u=0;for(this[e]=255&t;++i<r&&(o*=256);)t<0&&0===u&&0!==this[e+i-1]&&(u=1),this[e+i]=(t/o>>0)-u&255;return e+r},Buffer.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e|=0,!n){var f=Math.pow(2,8*r-1);checkInt(this,t,e,r,f-1,-f)}var i=r-1,o=1,u=0;for(this[e+i]=255&t;--i>=0&&(o*=256);)t<0&&0===u&&0!==this[e+i+1]&&(u=1),this[e+i]=(t/o>>0)-u&255;return e+r},Buffer.prototype.writeInt8=function(t,e,r){return t=+t,e|=0,r||checkInt(this,t,e,1,127,-128),Buffer.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},Buffer.prototype.writeInt16LE=function(t,e,r){return t=+t,e|=0,r||checkInt(this,t,e,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):objectWriteUInt16(this,t,e,!0),e+2},Buffer.prototype.writeInt16BE=function(t,e,r){return t=+t,e|=0,r||checkInt(this,t,e,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):objectWriteUInt16(this,t,e,!1),e+2},Buffer.prototype.writeInt32LE=function(t,e,r){return t=+t,e|=0,r||checkInt(this,t,e,4,2147483647,-2147483648),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):objectWriteUInt32(this,t,e,!0),e+4},Buffer.prototype.writeInt32BE=function(t,e,r){return t=+t,e|=0,r||checkInt(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),Buffer.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):objectWriteUInt32(this,t,e,!1),e+4},Buffer.prototype.writeFloatLE=function(t,e,r){return writeFloat(this,t,e,!0,r)},Buffer.prototype.writeFloatBE=function(t,e,r){return writeFloat(this,t,e,!1,r)},Buffer.prototype.writeDoubleLE=function(t,e,r){return writeDouble(this,t,e,!0,r)},Buffer.prototype.writeDoubleBE=function(t,e,r){return writeDouble(this,t,e,!1,r)},Buffer.prototype.copy=function(t,e,r,n){if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);var f,i=n-r;if(this===t&&r<e&&e<n)for(f=i-1;f>=0;--f)t[f+e]=this[f+r];else if(i<1e3||!Buffer.TYPED_ARRAY_SUPPORT)for(f=0;f<i;++f)t[f+e]=this[f+r];else Uint8Array.prototype.set.call(t,this.subarray(r,r+i),e);return i},Buffer.prototype.fill=function(t,e,r,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===t.length){var f=t.charCodeAt(0);f<256&&(t=f)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!Buffer.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;var i;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(i=e;i<r;++i)this[i]=t;else{var o=Buffer.isBuffer(t)?t:utf8ToBytes(new Buffer(t,n).toString()),u=o.length;for(i=0;i<r-e;++i)this[i+e]=o[i%u]}return this};var INVALID_BASE64_RE=/[^+\/0-9A-Za-z-_]/g;function base64clean(t){if((t=stringtrim(t).replace(INVALID_BASE64_RE,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}function stringtrim(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function toHex(t){return t<16?"0"+t.toString(16):t.toString(16)}function utf8ToBytes(t,e){var r;e=e||1/0;for(var n=t.length,f=null,i=[],o=0;o<n;++o){if((r=t.charCodeAt(o))>55295&&r<57344){if(!f){if(r>56319){(e-=3)>-1&&i.push(239,191,189);continue}if(o+1===n){(e-=3)>-1&&i.push(239,191,189);continue}f=r;continue}if(r<56320){(e-=3)>-1&&i.push(239,191,189),f=r;continue}r=65536+(f-55296<<10|r-56320)}else f&&(e-=3)>-1&&i.push(239,191,189);if(f=null,r<128){if((e-=1)<0)break;i.push(r)}else if(r<2048){if((e-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function asciiToBytes(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}function utf16leToBytes(t,e){for(var r,n,f,i=[],o=0;o<t.length&&!((e-=2)<0);++o)n=(r=t.charCodeAt(o))>>8,f=r%256,i.push(f),i.push(n);return i}function base64ToBytes(t){return base64.toByteArray(base64clean(t))}function blitBuffer(t,e,r,n){for(var f=0;f<n&&!(f+r>=e.length||f>=t.length);++f)e[f+r]=t[f];return f}function isnan(t){return t!=t}

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"base64-js":49,"ieee754":92,"isarray":96}],53:[function(require,module,exports){
(function (Buffer){
function isArray(r){return Array.isArray?Array.isArray(r):"[object Array]"===objectToString(r)}function isBoolean(r){return"boolean"==typeof r}function isNull(r){return null===r}function isNullOrUndefined(r){return null==r}function isNumber(r){return"number"==typeof r}function isString(r){return"string"==typeof r}function isSymbol(r){return"symbol"==typeof r}function isUndefined(r){return void 0===r}function isRegExp(r){return"[object RegExp]"===objectToString(r)}function isObject(r){return"object"==typeof r&&null!==r}function isDate(r){return"[object Date]"===objectToString(r)}function isError(r){return"[object Error]"===objectToString(r)||r instanceof Error}function isFunction(r){return"function"==typeof r}function isPrimitive(r){return null===r||"boolean"==typeof r||"number"==typeof r||"string"==typeof r||"symbol"==typeof r||void 0===r}function objectToString(r){return Object.prototype.toString.call(r)}exports.isArray=isArray,exports.isBoolean=isBoolean,exports.isNull=isNull,exports.isNullOrUndefined=isNullOrUndefined,exports.isNumber=isNumber,exports.isString=isString,exports.isSymbol=isSymbol,exports.isUndefined=isUndefined,exports.isRegExp=isRegExp,exports.isObject=isObject,exports.isDate=isDate,exports.isError=isError,exports.isFunction=isFunction,exports.isPrimitive=isPrimitive,exports.isBuffer=Buffer.isBuffer;

}).call(this,{"isBuffer":require("../../is-buffer/index.js")})
},{"../../is-buffer/index.js":95}],54:[function(require,module,exports){
var util=require("util"),AbstractIterator=require("abstract-leveldown").AbstractIterator;function DeferredIterator(t){AbstractIterator.call(this,t),this._options=t,this._iterator=null,this._operations=[]}util.inherits(DeferredIterator,AbstractIterator),DeferredIterator.prototype.setDb=function(t){var r=this._iterator=t.iterator(this._options);this._operations.forEach(function(t){r[t.method].apply(r,t.args)})},DeferredIterator.prototype._operation=function(t,r){if(this._iterator)return this._iterator[t].apply(this._iterator,r);this._operations.push({method:t,args:r})},"next end".split(" ").forEach(function(t){DeferredIterator.prototype["_"+t]=function(){this._operation(t,arguments)}}),module.exports=DeferredIterator;

},{"abstract-leveldown":59,"util":309}],55:[function(require,module,exports){
(function (Buffer,process){
var util=require("util"),AbstractLevelDOWN=require("abstract-leveldown").AbstractLevelDOWN,DeferredIterator=require("./deferred-iterator");function DeferredLevelDOWN(e){AbstractLevelDOWN.call(this,"string"==typeof e?e:""),this._db=void 0,this._operations=[],this._iterators=[]}util.inherits(DeferredLevelDOWN,AbstractLevelDOWN),DeferredLevelDOWN.prototype.setDb=function(e){this._db=e,this._operations.forEach(function(r){e[r.method].apply(e,r.args)}),this._iterators.forEach(function(r){r.setDb(e)})},DeferredLevelDOWN.prototype._open=function(e,r){return process.nextTick(r)},DeferredLevelDOWN.prototype._operation=function(e,r){if(this._db)return this._db[e].apply(this._db,r);this._operations.push({method:e,args:r})},"put get del batch approximateSize".split(" ").forEach(function(e){DeferredLevelDOWN.prototype["_"+e]=function(){this._operation(e,arguments)}}),DeferredLevelDOWN.prototype._isBuffer=function(e){return Buffer.isBuffer(e)},DeferredLevelDOWN.prototype._iterator=function(e){if(this._db)return this._db.iterator.apply(this._db,arguments);var r=new DeferredIterator(e);return this._iterators.push(r),r},module.exports=DeferredLevelDOWN,module.exports.DeferredIterator=DeferredIterator;

}).call(this,{"isBuffer":require("../is-buffer/index.js")},require('_process'))
},{"../is-buffer/index.js":95,"./deferred-iterator":54,"_process":140,"abstract-leveldown":59,"util":309}],56:[function(require,module,exports){
(function (process){
function AbstractChainedBatch(t){this._db=t,this._operations=[],this._written=!1}AbstractChainedBatch.prototype._serializeKey=function(t){return this._db._serializeKey(t)},AbstractChainedBatch.prototype._serializeValue=function(t){return this._db._serializeValue(t)},AbstractChainedBatch.prototype._checkWritten=function(){if(this._written)throw new Error("write() already called on this batch")},AbstractChainedBatch.prototype.put=function(t,e){this._checkWritten();var i=this._db._checkKey(t,"key",this._db._isBuffer);if(i)throw i;return t=this._serializeKey(t),e=this._serializeValue(e),"function"==typeof this._put?this._put(t,e):this._operations.push({type:"put",key:t,value:e}),this},AbstractChainedBatch.prototype.del=function(t){this._checkWritten();var e=this._db._checkKey(t,"key",this._db._isBuffer);if(e)throw e;return t=this._serializeKey(t),"function"==typeof this._del?this._del(t):this._operations.push({type:"del",key:t}),this},AbstractChainedBatch.prototype.clear=function(){return this._checkWritten(),this._operations=[],"function"==typeof this._clear&&this._clear(),this},AbstractChainedBatch.prototype.write=function(t,e){if(this._checkWritten(),"function"==typeof t&&(e=t),"function"!=typeof e)throw new Error("write() requires a callback argument");return"object"!=typeof t&&(t={}),this._written=!0,"function"==typeof this._write?this._write(e):"function"==typeof this._db._batch?this._db._batch(this._operations,t,e):void process.nextTick(e)},module.exports=AbstractChainedBatch;

}).call(this,require('_process'))
},{"_process":140}],57:[function(require,module,exports){
(function (process){
function AbstractIterator(t){this.db=t,this._ended=!1,this._nexting=!1}AbstractIterator.prototype.next=function(t){var e=this;if("function"!=typeof t)throw new Error("next() requires a callback argument");return e._ended?t(new Error("cannot call next() after end()")):e._nexting?t(new Error("cannot call next() before previous next() has completed")):(e._nexting=!0,"function"==typeof e._next?e._next(function(){e._nexting=!1,t.apply(null,arguments)}):void process.nextTick(function(){e._nexting=!1,t()}))},AbstractIterator.prototype.end=function(t){if("function"!=typeof t)throw new Error("end() requires a callback argument");return this._ended?t(new Error("end() already called on iterator")):(this._ended=!0,"function"==typeof this._end?this._end(t):void process.nextTick(t))},module.exports=AbstractIterator;

}).call(this,require('_process'))
},{"_process":140}],58:[function(require,module,exports){
(function (Buffer,process){
var xtend=require("xtend"),AbstractIterator=require("./abstract-iterator"),AbstractChainedBatch=require("./abstract-chained-batch");function AbstractLevelDOWN(t){if(!arguments.length||void 0===t)throw new Error("constructor requires at least a location argument");if("string"!=typeof t)throw new Error("constructor requires a location string argument");this.location=t,this.status="new"}AbstractLevelDOWN.prototype.open=function(t,e){var r=this,i=this.status;if("function"==typeof t&&(e=t),"function"!=typeof e)throw new Error("open() requires a callback argument");"object"!=typeof t&&(t={}),t.createIfMissing=0!=t.createIfMissing,t.errorIfExists=!!t.errorIfExists,"function"==typeof this._open?(this.status="opening",this._open(t,function(t){if(t)return r.status=i,e(t);r.status="open",e()})):(this.status="open",process.nextTick(e))},AbstractLevelDOWN.prototype.close=function(t){var e=this,r=this.status;if("function"!=typeof t)throw new Error("close() requires a callback argument");"function"==typeof this._close?(this.status="closing",this._close(function(i){if(i)return e.status=r,t(i);e.status="closed",t()})):(this.status="closed",process.nextTick(t))},AbstractLevelDOWN.prototype.get=function(t,e,r){var i;if("function"==typeof e&&(r=e),"function"!=typeof r)throw new Error("get() requires a callback argument");return(i=this._checkKey(t,"key"))?r(i):(t=this._serializeKey(t),"object"!=typeof e&&(e={}),e.asBuffer=0!=e.asBuffer,"function"==typeof this._get?this._get(t,e,r):void process.nextTick(function(){r(new Error("NotFound"))}))},AbstractLevelDOWN.prototype.put=function(t,e,r,i){var o;if("function"==typeof r&&(i=r),"function"!=typeof i)throw new Error("put() requires a callback argument");return(o=this._checkKey(t,"key"))?i(o):(t=this._serializeKey(t),e=this._serializeValue(e),"object"!=typeof r&&(r={}),"function"==typeof this._put?this._put(t,e,r,i):void process.nextTick(i))},AbstractLevelDOWN.prototype.del=function(t,e,r){var i;if("function"==typeof e&&(r=e),"function"!=typeof r)throw new Error("del() requires a callback argument");return(i=this._checkKey(t,"key"))?r(i):(t=this._serializeKey(t),"object"!=typeof e&&(e={}),"function"==typeof this._del?this._del(t,e,r):void process.nextTick(r))},AbstractLevelDOWN.prototype.batch=function(t,e,r){if(!arguments.length)return this._chainedBatch();if("function"==typeof e&&(r=e),"function"==typeof t&&(r=t),"function"!=typeof r)throw new Error("batch(array) requires a callback argument");if(!Array.isArray(t))return r(new Error("batch(array) requires an array argument"));e&&"object"==typeof e||(e={});for(var i,o,n=0,s=t.length;n<s;n++)if("object"==typeof(i=t[n])){if(o=this._checkKey(i.type,"type"))return r(o);if(o=this._checkKey(i.key,"key"))return r(o)}if("function"==typeof this._batch)return this._batch(t,e,r);process.nextTick(r)},AbstractLevelDOWN.prototype.approximateSize=function(t,e,r){if(null==t||null==e||"function"==typeof t||"function"==typeof e)throw new Error("approximateSize() requires valid `start`, `end` and `callback` arguments");if("function"!=typeof r)throw new Error("approximateSize() requires a callback argument");if(t=this._serializeKey(t),e=this._serializeKey(e),"function"==typeof this._approximateSize)return this._approximateSize(t,e,r);process.nextTick(function(){r(null,0)})},AbstractLevelDOWN.prototype._setupIteratorOptions=function(t){var e=this;return t=xtend(t),["start","end","gt","gte","lt","lte"].forEach(function(r){t[r]&&e._isBuffer(t[r])&&0===t[r].length&&delete t[r]}),t.reverse=!!t.reverse,t.keys=0!=t.keys,t.values=0!=t.values,t.limit="limit"in t?t.limit:-1,t.keyAsBuffer=0!=t.keyAsBuffer,t.valueAsBuffer=0!=t.valueAsBuffer,t},AbstractLevelDOWN.prototype.iterator=function(t){return"object"!=typeof t&&(t={}),t=this._setupIteratorOptions(t),"function"==typeof this._iterator?this._iterator(t):new AbstractIterator(this)},AbstractLevelDOWN.prototype._chainedBatch=function(){return new AbstractChainedBatch(this)},AbstractLevelDOWN.prototype._isBuffer=function(t){return Buffer.isBuffer(t)},AbstractLevelDOWN.prototype._serializeKey=function(t){return this._isBuffer(t)?t:String(t)},AbstractLevelDOWN.prototype._serializeValue=function(t){return null==t?"":this._isBuffer(t)||process.browser?t:String(t)},AbstractLevelDOWN.prototype._checkKey=function(t,e){return null===t||void 0===t?new Error(e+" cannot be `null` or `undefined`"):this._isBuffer(t)&&0===t.length?new Error(e+" cannot be an empty Buffer"):""===String(t)?new Error(e+" cannot be an empty String"):void 0},module.exports=AbstractLevelDOWN;

}).call(this,{"isBuffer":require("../../../is-buffer/index.js")},require('_process'))
},{"../../../is-buffer/index.js":95,"./abstract-chained-batch":56,"./abstract-iterator":57,"_process":140,"xtend":311}],59:[function(require,module,exports){
exports.AbstractLevelDOWN=require("./abstract-leveldown"),exports.AbstractIterator=require("./abstract-iterator"),exports.AbstractChainedBatch=require("./abstract-chained-batch"),exports.isLevelDOWN=require("./is-leveldown");

},{"./abstract-chained-batch":56,"./abstract-iterator":57,"./abstract-leveldown":58,"./is-leveldown":60}],60:[function(require,module,exports){
var AbstractLevelDOWN=require("./abstract-leveldown");function isLevelDOWN(e){return!(!e||"object"!=typeof e)&&Object.keys(AbstractLevelDOWN.prototype).filter(function(e){return"_"!=e[0]&&"approximateSize"!=e}).every(function(t){return"function"==typeof e[t]})}module.exports=isLevelDOWN;

},{"./abstract-leveldown":58}],61:[function(require,module,exports){
"use strict";function Deque(t){if(this._capacity=getCapacity(t),this._length=0,this._front=0,this._makeCapacity(),isArray(t)){for(var e=t.length,i=0;i<e;++i)this[i]=t[i];this._length=e}}Deque.prototype.toArray=function(){for(var t=this._length,e=new Array(t),i=this._front,r=this._capacity,o=0;o<t;++o)e[o]=this[i+o&r-1];return e},Deque.prototype.push=function(t){var e=arguments.length,i=this._length;if(e>1){var r=this._capacity;if(i+e>r){for(var o=0;o<e;++o){this._checkCapacity(i+1),this[h=this._front+i&this._capacity-1]=arguments[o],i++,this._length=i}return i}for(var h=this._front,o=0;o<e;++o)this[h+i&r-1]=arguments[o],h++;return this._length=i+e,i+e}return 0===e?i:(this._checkCapacity(i+1),this[o=this._front+i&this._capacity-1]=t,this._length=i+1,i+1)},Deque.prototype.pop=function(){var t=this._length;if(0!==t){var e=this._front+t-1&this._capacity-1,i=this[e];return this[e]=void 0,this._length=t-1,i}},Deque.prototype.shift=function(){var t=this._length;if(0!==t){var e=this._front,i=this[e];return this[e]=void 0,this._front=e+1&this._capacity-1,this._length=t-1,i}},Deque.prototype.unshift=function(t){var e=this._length,i=arguments.length;if(i>1){if(e+i>(o=this._capacity)){for(var r=i-1;r>=0;r--){this._checkCapacity(e+1);var o=this._capacity;this[n=(this._front-1&o-1^o)-o]=arguments[r],e++,this._length=e,this._front=n}return e}var h=this._front;for(r=i-1;r>=0;r--){var n;this[n=(h-1&o-1^o)-o]=arguments[r],h=n}return this._front=h,this._length=e+i,e+i}if(0===i)return e;this._checkCapacity(e+1);o=this._capacity;return this[r=(this._front-1&o-1^o)-o]=t,this._length=e+1,this._front=r,e+1},Deque.prototype.peekBack=function(){var t=this._length;if(0!==t)return this[this._front+t-1&this._capacity-1]},Deque.prototype.peekFront=function(){if(0!==this._length)return this[this._front]},Deque.prototype.get=function(t){var e=t;if(e===(0|e)){var i=this._length;if(e<0&&(e+=i),!(e<0||e>=i))return this[this._front+e&this._capacity-1]}},Deque.prototype.isEmpty=function(){return 0===this._length},Deque.prototype.clear=function(){this._length=0,this._front=0,this._makeCapacity()},Deque.prototype.toString=function(){return this.toArray().toString()},Deque.prototype.valueOf=Deque.prototype.toString,Deque.prototype.removeFront=Deque.prototype.shift,Deque.prototype.removeBack=Deque.prototype.pop,Deque.prototype.insertFront=Deque.prototype.unshift,Deque.prototype.insertBack=Deque.prototype.push,Deque.prototype.enqueue=Deque.prototype.push,Deque.prototype.dequeue=Deque.prototype.shift,Deque.prototype.toJSON=Deque.prototype.toArray,Object.defineProperty(Deque.prototype,"length",{get:function(){return this._length},set:function(){throw new RangeError("")}}),Deque.prototype._makeCapacity=function(){for(var t=this._capacity,e=0;e<t;++e)this[e]=void 0},Deque.prototype._checkCapacity=function(t){this._capacity<t&&this._resizeTo(getCapacity(1.5*this._capacity+16))},Deque.prototype._resizeTo=function(t){var e=this._front,i=this._capacity,r=new Array(i),o=this._length;if(arrayCopy(this,0,r,0,i),this._capacity=t,this._makeCapacity(),this._front=0,e+o<=i)arrayCopy(r,e,this,0,o);else{var h=o-(e+o&i-1);arrayCopy(r,e,this,0,h),arrayCopy(r,0,this,h,o-h)}};var isArray=Array.isArray;function arrayCopy(t,e,i,r,o){for(var h=0;h<o;++h)i[h+r]=t[h+e]}function pow2AtLeast(t){return t>>>=0,t-=1,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,(t|=t>>16)+1}function getCapacity(t){if("number"!=typeof t){if(!isArray(t))return 16;t=t.length}return pow2AtLeast(Math.min(Math.max(16,t),1073741824))}module.exports=Deque;

},{}],62:[function(require,module,exports){
var prr=require("prr");function init(r,t,e){t&&"string"!=typeof t&&(t=t.message||t.name),prr(this,{type:r,name:r,cause:"string"!=typeof t?t:e,message:t},"ewr")}function CustomError(r,t){Error.call(this),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),init.call(this,"CustomError",r,t)}function createError(r,t,e){var s=function(e,o){init.call(this,t,e,o),"FilesystemError"==t&&(this.code=this.cause.code,this.path=this.cause.path,this.errno=this.cause.errno,this.message=(r.errno[this.cause.errno]?r.errno[this.cause.errno].description:this.cause.message)+(this.cause.path?" ["+this.cause.path+"]":"")),Error.call(this),Error.captureStackTrace&&Error.captureStackTrace(this,s)};return s.prototype=e?new e:new CustomError,s}CustomError.prototype=new Error,module.exports=function(r){var t=function(t,e){return createError(r,t,e)};return{CustomError:CustomError,FilesystemError:t("FilesystemError"),createError:t}};

},{"prr":141}],63:[function(require,module,exports){
var all=module.exports.all=[{errno:-2,code:"ENOENT",description:"no such file or directory"},{errno:-1,code:"UNKNOWN",description:"unknown error"},{errno:0,code:"OK",description:"success"},{errno:1,code:"EOF",description:"end of file"},{errno:2,code:"EADDRINFO",description:"getaddrinfo error"},{errno:3,code:"EACCES",description:"permission denied"},{errno:4,code:"EAGAIN",description:"resource temporarily unavailable"},{errno:5,code:"EADDRINUSE",description:"address already in use"},{errno:6,code:"EADDRNOTAVAIL",description:"address not available"},{errno:7,code:"EAFNOSUPPORT",description:"address family not supported"},{errno:8,code:"EALREADY",description:"connection already in progress"},{errno:9,code:"EBADF",description:"bad file descriptor"},{errno:10,code:"EBUSY",description:"resource busy or locked"},{errno:11,code:"ECONNABORTED",description:"software caused connection abort"},{errno:12,code:"ECONNREFUSED",description:"connection refused"},{errno:13,code:"ECONNRESET",description:"connection reset by peer"},{errno:14,code:"EDESTADDRREQ",description:"destination address required"},{errno:15,code:"EFAULT",description:"bad address in system call argument"},{errno:16,code:"EHOSTUNREACH",description:"host is unreachable"},{errno:17,code:"EINTR",description:"interrupted system call"},{errno:18,code:"EINVAL",description:"invalid argument"},{errno:19,code:"EISCONN",description:"socket is already connected"},{errno:20,code:"EMFILE",description:"too many open files"},{errno:21,code:"EMSGSIZE",description:"message too long"},{errno:22,code:"ENETDOWN",description:"network is down"},{errno:23,code:"ENETUNREACH",description:"network is unreachable"},{errno:24,code:"ENFILE",description:"file table overflow"},{errno:25,code:"ENOBUFS",description:"no buffer space available"},{errno:26,code:"ENOMEM",description:"not enough memory"},{errno:27,code:"ENOTDIR",description:"not a directory"},{errno:28,code:"EISDIR",description:"illegal operation on a directory"},{errno:29,code:"ENONET",description:"machine is not on the network"},{errno:31,code:"ENOTCONN",description:"socket is not connected"},{errno:32,code:"ENOTSOCK",description:"socket operation on non-socket"},{errno:33,code:"ENOTSUP",description:"operation not supported on socket"},{errno:34,code:"ENOENT",description:"no such file or directory"},{errno:35,code:"ENOSYS",description:"function not implemented"},{errno:36,code:"EPIPE",description:"broken pipe"},{errno:37,code:"EPROTO",description:"protocol error"},{errno:38,code:"EPROTONOSUPPORT",description:"protocol not supported"},{errno:39,code:"EPROTOTYPE",description:"protocol wrong type for socket"},{errno:40,code:"ETIMEDOUT",description:"connection timed out"},{errno:41,code:"ECHARSET",description:"invalid Unicode character"},{errno:42,code:"EAIFAMNOSUPPORT",description:"address family for hostname not supported"},{errno:44,code:"EAISERVICE",description:"servname not supported for ai_socktype"},{errno:45,code:"EAISOCKTYPE",description:"ai_socktype not supported"},{errno:46,code:"ESHUTDOWN",description:"cannot send after transport endpoint shutdown"},{errno:47,code:"EEXIST",description:"file already exists"},{errno:48,code:"ESRCH",description:"no such process"},{errno:49,code:"ENAMETOOLONG",description:"name too long"},{errno:50,code:"EPERM",description:"operation not permitted"},{errno:51,code:"ELOOP",description:"too many symbolic links encountered"},{errno:52,code:"EXDEV",description:"cross-device link not permitted"},{errno:53,code:"ENOTEMPTY",description:"directory not empty"},{errno:54,code:"ENOSPC",description:"no space left on device"},{errno:55,code:"EIO",description:"i/o error"},{errno:56,code:"EROFS",description:"read-only file system"},{errno:57,code:"ENODEV",description:"no such device"},{errno:58,code:"ESPIPE",description:"invalid seek"},{errno:59,code:"ECANCELED",description:"operation canceled"}];module.exports.errno={},module.exports.code={},all.forEach(function(e){module.exports.errno[e.errno]=e,module.exports.code[e.code]=e}),module.exports.custom=require("./custom")(module.exports),module.exports.create=module.exports.custom.createError;

},{"./custom":62}],64:[function(require,module,exports){
!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():(t.PromisePool=e(),t.promisePool=t.PromisePool)}(this,function(){"use strict";var t=function(){this._listeners={}};t.prototype.addEventListener=function(t,e){this._listeners[t]=this._listeners[t]||[],this._listeners[t].indexOf(e)<0&&this._listeners[t].push(e)},t.prototype.removeEventListener=function(t,e){if(this._listeners[t]){var i=this._listeners[t].indexOf(e);i>=0&&this._listeners[t].splice(i,1)}},t.prototype.dispatchEvent=function(t){if(this._listeners[t.type]&&this._listeners[t.type].length)for(var e=this._listeners[t.type].slice(),i=0,o=e.length;i<o;++i)e[i].call(this,t)};var e=function(t){var e=!1;return{next:function(){return e?{done:!0}:(e=!0,{value:t})}}},i=function(t,e,i){this.target=t,this.type=e,this.data=i},o=function(i,o,n){if(t.call(this),"number"!=typeof o||Math.floor(o)!==o||o<1)throw new Error("Invalid concurrency");this._concurrency=o,this._options=n||{},this._options.promise=this._options.promise||Promise,this._iterator=function(t,i){var o,n=typeof t;if("object"===n){if("function"==typeof t.next)return t;if("function"==typeof t.then)return e(t)}return"function"===n?"function"==typeof(o=t).constructor&&"GeneratorFunction"===o.constructor.name?t():function(t){return{next:function(){var e=t();return e?{value:e}:{done:!0}}}}(t):e(i.resolve(t))}(i,this._options.promise),this._done=!1,this._size=0,this._promise=null,this._callbacks=null};return(o.prototype=new t).constructor=o,o.prototype.concurrency=function(t){return void 0!==t&&(this._concurrency=t,this.active()&&this._proceed()),this._concurrency},o.prototype.size=function(){return this._size},o.prototype.active=function(){return!!this._promise},o.prototype.promise=function(){return this._promise},o.prototype.start=function(){var t=this,e=this._options.promise;return this._promise=new e(function(e,i){t._callbacks={reject:i,resolve:e},t._proceed()}),this._promise},o.prototype._fireEvent=function(t,e){this.dispatchEvent(new i(this,t,e))},o.prototype._settle=function(t){t?this._callbacks.reject(t):this._callbacks.resolve(),this._promise=null,this._callbacks=null},o.prototype._onPooledPromiseFulfilled=function(t,e){this._size--,this.active()&&(this._fireEvent("fulfilled",{promise:t,result:e}),this._proceed())},o.prototype._onPooledPromiseRejected=function(t,e){this._size--,this.active()&&(this._fireEvent("rejected",{promise:t,error:e}),this._settle(e||new Error("Unknown error")))},o.prototype._trackPromise=function(t){var e=this;t.then(function(i){e._onPooledPromiseFulfilled(t,i)},function(i){e._onPooledPromiseRejected(t,i)}).catch(function(t){e._settle(new Error("Promise processing failed: "+t))})},o.prototype._proceed=function(){if(!this._done){for(var t=null;this._size<this._concurrency&&!(t=this._iterator.next()).done;)this._size++,this._trackPromise(t.value);this._done=null===t||!!t.done}this._done&&0===this._size&&this._settle()},o.PromisePoolEvent=i,o.PromisePool=o,o});

},{}],65:[function(require,module,exports){
function EventEmitter(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function isFunction(e){return"function"==typeof e}function isNumber(e){return"number"==typeof e}function isObject(e){return"object"==typeof e&&null!==e}function isUndefined(e){return void 0===e}module.exports=EventEmitter,EventEmitter.EventEmitter=EventEmitter,EventEmitter.prototype._events=void 0,EventEmitter.prototype._maxListeners=void 0,EventEmitter.defaultMaxListeners=10,EventEmitter.prototype.setMaxListeners=function(e){if(!isNumber(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},EventEmitter.prototype.emit=function(e){var t,i,n,s,r,o;if(this._events||(this._events={}),"error"===e&&(!this._events.error||isObject(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var h=new Error('Uncaught, unspecified "error" event. ('+t+")");throw h.context=t,h}if(isUndefined(i=this._events[e]))return!1;if(isFunction(i))switch(arguments.length){case 1:i.call(this);break;case 2:i.call(this,arguments[1]);break;case 3:i.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),i.apply(this,s)}else if(isObject(i))for(s=Array.prototype.slice.call(arguments,1),n=(o=i.slice()).length,r=0;r<n;r++)o[r].apply(this,s);return!0},EventEmitter.prototype.addListener=function(e,t){var i;if(!isFunction(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,isFunction(t.listener)?t.listener:t),this._events[e]?isObject(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,isObject(this._events[e])&&!this._events[e].warned&&(i=isUndefined(this._maxListeners)?EventEmitter.defaultMaxListeners:this._maxListeners)&&i>0&&this._events[e].length>i&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.once=function(e,t){if(!isFunction(t))throw TypeError("listener must be a function");var i=!1;function n(){this.removeListener(e,n),i||(i=!0,t.apply(this,arguments))}return n.listener=t,this.on(e,n),this},EventEmitter.prototype.removeListener=function(e,t){var i,n,s,r;if(!isFunction(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(s=(i=this._events[e]).length,n=-1,i===t||isFunction(i.listener)&&i.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(isObject(i)){for(r=s;r-- >0;)if(i[r]===t||i[r].listener&&i[r].listener===t){n=r;break}if(n<0)return this;1===i.length?(i.length=0,delete this._events[e]):i.splice(n,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},EventEmitter.prototype.removeAllListeners=function(e){var t,i;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(isFunction(i=this._events[e]))this.removeListener(e,i);else if(i)for(;i.length;)this.removeListener(e,i[i.length-1]);return delete this._events[e],this},EventEmitter.prototype.listeners=function(e){return this._events&&this._events[e]?isFunction(this._events[e])?[this._events[e]]:this._events[e].slice():[]},EventEmitter.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(isFunction(t))return 1;if(t)return t.length}return 0},EventEmitter.listenerCount=function(e,t){return e.listenerCount(t)};

},{}],66:[function(require,module,exports){
"use strict";var emptyFunction=require("./emptyFunction"),EventListener={listen:function(e,t,n){return e.addEventListener?(e.addEventListener(t,n,!1),{remove:function(){e.removeEventListener(t,n,!1)}}):e.attachEvent?(e.attachEvent("on"+t,n),{remove:function(){e.detachEvent("on"+t,n)}}):void 0},capture:function(e,t,n){return e.addEventListener?(e.addEventListener(t,n,!0),{remove:function(){e.removeEventListener(t,n,!0)}}):{remove:emptyFunction}},registerDefault:function(){}};module.exports=EventListener;

},{"./emptyFunction":73}],67:[function(require,module,exports){
"use strict";var canUseDOM=!("undefined"==typeof window||!window.document||!window.document.createElement),ExecutionEnvironment={canUseDOM:canUseDOM,canUseWorkers:"undefined"!=typeof Worker,canUseEventListeners:canUseDOM&&!(!window.addEventListener&&!window.attachEvent),canUseViewport:canUseDOM&&!!window.screen,isInWorker:!canUseDOM};module.exports=ExecutionEnvironment;

},{}],68:[function(require,module,exports){
"use strict";var _hyphenPattern=/-(.)/g;function camelize(e){return e.replace(_hyphenPattern,function(e,t){return t.toUpperCase()})}module.exports=camelize;

},{}],69:[function(require,module,exports){
"use strict";var camelize=require("./camelize"),msPattern=/^-ms-/;function camelizeStyleName(e){return camelize(e.replace(msPattern,"ms-"))}module.exports=camelizeStyleName;

},{"./camelize":68}],70:[function(require,module,exports){
"use strict";var isTextNode=require("./isTextNode");function containsNode(e,o){var t=!0;e:for(;t;){var n=e,i=o;if(t=!1,n&&i){if(n===i)return!0;if(isTextNode(n))return!1;if(isTextNode(i)){e=n,o=i.parentNode,t=!0;continue e}return n.contains?n.contains(i):!!n.compareDocumentPosition&&!!(16&n.compareDocumentPosition(i))}return!1}}module.exports=containsNode;

},{"./isTextNode":83}],71:[function(require,module,exports){
"use strict";var toArray=require("./toArray");function hasArrayNature(r){return!!r&&("object"==typeof r||"function"==typeof r)&&"length"in r&&!("setInterval"in r)&&"number"!=typeof r.nodeType&&(Array.isArray(r)||"callee"in r||"item"in r)}function createArrayFromMixed(r){return hasArrayNature(r)?Array.isArray(r)?r.slice():toArray(r):[r]}module.exports=createArrayFromMixed;

},{"./toArray":89}],72:[function(require,module,exports){
"use strict";var ExecutionEnvironment=require("./ExecutionEnvironment"),createArrayFromMixed=require("./createArrayFromMixed"),getMarkupWrap=require("./getMarkupWrap"),invariant=require("./invariant"),dummyNode=ExecutionEnvironment.canUseDOM?document.createElement("div"):null,nodeNamePattern=/^\s*<(\w+)/;function getNodeName(e){var r=e.match(nodeNamePattern);return r&&r[1].toLowerCase()}function createNodesFromMarkup(e,r){var a=dummyNode;dummyNode||invariant(!1);var t=getNodeName(e),n=t&&getMarkupWrap(t);if(n){a.innerHTML=n[1]+e+n[2];for(var i=n[0];i--;)a=a.lastChild}else a.innerHTML=e;var o=a.getElementsByTagName("script");o.length&&(r||invariant(!1),createArrayFromMixed(o).forEach(r));for(var m=createArrayFromMixed(a.childNodes);a.lastChild;)a.removeChild(a.lastChild);return m}module.exports=createNodesFromMarkup;

},{"./ExecutionEnvironment":67,"./createArrayFromMixed":71,"./getMarkupWrap":77,"./invariant":81}],73:[function(require,module,exports){
"use strict";function makeEmptyFunction(t){return function(){return t}}function emptyFunction(){}emptyFunction.thatReturns=makeEmptyFunction,emptyFunction.thatReturnsFalse=makeEmptyFunction(!1),emptyFunction.thatReturnsTrue=makeEmptyFunction(!0),emptyFunction.thatReturnsNull=makeEmptyFunction(null),emptyFunction.thatReturnsThis=function(){return this},emptyFunction.thatReturnsArgument=function(t){return t},module.exports=emptyFunction;

},{}],74:[function(require,module,exports){
"use strict";var emptyObject={};module.exports=emptyObject;

},{}],75:[function(require,module,exports){
"use strict";function focusNode(o){try{o.focus()}catch(o){}}module.exports=focusNode;

},{}],76:[function(require,module,exports){
"use strict";function getActiveElement(){if("undefined"==typeof document)return null;try{return document.activeElement||document.body}catch(e){return document.body}}module.exports=getActiveElement;

},{}],77:[function(require,module,exports){
"use strict";var ExecutionEnvironment=require("./ExecutionEnvironment"),invariant=require("./invariant"),dummyNode=ExecutionEnvironment.canUseDOM?document.createElement("div"):null,shouldWrap={},selectWrap=[1,'<select multiple="true">',"</select>"],tableWrap=[1,"<table>","</table>"],trWrap=[3,"<table><tbody><tr>","</tr></tbody></table>"],svgWrap=[1,'<svg xmlns="http://www.w3.org/2000/svg">',"</svg>"],markupWrap={"*":[1,"?<div>","</div>"],area:[1,"<map>","</map>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],legend:[1,"<fieldset>","</fieldset>"],param:[1,"<object>","</object>"],tr:[2,"<table><tbody>","</tbody></table>"],optgroup:selectWrap,option:selectWrap,caption:tableWrap,colgroup:tableWrap,tbody:tableWrap,tfoot:tableWrap,thead:tableWrap,td:trWrap,th:trWrap},svgElements=["circle","clipPath","defs","ellipse","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","text","tspan"];function getMarkupWrap(t){return dummyNode||invariant(!1),markupWrap.hasOwnProperty(t)||(t="*"),shouldWrap.hasOwnProperty(t)||(dummyNode.innerHTML="*"===t?"<link />":"<"+t+"></"+t+">",shouldWrap[t]=!dummyNode.firstChild),shouldWrap[t]?markupWrap[t]:null}svgElements.forEach(function(t){markupWrap[t]=svgWrap,shouldWrap[t]=!0}),module.exports=getMarkupWrap;

},{"./ExecutionEnvironment":67,"./invariant":81}],78:[function(require,module,exports){
"use strict";function getUnboundedScrollPosition(o){return o===window?{x:window.pageXOffset||document.documentElement.scrollLeft,y:window.pageYOffset||document.documentElement.scrollTop}:{x:o.scrollLeft,y:o.scrollTop}}module.exports=getUnboundedScrollPosition;

},{}],79:[function(require,module,exports){
"use strict";var _uppercasePattern=/([A-Z])/g;function hyphenate(e){return e.replace(_uppercasePattern,"-$1").toLowerCase()}module.exports=hyphenate;

},{}],80:[function(require,module,exports){
"use strict";var hyphenate=require("./hyphenate"),msPattern=/^ms-/;function hyphenateStyleName(e){return hyphenate(e).replace(msPattern,"-ms-")}module.exports=hyphenateStyleName;

},{"./hyphenate":79}],81:[function(require,module,exports){
"use strict";function invariant(e,n,r,i,o,a,t,f){if(!e){var s;if(void 0===n)s=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var d=[r,i,o,a,t,f],l=0;(s=new Error(n.replace(/%s/g,function(){return d[l++]}))).name="Invariant Violation"}throw s.framesToPop=1,s}}module.exports=invariant;

},{}],82:[function(require,module,exports){
"use strict";function isNode(e){return!(!e||!("function"==typeof Node?e instanceof Node:"object"==typeof e&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName))}module.exports=isNode;

},{}],83:[function(require,module,exports){
"use strict";var isNode=require("./isNode");function isTextNode(e){return isNode(e)&&3==e.nodeType}module.exports=isTextNode;

},{"./isNode":82}],84:[function(require,module,exports){
"use strict";var invariant=require("./invariant"),keyMirror=function(r){var i,n={};for(i in r instanceof Object&&!Array.isArray(r)||invariant(!1),r)r.hasOwnProperty(i)&&(n[i]=i);return n};module.exports=keyMirror;

},{"./invariant":81}],85:[function(require,module,exports){
"use strict";var keyOf=function(r){var e;for(e in r)if(r.hasOwnProperty(e))return e;return null};module.exports=keyOf;

},{}],86:[function(require,module,exports){
"use strict";var hasOwnProperty=Object.prototype.hasOwnProperty;function mapObject(r,t,e){if(!r)return null;var a={};for(var n in r)hasOwnProperty.call(r,n)&&(a[n]=t.call(e,r[n],n,r));return a}module.exports=mapObject;

},{}],87:[function(require,module,exports){
"use strict";function memoizeStringOnly(n){var r={};return function(t){return r.hasOwnProperty(t)||(r[t]=n.call(this,t)),r[t]}}module.exports=memoizeStringOnly;

},{}],88:[function(require,module,exports){
"use strict";var hasOwnProperty=Object.prototype.hasOwnProperty;function shallowEqual(e,t){if(e===t)return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(var o=hasOwnProperty.bind(t),l=0;l<r.length;l++)if(!o(r[l])||e[r[l]]!==t[r[l]])return!1;return!0}module.exports=shallowEqual;

},{}],89:[function(require,module,exports){
"use strict";var invariant=require("./invariant");function toArray(r){var t=r.length;if((Array.isArray(r)||"object"!=typeof r&&"function"!=typeof r)&&invariant(!1),"number"!=typeof t&&invariant(!1),0===t||t-1 in r||invariant(!1),r.hasOwnProperty)try{return Array.prototype.slice.call(r)}catch(r){}for(var a=Array(t),n=0;n<t;n++)a[n]=r[n];return a}module.exports=toArray;

},{"./invariant":81}],90:[function(require,module,exports){
"use strict";var emptyFunction=require("./emptyFunction"),warning=emptyFunction;module.exports=warning;

},{"./emptyFunction":73}],91:[function(require,module,exports){
"use strict";module.exports=createRBTree;var RED=0,BLACK=1;function RBNode(t,e,r,o,i,l){this._color=t,this.key=e,this.value=r,this.left=o,this.right=i,this._count=l}function cloneNode(t){return new RBNode(t._color,t.key,t.value,t.left,t.right,t._count)}function repaint(t,e){return new RBNode(t,e.key,e.value,e.left,e.right,e._count)}function recount(t){t._count=1+(t.left?t.left._count:0)+(t.right?t.right._count:0)}function RedBlackTree(t,e){this._compare=t,this.root=e}var proto=RedBlackTree.prototype;function doVisitFull(t,e){var r;if(e.left&&(r=doVisitFull(t,e.left)))return r;return(r=t(e.key,e.value))||(e.right?doVisitFull(t,e.right):void 0)}function doVisitHalf(t,e,r,o){if(e(t,o.key)<=0){var i;if(o.left)if(i=doVisitHalf(t,e,r,o.left))return i;if(i=r(o.key,o.value))return i}if(o.right)return doVisitHalf(t,e,r,o.right)}function doVisit(t,e,r,o,i){var l,n=r(t,i.key),f=r(e,i.key);if(n<=0){if(i.left&&(l=doVisit(t,e,r,o,i.left)))return l;if(f>0&&(l=o(i.key,i.value)))return l}if(f>0&&i.right)return doVisit(t,e,r,o,i.right)}function RedBlackTreeIterator(t,e){this.tree=t,this._stack=e}Object.defineProperty(proto,"keys",{get:function(){var t=[];return this.forEach(function(e,r){t.push(e)}),t}}),Object.defineProperty(proto,"values",{get:function(){var t=[];return this.forEach(function(e,r){t.push(r)}),t}}),Object.defineProperty(proto,"length",{get:function(){return this.root?this.root._count:0}}),proto.insert=function(t,e){for(var r=this._compare,o=this.root,i=[],l=[];o;){var n=r(t,o.key);i.push(o),l.push(n),o=n<=0?o.left:o.right}i.push(new RBNode(RED,t,e,null,null,1));for(var f=i.length-2;f>=0;--f){o=i[f];l[f]<=0?i[f]=new RBNode(o._color,o.key,o.value,i[f+1],o.right,o._count+1):i[f]=new RBNode(o._color,o.key,o.value,o.left,i[f+1],o._count+1)}for(f=i.length-1;f>1;--f){var c=i[f-1];o=i[f];if(c._color===BLACK||o._color===BLACK)break;var h=i[f-2];if(h.left===c)if(c.left===o){if(!(u=h.right)||u._color!==RED){if(h._color=RED,h.left=c.right,c._color=BLACK,c.right=h,i[f-2]=c,i[f-1]=o,recount(h),recount(c),f>=3)(a=i[f-3]).left===h?a.left=c:a.right=c;break}c._color=BLACK,h.right=repaint(BLACK,u),h._color=RED,f-=1}else{if(!(u=h.right)||u._color!==RED){if(c.right=o.left,h._color=RED,h.left=o.right,o._color=BLACK,o.left=c,o.right=h,i[f-2]=o,i[f-1]=c,recount(h),recount(c),recount(o),f>=3)(a=i[f-3]).left===h?a.left=o:a.right=o;break}c._color=BLACK,h.right=repaint(BLACK,u),h._color=RED,f-=1}else if(c.right===o){if(!(u=h.left)||u._color!==RED){if(h._color=RED,h.right=c.left,c._color=BLACK,c.left=h,i[f-2]=c,i[f-1]=o,recount(h),recount(c),f>=3)(a=i[f-3]).right===h?a.right=c:a.left=c;break}c._color=BLACK,h.left=repaint(BLACK,u),h._color=RED,f-=1}else{var u;if(!(u=h.left)||u._color!==RED){var a;if(c.left=o.right,h._color=RED,h.right=o.left,o._color=BLACK,o.right=c,o.left=h,i[f-2]=o,i[f-1]=c,recount(h),recount(c),recount(o),f>=3)(a=i[f-3]).right===h?a.right=o:a.left=o;break}c._color=BLACK,h.left=repaint(BLACK,u),h._color=RED,f-=1}}return i[0]._color=BLACK,new RedBlackTree(r,i[0])},proto.forEach=function(t,e,r){if(this.root)switch(arguments.length){case 1:return doVisitFull(t,this.root);case 2:return doVisitHalf(e,this._compare,t,this.root);case 3:if(this._compare(e,r)>=0)return;return doVisit(e,r,this._compare,t,this.root)}},Object.defineProperty(proto,"begin",{get:function(){for(var t=[],e=this.root;e;)t.push(e),e=e.left;return new RedBlackTreeIterator(this,t)}}),Object.defineProperty(proto,"end",{get:function(){for(var t=[],e=this.root;e;)t.push(e),e=e.right;return new RedBlackTreeIterator(this,t)}}),proto.at=function(t){if(t<0)return new RedBlackTreeIterator(this,[]);for(var e=this.root,r=[];;){if(r.push(e),e.left){if(t<e.left._count){e=e.left;continue}t-=e.left._count}if(!t)return new RedBlackTreeIterator(this,r);if(t-=1,!e.right)break;if(t>=e.right._count)break;e=e.right}return new RedBlackTreeIterator(this,[])},proto.ge=function(t){for(var e=this._compare,r=this.root,o=[],i=0;r;){var l=e(t,r.key);o.push(r),l<=0&&(i=o.length),r=l<=0?r.left:r.right}return o.length=i,new RedBlackTreeIterator(this,o)},proto.gt=function(t){for(var e=this._compare,r=this.root,o=[],i=0;r;){var l=e(t,r.key);o.push(r),l<0&&(i=o.length),r=l<0?r.left:r.right}return o.length=i,new RedBlackTreeIterator(this,o)},proto.lt=function(t){for(var e=this._compare,r=this.root,o=[],i=0;r;){var l=e(t,r.key);o.push(r),l>0&&(i=o.length),r=l<=0?r.left:r.right}return o.length=i,new RedBlackTreeIterator(this,o)},proto.le=function(t){for(var e=this._compare,r=this.root,o=[],i=0;r;){var l=e(t,r.key);o.push(r),l>=0&&(i=o.length),r=l<0?r.left:r.right}return o.length=i,new RedBlackTreeIterator(this,o)},proto.find=function(t){for(var e=this._compare,r=this.root,o=[];r;){var i=e(t,r.key);if(o.push(r),0===i)return new RedBlackTreeIterator(this,o);r=i<=0?r.left:r.right}return new RedBlackTreeIterator(this,[])},proto.remove=function(t){var e=this.find(t);return e?e.remove():this},proto.get=function(t){for(var e=this._compare,r=this.root;r;){var o=e(t,r.key);if(0===o)return r.value;r=o<=0?r.left:r.right}};var iproto=RedBlackTreeIterator.prototype;function swapNode(t,e){t.key=e.key,t.value=e.value,t.left=e.left,t.right=e.right,t._color=e._color,t._count=e._count}function fixDoubleBlack(t){for(var e,r,o,i,l=t.length-1;l>=0;--l){if(e=t[l],0===l)return void(e._color=BLACK);if((r=t[l-1]).left===e){if((o=r.right).right&&o.right._color===RED){if(i=(o=r.right=cloneNode(o)).right=cloneNode(o.right),r.right=o.left,o.left=r,o.right=i,o._color=r._color,e._color=BLACK,r._color=BLACK,i._color=BLACK,recount(r),recount(o),l>1)(n=t[l-2]).left===r?n.left=o:n.right=o;return void(t[l-1]=o)}if(o.left&&o.left._color===RED){if(i=(o=r.right=cloneNode(o)).left=cloneNode(o.left),r.right=i.left,o.left=i.right,i.left=r,i.right=o,i._color=r._color,r._color=BLACK,o._color=BLACK,e._color=BLACK,recount(r),recount(o),recount(i),l>1)(n=t[l-2]).left===r?n.left=i:n.right=i;return void(t[l-1]=i)}if(o._color===BLACK){if(r._color===RED)return r._color=BLACK,void(r.right=repaint(RED,o));r.right=repaint(RED,o);continue}o=cloneNode(o),r.right=o.left,o.left=r,o._color=r._color,r._color=RED,recount(r),recount(o),l>1&&((n=t[l-2]).left===r?n.left=o:n.right=o),t[l-1]=o,t[l]=r,l+1<t.length?t[l+1]=e:t.push(e),l+=2}else{if((o=r.left).left&&o.left._color===RED){if(i=(o=r.left=cloneNode(o)).left=cloneNode(o.left),r.left=o.right,o.right=r,o.left=i,o._color=r._color,e._color=BLACK,r._color=BLACK,i._color=BLACK,recount(r),recount(o),l>1)(n=t[l-2]).right===r?n.right=o:n.left=o;return void(t[l-1]=o)}if(o.right&&o.right._color===RED){if(i=(o=r.left=cloneNode(o)).right=cloneNode(o.right),r.left=i.right,o.right=i.left,i.right=r,i.left=o,i._color=r._color,r._color=BLACK,o._color=BLACK,e._color=BLACK,recount(r),recount(o),recount(i),l>1)(n=t[l-2]).right===r?n.right=i:n.left=i;return void(t[l-1]=i)}if(o._color===BLACK){if(r._color===RED)return r._color=BLACK,void(r.left=repaint(RED,o));r.left=repaint(RED,o);continue}var n;o=cloneNode(o),r.left=o.right,o.right=r,o._color=r._color,r._color=RED,recount(r),recount(o),l>1&&((n=t[l-2]).right===r?n.right=o:n.left=o),t[l-1]=o,t[l]=r,l+1<t.length?t[l+1]=e:t.push(e),l+=2}}}function defaultCompare(t,e){return t<e?-1:t>e?1:0}function createRBTree(t){return new RedBlackTree(t||defaultCompare,null)}Object.defineProperty(iproto,"valid",{get:function(){return this._stack.length>0}}),Object.defineProperty(iproto,"node",{get:function(){return this._stack.length>0?this._stack[this._stack.length-1]:null},enumerable:!0}),iproto.clone=function(){return new RedBlackTreeIterator(this.tree,this._stack.slice())},iproto.remove=function(){var t=this._stack;if(0===t.length)return this.tree;var e=new Array(t.length),r=t[t.length-1];e[e.length-1]=new RBNode(r._color,r.key,r.value,r.left,r.right,r._count);for(var o=t.length-2;o>=0;--o){(r=t[o]).left===t[o+1]?e[o]=new RBNode(r._color,r.key,r.value,e[o+1],r.right,r._count):e[o]=new RBNode(r._color,r.key,r.value,r.left,e[o+1],r._count)}if((r=e[e.length-1]).left&&r.right){var i=e.length;for(r=r.left;r.right;)e.push(r),r=r.right;var l=e[i-1];e.push(new RBNode(r._color,l.key,l.value,r.left,r.right,r._count)),e[i-1].key=r.key,e[i-1].value=r.value;for(o=e.length-2;o>=i;--o)r=e[o],e[o]=new RBNode(r._color,r.key,r.value,r.left,e[o+1],r._count);e[i-1].left=e[i]}if((r=e[e.length-1])._color===RED){var n=e[e.length-2];n.left===r?n.left=null:n.right===r&&(n.right=null),e.pop();for(o=0;o<e.length;++o)e[o]._count--;return new RedBlackTree(this.tree._compare,e[0])}if(r.left||r.right){r.left?swapNode(r,r.left):r.right&&swapNode(r,r.right),r._color=BLACK;for(o=0;o<e.length-1;++o)e[o]._count--;return new RedBlackTree(this.tree._compare,e[0])}if(1===e.length)return new RedBlackTree(this.tree._compare,null);for(o=0;o<e.length;++o)e[o]._count--;var f=e[e.length-2];return fixDoubleBlack(e),f.left===r?f.left=null:f.right=null,new RedBlackTree(this.tree._compare,e[0])},Object.defineProperty(iproto,"key",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].key},enumerable:!0}),Object.defineProperty(iproto,"value",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].value},enumerable:!0}),Object.defineProperty(iproto,"index",{get:function(){var t=0,e=this._stack;if(0===e.length){var r=this.tree.root;return r?r._count:0}e[e.length-1].left&&(t=e[e.length-1].left._count);for(var o=e.length-2;o>=0;--o)e[o+1]===e[o].right&&(++t,e[o].left&&(t+=e[o].left._count));return t},enumerable:!0}),iproto.next=function(){var t=this._stack;if(0!==t.length){var e=t[t.length-1];if(e.right)for(e=e.right;e;)t.push(e),e=e.left;else for(t.pop();t.length>0&&t[t.length-1].right===e;)e=t[t.length-1],t.pop()}},Object.defineProperty(iproto,"hasNext",{get:function(){var t=this._stack;if(0===t.length)return!1;if(t[t.length-1].right)return!0;for(var e=t.length-1;e>0;--e)if(t[e-1].left===t[e])return!0;return!1}}),iproto.update=function(t){var e=this._stack;if(0===e.length)throw new Error("Can't update empty node!");var r=new Array(e.length),o=e[e.length-1];r[r.length-1]=new RBNode(o._color,o.key,t,o.left,o.right,o._count);for(var i=e.length-2;i>=0;--i)(o=e[i]).left===e[i+1]?r[i]=new RBNode(o._color,o.key,o.value,r[i+1],o.right,o._count):r[i]=new RBNode(o._color,o.key,o.value,o.left,r[i+1],o._count);return new RedBlackTree(this.tree._compare,r[0])},iproto.prev=function(){var t=this._stack;if(0!==t.length){var e=t[t.length-1];if(e.left)for(e=e.left;e;)t.push(e),e=e.right;else for(t.pop();t.length>0&&t[t.length-1].left===e;)e=t[t.length-1],t.pop()}},Object.defineProperty(iproto,"hasPrev",{get:function(){var t=this._stack;if(0===t.length)return!1;if(t[t.length-1].left)return!0;for(var e=t.length-1;e>0;--e)if(t[e-1].right===t[e])return!0;return!1}});

},{}],92:[function(require,module,exports){
exports.read=function(a,o,t,r,h){var M,p,w=8*h-r-1,f=(1<<w)-1,e=f>>1,i=-7,N=t?h-1:0,n=t?-1:1,s=a[o+N];for(N+=n,M=s&(1<<-i)-1,s>>=-i,i+=w;i>0;M=256*M+a[o+N],N+=n,i-=8);for(p=M&(1<<-i)-1,M>>=-i,i+=r;i>0;p=256*p+a[o+N],N+=n,i-=8);if(0===M)M=1-e;else{if(M===f)return p?NaN:1/0*(s?-1:1);p+=Math.pow(2,r),M-=e}return(s?-1:1)*p*Math.pow(2,M-r)},exports.write=function(a,o,t,r,h,M){var p,w,f,e=8*M-h-1,i=(1<<e)-1,N=i>>1,n=23===h?Math.pow(2,-24)-Math.pow(2,-77):0,s=r?0:M-1,u=r?1:-1,l=o<0||0===o&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(w=isNaN(o)?1:0,p=i):(p=Math.floor(Math.log(o)/Math.LN2),o*(f=Math.pow(2,-p))<1&&(p--,f*=2),(o+=p+N>=1?n/f:n*Math.pow(2,1-N))*f>=2&&(p++,f/=2),p+N>=i?(w=0,p=i):p+N>=1?(w=(o*f-1)*Math.pow(2,h),p+=N):(w=o*Math.pow(2,N-1)*Math.pow(2,h),p=0));h>=8;a[t+s]=255&w,s+=u,w/=256,h-=8);for(p=p<<h|w,e+=h;e>0;a[t+s]=255&p,s+=u,p/=256,e-=8);a[t+s-u]|=128*l};

},{}],93:[function(require,module,exports){
(function (global){
"use strict";var scheduleDrain,draining,Mutation=global.MutationObserver||global.WebKitMutationObserver;if(Mutation){var called=0,observer=new Mutation(nextTick),element=global.document.createTextNode("");observer.observe(element,{characterData:!0}),scheduleDrain=function(){element.data=called=++called%2}}else if(global.setImmediate||void 0===global.MessageChannel)scheduleDrain="document"in global&&"onreadystatechange"in global.document.createElement("script")?function(){var e=global.document.createElement("script");e.onreadystatechange=function(){nextTick(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},global.document.documentElement.appendChild(e)}:function(){setTimeout(nextTick,0)};else{var channel=new global.MessageChannel;channel.port1.onmessage=nextTick,scheduleDrain=function(){channel.port2.postMessage(0)}}var queue=[];function nextTick(){var e,n;draining=!0;for(var a=queue.length;a;){for(n=queue,queue=[],e=-1;++e<a;)n[e]();a=queue.length}draining=!1}function immediate(e){1!==queue.push(e)||draining||scheduleDrain()}module.exports=immediate;

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],94:[function(require,module,exports){
"function"==typeof Object.create?module.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:module.exports=function(t,e){t.super_=e;var o=function(){};o.prototype=e.prototype,t.prototype=new o,t.prototype.constructor=t};

},{}],95:[function(require,module,exports){
function isBuffer(f){return!!f.constructor&&"function"==typeof f.constructor.isBuffer&&f.constructor.isBuffer(f)}function isSlowBuffer(f){return"function"==typeof f.readFloatLE&&"function"==typeof f.slice&&isBuffer(f.slice(0,0))}module.exports=function(f){return null!=f&&(isBuffer(f)||isSlowBuffer(f)||!!f._isBuffer)};

},{}],96:[function(require,module,exports){
var toString={}.toString;module.exports=Array.isArray||function(r){return"[object Array]"==toString.call(r)};

},{}],97:[function(require,module,exports){
(function(){var t=Array.prototype.slice,o=Array.prototype.forEach,r=function(c){if("object"!=typeof c)throw c+" is not an object";var a=t.call(arguments,1);return o.call(a,function(t){if(t)for(var o in t)"object"==typeof t[o]&&c[o]?r.call(c,c[o],t[o]):c[o]=t[o]}),c};this.extend=r}).call(this);

},{}],98:[function(require,module,exports){
var encodings=require("./lib/encodings");function Codec(e){this.opts=e||{},this.encodings=encodings}module.exports=Codec,Codec.prototype._encoding=function(e){return"string"==typeof e&&(e=encodings[e]),e||(e=encodings.id),e},Codec.prototype._keyEncoding=function(e,n){return this._encoding(n&&n.keyEncoding||e&&e.keyEncoding||this.opts.keyEncoding)},Codec.prototype._valueEncoding=function(e,n){return this._encoding(n&&(n.valueEncoding||n.encoding)||e&&(e.valueEncoding||e.encoding)||this.opts.valueEncoding||this.opts.encoding)},Codec.prototype.encodeKey=function(e,n,o){return this._keyEncoding(n,o).encode(e)},Codec.prototype.encodeValue=function(e,n,o){return this._valueEncoding(n,o).encode(e)},Codec.prototype.decodeKey=function(e,n){return this._keyEncoding(n).decode(e)},Codec.prototype.decodeValue=function(e,n){return this._valueEncoding(n).decode(e)},Codec.prototype.encodeBatch=function(e,n){var o=this;return e.map(function(e){var t={type:e.type,key:o.encodeKey(e.key,n,e)};return o.keyAsBuffer(n,e)&&(t.keyEncoding="binary"),e.prefix&&(t.prefix=e.prefix),"value"in e&&(t.value=o.encodeValue(e.value,n,e),o.valueAsBuffer(n,e)&&(t.valueEncoding="binary")),t})};var ltgtKeys=["lt","gt","lte","gte","start","end"];Codec.prototype.encodeLtgt=function(e){var n=this,o={};return Object.keys(e).forEach(function(t){o[t]=ltgtKeys.indexOf(t)>-1?n.encodeKey(e[t],e):e[t]}),o},Codec.prototype.createStreamDecoder=function(e){var n=this;return e.keys&&e.values?function(o,t){return{key:n.decodeKey(o,e),value:n.decodeValue(t,e)}}:e.keys?function(o){return n.decodeKey(o,e)}:e.values?function(o,t){return n.decodeValue(t,e)}:function(){}},Codec.prototype.keyAsBuffer=function(e){return this._keyEncoding(e).buffer},Codec.prototype.valueAsBuffer=function(e){return this._valueEncoding(e).buffer};

},{"./lib/encodings":99}],99:[function(require,module,exports){
(function (Buffer){
exports.utf8=exports["utf-8"]={encode:function(e){return isBinary(e)?e:String(e)},decode:identity,buffer:!1,type:"utf8"},exports.json={encode:JSON.stringify,decode:JSON.parse,buffer:!1,type:"json"},exports.binary={encode:function(e){return isBinary(e)?e:new Buffer(e)},decode:identity,buffer:!0,type:"binary"},exports.id={encode:function(e){return e},decode:function(e){return e},buffer:!1,type:"id"};var bufferEncodings=["hex","ascii","base64","ucs2","ucs-2","utf16le","utf-16le"];function identity(e){return e}function isBinary(e){return void 0===e||null===e||Buffer.isBuffer(e)}bufferEncodings.forEach(function(e){exports[e]={encode:function(n){return isBinary(n)?n:new Buffer(n,e)},decode:function(n){return n.toString(e)},buffer:!0,type:e}});

}).call(this,require("buffer").Buffer)
},{"buffer":52}],100:[function(require,module,exports){
var createError=require("errno").create,LevelUPError=createError("LevelUPError"),NotFoundError=createError("NotFoundError",LevelUPError);NotFoundError.prototype.notFound=!0,NotFoundError.prototype.status=404,module.exports={LevelUPError:LevelUPError,InitializationError:createError("InitializationError",LevelUPError),OpenError:createError("OpenError",LevelUPError),ReadError:createError("ReadError",LevelUPError),WriteError:createError("WriteError",LevelUPError),NotFoundError:NotFoundError,EncodingError:createError("EncodingError",LevelUPError)};

},{"errno":63}],101:[function(require,module,exports){
var inherits=require("inherits"),Readable=require("readable-stream").Readable,extend=require("xtend"),EncodingError=require("level-errors").EncodingError;function ReadStream(e,r){if(!(this instanceof ReadStream))return new ReadStream(e,r);Readable.call(this,extend(r,{objectMode:!0})),this._iterator=e,this._destroyed=!1,this._decoder=null,r&&r.decoder&&(this._decoder=r.decoder),this.on("end",this._cleanup.bind(this))}module.exports=ReadStream,inherits(ReadStream,Readable),ReadStream.prototype._read=function(){var e=this;this._destroyed||this._iterator.next(function(r,t,i){if(!e._destroyed){if(r)return e.emit("error",r);if(void 0===t&&void 0===i)e.push(null);else{if(!e._decoder)return e.push({key:t,value:i});try{i=e._decoder(t,i)}catch(r){return e.emit("error",new EncodingError(r)),void e.push(null)}e.push(i)}}})},ReadStream.prototype.destroy=ReadStream.prototype._cleanup=function(){var e=this;this._destroyed||(this._destroyed=!0,this._iterator.end(function(r){if(r)return e.emit("error",r);e.emit("close")}))};

},{"inherits":94,"level-errors":100,"readable-stream":108,"xtend":311}],102:[function(require,module,exports){
module.exports=Array.isArray||function(r){return"[object Array]"==Object.prototype.toString.call(r)};

},{}],103:[function(require,module,exports){
(function (process){
module.exports=Duplex;var objectKeys=Object.keys||function(e){var t=[];for(var i in e)t.push(i);return t},util=require("core-util-is");util.inherits=require("inherits");var Readable=require("./_stream_readable"),Writable=require("./_stream_writable");function Duplex(e){if(!(this instanceof Duplex))return new Duplex(e);Readable.call(this,e),Writable.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",onend)}function onend(){this.allowHalfOpen||this._writableState.ended||process.nextTick(this.end.bind(this))}function forEach(e,t){for(var i=0,r=e.length;i<r;i++)t(e[i],i)}util.inherits(Duplex,Readable),forEach(objectKeys(Writable.prototype),function(e){Duplex.prototype[e]||(Duplex.prototype[e]=Writable.prototype[e])});

}).call(this,require('_process'))
},{"./_stream_readable":105,"./_stream_writable":107,"_process":140,"core-util-is":53,"inherits":94}],104:[function(require,module,exports){
module.exports=PassThrough;var Transform=require("./_stream_transform"),util=require("core-util-is");function PassThrough(r){if(!(this instanceof PassThrough))return new PassThrough(r);Transform.call(this,r)}util.inherits=require("inherits"),util.inherits(PassThrough,Transform),PassThrough.prototype._transform=function(r,s,i){i(null,r)};

},{"./_stream_transform":106,"core-util-is":53,"inherits":94}],105:[function(require,module,exports){
(function (process){
module.exports=Readable;var isArray=require("isarray"),Buffer=require("buffer").Buffer;Readable.ReadableState=ReadableState;var EE=require("events").EventEmitter;EE.listenerCount||(EE.listenerCount=function(e,t){return e.listeners(t).length});var StringDecoder,Stream=require("stream"),util=require("core-util-is");util.inherits=require("inherits");var debug=require("util");function ReadableState(e,t){var n=require("./_stream_duplex"),r=(e=e||{}).highWaterMark,i=e.objectMode?16:16384;this.highWaterMark=r||0===r?r:i,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.objectMode=!!e.objectMode,t instanceof n&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(StringDecoder||(StringDecoder=require("string_decoder/").StringDecoder),this.decoder=new StringDecoder(e.encoding),this.encoding=e.encoding)}function Readable(e){require("./_stream_duplex");if(!(this instanceof Readable))return new Readable(e);this._readableState=new ReadableState(e,this),this.readable=!0,Stream.call(this)}function readableAddChunk(e,t,n,r,i){var a=chunkInvalid(t,n);if(a)e.emit("error",a);else if(util.isNullOrUndefined(n))t.reading=!1,t.ended||onEofChunk(e,t);else if(t.objectMode||n&&n.length>0)if(t.ended&&!i){var d=new Error("stream.push() after EOF");e.emit("error",d)}else if(t.endEmitted&&i){d=new Error("stream.unshift() after end event");e.emit("error",d)}else!t.decoder||i||r||(n=t.decoder.write(n)),i||(t.reading=!1),t.flowing&&0===t.length&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,i?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&emitReadable(e)),maybeReadMore(e,t);else i||(t.reading=!1);return needMoreData(t)}function needMoreData(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}debug=debug&&debug.debuglog?debug.debuglog("stream"):function(){},util.inherits(Readable,Stream),Readable.prototype.push=function(e,t){var n=this._readableState;return util.isString(e)&&!n.objectMode&&(t=t||n.defaultEncoding)!==n.encoding&&(e=new Buffer(e,t),t=""),readableAddChunk(this,n,e,t,!1)},Readable.prototype.unshift=function(e){return readableAddChunk(this,this._readableState,e,"",!0)},Readable.prototype.setEncoding=function(e){return StringDecoder||(StringDecoder=require("string_decoder/").StringDecoder),this._readableState.decoder=new StringDecoder(e),this._readableState.encoding=e,this};var MAX_HWM=8388608;function roundUpToNextPowerOf2(e){if(e>=MAX_HWM)e=MAX_HWM;else{e--;for(var t=1;t<32;t<<=1)e|=e>>t;e++}return e}function howMuchToRead(e,t){return 0===t.length&&t.ended?0:t.objectMode?0===e?0:1:isNaN(e)||util.isNull(e)?t.flowing&&t.buffer.length?t.buffer[0].length:t.length:e<=0?0:(e>t.highWaterMark&&(t.highWaterMark=roundUpToNextPowerOf2(e)),e>t.length?t.ended?t.length:(t.needReadable=!0,0):e)}function chunkInvalid(e,t){var n=null;return util.isBuffer(t)||util.isString(t)||util.isNullOrUndefined(t)||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n}function onEofChunk(e,t){if(t.decoder&&!t.ended){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,emitReadable(e)}function emitReadable(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(debug("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?process.nextTick(function(){emitReadable_(e)}):emitReadable_(e))}function emitReadable_(e){debug("emit readable"),e.emit("readable"),flow(e)}function maybeReadMore(e,t){t.readingMore||(t.readingMore=!0,process.nextTick(function(){maybeReadMore_(e,t)}))}function maybeReadMore_(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(debug("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function pipeOnDrain(e){return function(){var t=e._readableState;debug("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&EE.listenerCount(e,"data")&&(t.flowing=!0,flow(e))}}function resume(e,t){t.resumeScheduled||(t.resumeScheduled=!0,process.nextTick(function(){resume_(e,t)}))}function resume_(e,t){t.resumeScheduled=!1,e.emit("resume"),flow(e),t.flowing&&!t.reading&&e.read(0)}function flow(e){var t=e._readableState;if(debug("flow",t.flowing),t.flowing)do{var n=e.read()}while(null!==n&&t.flowing)}function fromList(e,t){var n,r=t.buffer,i=t.length,a=!!t.decoder,d=!!t.objectMode;if(0===r.length)return null;if(0===i)n=null;else if(d)n=r.shift();else if(!e||e>=i)n=a?r.join(""):Buffer.concat(r,i),r.length=0;else{if(e<r[0].length)n=(s=r[0]).slice(0,e),r[0]=s.slice(e);else if(e===r[0].length)n=r.shift();else{n=a?"":new Buffer(e);for(var o=0,l=0,u=r.length;l<u&&o<e;l++){var s=r[0],h=Math.min(e-o,s.length);a?n+=s.slice(0,h):s.copy(n,o,0,h),h<s.length?r[0]=s.slice(h):r.shift(),o+=h}}}return n}function endReadable(e){var t=e._readableState;if(t.length>0)throw new Error("endReadable called on non-empty stream");t.endEmitted||(t.ended=!0,process.nextTick(function(){t.endEmitted||0!==t.length||(t.endEmitted=!0,e.readable=!1,e.emit("end"))}))}function forEach(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n)}function indexOf(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}Readable.prototype.read=function(e){debug("read",e);var t=this._readableState,n=e;if((!util.isNumber(e)||e>0)&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return debug("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?endReadable(this):emitReadable(this),null;if(0===(e=howMuchToRead(e,t))&&t.ended)return 0===t.length&&endReadable(this),null;var r,i=t.needReadable;return debug("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&debug("length less than watermark",i=!0),(t.ended||t.reading)&&debug("reading or ended",i=!1),i&&(debug("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1),i&&!t.reading&&(e=howMuchToRead(n,t)),r=e>0?fromList(e,t):null,util.isNull(r)&&(t.needReadable=!0,e=0),t.length-=e,0!==t.length||t.ended||(t.needReadable=!0),n!==e&&t.ended&&0===t.length&&endReadable(this),util.isNull(r)||this.emit("data",r),r},Readable.prototype._read=function(e){this.emit("error",new Error("not implemented"))},Readable.prototype.pipe=function(e,t){var n=this,r=this._readableState;switch(r.pipesCount){case 0:r.pipes=e;break;case 1:r.pipes=[r.pipes,e];break;default:r.pipes.push(e)}r.pipesCount+=1,debug("pipe count=%d opts=%j",r.pipesCount,t);var i=(!t||!1!==t.end)&&e!==process.stdout&&e!==process.stderr?d:l;function a(e){debug("onunpipe"),e===n&&l()}function d(){debug("onend"),e.end()}r.endEmitted?process.nextTick(i):n.once("end",i),e.on("unpipe",a);var o=pipeOnDrain(n);function l(){debug("cleanup"),e.removeListener("close",h),e.removeListener("finish",f),e.removeListener("drain",o),e.removeListener("error",s),e.removeListener("unpipe",a),n.removeListener("end",d),n.removeListener("end",l),n.removeListener("data",u),!r.awaitDrain||e._writableState&&!e._writableState.needDrain||o()}function u(t){debug("ondata"),!1===e.write(t)&&(debug("false write response, pause",n._readableState.awaitDrain),n._readableState.awaitDrain++,n.pause())}function s(t){debug("onerror",t),b(),e.removeListener("error",s),0===EE.listenerCount(e,"error")&&e.emit("error",t)}function h(){e.removeListener("finish",f),b()}function f(){debug("onfinish"),e.removeListener("close",h),b()}function b(){debug("unpipe"),n.unpipe(e)}return e.on("drain",o),n.on("data",u),e._events&&e._events.error?isArray(e._events.error)?e._events.error.unshift(s):e._events.error=[s,e._events.error]:e.on("error",s),e.once("close",h),e.once("finish",f),e.emit("pipe",n),r.flowing||(debug("pipe resume"),n.resume()),e},Readable.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this),this);if(!e){var n=t.pipes,r=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var i=0;i<r;i++)n[i].emit("unpipe",this);return this}return-1===(i=indexOf(t.pipes,e))?this:(t.pipes.splice(i,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this),this)},Readable.prototype.on=function(e,t){var n=Stream.prototype.on.call(this,e,t);if("data"===e&&!1!==this._readableState.flowing&&this.resume(),"readable"===e&&this.readable){var r=this._readableState;if(!r.readableListening)if(r.readableListening=!0,r.emittedReadable=!1,r.needReadable=!0,r.reading)r.length&&emitReadable(this,r);else{var i=this;process.nextTick(function(){debug("readable nexttick read 0"),i.read(0)})}}return n},Readable.prototype.addListener=Readable.prototype.on,Readable.prototype.resume=function(){var e=this._readableState;return e.flowing||(debug("resume"),e.flowing=!0,e.reading||(debug("resume read 0"),this.read(0)),resume(this,e)),this},Readable.prototype.pause=function(){return debug("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(debug("pause"),this._readableState.flowing=!1,this.emit("pause")),this},Readable.prototype.wrap=function(e){var t=this._readableState,n=!1,r=this;for(var i in e.on("end",function(){if(debug("wrapped end"),t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&r.push(e)}r.push(null)}),e.on("data",function(i){(debug("wrapped data"),t.decoder&&(i=t.decoder.write(i)),i&&(t.objectMode||i.length))&&(r.push(i)||(n=!0,e.pause()))}),e)util.isFunction(e[i])&&util.isUndefined(this[i])&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));return forEach(["error","close","destroy","pause","resume"],function(t){e.on(t,r.emit.bind(r,t))}),r._read=function(t){debug("wrapped _read",t),n&&(n=!1,e.resume())},r},Readable._fromList=fromList;

}).call(this,require('_process'))
},{"./_stream_duplex":103,"_process":140,"buffer":52,"core-util-is":53,"events":65,"inherits":94,"isarray":102,"stream":287,"string_decoder/":288,"util":51}],106:[function(require,module,exports){
module.exports=Transform;var Duplex=require("./_stream_duplex"),util=require("core-util-is");function TransformState(r,t){this.afterTransform=function(r,n){return afterTransform(t,r,n)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null}function afterTransform(r,t,n){var e=r._transformState;e.transforming=!1;var i=e.writecb;if(!i)return r.emit("error",new Error("no writecb in Transform class"));e.writechunk=null,e.writecb=null,util.isNullOrUndefined(n)||r.push(n),i&&i(t);var a=r._readableState;a.reading=!1,(a.needReadable||a.length<a.highWaterMark)&&r._read(a.highWaterMark)}function Transform(r){if(!(this instanceof Transform))return new Transform(r);Duplex.call(this,r),this._transformState=new TransformState(r,this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,this.once("prefinish",function(){util.isFunction(this._flush)?this._flush(function(r){done(t,r)}):done(t)})}function done(r,t){if(t)return r.emit("error",t);var n=r._writableState,e=r._transformState;if(n.length)throw new Error("calling transform done when ws.length != 0");if(e.transforming)throw new Error("calling transform done when still transforming");return r.push(null)}util.inherits=require("inherits"),util.inherits(Transform,Duplex),Transform.prototype.push=function(r,t){return this._transformState.needTransform=!1,Duplex.prototype.push.call(this,r,t)},Transform.prototype._transform=function(r,t,n){throw new Error("not implemented")},Transform.prototype._write=function(r,t,n){var e=this._transformState;if(e.writecb=n,e.writechunk=r,e.writeencoding=t,!e.transforming){var i=this._readableState;(e.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},Transform.prototype._read=function(r){var t=this._transformState;util.isNull(t.writechunk)||!t.writecb||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))};

},{"./_stream_duplex":103,"core-util-is":53,"inherits":94}],107:[function(require,module,exports){
(function (process){
module.exports=Writable;var Buffer=require("buffer").Buffer;Writable.WritableState=WritableState;var util=require("core-util-is");util.inherits=require("inherits");var Stream=require("stream");function WriteReq(e,i,t){this.chunk=e,this.encoding=i,this.callback=t}function WritableState(e,i){var t=require("./_stream_duplex"),r=(e=e||{}).highWaterMark,n=e.objectMode?16:16384;this.highWaterMark=r||0===r?r:n,this.objectMode=!!e.objectMode,i instanceof t&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var f=!1===e.decodeStrings;this.decodeStrings=!f,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){onwrite(i,e)},this.writecb=null,this.writelen=0,this.buffer=[],this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1}function Writable(e){var i=require("./_stream_duplex");if(!(this instanceof Writable||this instanceof i))return new Writable(e);this._writableState=new WritableState(e,this),this.writable=!0,Stream.call(this)}function writeAfterEnd(e,i,t){var r=new Error("write after end");e.emit("error",r),process.nextTick(function(){t(r)})}function validChunk(e,i,t,r){var n=!0;if(!(util.isBuffer(t)||util.isString(t)||util.isNullOrUndefined(t)||i.objectMode)){var f=new TypeError("Invalid non-string/buffer chunk");e.emit("error",f),process.nextTick(function(){r(f)}),n=!1}return n}function decodeChunk(e,i,t){return!e.objectMode&&!1!==e.decodeStrings&&util.isString(i)&&(i=new Buffer(i,t)),i}function writeOrBuffer(e,i,t,r,n){t=decodeChunk(i,t,r),util.isBuffer(t)&&(r="buffer");var f=i.objectMode?1:t.length;i.length+=f;var o=i.length<i.highWaterMark;return o||(i.needDrain=!0),i.writing||i.corked?i.buffer.push(new WriteReq(t,r,n)):doWrite(e,i,!1,f,t,r,n),o}function doWrite(e,i,t,r,n,f,o){i.writelen=r,i.writecb=o,i.writing=!0,i.sync=!0,t?e._writev(n,i.onwrite):e._write(n,f,i.onwrite),i.sync=!1}function onwriteError(e,i,t,r,n){t?process.nextTick(function(){i.pendingcb--,n(r)}):(i.pendingcb--,n(r)),e._writableState.errorEmitted=!0,e.emit("error",r)}function onwriteStateUpdate(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function onwrite(e,i){var t=e._writableState,r=t.sync,n=t.writecb;if(onwriteStateUpdate(t),i)onwriteError(e,t,r,i,n);else{var f=needFinish(e,t);f||t.corked||t.bufferProcessing||!t.buffer.length||clearBuffer(e,t),r?process.nextTick(function(){afterWrite(e,t,f,n)}):afterWrite(e,t,f,n)}}function afterWrite(e,i,t,r){t||onwriteDrain(e,i),i.pendingcb--,r(),finishMaybe(e,i)}function onwriteDrain(e,i){0===i.length&&i.needDrain&&(i.needDrain=!1,e.emit("drain"))}function clearBuffer(e,i){if(i.bufferProcessing=!0,e._writev&&i.buffer.length>1){for(var t=[],r=0;r<i.buffer.length;r++)t.push(i.buffer[r].callback);i.pendingcb++,doWrite(e,i,!0,i.length,i.buffer,"",function(e){for(var r=0;r<t.length;r++)i.pendingcb--,t[r](e)}),i.buffer=[]}else{for(r=0;r<i.buffer.length;r++){var n=i.buffer[r],f=n.chunk,o=n.encoding,u=n.callback,s=i.objectMode?1:f.length;if(doWrite(e,i,!1,s,f,o,u),i.writing){r++;break}}r<i.buffer.length?i.buffer=i.buffer.slice(r):i.buffer.length=0}i.bufferProcessing=!1}function needFinish(e,i){return i.ending&&0===i.length&&!i.finished&&!i.writing}function prefinish(e,i){i.prefinished||(i.prefinished=!0,e.emit("prefinish"))}function finishMaybe(e,i){var t=needFinish(e,i);return t&&(0===i.pendingcb?(prefinish(e,i),i.finished=!0,e.emit("finish")):prefinish(e,i)),t}function endWritable(e,i,t){i.ending=!0,finishMaybe(e,i),t&&(i.finished?process.nextTick(t):e.once("finish",t)),i.ended=!0}util.inherits(Writable,Stream),Writable.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},Writable.prototype.write=function(e,i,t){var r=this._writableState,n=!1;return util.isFunction(i)&&(t=i,i=null),util.isBuffer(e)?i="buffer":i||(i=r.defaultEncoding),util.isFunction(t)||(t=function(){}),r.ended?writeAfterEnd(this,r,t):validChunk(this,r,e,t)&&(r.pendingcb++,n=writeOrBuffer(this,r,e,i,t)),n},Writable.prototype.cork=function(){this._writableState.corked++},Writable.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.buffer.length||clearBuffer(this,e))},Writable.prototype._write=function(e,i,t){t(new Error("not implemented"))},Writable.prototype._writev=null,Writable.prototype.end=function(e,i,t){var r=this._writableState;util.isFunction(e)?(t=e,e=null,i=null):util.isFunction(i)&&(t=i,i=null),util.isNullOrUndefined(e)||this.write(e,i),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||endWritable(this,r,t)};

}).call(this,require('_process'))
},{"./_stream_duplex":103,"_process":140,"buffer":52,"core-util-is":53,"inherits":94,"stream":287}],108:[function(require,module,exports){
(function (process){
exports=module.exports=require("./lib/_stream_readable.js"),exports.Stream=require("stream"),exports.Readable=exports,exports.Writable=require("./lib/_stream_writable.js"),exports.Duplex=require("./lib/_stream_duplex.js"),exports.Transform=require("./lib/_stream_transform.js"),exports.PassThrough=require("./lib/_stream_passthrough.js"),process.browser||"disable"!==process.env.READABLE_STREAM||(module.exports=require("stream"));

}).call(this,require('_process'))
},{"./lib/_stream_duplex.js":103,"./lib/_stream_passthrough.js":104,"./lib/_stream_readable.js":105,"./lib/_stream_transform.js":106,"./lib/_stream_writable.js":107,"_process":140,"stream":287}],109:[function(require,module,exports){
var util=require("./util"),WriteError=require("level-errors").WriteError,getOptions=util.getOptions,dispatchError=util.dispatchError;function Batch(t,r){this._levelup=t,this._codec=r,this.batch=t.db.batch(),this.ops=[],this.length=0}Batch.prototype.put=function(t,r,e){e=getOptions(e);var h=this._codec.encodeKey(t,e),i=this._codec.encodeValue(r,e);try{this.batch.put(h,i)}catch(t){throw new WriteError(t)}return this.ops.push({type:"put",key:h,value:i}),this.length++,this},Batch.prototype.del=function(t,r){r=getOptions(r);var e=this._codec.encodeKey(t,r);try{this.batch.del(e)}catch(t){throw new WriteError(t)}return this.ops.push({type:"del",key:e}),this.length++,this},Batch.prototype.clear=function(){try{this.batch.clear()}catch(t){throw new WriteError(t)}return this.ops=[],this.length=0,this},Batch.prototype.write=function(t){var r=this._levelup,e=this.ops;try{this.batch.write(function(h){if(h)return dispatchError(r,new WriteError(h),t);r.emit("batch",e),t&&t()})}catch(t){throw new WriteError(t)}},module.exports=Batch;

},{"./util":111,"level-errors":100}],110:[function(require,module,exports){
(function (process){
var EventEmitter=require("events").EventEmitter,inherits=require("util").inherits,deprecate=require("util").deprecate,extend=require("xtend"),prr=require("prr"),DeferredLevelDOWN=require("deferred-leveldown"),IteratorStream=require("level-iterator-stream"),errors=require("level-errors"),WriteError=errors.WriteError,ReadError=errors.ReadError,NotFoundError=errors.NotFoundError,OpenError=errors.OpenError,EncodingError=errors.EncodingError,InitializationError=errors.InitializationError,util=require("./util"),Batch=require("./batch"),Codec=require("level-codec"),getOptions=util.getOptions,defaultOptions=util.defaultOptions,getLevelDOWN=util.getLevelDOWN,dispatchError=util.dispatchError,isDefined=util.isDefined;function getCallback(e,t){return"function"==typeof e?e:t}function LevelUP(e,t,r){if(!(this instanceof LevelUP))return new LevelUP(e,t,r);var i;if(EventEmitter.call(this),this.setMaxListeners(1/0),"function"==typeof e?((t="object"==typeof t?t:{}).db=e,e=null):"object"==typeof e&&"function"==typeof e.db&&(t=e,e=null),"function"==typeof t&&(r=t,t={}),(!t||"function"!=typeof t.db)&&"string"!=typeof e){if(i=new InitializationError("Must provide a location for the database"),r)return process.nextTick(function(){r(i)});throw i}t=getOptions(t),this.options=extend(defaultOptions,t),this._codec=new Codec(this.options),this._status="new",prr(this,"location",e,"e"),this.open(r)}function maybeError(e,t,r){if(!e._isOpening()&&!e.isOpen())return dispatchError(e,new ReadError("Database is not open"),r),!0}function writeError(e,t,r){dispatchError(e,new WriteError(t),r)}function readError(e,t,r){dispatchError(e,new ReadError(t),r)}function utilStatic(e){return function(t,r){getLevelDOWN()[e](t,r||function(){})}}inherits(LevelUP,EventEmitter),LevelUP.prototype.open=function(e){var t,r,i=this;return this.isOpen()?(e&&process.nextTick(function(){e(null,i)}),this):this._isOpening()?e&&this.once("open",function(){e(null,i)}):(this.emit("opening"),this._status="opening",this.db=new DeferredLevelDOWN(this.location),t=this.options.db||getLevelDOWN(),void(r=t(this.location)).open(this.options,function(t){if(t)return dispatchError(i,new OpenError(t),e);i.db.setDb(r),i.db=r,i._status="open",e&&e(null,i),i.emit("open"),i.emit("ready")}))},LevelUP.prototype.close=function(e){var t=this;if(this.isOpen())this._status="closing",this.db.close(function(){t._status="closed",t.emit("closed"),e&&e.apply(null,arguments)}),this.emit("closing"),this.db=new DeferredLevelDOWN(this.location);else{if("closed"==this._status&&e)return process.nextTick(e);"closing"==this._status&&e?this.once("closed",e):this._isOpening()&&this.once("open",function(){t.close(e)})}},LevelUP.prototype.isOpen=function(){return"open"==this._status},LevelUP.prototype._isOpening=function(){return"opening"==this._status},LevelUP.prototype.isClosed=function(){return/^clos/.test(this._status)},LevelUP.prototype.get=function(e,t,r){var i,o=this;if(r=getCallback(t,r),!maybeError(this,t,r)){if(null===e||void 0===e||"function"!=typeof r)return readError(this,"get() requires key and callback arguments",r);t=util.getOptions(t),i=this._codec.encodeKey(e,t),t.asBuffer=this._codec.valueAsBuffer(t),this.db.get(i,t,function(i,n){if(i)return i=/notfound/i.test(i)||i.notFound?new NotFoundError("Key not found in database ["+e+"]",i):new ReadError(i),dispatchError(o,i,r);if(r){try{n=o._codec.decodeValue(n,t)}catch(e){return r(new EncodingError(e))}r(null,n)}})}},LevelUP.prototype.put=function(e,t,r,i){var o,n,s=this;if(i=getCallback(r,i),null===e||void 0===e)return writeError(this,"put() requires a key argument",i);maybeError(this,r,i)||(r=getOptions(r),o=this._codec.encodeKey(e,r),n=this._codec.encodeValue(t,r),this.db.put(o,n,r,function(r){if(r)return dispatchError(s,new WriteError(r),i);s.emit("put",e,t),i&&i()}))},LevelUP.prototype.del=function(e,t,r){var i,o=this;if(r=getCallback(t,r),null===e||void 0===e)return writeError(this,"del() requires a key argument",r);maybeError(this,t,r)||(t=getOptions(t),i=this._codec.encodeKey(e,t),this.db.del(i,t,function(t){if(t)return dispatchError(o,new WriteError(t),r);o.emit("del",e),r&&r()}))},LevelUP.prototype.batch=function(e,t,r){var i,o=this;return arguments.length?(r=getCallback(t,r),Array.isArray(e)?void(maybeError(this,t,r)||(t=getOptions(t),i=(i=o._codec.encodeBatch(e,t)).map(function(e){return e.type||void 0===e.key||void 0===e.value||(e.type="put"),e}),this.db.batch(i,t,function(t){if(t)return dispatchError(o,new WriteError(t),r);o.emit("batch",e),r&&r()}))):writeError(this,"batch() requires an array argument",r)):new Batch(this,this._codec)},LevelUP.prototype.approximateSize=deprecate(function(e,t,r,i){var o,n,s=this;if(i=getCallback(r,i),r=getOptions(r),null===e||void 0===e||null===t||void 0===t||"function"!=typeof i)return readError(this,"approximateSize() requires start, end and callback arguments",i);o=this._codec.encodeKey(e,r),n=this._codec.encodeKey(t,r),this.db.approximateSize(o,n,function(e,t){if(e)return dispatchError(s,new OpenError(e),i);i&&i(null,t)})},"db.approximateSize() is deprecated. Use db.db.approximateSize() instead"),LevelUP.prototype.readStream=LevelUP.prototype.createReadStream=function(e){return(e=extend({keys:!0,values:!0},this.options,e)).keyEncoding=e.keyEncoding,e.valueEncoding=e.valueEncoding,(e=this._codec.encodeLtgt(e)).keyAsBuffer=this._codec.keyAsBuffer(e),e.valueAsBuffer=this._codec.valueAsBuffer(e),"number"!=typeof e.limit&&(e.limit=-1),new IteratorStream(this.db.iterator(e),extend(e,{decoder:this._codec.createStreamDecoder(e)}))},LevelUP.prototype.keyStream=LevelUP.prototype.createKeyStream=function(e){return this.createReadStream(extend(e,{keys:!0,values:!1}))},LevelUP.prototype.valueStream=LevelUP.prototype.createValueStream=function(e){return this.createReadStream(extend(e,{keys:!1,values:!0}))},LevelUP.prototype.toString=function(){return"LevelUP"},module.exports=LevelUP,module.exports.errors=require("level-errors"),module.exports.destroy=deprecate(utilStatic("destroy"),"levelup.destroy() is deprecated. Use leveldown.destroy() instead"),module.exports.repair=deprecate(utilStatic("repair"),"levelup.repair() is deprecated. Use leveldown.repair() instead");

}).call(this,require('_process'))
},{"./batch":109,"./util":111,"_process":140,"deferred-leveldown":55,"events":65,"level-codec":98,"level-errors":100,"level-iterator-stream":101,"prr":141,"util":309,"xtend":311}],111:[function(require,module,exports){
var leveldown,extend=require("xtend"),LevelUPError=require("level-errors").LevelUPError,format=require("util").format,defaultOptions={createIfMissing:!0,errorIfExists:!1,keyEncoding:"utf8",valueEncoding:"utf8",compression:!0};function getOptions(e){return"string"==typeof e&&(e={valueEncoding:e}),"object"!=typeof e&&(e={}),e}function getLevelDOWN(){if(leveldown)return leveldown;var e,r=require("../package.json").devDependencies.leveldown;try{e=require("leveldown/package").version}catch(e){throw requireError(e)}if(!require("semver").satisfies(e,r))throw new LevelUPError("Installed version of LevelDOWN ("+e+") does not match required version ("+r+")");try{return leveldown=require("leveldown")}catch(e){throw requireError(e)}}function requireError(e){return new LevelUPError(format("Failed to require LevelDOWN (%s). Try `npm install leveldown` if it's missing",e.message))}function dispatchError(e,r,t){"function"==typeof t?t(r):e.emit("error",r)}function isDefined(e){return void 0!==e}module.exports={defaultOptions:defaultOptions,getOptions:getOptions,getLevelDOWN:getLevelDOWN,dispatchError:dispatchError,isDefined:isDefined};

},{"../package.json":112,"level-errors":100,"leveldown":51,"leveldown/package":51,"semver":51,"util":309,"xtend":311}],112:[function(require,module,exports){
module.exports={
  "_args": [
    [
      "levelup@1.3.2",
      "/home/travis/build/Microsoft/pxt"
    ]
  ],
  "_development": true,
  "_from": "levelup@1.3.2",
  "_id": "levelup@1.3.2",
  "_inBundle": false,
  "_integrity": "sha1-syHTBx8OdcLfry8P6IZOW5o4e8k=",
  "_location": "/levelup",
  "_phantomChildren": {},
  "_requested": {
    "type": "version",
    "registry": true,
    "raw": "levelup@1.3.2",
    "name": "levelup",
    "escapedName": "levelup",
    "rawSpec": "1.3.2",
    "saveSpec": null,
    "fetchSpec": "1.3.2"
  },
  "_requiredBy": [
    "/pouchdb"
  ],
  "_resolved": "https://registry.npmjs.org/levelup/-/levelup-1.3.2.tgz",
  "_spec": "1.3.2",
  "_where": "/home/travis/build/Microsoft/pxt",
  "browser": {
    "leveldown": false,
    "leveldown/package": false,
    "semver": false
  },
  "bugs": {
    "url": "https://github.com/level/levelup/issues"
  },
  "contributors": [
    {
      "name": "Rod Vagg",
      "email": "r@va.gg",
      "url": "https://github.com/rvagg"
    },
    {
      "name": "John Chesley",
      "email": "john@chesl.es",
      "url": "https://github.com/chesles/"
    },
    {
      "name": "Jake Verbaten",
      "email": "raynos2@gmail.com",
      "url": "https://github.com/raynos"
    },
    {
      "name": "Dominic Tarr",
      "email": "dominic.tarr@gmail.com",
      "url": "https://github.com/dominictarr"
    },
    {
      "name": "Max Ogden",
      "email": "max@maxogden.com",
      "url": "https://github.com/maxogden"
    },
    {
      "name": "Lars-Magnus Skog",
      "email": "ralphtheninja@riseup.net",
      "url": "https://github.com/ralphtheninja"
    },
    {
      "name": "David Björklund",
      "email": "david.bjorklund@gmail.com",
      "url": "https://github.com/kesla"
    },
    {
      "name": "Julian Gruber",
      "email": "julian@juliangruber.com",
      "url": "https://github.com/juliangruber"
    },
    {
      "name": "Paolo Fragomeni",
      "email": "paolo@async.ly",
      "url": "https://github.com/0x00a"
    },
    {
      "name": "Anton Whalley",
      "email": "anton.whalley@nearform.com",
      "url": "https://github.com/No9"
    },
    {
      "name": "Matteo Collina",
      "email": "matteo.collina@gmail.com",
      "url": "https://github.com/mcollina"
    },
    {
      "name": "Pedro Teixeira",
      "email": "pedro.teixeira@gmail.com",
      "url": "https://github.com/pgte"
    },
    {
      "name": "James Halliday",
      "email": "mail@substack.net",
      "url": "https://github.com/substack"
    },
    {
      "name": "Jarrett Cruger",
      "email": "jcrugzz@gmail.com",
      "url": "https://github.com/jcrugzz"
    }
  ],
  "dependencies": {
    "deferred-leveldown": "~1.2.1",
    "level-codec": "~6.1.0",
    "level-errors": "~1.0.3",
    "level-iterator-stream": "~1.3.0",
    "prr": "~1.0.1",
    "semver": "~5.1.0",
    "xtend": "~4.0.0"
  },
  "description": "Fast & simple storage - a Node.js-style LevelDB wrapper",
  "devDependencies": {
    "async": "~1.5.0",
    "bustermove": "~1.0.0",
    "delayed": "~1.0.1",
    "faucet": "~0.0.1",
    "leveldown": "^1.1.0",
    "memdown": "~1.1.0",
    "msgpack-js": "~0.3.0",
    "referee": "~1.2.0",
    "rimraf": "~2.4.3",
    "slow-stream": "0.0.4",
    "tap": "~2.3.1",
    "tape": "~4.2.1"
  },
  "homepage": "https://github.com/level/levelup",
  "keywords": [
    "leveldb",
    "stream",
    "database",
    "db",
    "store",
    "storage",
    "json"
  ],
  "license": "MIT",
  "main": "lib/levelup.js",
  "name": "levelup",
  "repository": {
    "type": "git",
    "url": "git+https://github.com/level/levelup.git"
  },
  "scripts": {
    "test": "tape test/*-test.js | faucet"
  },
  "version": "1.3.2"
}

},{}],113:[function(require,module,exports){
"use strict";var immediate=require("immediate");function INTERNAL(){}var handlers={},REJECTED=["REJECTED"],FULFILLED=["FULFILLED"],PENDING=["PENDING"];function Promise(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=PENDING,this.queue=[],this.outcome=void 0,e!==INTERNAL&&safelyResolveThenable(this,e)}function QueueItem(e,t,r){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof r&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}function unwrap(e,t,r){immediate(function(){var n;try{n=t(r)}catch(t){return handlers.reject(e,t)}n===e?handlers.reject(e,new TypeError("Cannot resolve promise with itself")):handlers.resolve(e,n)})}function getThen(e){var t=e&&e.then;if(e&&"object"==typeof e&&"function"==typeof t)return function(){t.apply(e,arguments)}}function safelyResolveThenable(e,t){var r=!1;function n(t){r||(r=!0,handlers.reject(e,t))}function o(t){r||(r=!0,handlers.resolve(e,t))}var s=tryCatch(function(){t(o,n)});"error"===s.status&&n(s.value)}function tryCatch(e,t){var r={};try{r.value=e(t),r.status="success"}catch(e){r.status="error",r.value=e}return r}function resolve(e){return e instanceof this?e:handlers.resolve(new this(INTERNAL),e)}function reject(e){var t=new this(INTERNAL);return handlers.reject(t,e)}function all(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,n=!1;if(!r)return this.resolve([]);for(var o=new Array(r),s=0,i=-1,u=new this(INTERNAL);++i<r;)l(e[i],i);return u;function l(e,i){t.resolve(e).then(function(e){o[i]=e,++s!==r||n||(n=!0,handlers.resolve(u,o))},function(e){n||(n=!0,handlers.reject(u,e))})}}function race(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,n=!1;if(!r)return this.resolve([]);for(var o,s=-1,i=new this(INTERNAL);++s<r;)o=e[s],t.resolve(o).then(function(e){n||(n=!0,handlers.resolve(i,e))},function(e){n||(n=!0,handlers.reject(i,e))});return i}module.exports=Promise,Promise.prototype.catch=function(e){return this.then(null,e)},Promise.prototype.then=function(e,t){if("function"!=typeof e&&this.state===FULFILLED||"function"!=typeof t&&this.state===REJECTED)return this;var r=new this.constructor(INTERNAL);this.state!==PENDING?unwrap(r,this.state===FULFILLED?e:t,this.outcome):this.queue.push(new QueueItem(r,e,t));return r},QueueItem.prototype.callFulfilled=function(e){handlers.resolve(this.promise,e)},QueueItem.prototype.otherCallFulfilled=function(e){unwrap(this.promise,this.onFulfilled,e)},QueueItem.prototype.callRejected=function(e){handlers.reject(this.promise,e)},QueueItem.prototype.otherCallRejected=function(e){unwrap(this.promise,this.onRejected,e)},handlers.resolve=function(e,t){var r=tryCatch(getThen,t);if("error"===r.status)return handlers.reject(e,r.value);var n=r.value;if(n)safelyResolveThenable(e,n);else{e.state=FULFILLED,e.outcome=t;for(var o=-1,s=e.queue.length;++o<s;)e.queue[o].callFulfilled(t)}return e},handlers.reject=function(e,t){e.state=REJECTED,e.outcome=t;for(var r=-1,n=e.queue.length;++r<n;)e.queue[r].callRejected(t);return e},Promise.resolve=resolve,Promise.reject=reject,Promise.all=all,Promise.race=race;

},{"immediate":93}],114:[function(require,module,exports){
(function (Buffer){
function has(e,r){return Object.hasOwnProperty.call(e,r)}function isDef(e){return null!=e&&""!==e}exports.compare=function(e,r){if(Buffer.isBuffer(e)){for(var n=Math.min(e.length,r.length),t=0;t<n;t++){var u=e[t]-r[t];if(u)return u}return e.length-r.length}return e<r?-1:e>r?1:0};var lowerBound=exports.lowerBound=function(e){return isDef(e.gt)?e.gt:isDef(e.gte)?e.gte:isDef(e.min)?e.min:isDef(e.start)&&!e.reverse?e.start:isDef(e.end)&&e.reverse?e.end:void 0};exports.lowerBoundInclusive=function(e){return!isDef(e.gt)},exports.upperBoundInclusive=function(e){return!isDef(e.lt)};var lowerBoundExclusive=exports.lowerBoundExclusive=function(e){return!!isDef(e.gt)},upperBoundExclusive=exports.upperBoundExclusive=function(e){return!!isDef(e.lt)},upperBound=exports.upperBound=function(e){return isDef(e.lt)?e.lt:isDef(e.lte)?e.lte:isDef(e.max)?e.max:isDef(e.start)&&e.reverse?e.start:isDef(e.end)&&!e.reverse?e.end:void 0};exports.contains=function(e,r,n){n=n||exports.compare;var t=lowerBound(e);if(isDef(t)&&((u=n(r,t))<0||0===u&&lowerBoundExclusive(e)))return!1;var u,o=upperBound(e);if(isDef(o)&&((u=n(r,o))>0||0===u&&upperBoundExclusive(e)))return!1;return!0},exports.filter=function(e,r){return function(n){return exports.contains(e,n,r)}};

}).call(this,{"isBuffer":require("../is-buffer/index.js")})
},{"../is-buffer/index.js":95}],115:[function(require,module,exports){
(function (global){
!function(e){"use strict";var t={newline:/^\n+/,code:/^( {4}[^\n]+\n*)+/,fences:f,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ *(#{1,6}) *([^\n]+?) *#* *(?:\n+|$)/,nptable:f,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( *)(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?!\1bull )\n*|\s*$)/,html:/^ *(?:comment *(?:\n|\s*$)|closed *(?:\n{2,}|\s*$)|closing *(?:\n{2,}|\s*$))/,def:/^ {0,3}\[(label)\]: *\n? *<?([^\s>]+)>?(?:(?: +\n? *| *\n *)(title))? *(?:\n+|$)/,table:f,lheading:/^([^\n]+)\n *(=|-){2,} *(?:\n+|$)/,paragraph:/^([^\n]+(?:\n?(?!hr|heading|lheading| {0,3}>|tag)[^\n]+)+)/,text:/^[^\n]+/};function n(e){this.tokens=[],this.tokens.links={},this.options=e||k.defaults,this.rules=t.normal,this.options.gfm&&(this.options.tables?this.rules=t.tables:this.rules=t.gfm)}t._label=/(?:\\[\[\]]|[^\[\]])+/,t._title=/(?:"(?:\\"|[^"]|"[^"\n]*")*"|'\n?(?:[^'\n]+\n?)*'|\([^()]*\))/,t.def=p(t.def).replace("label",t._label).replace("title",t._title).getRegex(),t.bullet=/(?:[*+-]|\d+\.)/,t.item=/^( *)(bull) [^\n]*(?:\n(?!\1bull )[^\n]*)*/,t.item=p(t.item,"gm").replace(/bull/g,t.bullet).getRegex(),t.list=p(t.list).replace(/bull/g,t.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+t.def.source+")").getRegex(),t._tag="(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b",t.html=p(t.html).replace("comment",/<!--[\s\S]*?-->/).replace("closed",/<(tag)[\s\S]+?<\/\1>/).replace("closing",/<tag(?:"[^"]*"|'[^']*'|\s[^'"\/>\s]*)*?\/?>/).replace(/tag/g,t._tag).getRegex(),t.paragraph=p(t.paragraph).replace("hr",t.hr).replace("heading",t.heading).replace("lheading",t.lheading).replace("tag","<"+t._tag).getRegex(),t.blockquote=p(t.blockquote).replace("paragraph",t.paragraph).getRegex(),t.normal=d({},t),t.gfm=d({},t.normal,{fences:/^ *(`{3,}|~{3,})[ \.]*(\S+)? *\n([\s\S]*?)\n? *\1 *(?:\n+|$)/,paragraph:/^/,heading:/^ *(#{1,6}) +([^\n]+?) *#* *(?:\n+|$)/}),t.gfm.paragraph=p(t.paragraph).replace("(?!","(?!"+t.gfm.fences.source.replace("\\1","\\2")+"|"+t.list.source.replace("\\1","\\3")+"|").getRegex(),t.tables=d({},t.gfm,{nptable:/^ *(\S.*\|.*)\n *([-:]+ *\|[-| :]*)\n((?:.*\|.*(?:\n|$))*)\n*/,table:/^ *\|(.+)\n *\|( *[-:]+[-| :]*)\n((?: *\|.*(?:\n|$))*)\n*/}),n.rules=t,n.lex=function(e,t){return new n(t).lex(e)},n.prototype.lex=function(e){return e=e.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    ").replace(/\u00a0/g," ").replace(/\u2424/g,"\n"),this.token(e,!0)},n.prototype.token=function(e,n){var r,s,i,l,o,a,h,p,u,c,g;for(e=e.replace(/^ +$/gm,"");e;)if((i=this.rules.newline.exec(e))&&(e=e.substring(i[0].length),i[0].length>1&&this.tokens.push({type:"space"})),i=this.rules.code.exec(e))e=e.substring(i[0].length),i=i[0].replace(/^ {4}/gm,""),this.tokens.push({type:"code",text:this.options.pedantic?i:i.replace(/\n+$/,"")});else if(i=this.rules.fences.exec(e))e=e.substring(i[0].length),this.tokens.push({type:"code",lang:i[2],text:i[3]||""});else if(i=this.rules.heading.exec(e))e=e.substring(i[0].length),this.tokens.push({type:"heading",depth:i[1].length,text:i[2]});else if(n&&(i=this.rules.nptable.exec(e))){for(e=e.substring(i[0].length),a={type:"table",header:i[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:i[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:i[3].replace(/\n$/,"").split("\n")},p=0;p<a.align.length;p++)/^ *-+: *$/.test(a.align[p])?a.align[p]="right":/^ *:-+: *$/.test(a.align[p])?a.align[p]="center":/^ *:-+ *$/.test(a.align[p])?a.align[p]="left":a.align[p]=null;for(p=0;p<a.cells.length;p++)a.cells[p]=a.cells[p].split(/ *\| */);this.tokens.push(a)}else if(i=this.rules.hr.exec(e))e=e.substring(i[0].length),this.tokens.push({type:"hr"});else if(i=this.rules.blockquote.exec(e))e=e.substring(i[0].length),this.tokens.push({type:"blockquote_start"}),i=i[0].replace(/^ *> ?/gm,""),this.token(i,n),this.tokens.push({type:"blockquote_end"});else if(i=this.rules.list.exec(e)){for(e=e.substring(i[0].length),g=(l=i[2]).length>1,this.tokens.push({type:"list_start",ordered:g,start:g?+l:""}),r=!1,c=(i=i[0].match(this.rules.item)).length,p=0;p<c;p++)h=(a=i[p]).length,~(a=a.replace(/^ *([*+-]|\d+\.) +/,"")).indexOf("\n ")&&(h-=a.length,a=this.options.pedantic?a.replace(/^ {1,4}/gm,""):a.replace(new RegExp("^ {1,"+h+"}","gm"),"")),this.options.smartLists&&p!==c-1&&(l===(o=t.bullet.exec(i[p+1])[0])||l.length>1&&o.length>1||(e=i.slice(p+1).join("\n")+e,p=c-1)),s=r||/\n\n(?!\s*$)/.test(a),p!==c-1&&(r="\n"===a.charAt(a.length-1),s||(s=r)),this.tokens.push({type:s?"loose_item_start":"list_item_start"}),this.token(a,!1),this.tokens.push({type:"list_item_end"});this.tokens.push({type:"list_end"})}else if(i=this.rules.html.exec(e))e=e.substring(i[0].length),this.tokens.push({type:this.options.sanitize?"paragraph":"html",pre:!this.options.sanitizer&&("pre"===i[1]||"script"===i[1]||"style"===i[1]),text:i[0]});else if(n&&(i=this.rules.def.exec(e)))e=e.substring(i[0].length),i[3]&&(i[3]=i[3].substring(1,i[3].length-1)),u=i[1].toLowerCase(),this.tokens.links[u]||(this.tokens.links[u]={href:i[2],title:i[3]});else if(n&&(i=this.rules.table.exec(e))){for(e=e.substring(i[0].length),a={type:"table",header:i[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:i[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:i[3].replace(/(?: *\| *)?\n$/,"").split("\n")},p=0;p<a.align.length;p++)/^ *-+: *$/.test(a.align[p])?a.align[p]="right":/^ *:-+: *$/.test(a.align[p])?a.align[p]="center":/^ *:-+ *$/.test(a.align[p])?a.align[p]="left":a.align[p]=null;for(p=0;p<a.cells.length;p++)a.cells[p]=a.cells[p].replace(/^ *\| *| *\| *$/g,"").split(/ *\| */);this.tokens.push(a)}else if(i=this.rules.lheading.exec(e))e=e.substring(i[0].length),this.tokens.push({type:"heading",depth:"="===i[2]?1:2,text:i[1]});else if(n&&(i=this.rules.paragraph.exec(e)))e=e.substring(i[0].length),this.tokens.push({type:"paragraph",text:"\n"===i[1].charAt(i[1].length-1)?i[1].slice(0,-1):i[1]});else if(i=this.rules.text.exec(e))e=e.substring(i[0].length),this.tokens.push({type:"text",text:i[0]});else if(e)throw new Error("Infinite loop on byte: "+e.charCodeAt(0));return this.tokens};var r={escape:/^\\([\\`*{}\[\]()#+\-.!_>])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:f,tag:/^<!--[\s\S]*?-->|^<\/?[a-zA-Z0-9\-]+(?:"[^"]*"|'[^']*'|\s[^<'">\/\s]*)*?\/?>/,link:/^!?\[(inside)\]\(href\)/,reflink:/^!?\[(inside)\]\s*\[([^\]]*)\]/,nolink:/^!?\[((?:\[[^\[\]]*\]|\\[\[\]]|[^\[\]])*)\]/,strong:/^__([\s\S]+?)__(?!_)|^\*\*([\s\S]+?)\*\*(?!\*)/,em:/^_([^\s_](?:[^_]|__)+?[^\s_])_\b|^\*((?:\*\*|[^*])+?)\*(?!\*)/,code:/^(`+)\s*([\s\S]*?[^`]?)\s*\1(?!`)/,br:/^ {2,}\n(?!\s*$)/,del:f,text:/^[\s\S]+?(?=[\\<!\[`*]|\b_| {2,}\n|$)/};function s(e,t){if(this.options=t||k.defaults,this.links=e,this.rules=r.normal,this.renderer=this.options.renderer||new i,this.renderer.options=this.options,!this.links)throw new Error("Tokens array requires a `links` property.");this.options.gfm?this.options.breaks?this.rules=r.breaks:this.rules=r.gfm:this.options.pedantic&&(this.rules=r.pedantic)}function i(e){this.options=e||{}}function l(){}function o(e){this.tokens=[],this.token=null,this.options=e||k.defaults,this.options.renderer=this.options.renderer||new i,this.renderer=this.options.renderer,this.renderer.options=this.options}function a(e,t){return e.replace(t?/&/g:/&(?!#?\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function h(e){return e.replace(/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi,function(e,t){return"colon"===(t=t.toLowerCase())?":":"#"===t.charAt(0)?"x"===t.charAt(1)?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""})}function p(e,t){return e=e.source,t=t||"",{replace:function(t,n){return n=(n=n.source||n).replace(/(^|[^\[])\^/g,"$1"),e=e.replace(t,n),this},getRegex:function(){return new RegExp(e,t)}}}function u(e,t){return c[" "+e]||(/^[^:]+:\/*[^/]*$/.test(e)?c[" "+e]=e+"/":c[" "+e]=e.replace(/[^/]*$/,"")),e=c[" "+e],"//"===t.slice(0,2)?e.replace(/:[\s\S]*/,":")+t:"/"===t.charAt(0)?e.replace(/(:\/*[^/]*)[\s\S]*/,"$1")+t:e+t}r._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,r._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,r.autolink=p(r.autolink).replace("scheme",r._scheme).replace("email",r._email).getRegex(),r._inside=/(?:\[[^\[\]]*\]|\\[\[\]]|[^\[\]]|\](?=[^\[]*\]))*/,r._href=/\s*<?([\s\S]*?)>?(?:\s+['"]([\s\S]*?)['"])?\s*/,r.link=p(r.link).replace("inside",r._inside).replace("href",r._href).getRegex(),r.reflink=p(r.reflink).replace("inside",r._inside).getRegex(),r.normal=d({},r),r.pedantic=d({},r.normal,{strong:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,em:/^_(?=\S)([\s\S]*?\S)_(?!_)|^\*(?=\S)([\s\S]*?\S)\*(?!\*)/}),r.gfm=d({},r.normal,{escape:p(r.escape).replace("])","~|])").getRegex(),url:p(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("email",r._email).getRegex(),_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^~~(?=\S)([\s\S]*?\S)~~/,text:p(r.text).replace("]|","~]|").replace("|","|https?://|ftp://|www\\.|[a-zA-Z0-9.!#$%&'*+/=?^_`{\\|}~-]+@|").getRegex()}),r.breaks=d({},r.gfm,{br:p(r.br).replace("{2,}","*").getRegex(),text:p(r.gfm.text).replace("{2,}","*").getRegex()}),s.rules=r,s.output=function(e,t,n){return new s(t,n).output(e)},s.prototype.output=function(e){for(var t,n,r,s,i="";e;)if(s=this.rules.escape.exec(e))e=e.substring(s[0].length),i+=s[1];else if(s=this.rules.autolink.exec(e))e=e.substring(s[0].length),r="@"===s[2]?"mailto:"+(n=a(this.mangle(s[1]))):n=a(s[1]),i+=this.renderer.link(r,null,n);else if(this.inLink||!(s=this.rules.url.exec(e))){if(s=this.rules.tag.exec(e))!this.inLink&&/^<a /i.test(s[0])?this.inLink=!0:this.inLink&&/^<\/a>/i.test(s[0])&&(this.inLink=!1),e=e.substring(s[0].length),i+=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(s[0]):a(s[0]):s[0];else if(s=this.rules.link.exec(e))e=e.substring(s[0].length),this.inLink=!0,i+=this.outputLink(s,{href:s[2],title:s[3]}),this.inLink=!1;else if((s=this.rules.reflink.exec(e))||(s=this.rules.nolink.exec(e))){if(e=e.substring(s[0].length),t=(s[2]||s[1]).replace(/\s+/g," "),!(t=this.links[t.toLowerCase()])||!t.href){i+=s[0].charAt(0),e=s[0].substring(1)+e;continue}this.inLink=!0,i+=this.outputLink(s,t),this.inLink=!1}else if(s=this.rules.strong.exec(e))e=e.substring(s[0].length),i+=this.renderer.strong(this.output(s[2]||s[1]));else if(s=this.rules.em.exec(e))e=e.substring(s[0].length),i+=this.renderer.em(this.output(s[2]||s[1]));else if(s=this.rules.code.exec(e))e=e.substring(s[0].length),i+=this.renderer.codespan(a(s[2].trim(),!0));else if(s=this.rules.br.exec(e))e=e.substring(s[0].length),i+=this.renderer.br();else if(s=this.rules.del.exec(e))e=e.substring(s[0].length),i+=this.renderer.del(this.output(s[1]));else if(s=this.rules.text.exec(e))e=e.substring(s[0].length),i+=this.renderer.text(a(this.smartypants(s[0])));else if(e)throw new Error("Infinite loop on byte: "+e.charCodeAt(0))}else s[0]=this.rules._backpedal.exec(s[0])[0],e=e.substring(s[0].length),"@"===s[2]?r="mailto:"+(n=a(s[0])):(n=a(s[0]),r="www."===s[1]?"http://"+n:n),i+=this.renderer.link(r,null,n);return i},s.prototype.outputLink=function(e,t){var n=a(t.href),r=t.title?a(t.title):null;return"!"!==e[0].charAt(0)?this.renderer.link(n,r,this.output(e[1])):this.renderer.image(n,r,a(e[1]))},s.prototype.smartypants=function(e){return this.options.smartypants?e.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…"):e},s.prototype.mangle=function(e){if(!this.options.mangle)return e;for(var t,n="",r=e.length,s=0;s<r;s++)t=e.charCodeAt(s),Math.random()>.5&&(t="x"+t.toString(16)),n+="&#"+t+";";return n},i.prototype.code=function(e,t,n){if(this.options.highlight){var r=this.options.highlight(e,t);null!=r&&r!==e&&(n=!0,e=r)}return t?'<pre><code class="'+this.options.langPrefix+a(t,!0)+'">'+(n?e:a(e,!0))+"\n</code></pre>\n":"<pre><code>"+(n?e:a(e,!0))+"\n</code></pre>"},i.prototype.blockquote=function(e){return"<blockquote>\n"+e+"</blockquote>\n"},i.prototype.html=function(e){return e},i.prototype.heading=function(e,t,n){return"<h"+t+' id="'+this.options.headerPrefix+n.toLowerCase().replace(/[^\w]+/g,"-")+'">'+e+"</h"+t+">\n"},i.prototype.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},i.prototype.list=function(e,t,n){var r=t?"ol":"ul";return"<"+r+(t&&1!==n?' start="'+n+'"':"")+">\n"+e+"</"+r+">\n"},i.prototype.listitem=function(e){return"<li>"+e+"</li>\n"},i.prototype.paragraph=function(e){return"<p>"+e+"</p>\n"},i.prototype.table=function(e,t){return"<table>\n<thead>\n"+e+"</thead>\n<tbody>\n"+t+"</tbody>\n</table>\n"},i.prototype.tablerow=function(e){return"<tr>\n"+e+"</tr>\n"},i.prototype.tablecell=function(e,t){var n=t.header?"th":"td";return(t.align?"<"+n+' style="text-align:'+t.align+'">':"<"+n+">")+e+"</"+n+">\n"},i.prototype.strong=function(e){return"<strong>"+e+"</strong>"},i.prototype.em=function(e){return"<em>"+e+"</em>"},i.prototype.codespan=function(e){return"<code>"+e+"</code>"},i.prototype.br=function(){return this.options.xhtml?"<br/>":"<br>"},i.prototype.del=function(e){return"<del>"+e+"</del>"},i.prototype.link=function(e,t,n){if(this.options.sanitize){try{var r=decodeURIComponent(h(e)).replace(/[^\w:]/g,"").toLowerCase()}catch(e){return n}if(0===r.indexOf("javascript:")||0===r.indexOf("vbscript:")||0===r.indexOf("data:"))return n}this.options.baseUrl&&!g.test(e)&&(e=u(this.options.baseUrl,e));var s='<a href="'+e+'"';return t&&(s+=' title="'+t+'"'),s+=">"+n+"</a>"},i.prototype.image=function(e,t,n){this.options.baseUrl&&!g.test(e)&&(e=u(this.options.baseUrl,e));var r='<img src="'+e+'" alt="'+n+'"';return t&&(r+=' title="'+t+'"'),r+=this.options.xhtml?"/>":">"},i.prototype.text=function(e){return e},l.prototype.strong=l.prototype.em=l.prototype.codespan=l.prototype.del=l.prototype.text=function(e){return e},l.prototype.link=l.prototype.image=function(e,t,n){return""+n},l.prototype.br=function(){return""},o.parse=function(e,t){return new o(t).parse(e)},o.prototype.parse=function(e){this.inline=new s(e.links,this.options),this.inlineText=new s(e.links,d({},this.options,{renderer:new l})),this.tokens=e.reverse();for(var t="";this.next();)t+=this.tok();return t},o.prototype.next=function(){return this.token=this.tokens.pop()},o.prototype.peek=function(){return this.tokens[this.tokens.length-1]||0},o.prototype.parseText=function(){for(var e=this.token.text;"text"===this.peek().type;)e+="\n"+this.next().text;return this.inline.output(e)},o.prototype.tok=function(){switch(this.token.type){case"space":return"";case"hr":return this.renderer.hr();case"heading":return this.renderer.heading(this.inline.output(this.token.text),this.token.depth,h(this.inlineText.output(this.token.text)));case"code":return this.renderer.code(this.token.text,this.token.lang,this.token.escaped);case"table":var e,t,n,r,s="",i="";for(n="",e=0;e<this.token.header.length;e++)n+=this.renderer.tablecell(this.inline.output(this.token.header[e]),{header:!0,align:this.token.align[e]});for(s+=this.renderer.tablerow(n),e=0;e<this.token.cells.length;e++){for(t=this.token.cells[e],n="",r=0;r<t.length;r++)n+=this.renderer.tablecell(this.inline.output(t[r]),{header:!1,align:this.token.align[r]});i+=this.renderer.tablerow(n)}return this.renderer.table(s,i);case"blockquote_start":for(i="";"blockquote_end"!==this.next().type;)i+=this.tok();return this.renderer.blockquote(i);case"list_start":i="";for(var l=this.token.ordered,o=this.token.start;"list_end"!==this.next().type;)i+=this.tok();return this.renderer.list(i,l,o);case"list_item_start":for(i="";"list_item_end"!==this.next().type;)i+="text"===this.token.type?this.parseText():this.tok();return this.renderer.listitem(i);case"loose_item_start":for(i="";"list_item_end"!==this.next().type;)i+=this.tok();return this.renderer.listitem(i);case"html":var a=this.token.pre||this.options.pedantic?this.token.text:this.inline.output(this.token.text);return this.renderer.html(a);case"paragraph":return this.renderer.paragraph(this.inline.output(this.token.text));case"text":return this.renderer.paragraph(this.parseText())}};var c={},g=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function f(){}function d(e){for(var t,n,r=1;r<arguments.length;r++)for(n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}function k(e,t,r){if(void 0===e||null===e)throw new Error("marked(): input parameter is undefined or null");if("string"!=typeof e)throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected");if(r||"function"==typeof t){r||(r=t,t=null);var s,i,l=(t=d({},k.defaults,t||{})).highlight,h=0;try{s=n.lex(e,t)}catch(e){return r(e)}i=s.length;var p=function(e){if(e)return t.highlight=l,r(e);var n;try{n=o.parse(s,t)}catch(t){e=t}return t.highlight=l,e?r(e):r(null,n)};if(!l||l.length<3)return p();if(delete t.highlight,!i)return p();for(;h<s.length;h++)!function(e){"code"!==e.type?--i||p():l(e.text,e.lang,function(t,n){return t?p(t):null==n||n===e.text?--i||p():(e.text=n,e.escaped=!0,void(--i||p()))})}(s[h])}else try{return t&&(t=d({},k.defaults,t)),o.parse(n.lex(e,t),t)}catch(e){if(e.message+="\nPlease report this to https://github.com/markedjs/marked.",(t||k.defaults).silent)return"<p>An error occurred:</p><pre>"+a(e.message+"",!0)+"</pre>";throw e}}f.exec=f,k.options=k.setOptions=function(e){return d(k.defaults,e),k},k.defaults={gfm:!0,tables:!0,breaks:!1,pedantic:!1,sanitize:!1,sanitizer:null,mangle:!0,smartLists:!1,silent:!1,highlight:null,langPrefix:"lang-",smartypants:!1,headerPrefix:"",renderer:new i,xhtml:!1,baseUrl:null},k.Parser=o,k.parser=o.parse,k.Renderer=i,k.TextRenderer=l,k.Lexer=n,k.lexer=n.lex,k.InlineLexer=s,k.inlineLexer=s.output,k.parse=k,"undefined"!=typeof module&&"object"==typeof exports?module.exports=k:"function"==typeof define&&define.amd?define(function(){return k}):e.marked=k}(this||("undefined"!=typeof window?window:global));

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],116:[function(require,module,exports){
(function (process,global,Buffer){
var inherits=require("inherits"),AbstractLevelDOWN=require("abstract-leveldown").AbstractLevelDOWN,AbstractIterator=require("abstract-leveldown").AbstractIterator,ltgt=require("ltgt"),setImmediate=global.setImmediate||process.nextTick,createRBT=require("functional-red-black-tree"),globalStore={};function toKey(t){return"string"==typeof t?"$"+t:JSON.stringify(t)}function gt(t){return ltgt.compare(t,this._end)>0}function gte(t){return ltgt.compare(t,this._end)>=0}function lt(t){return ltgt.compare(t,this._end)<0}function lte(t){return ltgt.compare(t,this._end)<=0}function MemIterator(t,e){AbstractIterator.call(this,t),this._limit=e.limit,-1===this._limit&&(this._limit=1/0);var i=t._store[t._location];this.keyAsBuffer=!1!==e.keyAsBuffer,this.valueAsBuffer=!1!==e.valueAsBuffer,this._reverse=e.reverse,this._options=e,this._done=0,this._reverse?(this._incr="prev",this._start=ltgt.upperBound(e),this._end=ltgt.lowerBound(e),void 0===this._start?this._tree=i.end:ltgt.upperBoundInclusive(e)?this._tree=i.le(this._start):this._tree=i.lt(this._start),this._end&&(ltgt.lowerBoundInclusive(e)?this._test=gte:this._test=gt)):(this._incr="next",this._start=ltgt.lowerBound(e),this._end=ltgt.upperBound(e),void 0===this._start?this._tree=i.begin:ltgt.lowerBoundInclusive(e)?this._tree=i.ge(this._start):this._tree=i.gt(this._start),this._end&&(ltgt.upperBoundInclusive(e)?this._test=lte:this._test=lt))}function MemDOWN(t){if(!(this instanceof MemDOWN))return new MemDOWN(t);AbstractLevelDOWN.call(this,"string"==typeof t?t:""),this._location=this.location?toKey(this.location):"_tree",this._store=this.location?globalStore:this,this._store[this._location]=this._store[this._location]||createRBT(ltgt.compare)}inherits(MemIterator,AbstractIterator),MemIterator.prototype._next=function(t){var e,i;return this._done++>=this._limit?setImmediate(t):this._tree.valid?(e=this._tree.key,i=this._tree.value,this._test(e)?(this.keyAsBuffer&&(e=new Buffer(e)),this.valueAsBuffer&&(i=new Buffer(i)),this._tree[this._incr](),void setImmediate(function(){t(null,e,i)})):setImmediate(t)):setImmediate(t)},MemIterator.prototype._test=function(){return!0},MemDOWN.clearGlobalStore=function(t){t?Object.keys(globalStore).forEach(function(t){delete globalStore[t]}):globalStore={}},inherits(MemDOWN,AbstractLevelDOWN),MemDOWN.prototype._open=function(t,e){var i=this;setImmediate(function(){e(null,i)})},MemDOWN.prototype._put=function(t,e,i,r){void 0!==e&&null!==e||(e="");var s=this._store[this._location].find(t);s.valid?this._store[this._location]=s.update(e):this._store[this._location]=this._store[this._location].insert(t,e),setImmediate(r)},MemDOWN.prototype._get=function(t,e,i){var r=this._store[this._location].get(t);if(void 0===r){var s=new Error("NotFound");return setImmediate(function(){i(s)})}!1===e.asBuffer||this._isBuffer(r)||(r=new Buffer(String(r))),setImmediate(function(){i(null,r)})},MemDOWN.prototype._del=function(t,e,i){this._store[this._location]=this._store[this._location].remove(t),setImmediate(i)},MemDOWN.prototype._batch=function(t,e,i){for(var r,s,o,n,a=-1,l=t.length,h=this._store[this._location];++a<l;)if(t[a]){if(s=this._isBuffer(t[a].key)?t[a].key:String(t[a].key),r=this._checkKey(s,"key"))return setImmediate(function(){i(r)});if(n=h.find(s),"put"===t[a].type){if(o=this._isBuffer(t[a].value)?t[a].value:String(t[a].value),r=this._checkKey(o,"value"))return setImmediate(function(){i(r)});h=n.valid?n.update(o):h.insert(s,o)}else h=n.remove()}this._store[this._location]=h,setImmediate(i)},MemDOWN.prototype._iterator=function(t){return new MemIterator(this,t)},MemDOWN.prototype._isBuffer=function(t){return Buffer.isBuffer(t)},MemDOWN.destroy=function(t,e){var i=toKey(t);i in globalStore&&delete globalStore[i],setImmediate(e)},module.exports=MemDOWN;

}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {},require("buffer").Buffer)
},{"_process":140,"abstract-leveldown":120,"buffer":52,"functional-red-black-tree":91,"inherits":94,"ltgt":114}],117:[function(require,module,exports){
(function (process){
function AbstractChainedBatch(t){this._db=t,this._operations=[],this._written=!1}AbstractChainedBatch.prototype._serializeKey=function(t){return this._db._serializeKey(t)},AbstractChainedBatch.prototype._serializeValue=function(t){return this._db._serializeValue(t)},AbstractChainedBatch.prototype._checkWritten=function(){if(this._written)throw new Error("write() already called on this batch")},AbstractChainedBatch.prototype.put=function(t,e){this._checkWritten();var i=this._db._checkKey(t,"key",this._db._isBuffer);if(i)throw i;return t=this._serializeKey(t),e=this._serializeValue(e),"function"==typeof this._put?this._put(t,e):this._operations.push({type:"put",key:t,value:e}),this},AbstractChainedBatch.prototype.del=function(t){this._checkWritten();var e=this._db._checkKey(t,"key",this._db._isBuffer);if(e)throw e;return t=this._serializeKey(t),"function"==typeof this._del?this._del(t):this._operations.push({type:"del",key:t}),this},AbstractChainedBatch.prototype.clear=function(){return this._checkWritten(),this._operations=[],"function"==typeof this._clear&&this._clear(),this},AbstractChainedBatch.prototype.write=function(t,e){if(this._checkWritten(),"function"==typeof t&&(e=t),"function"!=typeof e)throw new Error("write() requires a callback argument");return"object"!=typeof t&&(t={}),this._written=!0,"function"==typeof this._write?this._write(e):"function"==typeof this._db._batch?this._db._batch(this._operations,t,e):void process.nextTick(e)},module.exports=AbstractChainedBatch;

}).call(this,require('_process'))
},{"_process":140}],118:[function(require,module,exports){
(function (process){
function AbstractIterator(t){this.db=t,this._ended=!1,this._nexting=!1}AbstractIterator.prototype.next=function(t){var e=this;if("function"!=typeof t)throw new Error("next() requires a callback argument");return e._ended?t(new Error("cannot call next() after end()")):e._nexting?t(new Error("cannot call next() before previous next() has completed")):(e._nexting=!0,"function"==typeof e._next?e._next(function(){e._nexting=!1,t.apply(null,arguments)}):void process.nextTick(function(){e._nexting=!1,t()}))},AbstractIterator.prototype.end=function(t){if("function"!=typeof t)throw new Error("end() requires a callback argument");return this._ended?t(new Error("end() already called on iterator")):(this._ended=!0,"function"==typeof this._end?this._end(t):void process.nextTick(t))},module.exports=AbstractIterator;

}).call(this,require('_process'))
},{"_process":140}],119:[function(require,module,exports){
(function (Buffer,process){
var xtend=require("xtend"),AbstractIterator=require("./abstract-iterator"),AbstractChainedBatch=require("./abstract-chained-batch");function AbstractLevelDOWN(t){if(!arguments.length||void 0===t)throw new Error("constructor requires at least a location argument");if("string"!=typeof t)throw new Error("constructor requires a location string argument");this.location=t,this.status="new"}AbstractLevelDOWN.prototype.open=function(t,e){var r=this,i=this.status;if("function"==typeof t&&(e=t),"function"!=typeof e)throw new Error("open() requires a callback argument");"object"!=typeof t&&(t={}),t.createIfMissing=0!=t.createIfMissing,t.errorIfExists=!!t.errorIfExists,"function"==typeof this._open?(this.status="opening",this._open(t,function(t){if(t)return r.status=i,e(t);r.status="open",e()})):(this.status="open",process.nextTick(e))},AbstractLevelDOWN.prototype.close=function(t){var e=this,r=this.status;if("function"!=typeof t)throw new Error("close() requires a callback argument");"function"==typeof this._close?(this.status="closing",this._close(function(i){if(i)return e.status=r,t(i);e.status="closed",t()})):(this.status="closed",process.nextTick(t))},AbstractLevelDOWN.prototype.get=function(t,e,r){var i;if("function"==typeof e&&(r=e),"function"!=typeof r)throw new Error("get() requires a callback argument");return(i=this._checkKey(t,"key"))?r(i):(t=this._serializeKey(t),"object"!=typeof e&&(e={}),e.asBuffer=0!=e.asBuffer,"function"==typeof this._get?this._get(t,e,r):void process.nextTick(function(){r(new Error("NotFound"))}))},AbstractLevelDOWN.prototype.put=function(t,e,r,i){var o;if("function"==typeof r&&(i=r),"function"!=typeof i)throw new Error("put() requires a callback argument");return(o=this._checkKey(t,"key"))?i(o):(t=this._serializeKey(t),e=this._serializeValue(e),"object"!=typeof r&&(r={}),"function"==typeof this._put?this._put(t,e,r,i):void process.nextTick(i))},AbstractLevelDOWN.prototype.del=function(t,e,r){var i;if("function"==typeof e&&(r=e),"function"!=typeof r)throw new Error("del() requires a callback argument");return(i=this._checkKey(t,"key"))?r(i):(t=this._serializeKey(t),"object"!=typeof e&&(e={}),"function"==typeof this._del?this._del(t,e,r):void process.nextTick(r))},AbstractLevelDOWN.prototype.batch=function(t,e,r){if(!arguments.length)return this._chainedBatch();if("function"==typeof e&&(r=e),"function"==typeof t&&(r=t),"function"!=typeof r)throw new Error("batch(array) requires a callback argument");if(!Array.isArray(t))return r(new Error("batch(array) requires an array argument"));e&&"object"==typeof e||(e={});for(var i,o,n=0,s=t.length;n<s;n++)if("object"==typeof(i=t[n])){if(o=this._checkKey(i.type,"type"))return r(o);if(o=this._checkKey(i.key,"key"))return r(o)}if("function"==typeof this._batch)return this._batch(t,e,r);process.nextTick(r)},AbstractLevelDOWN.prototype.approximateSize=function(t,e,r){if(null==t||null==e||"function"==typeof t||"function"==typeof e)throw new Error("approximateSize() requires valid `start`, `end` and `callback` arguments");if("function"!=typeof r)throw new Error("approximateSize() requires a callback argument");if(t=this._serializeKey(t),e=this._serializeKey(e),"function"==typeof this._approximateSize)return this._approximateSize(t,e,r);process.nextTick(function(){r(null,0)})},AbstractLevelDOWN.prototype._setupIteratorOptions=function(t){var e=this;return t=xtend(t),["start","end","gt","gte","lt","lte"].forEach(function(r){t[r]&&e._isBuffer(t[r])&&0===t[r].length&&delete t[r]}),t.reverse=!!t.reverse,t.keys=0!=t.keys,t.values=0!=t.values,t.limit="limit"in t?t.limit:-1,t.keyAsBuffer=0!=t.keyAsBuffer,t.valueAsBuffer=0!=t.valueAsBuffer,t},AbstractLevelDOWN.prototype.iterator=function(t){return"object"!=typeof t&&(t={}),t=this._setupIteratorOptions(t),"function"==typeof this._iterator?this._iterator(t):new AbstractIterator(this)},AbstractLevelDOWN.prototype._chainedBatch=function(){return new AbstractChainedBatch(this)},AbstractLevelDOWN.prototype._isBuffer=function(t){return Buffer.isBuffer(t)},AbstractLevelDOWN.prototype._serializeKey=function(t){return this._isBuffer(t)?t:String(t)},AbstractLevelDOWN.prototype._serializeValue=function(t){return null==t?"":this._isBuffer(t)||process.browser?t:String(t)},AbstractLevelDOWN.prototype._checkKey=function(t,e){return null===t||void 0===t?new Error(e+" cannot be `null` or `undefined`"):this._isBuffer(t)&&0===t.length?new Error(e+" cannot be an empty Buffer"):""===String(t)?new Error(e+" cannot be an empty String"):void 0},module.exports=AbstractLevelDOWN;

}).call(this,{"isBuffer":require("../../../is-buffer/index.js")},require('_process'))
},{"../../../is-buffer/index.js":95,"./abstract-chained-batch":117,"./abstract-iterator":118,"_process":140,"xtend":311}],120:[function(require,module,exports){
exports.AbstractLevelDOWN=require("./abstract-leveldown"),exports.AbstractIterator=require("./abstract-iterator"),exports.AbstractChainedBatch=require("./abstract-chained-batch"),exports.isLevelDOWN=require("./is-leveldown");

},{"./abstract-chained-batch":117,"./abstract-iterator":118,"./abstract-leveldown":119,"./is-leveldown":121}],121:[function(require,module,exports){
var AbstractLevelDOWN=require("./abstract-leveldown");function isLevelDOWN(e){return!(!e||"object"!=typeof e)&&Object.keys(AbstractLevelDOWN.prototype).filter(function(e){return"_"!=e[0]&&"approximateSize"!=e}).every(function(t){return"function"==typeof e[t]})}module.exports=isLevelDOWN;

},{"./abstract-leveldown":119}],122:[function(require,module,exports){
"use strict";var MIN_MAGNITUDE=-324,MAGNITUDE_DIGITS=3,SEP="",utils=require("./utils");function indexify(e){if(null!==e)switch(typeof e){case"boolean":return e?1:0;case"number":return numToIndexableString(e);case"string":return e.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var r=Array.isArray(e),t=r?e:Object.keys(e),n=-1,a=t.length,l="";if(r)for(;++n<a;)l+=exports.toIndexableString(t[n]);else for(;++n<a;){var o=t[n];l+=exports.toIndexableString(o)+exports.toIndexableString(e[o])}return l}return""}function parseNumber(e,r){var t,n=r;if("1"===e[r])t=0,r++;else{var a="0"===e[r];r++;var l="",o=e.substring(r,r+MAGNITUDE_DIGITS),i=parseInt(o,10)+MIN_MAGNITUDE;for(a&&(i=-i),r+=MAGNITUDE_DIGITS;;){var s=e[r];if("\0"===s)break;l+=s,r++}t=1===(l=l.split(".")).length?parseInt(l,10):parseFloat(l[0]+"."+l[1]),a&&(t-=10),0!==i&&(t=parseFloat(t+"e"+i))}return{num:t,length:r-n}}function pop(e,r){var t=e.pop();if(r.length){var n=r[r.length-1];t===n.element&&(r.pop(),n=r[r.length-1]);var a=n.element,l=n.index;if(Array.isArray(a))a.push(t);else if(l===e.length-2){a[e.pop()]=t}else e.push(t)}}function arrayCollate(e,r){for(var t=Math.min(e.length,r.length),n=0;n<t;n++){var a=exports.collate(e[n],r[n]);if(0!==a)return a}return e.length===r.length?0:e.length>r.length?1:-1}function stringCollate(e,r){return e===r?0:e>r?1:-1}function objectCollate(e,r){for(var t=Object.keys(e),n=Object.keys(r),a=Math.min(t.length,n.length),l=0;l<a;l++){var o=exports.collate(t[l],n[l]);if(0!==o)return o;if(0!==(o=exports.collate(e[t[l]],r[n[l]])))return o}return t.length===n.length?0:t.length>n.length?1:-1}function collationIndex(e){var r=["boolean","number","string","object"].indexOf(typeof e);return~r?null===e?1:Array.isArray(e)?5:r<3?r+2:r+3:Array.isArray(e)?5:void 0}function numToIndexableString(e){if(0===e)return"1";var r=e.toExponential().split(/e\+?/),t=parseInt(r[1],10),n=e<0,a=n?"0":"2",l=(n?-t:t)-MIN_MAGNITUDE,o=utils.padLeft(l.toString(),"0",MAGNITUDE_DIGITS);a+=SEP+o;var i=Math.abs(parseFloat(r[0]));n&&(i=10-i);var s=i.toFixed(20);return s=s.replace(/\.?0+$/,""),a+=SEP+s}exports.collate=function(e,r){if(e===r)return 0;e=exports.normalizeKey(e),r=exports.normalizeKey(r);var t=collationIndex(e),n=collationIndex(r);if(t-n!=0)return t-n;if(null===e)return 0;switch(typeof e){case"number":return e-r;case"boolean":return e===r?0:e<r?-1:1;case"string":return stringCollate(e,r)}return Array.isArray(e)?arrayCollate(e,r):objectCollate(e,r)},exports.normalizeKey=function(e){switch(typeof e){case"undefined":return null;case"number":return e===1/0||e===-1/0||isNaN(e)?null:e;case"object":var r=e;if(Array.isArray(e)){var t=e.length;e=new Array(t);for(var n=0;n<t;n++)e[n]=exports.normalizeKey(r[n])}else{if(e instanceof Date)return e.toJSON();if(null!==e)for(var a in e={},r)if(r.hasOwnProperty(a)){var l=r[a];void 0!==l&&(e[a]=exports.normalizeKey(l))}}}return e},exports.toIndexableString=function(e){return collationIndex(e=exports.normalizeKey(e))+SEP+indexify(e)+"\0"},exports.parseIndexableString=function(e){for(var r=[],t=[],n=0;;){var a=e[n++];if("\0"!==a)switch(a){case"1":r.push(null);break;case"2":r.push("1"===e[n]),n++;break;case"3":var l=parseNumber(e,n);r.push(l.num),n+=l.length;break;case"4":for(var o="";;){var i=e[n];if("\0"===i)break;o+=i,n++}o=o.replace(/\u0001\u0001/g,"\0").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),r.push(o);break;case"5":var s={element:[],index:r.length};r.push(s.element),t.push(s);break;case"6":var u={element:{},index:r.length};r.push(u.element),t.push(u);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+a)}else{if(1===r.length)return r.pop();pop(r,t)}}};

},{"./utils":123}],123:[function(require,module,exports){
"use strict";function pad(r,t,e){for(var n="",o=e-r.length;n.length<o;)n+=t;return n}exports.padLeft=function(r,t,e){return pad(r,t,e)+r},exports.padRight=function(r,t,e){return r+pad(r,t,e)},exports.stringLexCompare=function(r,t){var e,n=r.length,o=t.length;for(e=0;e<n;e++){if(e===o)return 1;var a=r.charAt(e),i=t.charAt(e);if(a!==i)return a<i?-1:1}return n<o?-1:0},exports.intToDecimalForm=function(r){var t=r<0,e="";do{e=(t?-Math.ceil(r%10):Math.floor(r%10))+e,r=t?Math.ceil(r/10):Math.floor(r/10)}while(r);return t&&"0"!==e&&(e="-"+e),e};

},{}],124:[function(require,module,exports){
"use strict";function LazyMap(){this.store={}}function LazySet(t){if(this.store=new LazyMap,t&&Array.isArray(t))for(var e=0,r=t.length;e<r;e++)this.add(t[e])}exports.Map=LazyMap,exports.Set=LazySet,LazyMap.prototype.mangle=function(t){if("string"!=typeof t)throw new TypeError("key must be a string but Got "+t);return"$"+t},LazyMap.prototype.unmangle=function(t){return t.substring(1)},LazyMap.prototype.get=function(t){var e=this.mangle(t);if(e in this.store)return this.store[e]},LazyMap.prototype.set=function(t,e){var r=this.mangle(t);return this.store[r]=e,!0},LazyMap.prototype.has=function(t){return this.mangle(t)in this.store},LazyMap.prototype.delete=function(t){var e=this.mangle(t);return e in this.store&&(delete this.store[e],!0)},LazyMap.prototype.forEach=function(t){for(var e=Object.keys(this.store),r=0,o=e.length;r<o;r++){var n=e[r];t(this.store[n],n=this.unmangle(n))}},LazySet.prototype.add=function(t){return this.store.set(t,!0)},LazySet.prototype.has=function(t){return this.store.has(t)},LazySet.prototype.delete=function(t){return this.store.delete(t)};

},{}],125:[function(require,module,exports){
module.exports=require("../lib/extras/memory");

},{"../lib/extras/memory":126}],126:[function(require,module,exports){
(function (process,global,Buffer){
"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var levelup=_interopDefault(require("levelup")),sublevel=_interopDefault(require("sublevel-pouchdb")),through2=require("through2"),getArguments=_interopDefault(require("argsarray")),pouchdbCollections=require("pouchdb-collections"),Deque=_interopDefault(require("double-ended-queue")),lie=_interopDefault(require("lie")),debug=_interopDefault(require("debug")),events=require("events"),inherits=_interopDefault(require("inherits")),Md5=_interopDefault(require("spark-md5")),vuvuzela=_interopDefault(require("vuvuzela")),jsExtend=require("js-extend"),memdown=_interopDefault(require("memdown")),toSublevel=function(e,t,r){process.nextTick(function(){r()})},localAndMetaStores=function(e,t,r){process.nextTick(function(){r()})},migrate={toSublevel:toSublevel,localAndMetaStores:localAndMetaStores},PouchPromise="function"==typeof Promise?Promise:lie;function isBinaryObject(e){return e instanceof ArrayBuffer||"undefined"!=typeof Blob&&e instanceof Blob}function cloneArrayBuffer(e){if("function"==typeof e.slice)return e.slice(0);var t=new ArrayBuffer(e.byteLength),r=new Uint8Array(t),n=new Uint8Array(e);return r.set(n),t}function cloneBinaryObject(e){if(e instanceof ArrayBuffer)return cloneArrayBuffer(e);var t=e.size,r=e.type;return"function"==typeof e.slice?e.slice(0,t,r):e.webkitSlice(0,t,r)}var funcToString=Function.prototype.toString,objectCtorString=funcToString.call(Object);function isPlainObject(e){var t=Object.getPrototypeOf(e);if(null===t)return!0;var r=t.constructor;return"function"==typeof r&&r instanceof r&&funcToString.call(r)==objectCtorString}function clone(e){var t,r,n;if(!e||"object"!=typeof e)return e;if(Array.isArray(e)){for(t=[],r=0,n=e.length;r<n;r++)t[r]=clone(e[r]);return t}if(e instanceof Date)return e.toISOString();if(isBinaryObject(e))return cloneBinaryObject(e);if(!isPlainObject(e))return e;for(r in t={},e)if(Object.prototype.hasOwnProperty.call(e,r)){var o=clone(e[r]);void 0!==o&&(t[r]=o)}return t}var hasLocal,log=debug("pouchdb:api");function pick(e,t){for(var r={},n=0,o=t.length;n<o;n++){var a=t[n];a in e&&(r[a]=e[a])}return r}function isChromeApp(){return"undefined"!=typeof chrome&&void 0!==chrome.storage&&void 0!==chrome.storage.local}if(isChromeApp())hasLocal=!1;else try{localStorage.setItem("_pouch_check_localstorage",1),hasLocal=!!localStorage.getItem("_pouch_check_localstorage")}catch(e){hasLocal=!1}function hasLocalStorage(){return hasLocal}function attachBrowserEvents(e){isChromeApp()?chrome.storage.onChanged.addListener(function(t){null!=t.db_name&&e.emit(t.dbName.newValue)}):hasLocalStorage()&&("undefined"!=typeof addEventListener?addEventListener("storage",function(t){e.emit(t.key)}):window.attachEvent("storage",function(t){e.emit(t.key)}))}function Changes(){events.EventEmitter.call(this),this._listeners={},attachBrowserEvents(this)}function guardedConsole(e){if("undefined"!==console&&e in console){var t=Array.prototype.slice.call(arguments,1);console[e].apply(console,t)}}function PouchError(e){Error.call(this,e.reason),this.status=e.status,this.name=e.error,this.message=e.reason,this.error=!0}inherits(Changes,events.EventEmitter),Changes.prototype.addListener=function(e,t,r,n){if(!this._listeners[t]){var o=this,a=!1;this._listeners[t]=i,this.on(e,i)}function i(){if(o._listeners[t])if(a)a="waiting";else{a=!0;var e=pick(n,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);r.changes(e).on("change",function(e){e.seq>n.since&&!n.cancelled&&(n.since=e.seq,n.onChange(e))}).on("complete",function(){"waiting"===a&&setTimeout(function(){i()},0),a=!1}).on("error",function(){a=!1})}}},Changes.prototype.removeListener=function(e,t){t in this._listeners&&events.EventEmitter.prototype.removeListener.call(this,e,this._listeners[t])},Changes.prototype.notifyLocalWindows=function(e){isChromeApp()?chrome.storage.local.set({dbName:e}):hasLocalStorage()&&(localStorage[e]="a"===localStorage[e]?"b":"a")},Changes.prototype.notify=function(e){this.emit(e),this.notifyLocalWindows(e)},inherits(PouchError,Error),PouchError.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var UNAUTHORIZED=new PouchError({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),MISSING_BULK_DOCS=new PouchError({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),MISSING_DOC=new PouchError({status:404,error:"not_found",reason:"missing"}),REV_CONFLICT=new PouchError({status:409,error:"conflict",reason:"Document update conflict"}),INVALID_ID=new PouchError({status:400,error:"bad_request",reason:"_id field must contain a string"}),MISSING_ID=new PouchError({status:412,error:"missing_id",reason:"_id is required for puts"}),RESERVED_ID=new PouchError({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),NOT_OPEN=new PouchError({status:412,error:"precondition_failed",reason:"Database not open"}),UNKNOWN_ERROR=new PouchError({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),BAD_ARG=new PouchError({status:500,error:"badarg",reason:"Some query argument is invalid"}),INVALID_REQUEST=new PouchError({status:400,error:"invalid_request",reason:"Request was invalid"}),QUERY_PARSE_ERROR=new PouchError({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),DOC_VALIDATION=new PouchError({status:500,error:"doc_validation",reason:"Bad special document member"}),BAD_REQUEST=new PouchError({status:400,error:"bad_request",reason:"Something wrong with the request"}),NOT_AN_OBJECT=new PouchError({status:400,error:"bad_request",reason:"Document must be a JSON object"}),DB_MISSING=new PouchError({status:404,error:"not_found",reason:"Database not found"}),IDB_ERROR=new PouchError({status:500,error:"indexed_db_went_bad",reason:"unknown"}),WSQ_ERROR=new PouchError({status:500,error:"web_sql_went_bad",reason:"unknown"}),LDB_ERROR=new PouchError({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),FORBIDDEN=new PouchError({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),INVALID_REV=new PouchError({status:400,error:"bad_request",reason:"Invalid rev format"}),FILE_EXISTS=new PouchError({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),MISSING_STUB=new PouchError({status:412,error:"missing_stub"}),INVALID_URL=new PouchError({status:413,error:"invalid_url",reason:"Provided URL is invalid"});function createError(e,t){function r(t){for(var r in e)"function"!=typeof e[r]&&(this[r]=e[r]);void 0!==t&&(this.reason=t)}return r.prototype=PouchError.prototype,new r(t)}function tryFilter(e,t,r){try{return!e(t,r)}catch(e){var n="Filter function threw: "+e.toString();return createError(BAD_REQUEST,n)}}function filterChange(e){var t={},r=e.filter&&"function"==typeof e.filter;return t.query=e.query_params,function(n){n.doc||(n.doc={});var o=r&&tryFilter(e.filter,n.doc,t);if("object"==typeof o)return o;if(o)return!1;if(e.include_docs){if(!e.attachments)for(var a in n.doc._attachments)n.doc._attachments.hasOwnProperty(a)&&(n.doc._attachments[a].stub=!0)}else delete n.doc;return!0}}function f(){}var res,hasName=f.name,functionName=res=hasName?function(e){return e.name}:function(e){return e.toString().match(/^\s*function\s*(\S*)\s*\(/)[1]};function invalidIdError(e){var t;if(e?"string"!=typeof e?t=createError(INVALID_ID):/^_/.test(e)&&!/^_(design|local)/.test(e)&&(t=createError(RESERVED_ID)):t=createError(MISSING_ID),t)throw t}var chars="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");function getValue(e){return 0|Math.random()*e}function uuid(e,t){t=t||chars.length;var r="",n=-1;if(e){for(;++n<e;)r+=chars[getValue(t)];return r}for(;++n<36;)switch(n){case 8:case 13:case 18:case 23:r+="-";break;case 19:r+=chars[3&getValue(16)|8];break;default:r+=chars[getValue(16)]}return r}function toObject(e){return e.reduce(function(e,t){return e[t]=!0,e},{})}var reservedWords=toObject(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),dataWords=toObject(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]);function parseRevisionInfo(e){if(!/^\d+\-./.test(e))return createError(INVALID_REV);var t=e.indexOf("-"),r=e.substring(0,t),n=e.substring(t+1);return{prefix:parseInt(r,10),id:n}}function makeRevTreeFromRevisions(e,t){for(var r=e.start-e.ids.length+1,n=e.ids,o=[n[0],t,[]],a=1,i=n.length;a<i;a++)o=[n[a],{status:"missing"},[o]];return[{pos:r,ids:o}]}function parseDoc(e,t){var r,n,o,a={status:"available"};if(e._deleted&&(a.deleted=!0),t)if(e._id||(e._id=uuid()),n=uuid(32,16).toLowerCase(),e._rev){if((o=parseRevisionInfo(e._rev)).error)return o;e._rev_tree=[{pos:o.prefix,ids:[o.id,{status:"missing"},[[n,a,[]]]]}],r=o.prefix+1}else e._rev_tree=[{pos:1,ids:[n,a,[]]}],r=1;else if(e._revisions&&(e._rev_tree=makeRevTreeFromRevisions(e._revisions,a),r=e._revisions.start,n=e._revisions.ids[0]),!e._rev_tree){if((o=parseRevisionInfo(e._rev)).error)return o;r=o.prefix,n=o.id,e._rev_tree=[{pos:r,ids:[n,a,[]]}]}invalidIdError(e._id),e._rev=r+"-"+n;var i={metadata:{},data:{}};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){var u="_"===s[0];if(u&&!reservedWords[s]){var c=createError(DOC_VALIDATION,s);throw c.message=DOC_VALIDATION.message+": "+s,c}u&&!dataWords[s]?i.metadata[s.slice(1)]=e[s]:i.data[s]=e[s]}return i}function winningRev(e){for(var t,r,n,o,a=e.rev_tree.slice();o=a.pop();){var i=o.ids,s=i[2],u=o.pos;if(s.length)for(var c=0,l=s.length;c<l;c++)a.push({pos:u+1,ids:s[c]});else{var f=!!i[1].deleted,d=i[0];t&&!(n!==f?n:r!==u?r<u:t<d)||(t=d,r=u,n=f)}}return r+"-"+t}function traverseRevTree(e,t){for(var r,n=e.slice();r=n.pop();)for(var o=r.pos,a=r.ids,i=a[2],s=t(0===i.length,o,a[0],r.ctx,a[1]),u=0,c=i.length;u<c;u++)n.push({pos:o+1,ids:i[u],ctx:s})}function sortByPos(e,t){return e.pos-t.pos}function collectLeaves(e){var t=[];traverseRevTree(e,function(e,r,n,o,a){e&&t.push({rev:r+"-"+n,pos:r,opts:a})}),t.sort(sortByPos).reverse();for(var r=0,n=t.length;r<n;r++)delete t[r].pos;return t}function collectConflicts(e){for(var t=winningRev(e),r=collectLeaves(e.rev_tree),n=[],o=0,a=r.length;o<a;o++){var i=r[o];i.rev===t||i.opts.deleted||n.push(i.rev)}return n}function compactTree(e){var t=[];return traverseRevTree(e.rev_tree,function(e,r,n,o,a){"available"!==a.status||e||(t.push(r+"-"+n),a.status="missing")}),t}function rootToLeaf(e){for(var t,r=[],n=e.slice();t=n.pop();){var o=t.pos,a=t.ids,i=a[0],s=a[1],u=a[2],c=0===u.length,l=t.history?t.history.slice():[];l.push({id:i,opts:s}),c&&r.push({pos:o+1-l.length,ids:l});for(var f=0,d=u.length;f<d;f++)n.push({pos:o+1,ids:u[f],history:l})}return r.reverse()}function sortByPos$1(e,t){return e.pos-t.pos}function binarySearch(e,t,r){for(var n,o=0,a=e.length;o<a;)r(e[n=o+a>>>1],t)<0?o=n+1:a=n;return o}function insertSorted(e,t,r){var n=binarySearch(e,t,r);e.splice(n,0,t)}function pathToTree(e,t){for(var r,n,o=t,a=e.length;o<a;o++){var i=e[o],s=[i.id,i.opts,[]];n?(n[2].push(s),n=s):r=n=s}return r}function compareTree(e,t){return e[0]<t[0]?-1:1}function mergeTree(e,t){for(var r=[{tree1:e,tree2:t}],n=!1;r.length>0;){var o=r.pop(),a=o.tree1,i=o.tree2;(a[1].status||i[1].status)&&(a[1].status="available"===a[1].status||"available"===i[1].status?"available":"missing");for(var s=0;s<i[2].length;s++)if(a[2][0]){for(var u=!1,c=0;c<a[2].length;c++)a[2][c][0]===i[2][s][0]&&(r.push({tree1:a[2][c],tree2:i[2][s]}),u=!0);u||(n="new_branch",insertSorted(a[2],i[2][s],compareTree))}else n="new_leaf",a[2][0]=i[2][s]}return{conflicts:n,tree:e}}function doMerge(e,t,r){var n,o=[],a=!1,i=!1;if(!e.length)return{tree:[t],conflicts:"new_leaf"};for(var s=0,u=e.length;s<u;s++){var c=e[s];if(c.pos===t.pos&&c.ids[0]===t.ids[0])n=mergeTree(c.ids,t.ids),o.push({pos:c.pos,ids:n.tree}),a=a||n.conflicts,i=!0;else if(!0!==r){var l=c.pos<t.pos?c:t,f=c.pos<t.pos?t:c,d=f.pos-l.pos,v=[],p=[];for(p.push({ids:l.ids,diff:d,parent:null,parentIdx:null});p.length>0;){var h=p.pop();if(0!==h.diff)for(var _=h.ids[2],g=0,m=_.length;g<m;g++)p.push({ids:_[g],diff:h.diff-1,parent:h.ids,parentIdx:g});else h.ids[0]===f.ids[0]&&v.push(h)}var y=v[0];y?(n=mergeTree(y.ids,f.ids),y.parent[2][y.parentIdx]=n.tree,o.push({pos:l.pos,ids:l.ids}),a=a||n.conflicts,i=!0):o.push(c)}else o.push(c)}return i||o.push(t),o.sort(sortByPos$1),{tree:o,conflicts:a||"internal_node"}}function stem(e,t){for(var r,n=rootToLeaf(e),o={},a=0,i=n.length;a<i;a++){for(var s=n[a],u=s.ids,c=Math.max(0,u.length-t),l={pos:s.pos+c,ids:pathToTree(u,c)},f=0;f<c;f++){var d=s.pos+f+"-"+u[f].id;o[d]=!0}r=r?doMerge(r,l,!0).tree:[l]}return traverseRevTree(r,function(e,t,r){delete o[t+"-"+r]}),{tree:r,revs:Object.keys(o)}}function merge(e,t,r){var n=doMerge(e,t),o=stem(n.tree,r);return{tree:o.tree,stemmedRevs:o.revs,conflicts:n.conflicts}}function revExists(e,t){for(var r,n=e.slice(),o=t.split("-"),a=parseInt(o[0],10),i=o[1];r=n.pop();){if(r.pos===a&&r.ids[0]===i)return!0;for(var s=r.ids[2],u=0,c=s.length;u<c;u++)n.push({pos:r.pos+1,ids:s[u]})}return!1}function getTrees(e){return e.ids}function isDeleted(e,t){t||(t=winningRev(e));for(var r,n=t.substring(t.indexOf("-")+1),o=e.rev_tree.map(getTrees);r=o.pop();){if(r[0]===n)return!!r[1].deleted;o=o.concat(r[2])}}function isLocalId(e){return/^_local/.test(e)}var atob$1=function(e){return atob(e)},btoa$1=function(e){return btoa(e)};function createBlob(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(o){if("TypeError"!==o.name)throw o;for(var r=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),n=0;n<e.length;n+=1)r.append(e[n]);return r.getBlob(t.type)}}function binaryStringToArrayBuffer(e){for(var t=e.length,r=new ArrayBuffer(t),n=new Uint8Array(r),o=0;o<t;o++)n[o]=e.charCodeAt(o);return r}function binStringToBluffer(e,t){return createBlob([binaryStringToArrayBuffer(e)],{type:t})}function arrayBufferToBinaryString(e){for(var t="",r=new Uint8Array(e),n=r.byteLength,o=0;o<n;o++)t+=String.fromCharCode(r[o]);return t}function readAsBinaryString(e,t){if("undefined"==typeof FileReader)return t(arrayBufferToBinaryString((new FileReaderSync).readAsArrayBuffer(e)));var r=new FileReader,n="function"==typeof r.readAsBinaryString;r.onloadend=function(e){var r=e.target.result||"";if(n)return t(r);t(arrayBufferToBinaryString(r))},n?r.readAsBinaryString(e):r.readAsArrayBuffer(e)}function readAsArrayBuffer(e,t){if("undefined"==typeof FileReader)return t((new FileReaderSync).readAsArrayBuffer(e));var r=new FileReader;r.onloadend=function(e){var r=e.target.result||new ArrayBuffer(0);t(r)},r.readAsArrayBuffer(e)}var setImmediateShim=global.setImmediate||global.setTimeout,MD5_CHUNK_SIZE=32768;function rawToBase64(e){return btoa$1(e)}function sliceBlob(e,t,r){return e.webkitSlice?e.webkitSlice(t,r):e.slice(t,r)}function appendBlob(e,t,r,n,o){(r>0||n<t.size)&&(t=sliceBlob(t,r,n)),readAsArrayBuffer(t,function(t){e.append(t),o()})}function appendString(e,t,r,n,o){(r>0||n<t.length)&&(t=t.substring(r,n)),e.appendBinary(t),o()}function binaryMd5(e,t){var r="string"==typeof e,n=r?e.length:e.size,o=Math.min(MD5_CHUNK_SIZE,n),a=Math.ceil(n/o),i=0,s=r?new Md5:new Md5.ArrayBuffer,u=r?appendString:appendBlob;function c(){setImmediateShim(f)}function l(){var e=rawToBase64(s.end(!0));t(e),s.destroy()}function f(){var t=i*o,r=t+o;u(s,e,t,r,++i<a?c:l)}f()}function updateDoc(e,t,r,n,o,a,i,s){if(revExists(t.rev_tree,r.metadata.rev))return n[o]=r,a();var u=t.winningRev||winningRev(t),c="deleted"in t?t.deleted:isDeleted(t,u),l="deleted"in r.metadata?r.metadata.deleted:isDeleted(r.metadata),f=/^1-/.test(r.metadata.rev);if(c&&!l&&s&&f){var d=r.data;d._rev=u,d._id=r.metadata.id,r=parseDoc(d,s)}var v=merge(t.rev_tree,r.metadata.rev_tree[0],e);if(s&&(c&&l||!c&&"new_leaf"!==v.conflicts||c&&!l&&"new_branch"===v.conflicts)){var p=createError(REV_CONFLICT);return n[o]=p,a()}var h=r.metadata.rev;r.metadata.rev_tree=v.tree,r.stemmedRevs=v.stemmedRevs||[],t.rev_map&&(r.metadata.rev_map=t.rev_map);var _=winningRev(r.metadata),g=isDeleted(r.metadata,_),m=c===g?0:c<g?-1:1;i(r,_,g,h===_?g:isDeleted(r.metadata,h),!0,m,o,a)}function rootIsMissing(e){return"missing"===e.metadata.rev_tree[0].ids[1].status}function processDocs(e,t,r,n,o,a,i,s,u){e=e||1e3;var c=s.new_edits,l=new pouchdbCollections.Map,f=0,d=t.length;function v(){++f===d&&u&&u()}t.forEach(function(e,t){if(e._id&&isLocalId(e._id)){var n=e._deleted?"_removeLocal":"_putLocal";r[n](e,{ctx:o},function(e,r){a[t]=e||r,v()})}else{var i=e.metadata.id;l.has(i)?(d--,l.get(i).push([e,t])):l.set(i,[[e,t]])}}),l.forEach(function(t,r){var o=0;function u(){++o<t.length?l():v()}function l(){var l=t[o],f=l[0],d=l[1];if(n.has(r))updateDoc(e,n.get(r),f,a,d,u,i,c);else{var v=merge([],f.metadata.rev_tree[0],e);f.metadata.rev_tree=v.tree,f.stemmedRevs=v.stemmedRevs||[],function(e,t,r){var n=winningRev(e.metadata),o=isDeleted(e.metadata,n);if("was_delete"in s&&o)return a[t]=createError(MISSING_DOC,"deleted"),r();if(c&&rootIsMissing(e)){var u=createError(REV_CONFLICT);return a[t]=u,r()}i(e,n,o,o,!1,o?0:1,t,r)}(f,d,u)}}l()})}function slowJsonParse(e){try{return JSON.parse(e)}catch(t){return vuvuzela.parse(e)}}function safeJsonParse(e){return e.length<5e4?JSON.parse(e):slowJsonParse(e)}function safeJsonStringify(e){try{return JSON.stringify(e)}catch(t){return vuvuzela.stringify(e)}}function readAsBlobOrBuffer(e,t){return createBlob([new Uint8Array(e)],{type:t})}function prepareAttachmentForStorage(e,t){readAsBinaryString(e,t)}function createEmptyBlobOrBuffer(e){return createBlob([""],{type:e})}function getCacheFor(e,t){var r=t.prefix()[0],n=e._cache,o=n.get(r);return o||(o=new pouchdbCollections.Map,n.set(r,o)),o}function LevelTransaction(){this._batch=[],this._cache=new pouchdbCollections.Map}LevelTransaction.prototype.get=function(e,t,r){var n=getCacheFor(this,e),o=n.get(t);return o?process.nextTick(function(){r(null,o)}):null===o?process.nextTick(function(){r({name:"NotFoundError"})}):void e.get(t,function(e,o){if(e)return"NotFoundError"===e.name&&n.set(t,null),r(e);n.set(t,o),r(null,o)})},LevelTransaction.prototype.batch=function(e){for(var t=0,r=e.length;t<r;t++){var n=e[t],o=getCacheFor(this,n.prefix);"put"===n.type?o.set(n.key,n.value):o.set(n.key,null)}this._batch=this._batch.concat(e)},LevelTransaction.prototype.execute=function(e,t){for(var r=new pouchdbCollections.Set,n=[],o=this._batch.length-1;o>=0;o--){var a=this._batch[o],i=a.prefix.prefix()[0]+"ÿ"+a.key;r.has(i)||(r.add(i),n.push(a))}e.batch(n,t)};var DOC_STORE="document-store",BY_SEQ_STORE="by-sequence",ATTACHMENT_STORE="attach-store",BINARY_STORE="attach-binary-store",LOCAL_STORE="local-store",META_STORE="meta-store",dbStores=new pouchdbCollections.Map,UPDATE_SEQ_KEY="_local_last_update_seq",DOC_COUNT_KEY="_local_doc_count",UUID_KEY="_local_uuid",MD5_PREFIX="md5-",safeJsonEncoding={encode:safeJsonStringify,decode:safeJsonParse,buffer:!1,type:"cheap-json"},levelChanges=new Changes;function getWinningRev(e){return"winningRev"in e?e.winningRev:winningRev(e)}function getIsDeleted(e,t){return"deleted"in e?e.deleted:isDeleted(e,t)}function fetchAttachment(e,t,r){var n=e.content_type;return new PouchPromise(function(o,a){t.binaryStore.get(e.digest,function(t,i){var s;if(t){if("NotFoundError"!==t.name)return a(t);s=r.binary?binStringToBluffer("",n):""}else s=r.binary?readAsBlobOrBuffer(i,n):i.toString("base64");delete e.stub,delete e.length,e.data=s,o()})})}function fetchAttachments(e,t,r){var n=[];return e.forEach(function(e){e.doc&&e.doc._attachments&&Object.keys(e.doc._attachments).forEach(function(t){var r=e.doc._attachments[t];"data"in r||n.push(r)})}),PouchPromise.all(n.map(function(e){return fetchAttachment(e,t,r)}))}function LevelPouch(e,t){var r,n,o=this,a={},i=(e=clone(e)).revs_limit,s=e.name;void 0===e.createIfMissing&&(e.createIfMissing=!0);var u,c=e.db,l=functionName(c);function f(){a.docStore=n.sublevel(DOC_STORE,{valueEncoding:safeJsonEncoding}),a.bySeqStore=n.sublevel(BY_SEQ_STORE,{valueEncoding:"json"}),a.attachmentStore=n.sublevel(ATTACHMENT_STORE,{valueEncoding:"json"}),a.binaryStore=n.sublevel(BINARY_STORE,{valueEncoding:"binary"}),a.localStore=n.sublevel(LOCAL_STORE,{valueEncoding:"json"}),a.metaStore=n.sublevel(META_STORE,{valueEncoding:"json"}),migrate.localAndMetaStores(n,a,function(){a.metaStore.get(UPDATE_SEQ_KEY,function(e,i){void 0===n._updateSeq&&(n._updateSeq=i||0),a.metaStore.get(DOC_COUNT_KEY,function(e,i){n._docCount=e?0:i,a.metaStore.get(UUID_KEY,function(e,n){r=e?uuid():n,a.metaStore.put(UUID_KEY,r,function(){process.nextTick(function(){t(null,o)})})})})})})}function d(e,t){try{e.apply(null,t)}catch(e){t[t.length-1](e)}}function v(){var e=n._queue.peekFront();"read"===e.type?function(e){var t=[e],r=1,o=n._queue.get(r);for(;void 0!==o&&"read"===o.type;)t.push(o),r++,o=n._queue.get(r);var a=0;t.forEach(function(e){var r=e.args,o=r[r.length-1];r[r.length-1]=getArguments(function(e){o.apply(null,e),++a===t.length&&process.nextTick(function(){t.forEach(function(){n._queue.shift()}),n._queue.length&&v()})}),d(e.fun,r)})}(e):function(e){var t=e.args,r=t[t.length-1];t[t.length-1]=getArguments(function(e){r.apply(null,e),process.nextTick(function(){n._queue.shift(),n._queue.length&&v()})}),d(e.fun,t)}(e)}function p(e){return getArguments(function(t){n._queue.push({fun:e,args:t,type:"write"}),1===n._queue.length&&process.nextTick(v)})}function h(e){return getArguments(function(t){n._queue.push({fun:e,args:t,type:"read"}),1===n._queue.length&&process.nextTick(v)})}function _(e){return("0000000000000000"+e).slice(-16)}function g(e,t){c.destroy(e,t)}dbStores.has(l)?u=dbStores.get(l):(u=new pouchdbCollections.Map,dbStores.set(l,u)),u.has(s)?(n=u.get(s),f()):u.set(s,sublevel(levelup(s,e,function(r){if(r)return u.delete(s),t(r);(n=u.get(s))._docCount=-1,n._queue=new Deque,e.migrate?migrate.toSublevel(s,n,f):f()}))),o.type=function(){return"leveldb"},o._id=function(e){e(null,r)},o._info=function(e){var t={doc_count:n._docCount,update_seq:n._updateSeq,backend_adapter:functionName(c)};return process.nextTick(function(){e(null,t)})},o._get=h(function(e,t,r){t=clone(t),a.docStore.get(e,function(e,n){if(e||!n)return r(createError(MISSING_DOC,"missing"));var o=getWinningRev(n);if(getIsDeleted(n,o)&&!t.rev)return r(createError(MISSING_DOC,"deleted"));o=t.rev?t.rev:o;var i=n.rev_map[o];a.bySeqStore.get(_(i),function(e,t){if(!t)return r(createError(MISSING_DOC));if("_id"in t&&t._id!==n.id)return r(new Error("wrong doc returned"));if(t._id=n.id,"_rev"in t){if(t._rev!==o)return r(new Error("wrong doc returned"))}else t._rev=o;return r(null,{doc:t,metadata:n})})})}),o._getAttachment=function(e,t,r,n,o){var i=r.digest,s=r.content_type;a.binaryStore.get(i,function(e,t){if(e)return"NotFoundError"!==e.name?o(e):o(null,n.binary?createEmptyBlobOrBuffer(s):"");n.binary?o(null,readAsBlobOrBuffer(t,s)):o(null,t.toString("base64"))})},o._bulkDocs=p(function(e,t,r){var u=t.new_edits,c=new Array(e.docs.length),l=new pouchdbCollections.Map,f=new pouchdbCollections.Map,d=new LevelTransaction,v=0,p=n._updateSeq,h=e.docs,g=h.map(function(e){if(e._id&&isLocalId(e._id))return e;var t=parseDoc(e,u);return t.metadata&&!t.metadata.rev_map&&(t.metadata.rev_map={}),t}),m=g.filter(function(e){return e.error});if(m.length)return r(m[0]);function y(e,t){var r=PouchPromise.resolve();e.forEach(function(e,t){r=r.then(function(){return new PouchPromise(function(r,n){o._doCompactionNoLock(t,e,{ctx:d},function(e){if(e)return n(e);r()})})})}),r.then(function(){t()},t)}function b(){y(f,function(e){if(e&&D(e),o.auto_compaction)return t=D,r=new pouchdbCollections.Map,l.forEach(function(e,t){r.set(t,compactTree(e))}),void y(r,t);var t,r;D()})}function S(e,t,n,o,i,s,u,h){v+=s;var g=null,m=0;e.metadata.winningRev=t,e.metadata.deleted=n,e.data._id=e.metadata.id,e.data._rev=e.metadata.rev,o&&(e.data._deleted=!0),e.stemmedRevs.length&&f.set(e.metadata.id,e.stemmedRevs);var y=e.data._attachments?Object.keys(e.data._attachments):[];function b(e){m++,g||(e?h(g=e):m===y.length&&B())}function S(e,t,r,n){return function(o){!function(e,t,r,n,o){var i=e.data._attachments[r];delete i.data,i.digest=t,i.length=n.length;var s=e.metadata.id,u=e.metadata.rev;i.revpos=parseInt(u,10),w(s,u,t,function(e,r){return e?o(e):0===n.length?o(e):r?(d.batch([{type:"put",prefix:a.binaryStore,key:t,value:new Buffer(n,"binary")}]),void o()):o(e)})}(e,MD5_PREFIX+o,t,r,n)}}function E(e,t,r){return function(n){binaryMd5(n,S(e,t,n,r))}}for(var D=0;D<y.length;D++){var T,I=y[D],C=e.data._attachments[I];if(C.stub)w(e.data._id,e.data._rev,C.digest,b);else if("string"==typeof C.data){try{T=atob$1(C.data)}catch(e){return void r(createError(BAD_ARG,"Attachment is not a valid base64 string"))}E(e,I,b)(T)}else prepareAttachmentForStorage(C.data,E(e,I,b))}function B(){var r=e.metadata.rev_map[e.metadata.rev];if(r)return h();r=++p,e.metadata.rev_map[e.metadata.rev]=e.metadata.seq=r;var n=[{key:_(r),value:e.data,prefix:a.bySeqStore,type:"put"},{key:e.metadata.id,value:e.metadata,prefix:a.docStore,type:"put"}];d.batch(n),c[u]={ok:!0,id:e.metadata.id,rev:t},l.set(e.metadata.id,e.metadata),h()}y.length||B()}var E={};function w(e,t,r,n){function o(n){var o=[e,t].join("@"),i={};return n?n.refs&&(i.refs=n.refs,i.refs[o]=!0):(i.refs={},i.refs[o]=!0),new PouchPromise(function(e){d.batch([{type:"put",prefix:a.attachmentStore,key:r,value:i}]),e(!n)})}var i=E[r]||PouchPromise.resolve();E[r]=i.then(function(){return new PouchPromise(function(e,t){d.get(a.attachmentStore,r,function(r,n){if(r&&"NotFoundError"!==r.name)return t(r);e(n)})}).then(o).then(function(e){n(null,e)},n)})}function D(e){if(e)return process.nextTick(function(){r(e)});d.batch([{prefix:a.metaStore,type:"put",key:UPDATE_SEQ_KEY,value:p},{prefix:a.metaStore,type:"put",key:DOC_COUNT_KEY,value:n._docCount+v}]),d.execute(n,function(e){if(e)return r(e);n._docCount+=v,n._updateSeq=p,levelChanges.notify(s),process.nextTick(function(){r(null,c)})})}if(!g.length)return r(null,[]);!function(e){var t=[];if(h.forEach(function(e){e&&e._attachments&&Object.keys(e._attachments).forEach(function(r){var n=e._attachments[r];n.stub&&t.push(n.digest)})}),!t.length)return e();var r,n=0;t.forEach(function(o){!function(e,t){d.get(a.attachmentStore,e,function(r){if(r){var n=createError(MISSING_STUB,"unknown stub attachment with digest "+e);t(n)}else t()})}(o,function(o){o&&!r&&(r=o),++n===t.length&&e(r)})})}(function(e){if(e)return r(e);!function(e){var t,r=0;function n(){if(++r===h.length)return e(t)}h.forEach(function(e){if(e._id&&isLocalId(e._id))return n();d.get(a.docStore,e._id,function(r,o){r?"NotFoundError"!==r.name&&(t=r):l.set(e._id,o),n()})})}(function(e){if(e)return r(e);processDocs(i,g,o,l,d,c,S,t,b)})})}),o._allDocs=h(function(e,t){e=clone(e),function(e){n.isClosed()?e(new Error("database is closed")):e(null,n._docCount)}(function(r,n){if(r)return t(r);var o,i={},s=e.skip||0;if(e.startkey&&(i.gte=e.startkey),e.endkey&&(i.lte=e.endkey),e.key&&(i.gte=i.lte=e.key),e.descending){i.reverse=!0;var u=i.lte;i.lte=i.gte,i.gte=u}if("number"==typeof e.limit&&(o=e.limit),0===o||"start"in i&&"end"in i&&i.start>i.end)return t(null,{total_rows:n,offset:e.skip,rows:[]});var c=[],l=a.docStore.readStream(i),f=through2.obj(function(t,r,n){var i=t.value,u=getWinningRev(i),f=getIsDeleted(i,u);if(f){if("ok"!==e.deleted)return void n()}else{if(s-- >0)return void n();if("number"==typeof o&&o--<=0)return l.unpipe(),l.destroy(),void n()}function d(t){var r={id:i.id,key:i.id,value:{rev:u}};if(e.include_docs)for(var o in r.doc=t,r.doc._rev=r.value.rev,e.conflicts&&(r.doc._conflicts=collectConflicts(i)),r.doc._attachments)r.doc._attachments.hasOwnProperty(o)&&(r.doc._attachments[o].stub=!0);if(!1===e.inclusive_end&&i.id===e.endkey)return n();if(f){if("ok"!==e.deleted)return n();r.value.deleted=!0,r.doc=null}c.push(r),n()}if(e.include_docs){var v=i.rev_map[u];a.bySeqStore.get(_(v),function(e,t){d(t)})}else d()},function(r){PouchPromise.resolve().then(function(){if(e.include_docs&&e.attachments)return fetchAttachments(c,a,e)}).then(function(){t(null,{total_rows:n,offset:e.skip,rows:c})},t),r()}).on("unpipe",function(){f.end()});l.on("error",t),l.pipe(f)})}),o._changes=function(e){if((e=clone(e)).continuous){var t=s+":"+uuid();return levelChanges.addListener(s,t,o,e),levelChanges.notify(s),{cancel:function(){levelChanges.removeListener(s,t)}}}var r,i=e.descending,u=[],c=e.since||0,l=0,f={reverse:i};"limit"in e&&e.limit>0&&(r=e.limit),f.reverse||(f.start=_(e.since||0));var d,v=e.doc_ids&&new pouchdbCollections.Set(e.doc_ids),p=filterChange(e),h=new pouchdbCollections.Map;function g(){e.done=!0,d&&e.limit&&e.limit<u.length&&(u.length=e.limit),m.unpipe(y),m.destroy(),e.continuous||e.cancelled||(e.include_docs&&e.attachments?fetchAttachments(u,a,e).then(function(){e.complete(null,{results:u,last_seq:c})}):e.complete(null,{results:u,last_seq:c}))}d="return_docs"in e?e.return_docs:!("returnDocs"in e)||e.returnDocs;var m=a.bySeqStore.readStream(f),y=through2.obj(function(t,o,s){if(r&&l>=r)return g(),s();if(e.cancelled||e.done)return s();var f,m,y=(f=t.key,parseInt(f,10)),b=t.value;if(y===e.since&&!i)return s();if(v&&!v.has(b._id))return s();function S(t){var r=getWinningRev(t);function n(r){var n=e.processChange(r,t,e);n.seq=t.seq;var o=p(n);if("object"==typeof o)return e.complete(o);o&&(l++,e.attachments&&e.include_docs?fetchAttachments([n],a,e).then(function(){e.onChange(n)}):e.onChange(n),d&&u.push(n)),s()}if(t.seq!==y)return s();if(c=y,r===b._rev)return n(b);var o=t.rev_map[r];a.bySeqStore.get(_(o),function(e,t){n(t)})}if(m=h.get(b._id))return S(m);a.docStore.get(b._id,function(t,r){if(e.cancelled||e.done||n.isClosed()||isLocalId(r.id))return s();h.set(b._id,r),S(r)})},function(t){if(e.cancelled)return t();d&&e.limit&&e.limit<u.length&&(u.length=e.limit),t()}).on("unpipe",function(){y.end(),g()});return m.pipe(y),{cancel:function(){e.cancelled=!0,g()}}},o._close=function(e){if(n.isClosed())return e(createError(NOT_OPEN));n.close(function(t){t?e(t):(u.delete(s),e())})},o._getRevisionTree=function(e,t){a.docStore.get(e,function(e,r){e?t(createError(MISSING_DOC)):t(null,r.rev_tree)})},o._doCompaction=p(function(e,t,r,n){o._doCompactionNoLock(e,t,r,n)}),o._doCompactionNoLock=function(e,t,r,o){if("function"==typeof r&&(o=r,r={}),!t.length)return o();var i=r.ctx||new LevelTransaction;i.get(a.docStore,e,function(s,u){if(s)return o(s);var c=t.map(function(e){var t=u.rev_map[e];return delete u.rev_map[e],t});traverseRevTree(u.rev_tree,function(e,r,n,o,a){var i=r+"-"+n;-1!==t.indexOf(i)&&(a.status="missing")});var l=[];l.push({key:u.id,value:u,type:"put",prefix:a.docStore});var f,d={},v=0;function p(r){if(r&&(f=r),++v===t.length){if(f)return o(f);!function(){var r=Object.keys(d);if(!r.length)return h();var n,o=0;function s(e){e&&(n=e),++o===r.length&&h(n)}var u=new pouchdbCollections.Map;t.forEach(function(t){u.set(e+"@"+t,!0)}),r.forEach(function(e){i.get(a.attachmentStore,e,function(t,r){if(t)return"NotFoundError"===t.name?s():s(t);var n=Object.keys(r.refs||{}).filter(function(e){return!u.has(e)}),o={};n.forEach(function(e){o[e]=!0}),n.length?l.push({key:e,type:"put",value:{refs:o},prefix:a.attachmentStore}):l=l.concat([{key:e,type:"del",prefix:a.attachmentStore},{key:e,type:"del",prefix:a.binaryStore}]),s()})})}()}}function h(e){return e?o(e):(i.batch(l),r.ctx?o():void i.execute(n,o))}c.forEach(function(e){l.push({key:_(e),type:"del",prefix:a.bySeqStore}),i.get(a.bySeqStore,_(e),function(e,t){if(e)return"NotFoundError"===e.name?p():p(e);Object.keys(t._attachments||{}).forEach(function(e){var r=t._attachments[e].digest;d[r]=!0}),p()})})})},o._getLocal=function(e,t){a.localStore.get(e,function(e,r){e?t(createError(MISSING_DOC)):t(null,r)})},o._putLocal=function(e,t,r){"function"==typeof t&&(r=t,t={}),t.ctx?o._putLocalNoLock(e,t,r):o._putLocalWithLock(e,t,r)},o._putLocalWithLock=p(function(e,t,r){o._putLocalNoLock(e,t,r)}),o._putLocalNoLock=function(e,t,r){delete e._revisions;var o=e._rev,i=e._id,s=t.ctx||new LevelTransaction;s.get(a.localStore,i,function(u,c){if(u&&o)return r(createError(REV_CONFLICT));if(c&&c._rev!==o)return r(createError(REV_CONFLICT));e._rev=o?"0-"+(parseInt(o.split("-")[1],10)+1):"0-1";var l=[{type:"put",prefix:a.localStore,key:i,value:e}];s.batch(l);var f={ok:!0,id:e._id,rev:e._rev};if(t.ctx)return r(null,f);s.execute(n,function(e){if(e)return r(e);r(null,f)})})},o._removeLocal=function(e,t,r){"function"==typeof t&&(r=t,t={}),t.ctx?o._removeLocalNoLock(e,t,r):o._removeLocalWithLock(e,t,r)},o._removeLocalWithLock=p(function(e,t,r){o._removeLocalNoLock(e,t,r)}),o._removeLocalNoLock=function(e,t,r){var o=t.ctx||new LevelTransaction;o.get(a.localStore,e._id,function(i,s){if(i)return"NotFoundError"!==i.name?r(i):r(createError(MISSING_DOC));if(s._rev!==e._rev)return r(createError(REV_CONFLICT));o.batch([{prefix:a.localStore,type:"del",key:e._id}]);var u={ok:!0,id:e._id,rev:"0-0"};if(t.ctx)return r(null,u);o.execute(n,function(e){if(e)return r(e);r(null,u)})})},o._destroy=function(e,t){var r,n=functionName(c);if(!dbStores.has(n))return g(s,t);(r=dbStores.get(n)).has(s)?(levelChanges.removeAllListeners(s),r.get(s).close(function(){r.delete(s),g(s,t)})):g(s,t)}}function MemDownPouch(e,t){var r=jsExtend.extend({db:memdown},e);LevelPouch.call(this,r,t)}function MemoryPouchPlugin(e){e.adapter("memory",MemDownPouch,!0)}MemDownPouch.valid=function(){return!0},MemDownPouch.use_prefix=!1;var PDB="undefined"!=typeof PouchDB?PouchDB:require("pouchdb");PDB?MemoryPouchPlugin(PDB):guardedConsole("error",'memory adapter plugin error: Cannot find global "PouchDB" object! Did you remember to include pouchdb.js?');

}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {},require("buffer").Buffer)
},{"_process":140,"argsarray":48,"buffer":52,"debug":128,"double-ended-queue":61,"events":65,"inherits":130,"js-extend":97,"levelup":110,"lie":113,"memdown":116,"pouchdb":127,"pouchdb-collections":124,"spark-md5":286,"sublevel-pouchdb":291,"through2":138,"vuvuzela":310}],127:[function(require,module,exports){
(function (process,global){
"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var jsExtend=require("js-extend"),debug=_interopDefault(require("debug")),inherits=_interopDefault(require("inherits")),lie=_interopDefault(require("lie")),pouchdbCollections=require("pouchdb-collections"),getArguments=_interopDefault(require("argsarray")),events=require("events"),scopedEval=_interopDefault(require("scope-eval")),Md5=_interopDefault(require("spark-md5")),vuvuzela=_interopDefault(require("vuvuzela")),PromisePool=_interopDefault(require("es6-promise-pool")),pouchdbCollate=require("pouchdb-collate"),PouchPromise="function"==typeof Promise?Promise:lie;function isBinaryObject(e){return e instanceof ArrayBuffer||"undefined"!=typeof Blob&&e instanceof Blob}function cloneArrayBuffer(e){if("function"==typeof e.slice)return e.slice(0);var t=new ArrayBuffer(e.byteLength),n=new Uint8Array(t),r=new Uint8Array(e);return n.set(r),t}function cloneBinaryObject(e){if(e instanceof ArrayBuffer)return cloneArrayBuffer(e);var t=e.size,n=e.type;return"function"==typeof e.slice?e.slice(0,t,n):e.webkitSlice(0,t,n)}var funcToString=Function.prototype.toString,objectCtorString=funcToString.call(Object);function isPlainObject(e){var t=Object.getPrototypeOf(e);if(null===t)return!0;var n=t.constructor;return"function"==typeof n&&n instanceof n&&funcToString.call(n)==objectCtorString}function clone(e){var t,n,r;if(!e||"object"!=typeof e)return e;if(Array.isArray(e)){for(t=[],n=0,r=e.length;n<r;n++)t[n]=clone(e[n]);return t}if(e instanceof Date)return e.toISOString();if(isBinaryObject(e))return cloneBinaryObject(e);if(!isPlainObject(e))return e;for(n in t={},e)if(Object.prototype.hasOwnProperty.call(e,n)){var o=clone(e[n]);void 0!==o&&(t[n]=o)}return t}function once(e){var t=!1;return getArguments(function(n){if(t)throw new Error("once called more than once");t=!0,e.apply(this,n)})}function toPromise(e){return getArguments(function(t){var n,r=this,o="function"==typeof(t=clone(t))[t.length-1]&&t.pop();o&&(n=function(e,t){process.nextTick(function(){o(e,t)})});var i=new PouchPromise(function(n,o){var i;try{var a=once(function(e,t){e?o(e):n(t)});t.push(a),(i=e.apply(r,t))&&"function"==typeof i.then&&n(i)}catch(e){o(e)}});return n&&i.then(function(e){n(null,e)},n),i})}var log=debug("pouchdb:api");function adapterFun(e,t){return toPromise(getArguments(function(n){if(this._closed)return PouchPromise.reject(new Error("database is closed"));if(this._destroyed)return PouchPromise.reject(new Error("database is destroyed"));var r=this;return function(e,t,n){if(log.enabled){for(var r=[e._db_name,t],o=0;o<n.length-1;o++)r.push(n[o]);log.apply(null,r);var i=n[n.length-1];n[n.length-1]=function(n,r){var o=[e._db_name,t];o=o.concat(n?["error",n]:["success",r]),log.apply(null,o),i(n,r)}}}(r,e,n),this.taskqueue.isReady?t.apply(this,n):new PouchPromise(function(t,o){r.taskqueue.addTask(function(i){i?o(i):t(r[e].apply(r,n))})})}))}function pick(e,t){for(var n={},r=0,o=t.length;r<o;r++){var i=t[r];i in e&&(n[i]=e[i])}return n}var hasLocal,MAX_NUM_CONCURRENT_REQUESTS=6;function identityFunction(e){return e}function formatResultForOpenRevsGet(e){return[{ok:e}]}function bulkGet(e,t,n){var r={};t.docs.forEach(function(e){e.id in r?r[e.id].push(e):r[e.id]=[e]});var o=Object.keys(r).length,i=0,a=new Array(o);function c(){var e;++i===o&&(e=[],a.forEach(function(t){t.docs.forEach(function(n){e.push({id:t.id,docs:[n]})})}),n(null,{results:e}))}var s=Object.keys(r),u=0;function l(){if(!(u>=s.length)){var n=Math.min(u+MAX_NUM_CONCURRENT_REQUESTS,s.length),o=s.slice(u,n);!function(n,o){n.forEach(function(n,i){var s=o+i,u=r[n],d=pick(u[0],["atts_since","attachments"]);d.open_revs=u.map(function(e){return e.rev}),d.open_revs=d.open_revs.filter(identityFunction);var f=identityFunction;0===d.open_revs.length&&(delete d.open_revs,f=formatResultForOpenRevsGet),["revs","attachments","binary","ajax"].forEach(function(e){e in t&&(d[e]=t[e])}),e.get(n,d,function(e,t){var r,o,i;r=e?[{error:e}]:f(t),o=n,i=r,a[s]={id:o,docs:i},c(),l()})})}(o,u),u+=o.length}}l()}function isChromeApp(){return"undefined"!=typeof chrome&&void 0!==chrome.storage&&void 0!==chrome.storage.local}if(isChromeApp())hasLocal=!1;else try{localStorage.setItem("_pouch_check_localstorage",1),hasLocal=!!localStorage.getItem("_pouch_check_localstorage")}catch(e){hasLocal=!1}function hasLocalStorage(){return hasLocal}function attachBrowserEvents(e){isChromeApp()?chrome.storage.onChanged.addListener(function(t){null!=t.db_name&&e.emit(t.dbName.newValue)}):hasLocalStorage()&&("undefined"!=typeof addEventListener?addEventListener("storage",function(t){e.emit(t.key)}):window.attachEvent("storage",function(t){e.emit(t.key)}))}function Changes$1(){events.EventEmitter.call(this),this._listeners={},attachBrowserEvents(this)}function guardedConsole(e){if("undefined"!==console&&e in console){var t=Array.prototype.slice.call(arguments,1);console[e].apply(console,t)}}function randomNumber(e,t){return e=parseInt(e,10)||0,(t=parseInt(t,10))!=t||t<=e?t=(e||1)<<1:t+=1,t>6e5&&(e=3e5,t=6e5),~~((t-e)*Math.random()+e)}function defaultBackOff(e){var t=0;return e||(t=2e3),randomNumber(e,t)}function explainError(e,t){guardedConsole("info","The above "+e+" is totally normal. "+t)}function PouchError(e){Error.call(this,e.reason),this.status=e.status,this.name=e.error,this.message=e.reason,this.error=!0}inherits(Changes$1,events.EventEmitter),Changes$1.prototype.addListener=function(e,t,n,r){if(!this._listeners[t]){var o=this,i=!1;this._listeners[t]=a,this.on(e,a)}function a(){if(o._listeners[t])if(i)i="waiting";else{i=!0;var e=pick(r,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);n.changes(e).on("change",function(e){e.seq>r.since&&!r.cancelled&&(r.since=e.seq,r.onChange(e))}).on("complete",function(){"waiting"===i&&setTimeout(function(){a()},0),i=!1}).on("error",function(){i=!1})}}},Changes$1.prototype.removeListener=function(e,t){t in this._listeners&&events.EventEmitter.prototype.removeListener.call(this,e,this._listeners[t])},Changes$1.prototype.notifyLocalWindows=function(e){isChromeApp()?chrome.storage.local.set({dbName:e}):hasLocalStorage()&&(localStorage[e]="a"===localStorage[e]?"b":"a")},Changes$1.prototype.notify=function(e){this.emit(e),this.notifyLocalWindows(e)},inherits(PouchError,Error),PouchError.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var UNAUTHORIZED=new PouchError({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),MISSING_BULK_DOCS=new PouchError({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),MISSING_DOC=new PouchError({status:404,error:"not_found",reason:"missing"}),REV_CONFLICT=new PouchError({status:409,error:"conflict",reason:"Document update conflict"}),INVALID_ID=new PouchError({status:400,error:"bad_request",reason:"_id field must contain a string"}),MISSING_ID=new PouchError({status:412,error:"missing_id",reason:"_id is required for puts"}),RESERVED_ID=new PouchError({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),NOT_OPEN=new PouchError({status:412,error:"precondition_failed",reason:"Database not open"}),UNKNOWN_ERROR=new PouchError({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),BAD_ARG=new PouchError({status:500,error:"badarg",reason:"Some query argument is invalid"}),INVALID_REQUEST=new PouchError({status:400,error:"invalid_request",reason:"Request was invalid"}),QUERY_PARSE_ERROR=new PouchError({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),DOC_VALIDATION=new PouchError({status:500,error:"doc_validation",reason:"Bad special document member"}),BAD_REQUEST=new PouchError({status:400,error:"bad_request",reason:"Something wrong with the request"}),NOT_AN_OBJECT=new PouchError({status:400,error:"bad_request",reason:"Document must be a JSON object"}),DB_MISSING=new PouchError({status:404,error:"not_found",reason:"Database not found"}),IDB_ERROR=new PouchError({status:500,error:"indexed_db_went_bad",reason:"unknown"}),WSQ_ERROR=new PouchError({status:500,error:"web_sql_went_bad",reason:"unknown"}),LDB_ERROR=new PouchError({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),FORBIDDEN=new PouchError({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),INVALID_REV=new PouchError({status:400,error:"bad_request",reason:"Invalid rev format"}),FILE_EXISTS=new PouchError({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),MISSING_STUB=new PouchError({status:412,error:"missing_stub"}),INVALID_URL=new PouchError({status:413,error:"invalid_url",reason:"Provided URL is invalid"});function createError(e,t){function n(t){for(var n in e)"function"!=typeof e[n]&&(this[n]=e[n]);void 0!==t&&(this.reason=t)}return n.prototype=PouchError.prototype,new n(t)}function generateErrorFromResponse(e){if("object"!=typeof e){var t=e;(e=UNKNOWN_ERROR).data=t}return"error"in e&&"conflict"===e.error&&(e.name="conflict",e.status=409),"name"in e||(e.name=e.error||"unknown"),"status"in e||(e.status=500),"message"in e||(e.message=e.message||e.reason),e}function tryFilter(e,t,n){try{return!e(t,n)}catch(e){var r="Filter function threw: "+e.toString();return createError(BAD_REQUEST,r)}}function filterChange(e){var t={},n=e.filter&&"function"==typeof e.filter;return t.query=e.query_params,function(r){r.doc||(r.doc={});var o=n&&tryFilter(e.filter,r.doc,t);if("object"==typeof o)return o;if(o)return!1;if(e.include_docs){if(!e.attachments)for(var i in r.doc._attachments)r.doc._attachments.hasOwnProperty(i)&&(r.doc._attachments[i].stub=!0)}else delete r.doc;return!0}}function flatten(e){for(var t=[],n=0,r=e.length;n<r;n++)t=t.concat(e[n]);return t}function invalidIdError(e){var t;if(e?"string"!=typeof e?t=createError(INVALID_ID):/^_/.test(e)&&!/^_(design|local)/.test(e)&&(t=createError(RESERVED_ID)):t=createError(MISSING_ID),t)throw t}function listenerCount(e,t){return"listenerCount"in e?e.listenerCount(t):events.EventEmitter.listenerCount(e,t)}function parseDesignDocFunctionName(e){if(!e)return null;var t=e.split("/");return 2===t.length?t:1===t.length?[e,e]:null}function normalizeDesignDocFunctionName(e){var t=parseDesignDocFunctionName(e);return t?t.join("/"):null}var keys=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],qName="queryKey",qParser=/(?:^|&)([^&=]*)=?([^&]*)/g,parser=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/;function parseUri(e){for(var t=parser.exec(e),n={},r=14;r--;){var o=keys[r],i=t[r]||"",a=-1!==["user","password"].indexOf(o);n[o]=a?decodeURIComponent(i):i}return n[qName]={},n[keys[12]].replace(qParser,function(e,t,r){t&&(n[qName][t]=r)}),n}function upsert(e,t,n){return new PouchPromise(function(r,o){e.get(t,function(i,a){if(i){if(404!==i.status)return o(i);a={}}var c=a._rev,s=n(a);if(!s)return r({updated:!1,rev:c});s._id=t,s._rev=c,r(tryAndPut(e,s,n))})})}function tryAndPut(e,t,n){return e.put(t).then(function(e){return{updated:!0,rev:e.rev}},function(r){if(409!==r.status)throw r;return upsert(e,t._id,n)})}var chars="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");function getValue(e){return 0|Math.random()*e}function uuid(e,t){t=t||chars.length;var n="",r=-1;if(e){for(;++r<e;)n+=chars[getValue(t)];return n}for(;++r<36;)switch(r){case 8:case 13:case 18:case 23:n+="-";break;case 19:n+=chars[3&getValue(16)|8];break;default:n+=chars[getValue(16)]}return n}function winningRev(e){for(var t,n,r,o,i=e.rev_tree.slice();o=i.pop();){var a=o.ids,c=a[2],s=o.pos;if(c.length)for(var u=0,l=c.length;u<l;u++)i.push({pos:s+1,ids:c[u]});else{var d=!!a[1].deleted,f=a[0];t&&!(r!==d?r:n!==s?n<s:t<f)||(t=f,n=s,r=d)}}return n+"-"+t}function traverseRevTree(e,t){for(var n,r=e.slice();n=r.pop();)for(var o=n.pos,i=n.ids,a=i[2],c=t(0===a.length,o,i[0],n.ctx,i[1]),s=0,u=a.length;s<u;s++)r.push({pos:o+1,ids:a[s],ctx:c})}function sortByPos(e,t){return e.pos-t.pos}function collectLeaves(e){var t=[];traverseRevTree(e,function(e,n,r,o,i){e&&t.push({rev:n+"-"+r,pos:n,opts:i})}),t.sort(sortByPos).reverse();for(var n=0,r=t.length;n<r;n++)delete t[n].pos;return t}function collectConflicts(e){for(var t=winningRev(e),n=collectLeaves(e.rev_tree),r=[],o=0,i=n.length;o<i;o++){var a=n[o];a.rev===t||a.opts.deleted||r.push(a.rev)}return r}function compactTree(e){var t=[];return traverseRevTree(e.rev_tree,function(e,n,r,o,i){"available"!==i.status||e||(t.push(n+"-"+r),i.status="missing")}),t}function rootToLeaf(e){for(var t,n=[],r=e.slice();t=r.pop();){var o=t.pos,i=t.ids,a=i[0],c=i[1],s=i[2],u=0===s.length,l=t.history?t.history.slice():[];l.push({id:a,opts:c}),u&&n.push({pos:o+1-l.length,ids:l});for(var d=0,f=s.length;d<f;d++)r.push({pos:o+1,ids:s[d],history:l})}return n.reverse()}function sortByPos$1(e,t){return e.pos-t.pos}function binarySearch(e,t,n){for(var r,o=0,i=e.length;o<i;)n(e[r=o+i>>>1],t)<0?o=r+1:i=r;return o}function insertSorted(e,t,n){var r=binarySearch(e,t,n);e.splice(r,0,t)}function pathToTree(e,t){for(var n,r,o=t,i=e.length;o<i;o++){var a=e[o],c=[a.id,a.opts,[]];r?(r[2].push(c),r=c):n=r=c}return n}function compareTree(e,t){return e[0]<t[0]?-1:1}function mergeTree(e,t){for(var n=[{tree1:e,tree2:t}],r=!1;n.length>0;){var o=n.pop(),i=o.tree1,a=o.tree2;(i[1].status||a[1].status)&&(i[1].status="available"===i[1].status||"available"===a[1].status?"available":"missing");for(var c=0;c<a[2].length;c++)if(i[2][0]){for(var s=!1,u=0;u<i[2].length;u++)i[2][u][0]===a[2][c][0]&&(n.push({tree1:i[2][u],tree2:a[2][c]}),s=!0);s||(r="new_branch",insertSorted(i[2],a[2][c],compareTree))}else r="new_leaf",i[2][0]=a[2][c]}return{conflicts:r,tree:e}}function doMerge(e,t,n){var r,o=[],i=!1,a=!1;if(!e.length)return{tree:[t],conflicts:"new_leaf"};for(var c=0,s=e.length;c<s;c++){var u=e[c];if(u.pos===t.pos&&u.ids[0]===t.ids[0])r=mergeTree(u.ids,t.ids),o.push({pos:u.pos,ids:r.tree}),i=i||r.conflicts,a=!0;else if(!0!==n){var l=u.pos<t.pos?u:t,d=u.pos<t.pos?t:u,f=d.pos-l.pos,h=[],p=[];for(p.push({ids:l.ids,diff:f,parent:null,parentIdx:null});p.length>0;){var _=p.pop();if(0!==_.diff)for(var v=_.ids[2],E=0,m=v.length;E<m;E++)p.push({ids:v[E],diff:_.diff-1,parent:_.ids,parentIdx:E});else _.ids[0]===d.ids[0]&&h.push(_)}var g=h[0];g?(r=mergeTree(g.ids,d.ids),g.parent[2][g.parentIdx]=r.tree,o.push({pos:l.pos,ids:l.ids}),i=i||r.conflicts,a=!0):o.push(u)}else o.push(u)}return a||o.push(t),o.sort(sortByPos$1),{tree:o,conflicts:i||"internal_node"}}function stem(e,t){for(var n,r=rootToLeaf(e),o={},i=0,a=r.length;i<a;i++){for(var c=r[i],s=c.ids,u=Math.max(0,s.length-t),l={pos:c.pos+u,ids:pathToTree(s,u)},d=0;d<u;d++){var f=c.pos+d+"-"+s[d].id;o[f]=!0}n=n?doMerge(n,l,!0).tree:[l]}return traverseRevTree(n,function(e,t,n){delete o[t+"-"+n]}),{tree:n,revs:Object.keys(o)}}function merge(e,t,n){var r=doMerge(e,t),o=stem(r.tree,n);return{tree:o.tree,stemmedRevs:o.revs,conflicts:r.conflicts}}function revExists(e,t){for(var n,r=e.slice(),o=t.split("-"),i=parseInt(o[0],10),a=o[1];n=r.pop();){if(n.pos===i&&n.ids[0]===a)return!0;for(var c=n.ids[2],s=0,u=c.length;s<u;s++)r.push({pos:n.pos+1,ids:c[s]})}return!1}function getTrees(e){return e.ids}function isDeleted(e,t){t||(t=winningRev(e));for(var n,r=t.substring(t.indexOf("-")+1),o=e.rev_tree.map(getTrees);n=o.pop();){if(n[0]===r)return!!n[1].deleted;o=o.concat(n[2])}}function isLocalId(e){return/^_local/.test(e)}function evalFilter(e){return scopedEval("return "+e+";",{})}function evalView(e){return new Function("doc",["var emitted = false;","var emit = function (a, b) {","  emitted = true;","};","var view = "+e+";","view(doc);","if (emitted) {","  return true;","}"].join("\n"))}function tryCatchInChangeListener(e,t){try{e.emit("change",t)}catch(e){guardedConsole("error",'Error in .on("change", function):',e)}}function Changes(e,t,n){events.EventEmitter.call(this);var r=this;this.db=e;var o=(t=t?clone(t):{}).complete=once(function(t,n){t?listenerCount(r,"error")>0&&r.emit("error",t):r.emit("complete",n),r.removeAllListeners(),e.removeListener("destroyed",i)});function i(){r.cancel()}n&&(r.on("complete",function(e){n(null,e)}),r.on("error",n)),e.once("destroyed",i),t.onChange=function(e){t.isCancelled||(tryCatchInChangeListener(r,e),r.startSeq&&r.startSeq<=e.seq&&(r.startSeq=!1))};var a=new PouchPromise(function(e,n){t.complete=function(t,r){t?n(t):e(r)}});r.once("cancel",function(){e.removeListener("destroyed",i),t.complete(null,{status:"cancelled"})}),this.then=a.then.bind(a),this.catch=a.catch.bind(a),this.then(function(e){o(null,e)},o),e.taskqueue.isReady?r.doChanges(t):e.taskqueue.addTask(function(){r.isCancelled?r.emit("cancel"):r.doChanges(t)})}function processChange(e,t,n){var r=[{rev:e._rev}];"all_docs"===n.style&&(r=collectLeaves(t.rev_tree).map(function(e){return{rev:e.rev}}));var o={id:t.id,changes:r,doc:e};return isDeleted(t,e._rev)&&(o.deleted=!0),n.conflicts&&(o.doc._conflicts=collectConflicts(t),o.doc._conflicts.length||delete o.doc._conflicts),o}function compare(e,t){return e<t?-1:e>t?1:0}function arrayFirst(e,t){for(var n=0;n<e.length;n++)if(!0===t(e[n],n))return e[n]}function yankError(e){return function(t,n){t||n[0]&&n[0].error?e(t||n[0]):e(null,n.length?n[0]:n)}}function cleanDocs(e){for(var t=0;t<e.length;t++){var n=e[t];if(n._deleted)delete n._attachments;else if(n._attachments)for(var r=Object.keys(n._attachments),o=0;o<r.length;o++){var i=r[o];n._attachments[i]=pick(n._attachments[i],["data","digest","content_type","length","revpos","stub"])}}}function compareByIdThenRev(e,t){var n=compare(e._id,t._id);return 0!==n?n:compare(e._revisions?e._revisions.start:0,t._revisions?t._revisions.start:0)}function computeHeight(e){var t={},n=[];return traverseRevTree(e,function(e,r,o,i){var a=r+"-"+o;return e&&(t[a]=0),void 0!==i&&n.push({from:i,to:a}),a}),n.reverse(),n.forEach(function(e){void 0===t[e.from]?t[e.from]=1+t[e.to]:t[e.from]=Math.min(t[e.from],1+t[e.to])}),t}function allDocsKeysQuery(e,t,n){var r="limit"in t?t.keys.slice(t.skip,t.limit+t.skip):t.skip>0?t.keys.slice(t.skip):t.keys;if(t.descending&&r.reverse(),!r.length)return e._allDocs({limit:0},n);var o={offset:t.skip};return PouchPromise.all(r.map(function(n){var r=jsExtend.extend({key:n,deleted:"ok"},t);return["limit","skip","keys"].forEach(function(e){delete r[e]}),new PouchPromise(function(t,i){e._allDocs(r,function(e,r){if(e)return i(e);o.total_rows=r.total_rows,t(r.rows[0]||{key:n,error:"not_found"})})})})).then(function(e){return o.rows=e,o})}function doNextCompaction(e){var t=e._compactionQueue[0],n=t.opts,r=t.callback;e.get("_local/compaction").catch(function(){return!1}).then(function(t){t&&t.last_seq&&(n.last_seq=t.last_seq),e._compact(n,function(t,n){t?r(t):r(null,n),process.nextTick(function(){e._compactionQueue.shift(),e._compactionQueue.length&&doNextCompaction(e)})})})}function attachmentNameError(e){return"_"===e.charAt(0)&&e+"is not a valid attachment name, attachment names cannot start with '_'"}function AbstractPouchDB(){events.EventEmitter.call(this)}function TaskQueue(){this.isReady=!1,this.failed=!1,this.queue=[]}function defaultCallback(e){e&&global.debug&&guardedConsole("error",e)}function prepareForDestruction(e,t){var n=t.originalName,r=e.constructor,o=r._destructionListeners;function i(){r.emit("destroyed",n)}e.once("destroyed",i),o.has(n)||o.set(n,[]),o.get(n).push(function(){e.removeListener("destroyed",i),e.emit("destroyed",e)})}function PouchDB(e,t,n){if(!(this instanceof PouchDB))return new PouchDB(e,t,n);var r=this;if("function"!=typeof t&&void 0!==t||(n=t,t={}),e&&"object"==typeof e&&(t=e,e=void 0),void 0===n)n=defaultCallback;else{var o=n;n=function(){return guardedConsole("warn","Using a callback for new PouchDB()is deprecated."),o.apply(null,arguments)}}e=e||t.name,delete(t=clone(t)).name,this.__opts=t;var i=n;r.auto_compaction=t.auto_compaction,r.prefix=PouchDB.prefix,AbstractPouchDB.call(r),r.taskqueue=new TaskQueue;var a=new PouchPromise(function(o,i){var a,c;if(n=function(e,t){if(e)return i(e);delete t.then,o(t)},t=clone(t),function(){try{if("string"!=typeof e)throw(c=new Error("Missing/invalid DB name")).code=400,c;var n=(t.prefix||"")+e;if(a=PouchDB.parseAdapter(n,t),t.originalName=e,t.name=a.name,t.adapter=t.adapter||a.adapter,r._adapter=t.adapter,debug("pouchdb:adapter")("Picked adapter: "+t.adapter),r._db_name=e,!PouchDB.adapters[t.adapter])throw(c=new Error("Adapter is missing")).code=404,c;if(!PouchDB.adapters[t.adapter].valid())throw(c=new Error("Invalid Adapter")).code=404,c}catch(e){r.taskqueue.fail(e)}}(),c)return i(c);r.adapter=t.adapter,r.replicate={},r.replicate.from=function(e,t,n){return r.constructor.replicate(e,r,t,n)},r.replicate.to=function(e,t,n){return r.constructor.replicate(r,e,t,n)},r.sync=function(e,t,n){return r.constructor.sync(r,e,t,n)},r.replicate.sync=r.sync,PouchDB.adapters[t.adapter].call(r,t,function(e){if(e)return r.taskqueue.fail(e),void n(e);prepareForDestruction(r,t),r.emit("created",r),PouchDB.emit("created",t.originalName),r.taskqueue.ready(r),n(null,r)})});a.then(function(e){i(null,e)},i),r.then=a.then.bind(a),r.catch=a.catch.bind(a)}inherits(Changes,events.EventEmitter),Changes.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},Changes.prototype.doChanges=function(e){var t=this,n=e.complete;if("live"in(e=clone(e))&&!("continuous"in e)&&(e.continuous=e.live),e.processChange=processChange,"latest"===e.since&&(e.since="now"),e.since||(e.since=0),"now"!==e.since){if(e.continuous&&"now"!==e.since&&this.db.info().then(function(e){t.startSeq=e.update_seq},function(e){if("idbNull"!==e.id)throw e}),e.view&&!e.filter&&(e.filter="_view"),e.filter&&"string"==typeof e.filter&&("_view"===e.filter?e.view=normalizeDesignDocFunctionName(e.view):e.filter=normalizeDesignDocFunctionName(e.filter),"http"!==this.db.type()&&!e.doc_ids))return this.filterChanges(e);"descending"in e||(e.descending=!1),e.limit=0===e.limit?1:e.limit,e.complete=n;var r=this.db._changes(e);if(r&&"function"==typeof r.cancel){var o=t.cancel;t.cancel=getArguments(function(e){r.cancel(),o.apply(this,e)})}}else this.db.info().then(function(r){t.isCancelled?n(null,{status:"cancelled"}):(e.since=r.update_seq,t.doChanges(e))},n)},Changes.prototype.filterChanges=function(e){var t=this,n=e.complete;if("_view"===e.filter){if(!e.view||"string"!=typeof e.view){var r=createError(BAD_REQUEST,"`view` filter parameter not found or invalid.");return n(r)}var o=parseDesignDocFunctionName(e.view);this.db.get("_design/"+o[0],function(r,i){if(t.isCancelled)return n(null,{status:"cancelled"});if(r)return n(generateErrorFromResponse(r));var a=i&&i.views&&i.views[o[1]]&&i.views[o[1]].map;if(!a)return n(createError(MISSING_DOC,i.views?"missing json key: "+o[1]:"missing json key: views"));e.filter=evalView(a),t.doChanges(e)})}else{var i=parseDesignDocFunctionName(e.filter);if(!i)return t.doChanges(e);this.db.get("_design/"+i[0],function(r,o){if(t.isCancelled)return n(null,{status:"cancelled"});if(r)return n(generateErrorFromResponse(r));var a=o&&o.filters&&o.filters[i[1]];if(!a)return n(createError(MISSING_DOC,o&&o.filters?"missing json key: "+i[1]:"missing json key: filters"));e.filter=evalFilter(a),t.doChanges(e)})}},inherits(AbstractPouchDB,events.EventEmitter),AbstractPouchDB.prototype.post=adapterFun("post",function(e,t,n){if("function"==typeof t&&(n=t,t={}),"object"!=typeof e||Array.isArray(e))return n(createError(NOT_AN_OBJECT));this.bulkDocs({docs:[e]},t,yankError(n))}),AbstractPouchDB.prototype.put=adapterFun("put",getArguments(function(e){var t,n,r,o,i=!1,a=e.shift(),c="_id"in a;if("object"!=typeof a||Array.isArray(a))return(o=e.pop())(createError(NOT_AN_OBJECT));function s(){i||(guardedConsole("warn","db.put(doc, id, rev) has been deprecated and will be removed in a future release, please use db.put({_id: id, _rev: rev}) instead"),i=!0)}for(;"string"!==(n=typeof(t=e.shift()))||c?"string"!==n||!c||"_rev"in a?"object"===n?r=t:"function"===n&&(o=t):(s(),a._rev=t):(s(),a._id=t,c=!0),e.length;);if(r=r||{},invalidIdError(a._id),isLocalId(a._id)&&"function"==typeof this._putLocal)return a._deleted?this._removeLocal(a,o):this._putLocal(a,o);this.bulkDocs({docs:[a]},r,yankError(o))})),AbstractPouchDB.prototype.putAttachment=adapterFun("putAttachment",function(e,t,n,r,o){var i=this;function a(e){var n="_rev"in e?parseInt(e._rev,10):0;return e._attachments=e._attachments||{},e._attachments[t]={content_type:o,data:r,revpos:++n},i.put(e)}return"function"==typeof o&&(o=r,r=n,n=null),void 0===o&&(o=r,r=n,n=null),i.get(e).then(function(e){if(e._rev!==n)throw createError(REV_CONFLICT);return a(e)},function(t){if(t.reason===MISSING_DOC.message)return a({_id:e});throw t})}),AbstractPouchDB.prototype.removeAttachment=adapterFun("removeAttachment",function(e,t,n,r){var o=this;o.get(e,function(e,i){if(e)r(e);else if(i._rev===n){if(!i._attachments)return r();delete i._attachments[t],0===Object.keys(i._attachments).length&&delete i._attachments,o.put(i,r)}else r(createError(REV_CONFLICT))})}),AbstractPouchDB.prototype.remove=adapterFun("remove",function(e,t,n,r){var o;"string"==typeof t?(o={_id:e,_rev:t},"function"==typeof n&&(r=n,n={})):(o=e,"function"==typeof t?(r=t,n={}):(r=n,n=t)),(n=n||{}).was_delete=!0;var i={_id:o._id,_rev:o._rev||n.rev,_deleted:!0};if(isLocalId(i._id)&&"function"==typeof this._removeLocal)return this._removeLocal(o,r);this.bulkDocs({docs:[i]},n,yankError(r))}),AbstractPouchDB.prototype.revsDiff=adapterFun("revsDiff",function(e,t,n){"function"==typeof t&&(n=t,t={});var r=Object.keys(e);if(!r.length)return n(null,{});var o=0,i=new pouchdbCollections.Map;function a(e,t){i.has(e)||i.set(e,{missing:[]}),i.get(e).missing.push(t)}r.map(function(t){this._getRevisionTree(t,function(c,s){if(c&&404===c.status&&"missing"===c.message)i.set(t,{missing:e[t]});else{if(c)return n(c);!function(t,n){var r=e[t].slice(0);traverseRevTree(n,function(e,n,o,i,c){var s=n+"-"+o,u=r.indexOf(s);-1!==u&&(r.splice(u,1),"available"!==c.status&&a(t,s))}),r.forEach(function(e){a(t,e)})}(t,s)}if(++o===r.length){var u={};return i.forEach(function(e,t){u[t]=e}),n(null,u)}})},this)}),AbstractPouchDB.prototype.bulkGet=adapterFun("bulkGet",function(e,t){bulkGet(this,e,t)}),AbstractPouchDB.prototype.compactDocument=adapterFun("compactDocument",function(e,t,n){var r=this;this._getRevisionTree(e,function(o,i){if(o)return n(o);var a=computeHeight(i),c=[],s=[];Object.keys(a).forEach(function(e){a[e]>t&&c.push(e)}),traverseRevTree(i,function(e,t,n,r,o){var i=t+"-"+n;"available"===o.status&&-1!==c.indexOf(i)&&s.push(i)}),r._doCompaction(e,s,n)})}),AbstractPouchDB.prototype.compact=adapterFun("compact",function(e,t){"function"==typeof e&&(t=e,e={});e=e||{},this._compactionQueue=this._compactionQueue||[],this._compactionQueue.push({opts:e,callback:t}),1===this._compactionQueue.length&&doNextCompaction(this)}),AbstractPouchDB.prototype._compact=function(e,t){var n=this,r={return_docs:!1,last_seq:e.last_seq||0},o=[];n.changes(r).on("change",function(e){o.push(n.compactDocument(e.id,0))}).on("complete",function(e){var r=e.last_seq;PouchPromise.all(o).then(function(){return upsert(n,"_local/compaction",function(e){return(!e.last_seq||e.last_seq<r)&&(e.last_seq=r,e)})}).then(function(){t(null,{ok:!0})}).catch(t)}).on("error",t)},AbstractPouchDB.prototype.get=adapterFun("get",function(e,t,n){if("function"==typeof t&&(n=t,t={}),"string"!=typeof e)return n(createError(INVALID_ID));if(isLocalId(e)&&"function"==typeof this._getLocal)return this._getLocal(e,n);var r=[],o=this;function i(){var i=[],a=r.length;if(!a)return n(null,i);r.forEach(function(r){o.get(e,{rev:r,revs:t.revs,attachments:t.attachments},function(e,t){e?i.push({missing:r}):i.push({ok:t}),--a||n(null,i)})})}if(!t.open_revs)return this._get(e,t,function(e,r){if(e)return n(e);var i=r.doc,a=r.metadata,c=r.ctx;if(t.conflicts){var s=collectConflicts(a);s.length&&(i._conflicts=s)}if(isDeleted(a,i._rev)&&(i._deleted=!0),t.revs||t.revs_info){var u=arrayFirst(rootToLeaf(a.rev_tree),function(e){return-1!==e.ids.map(function(e){return e.id}).indexOf(i._rev.split("-")[1])}),l=u.ids.map(function(e){return e.id}).indexOf(i._rev.split("-")[1])+1,d=u.ids.length-l;if(u.ids.splice(l,d),u.ids.reverse(),t.revs&&(i._revisions={start:u.pos+u.ids.length-1,ids:u.ids.map(function(e){return e.id})}),t.revs_info){var f=u.pos+u.ids.length;i._revs_info=u.ids.map(function(e){return{rev:--f+"-"+e.id,status:e.opts.status}})}}if(t.attachments&&i._attachments){var h=i._attachments,p=Object.keys(h).length;if(0===p)return n(null,i);Object.keys(h).forEach(function(e){this._getAttachment(i._id,e,h[e],{rev:i._rev,binary:t.binary,ctx:c},function(t,r){var o=i._attachments[e];o.data=r,delete o.stub,delete o.length,--p||n(null,i)})},o)}else{if(i._attachments)for(var _ in i._attachments)i._attachments.hasOwnProperty(_)&&(i._attachments[_].stub=!0);n(null,i)}});if("all"===t.open_revs)this._getRevisionTree(e,function(e,t){if(e)return n(e);r=collectLeaves(t).map(function(e){return e.rev}),i()});else{if(!Array.isArray(t.open_revs))return n(createError(UNKNOWN_ERROR,"function_clause"));r=t.open_revs;for(var a=0;a<r.length;a++){var c=r[a];if("string"!=typeof c||!/^\d+-/.test(c))return n(createError(INVALID_REV))}i()}}),AbstractPouchDB.prototype.getAttachment=adapterFun("getAttachment",function(e,t,n,r){var o=this;n instanceof Function&&(r=n,n={}),this._get(e,n,function(i,a){return i?r(i):a.doc._attachments&&a.doc._attachments[t]?(n.ctx=a.ctx,n.binary=!0,void o._getAttachment(e,t,a.doc._attachments[t],n,r)):r(createError(MISSING_DOC))})}),AbstractPouchDB.prototype.allDocs=adapterFun("allDocs",function(e,t){if("function"==typeof e&&(t=e,e={}),e.skip=void 0!==e.skip?e.skip:0,e.start_key&&(e.startkey=e.start_key),e.end_key&&(e.endkey=e.end_key),"keys"in e){if(!Array.isArray(e.keys))return t(new TypeError("options.keys must be an array"));var n=["startkey","endkey","key"].filter(function(t){return t in e})[0];if(n)return void t(createError(QUERY_PARSE_ERROR,"Query parameter `"+n+"` is not compatible with multi-get"));if("http"!==this.type())return allDocsKeysQuery(this,e,t)}return this._allDocs(e,t)}),AbstractPouchDB.prototype.changes=function(e,t){return"function"==typeof e&&(t=e,e={}),new Changes(this,e,t)},AbstractPouchDB.prototype.close=adapterFun("close",function(e){return this._closed=!0,this._close(e)}),AbstractPouchDB.prototype.info=adapterFun("info",function(e){var t=this;this._info(function(n,r){if(n)return e(n);r.db_name=r.db_name||t._db_name,r.auto_compaction=!(!t.auto_compaction||"http"===t.type()),r.adapter=t.type(),e(null,r)})}),AbstractPouchDB.prototype.id=adapterFun("id",function(e){return this._id(e)}),AbstractPouchDB.prototype.type=function(){return"function"==typeof this._type?this._type():this.adapter},AbstractPouchDB.prototype.bulkDocs=adapterFun("bulkDocs",function(e,t,n){if("function"==typeof t&&(n=t,t={}),t=t||{},Array.isArray(e)&&(e={docs:e}),!e||!e.docs||!Array.isArray(e.docs))return n(createError(MISSING_BULK_DOCS));for(var r=0;r<e.docs.length;++r)if("object"!=typeof e.docs[r]||Array.isArray(e.docs[r]))return n(createError(NOT_AN_OBJECT));var o;return e.docs.forEach(function(e){e._attachments&&Object.keys(e._attachments).forEach(function(e){o=o||attachmentNameError(e)})}),o?n(createError(BAD_REQUEST,o)):("new_edits"in t||(t.new_edits=!("new_edits"in e)||e.new_edits),t.new_edits||"http"===this.type()||e.docs.sort(compareByIdThenRev),cleanDocs(e.docs),this._bulkDocs(e,t,function(e,r){if(e)return n(e);t.new_edits||(r=r.filter(function(e){return e.error})),n(null,r)}))}),AbstractPouchDB.prototype.registerDependentDatabase=adapterFun("registerDependentDatabase",function(e,t){var n=new this.constructor(e,this.__opts);upsert(this,"_local/_pouch_dependentDbs",function(t){return t.dependentDbs=t.dependentDbs||{},!t.dependentDbs[e]&&(t.dependentDbs[e]=!0,t)}).then(function(){t(null,{db:n})}).catch(t)}),AbstractPouchDB.prototype.destroy=adapterFun("destroy",function(e,t){"function"==typeof e&&(t=e,e={});var n=this,r=!("use_prefix"in n)||n.use_prefix;function o(){n._destroy(e,function(e,r){if(e)return t(e);n._destroyed=!0,n.emit("destroyed"),t(null,r||{ok:!0})})}if("http"===n.type())return o();n.get("_local/_pouch_dependentDbs",function(e,i){if(e)return 404!==e.status?t(e):o();var a=i.dependentDbs,c=n.constructor,s=Object.keys(a).map(function(e){var t=r?e.replace(new RegExp("^"+c.prefix),""):e;return new c(t,n.__opts).destroy()});PouchPromise.all(s).then(o,t)})}),TaskQueue.prototype.execute=function(){var e;if(this.failed)for(;e=this.queue.shift();)e(this.failed);else for(;e=this.queue.shift();)e()},TaskQueue.prototype.fail=function(e){this.failed=e,this.execute()},TaskQueue.prototype.ready=function(e){this.isReady=!0,this.db=e,this.execute()},TaskQueue.prototype.addTask=function(e){this.queue.push(e),this.failed&&this.execute()},inherits(PouchDB,AbstractPouchDB),PouchDB.debug=debug,PouchDB.adapters={},PouchDB.preferredAdapters=[],PouchDB.prefix="_pouch_";var eventEmitter=new events.EventEmitter;function setUpEventEmitter(e){Object.keys(events.EventEmitter.prototype).forEach(function(t){"function"==typeof events.EventEmitter.prototype[t]&&(e[t]=eventEmitter[t].bind(eventEmitter))});var t=e._destructionListeners=new pouchdbCollections.Map;e.on("destroyed",function(e){t.get(e).forEach(function(e){e()}),t.delete(e)})}setUpEventEmitter(PouchDB),PouchDB.parseAdapter=function(e,t){var n,r,o=e.match(/([a-z\-]*):\/\/(.*)/);if(o){if(e=/http(s?)/.test(o[1])?o[1]+"://"+o[2]:o[2],n=o[1],!PouchDB.adapters[n].valid())throw"Invalid adapter";return{name:e,adapter:o[1]}}var i="idb"in PouchDB.adapters&&"websql"in PouchDB.adapters&&hasLocalStorage()&&localStorage["_pouch__websqldb_"+PouchDB.prefix+e];if(t.adapter)r=t.adapter;else if(void 0!==t&&t.db)r="leveldb";else for(var a=0;a<PouchDB.preferredAdapters.length;++a)if((r=PouchDB.preferredAdapters[a])in PouchDB.adapters){if(i&&"idb"===r){guardedConsole("log",'PouchDB is downgrading "'+e+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');continue}break}return{name:!((n=PouchDB.adapters[r])&&"use_prefix"in n)||n.use_prefix?PouchDB.prefix+e:e,adapter:r}},PouchDB.adapter=function(e,t,n){t.valid()&&(PouchDB.adapters[e]=t,n&&PouchDB.preferredAdapters.push(e))},PouchDB.plugin=function(e){return"function"==typeof e?e(PouchDB):Object.keys(e).forEach(function(t){PouchDB.prototype[t]=e[t]}),PouchDB},PouchDB.defaults=function(e){function t(n,r,o){if(!(this instanceof t))return new t(n,r,o);"function"!=typeof r&&void 0!==r||(o=r,r={}),n&&"object"==typeof n&&(r=n,n=void 0),r=jsExtend.extend({},e,r),PouchDB.call(this,n,r,o)}return inherits(t,PouchDB),t.preferredAdapters=PouchDB.preferredAdapters.slice(),Object.keys(PouchDB).forEach(function(e){e in t||(t[e]=PouchDB[e])}),t};var version="5.4.5";function toObject(e){return e.reduce(function(e,t){return e[t]=!0,e},{})}PouchDB.version=version;var reservedWords=toObject(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),dataWords=toObject(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]);function parseRevisionInfo(e){if(!/^\d+\-./.test(e))return createError(INVALID_REV);var t=e.indexOf("-"),n=e.substring(0,t),r=e.substring(t+1);return{prefix:parseInt(n,10),id:r}}function makeRevTreeFromRevisions(e,t){for(var n=e.start-e.ids.length+1,r=e.ids,o=[r[0],t,[]],i=1,a=r.length;i<a;i++)o=[r[i],{status:"missing"},[o]];return[{pos:n,ids:o}]}function parseDoc(e,t){var n,r,o,i={status:"available"};if(e._deleted&&(i.deleted=!0),t)if(e._id||(e._id=uuid()),r=uuid(32,16).toLowerCase(),e._rev){if((o=parseRevisionInfo(e._rev)).error)return o;e._rev_tree=[{pos:o.prefix,ids:[o.id,{status:"missing"},[[r,i,[]]]]}],n=o.prefix+1}else e._rev_tree=[{pos:1,ids:[r,i,[]]}],n=1;else if(e._revisions&&(e._rev_tree=makeRevTreeFromRevisions(e._revisions,i),n=e._revisions.start,r=e._revisions.ids[0]),!e._rev_tree){if((o=parseRevisionInfo(e._rev)).error)return o;n=o.prefix,r=o.id,e._rev_tree=[{pos:n,ids:[r,i,[]]}]}invalidIdError(e._id),e._rev=n+"-"+r;var a={metadata:{},data:{}};for(var c in e)if(Object.prototype.hasOwnProperty.call(e,c)){var s="_"===c[0];if(s&&!reservedWords[c]){var u=createError(DOC_VALIDATION,c);throw u.message=DOC_VALIDATION.message+": "+c,u}s&&!dataWords[c]?a.metadata[c.slice(1)]=e[c]:a.data[c]=e[c]}return a}var atob$1=function(e){return atob(e)},btoa$1=function(e){return btoa(e)};function createBlob(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(o){if("TypeError"!==o.name)throw o;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),r=0;r<e.length;r+=1)n.append(e[r]);return n.getBlob(t.type)}}function binaryStringToArrayBuffer(e){for(var t=e.length,n=new ArrayBuffer(t),r=new Uint8Array(n),o=0;o<t;o++)r[o]=e.charCodeAt(o);return n}function binStringToBluffer(e,t){return createBlob([binaryStringToArrayBuffer(e)],{type:t})}function b64ToBluffer(e,t){return binStringToBluffer(atob$1(e),t)}function arrayBufferToBinaryString(e){for(var t="",n=new Uint8Array(e),r=n.byteLength,o=0;o<r;o++)t+=String.fromCharCode(n[o]);return t}function readAsBinaryString(e,t){if("undefined"==typeof FileReader)return t(arrayBufferToBinaryString((new FileReaderSync).readAsArrayBuffer(e)));var n=new FileReader,r="function"==typeof n.readAsBinaryString;n.onloadend=function(e){var n=e.target.result||"";if(r)return t(n);t(arrayBufferToBinaryString(n))},r?n.readAsBinaryString(e):n.readAsArrayBuffer(e)}function blobToBinaryString(e,t){readAsBinaryString(e,function(e){t(e)})}function blobToBase64(e,t){blobToBinaryString(e,function(e){t(btoa$1(e))})}function readAsArrayBuffer(e,t){if("undefined"==typeof FileReader)return t((new FileReaderSync).readAsArrayBuffer(e));var n=new FileReader;n.onloadend=function(e){var n=e.target.result||new ArrayBuffer(0);t(n)},n.readAsArrayBuffer(e)}var setImmediateShim=global.setImmediate||global.setTimeout,MD5_CHUNK_SIZE=32768;function rawToBase64(e){return btoa$1(e)}function sliceBlob(e,t,n){return e.webkitSlice?e.webkitSlice(t,n):e.slice(t,n)}function appendBlob(e,t,n,r,o){(n>0||r<t.size)&&(t=sliceBlob(t,n,r)),readAsArrayBuffer(t,function(t){e.append(t),o()})}function appendString(e,t,n,r,o){(n>0||r<t.length)&&(t=t.substring(n,r)),e.appendBinary(t),o()}function binaryMd5(e,t){var n="string"==typeof e,r=n?e.length:e.size,o=Math.min(MD5_CHUNK_SIZE,r),i=Math.ceil(r/o),a=0,c=n?new Md5:new Md5.ArrayBuffer,s=n?appendString:appendBlob;function u(){setImmediateShim(d)}function l(){var e=rawToBase64(c.end(!0));t(e),c.destroy()}function d(){var t=a*o,n=t+o;s(c,e,t,n,++a<i?u:l)}d()}function stringMd5(e){return Md5.hash(e)}function parseBase64(e){try{return atob$1(e)}catch(e){return{error:createError(BAD_ARG,"Attachment is not a valid base64 string")}}}function preprocessString(e,t,n){var r=parseBase64(e.data);if(r.error)return n(r.error);e.length=r.length,e.data="blob"===t?binStringToBluffer(r,e.content_type):"base64"===t?btoa$1(r):r,binaryMd5(r,function(t){e.digest="md5-"+t,n()})}function preprocessBlob(e,t,n){binaryMd5(e.data,function(r){e.digest="md5-"+r,e.length=e.data.size||e.data.length||0,"binary"===t?blobToBinaryString(e.data,function(t){e.data=t,n()}):"base64"===t?blobToBase64(e.data,function(t){e.data=t,n()}):n()})}function preprocessAttachment(e,t,n){if(e.stub)return n();"string"==typeof e.data?preprocessString(e,t,n):preprocessBlob(e,t,n)}function preprocessAttachments(e,t,n){if(!e.length)return n();var r,o=0;function i(){o++,e.length===o&&(r?n(r):n())}e.forEach(function(e){var n=e.data&&e.data._attachments?Object.keys(e.data._attachments):[],o=0;if(!n.length)return i();function a(e){r=e,++o===n.length&&i()}for(var c in e.data._attachments)e.data._attachments.hasOwnProperty(c)&&preprocessAttachment(e.data._attachments[c],t,a)})}function updateDoc(e,t,n,r,o,i,a,c){if(revExists(t.rev_tree,n.metadata.rev))return r[o]=n,i();var s=t.winningRev||winningRev(t),u="deleted"in t?t.deleted:isDeleted(t,s),l="deleted"in n.metadata?n.metadata.deleted:isDeleted(n.metadata),d=/^1-/.test(n.metadata.rev);if(u&&!l&&c&&d){var f=n.data;f._rev=s,f._id=n.metadata.id,n=parseDoc(f,c)}var h=merge(t.rev_tree,n.metadata.rev_tree[0],e);if(c&&(u&&l||!u&&"new_leaf"!==h.conflicts||u&&!l&&"new_branch"===h.conflicts)){var p=createError(REV_CONFLICT);return r[o]=p,i()}var _=n.metadata.rev;n.metadata.rev_tree=h.tree,n.stemmedRevs=h.stemmedRevs||[],t.rev_map&&(n.metadata.rev_map=t.rev_map);var v=winningRev(n.metadata),E=isDeleted(n.metadata,v),m=u===E?0:u<E?-1:1;a(n,v,E,_===v?E:isDeleted(n.metadata,_),!0,m,o,i)}function rootIsMissing(e){return"missing"===e.metadata.rev_tree[0].ids[1].status}function processDocs(e,t,n,r,o,i,a,c,s){e=e||1e3;var u=c.new_edits,l=new pouchdbCollections.Map,d=0,f=t.length;function h(){++d===f&&s&&s()}t.forEach(function(e,t){if(e._id&&isLocalId(e._id)){var r=e._deleted?"_removeLocal":"_putLocal";n[r](e,{ctx:o},function(e,n){i[t]=e||n,h()})}else{var a=e.metadata.id;l.has(a)?(f--,l.get(a).push([e,t])):l.set(a,[[e,t]])}}),l.forEach(function(t,n){var o=0;function s(){++o<t.length?l():h()}function l(){var l=t[o],d=l[0],f=l[1];if(r.has(n))updateDoc(e,r.get(n),d,i,f,s,a,u);else{var h=merge([],d.metadata.rev_tree[0],e);d.metadata.rev_tree=h.tree,d.stemmedRevs=h.stemmedRevs||[],function(e,t,n){var r=winningRev(e.metadata),o=isDeleted(e.metadata,r);if("was_delete"in c&&o)return i[t]=createError(MISSING_DOC,"deleted"),n();if(u&&rootIsMissing(e)){var s=createError(REV_CONFLICT);return i[t]=s,n()}a(e,r,o,o,!1,o?0:1,t,n)}(d,f,s)}}l()})}var ADAPTER_VERSION=5,DOC_STORE="document-store",BY_SEQ_STORE="by-sequence",ATTACH_STORE="attach-store",ATTACH_AND_SEQ_STORE="attach-seq-store",META_STORE="meta-store",LOCAL_STORE="local-store",DETECT_BLOB_SUPPORT_STORE="detect-blob-support";function slowJsonParse(e){try{return JSON.parse(e)}catch(t){return vuvuzela.parse(e)}}function safeJsonParse(e){return e.length<5e4?JSON.parse(e):slowJsonParse(e)}function safeJsonStringify(e){try{return JSON.stringify(e)}catch(t){return vuvuzela.stringify(e)}}function tryCode(e,t,n,r){try{e.apply(t,n)}catch(e){r.emit("error",e)}}var taskQueue={running:!1,queue:[]};function applyNext(e){if(!taskQueue.running&&taskQueue.queue.length){taskQueue.running=!0;var t=taskQueue.queue.shift();t.action(function(n,r){tryCode(t.callback,this,[n,r],e),taskQueue.running=!1,process.nextTick(function(){applyNext(e)})})}}function idbError(e){return function(t){var n="unknown_error";t.target&&t.target.error&&(n=t.target.error.name||t.target.error.message),e(createError(IDB_ERROR,n,t.type))}}function encodeMetadata(e,t,n){return{data:safeJsonStringify(e),winningRev:t,deletedOrLocal:n?"1":"0",seq:e.seq,id:e.id}}function decodeMetadata(e){if(!e)return null;var t=safeJsonParse(e.data);return t.winningRev=e.winningRev,t.deleted="1"===e.deletedOrLocal,t.seq=e.seq,t}function decodeDoc(e){if(!e)return e;var t=e._doc_id_rev.lastIndexOf(":");return e._id=e._doc_id_rev.substring(0,t-1),e._rev=e._doc_id_rev.substring(t+1),delete e._doc_id_rev,e}function readBlobData(e,t,n,r){n?r(e?"string"!=typeof e?e:b64ToBluffer(e,t):createBlob([""],{type:t})):e?"string"!=typeof e?readAsBinaryString(e,function(e){r(btoa$1(e))}):r(e):r("")}function fetchAttachmentsIfNecessary(e,t,n,r){var o=Object.keys(e._attachments||{});if(!o.length)return r&&r();var i=0;function a(){++i===o.length&&r&&r()}o.forEach(function(r){t.attachments&&t.include_docs?function(e,t){var r=e._attachments[t],o=r.digest;n.objectStore(ATTACH_STORE).get(o).onsuccess=function(e){r.body=e.target.result.body,a()}}(e,r):(e._attachments[r].stub=!0,a())})}function postProcessAttachments(e,t){return PouchPromise.all(e.map(function(e){if(e.doc&&e.doc._attachments){var n=Object.keys(e.doc._attachments);return PouchPromise.all(n.map(function(n){var r=e.doc._attachments[n];if("body"in r){var o=r.body,i=r.content_type;return new PouchPromise(function(a){readBlobData(o,i,t,function(t){e.doc._attachments[n]=jsExtend.extend(pick(r,["digest","content_type"]),{data:t}),a()})})}}))}}))}function compactRevs(e,t,n){var r=[],o=n.objectStore(BY_SEQ_STORE),i=n.objectStore(ATTACH_STORE),a=n.objectStore(ATTACH_AND_SEQ_STORE),c=e.length;function s(){--c||function(){if(!r.length)return;r.forEach(function(e){var t=a.index("digestSeq").count(IDBKeyRange.bound(e+"::",e+"::￿",!1,!1));t.onsuccess=function(t){var n=t.target.result;n||i.delete(e)}})}()}e.forEach(function(e){var n=o.index("_doc_id_rev"),i=t+"::"+e;n.getKey(i).onsuccess=function(e){var t=e.target.result;if("number"!=typeof t)return s();o.delete(t),a.index("seq").openCursor(IDBKeyRange.only(t)).onsuccess=function(e){var t=e.target.result;if(t){var n=t.value.digestSeq.split("::")[0];r.push(n),a.delete(t.primaryKey),t.continue()}else s()}}})}function openTransactionSafely(e,t,n){try{return{txn:e.transaction(t,n)}}catch(e){return{error:e}}}function idbBulkDocs(e,t,n,r,o,i,a){for(var c,s,u,l,d,f,h=t.docs,p=0,_=0,v=h.length;_<v;_++){var E=h[_];E._id&&isLocalId(E._id)||(E=h[_]=parseDoc(E,n.new_edits)).error&&!f&&(f=E)}if(f)return a(f);var m=new Array(h.length),g=new pouchdbCollections.Map,y=!1,S=r._meta.blobSupport?"blob":"base64";function T(){y||(i.notify(r._meta.name),r._meta.docCount+=p,a(null,m))}function b(e,t,n,r,o,i,a,c){p+=i,e.metadata.winningRev=t,e.metadata.deleted=n;var s=e.data;if(s._id=e.metadata.id,s._rev=e.metadata.rev,r&&(s._deleted=!0),s._attachments&&Object.keys(s._attachments).length)return function(e,t,n,r,o,i){var a=e.data,c=0,s=Object.keys(a._attachments);function u(){c===s.length&&O(e,t,n,r,o,i)}function d(){c++,u()}s.forEach(function(n){var r=e.data._attachments[n];if(r.stub)c++,u();else{var o=r.data;delete r.data,r.revpos=parseInt(t,10);var i=r.digest;!function(e,t,n){l.count(e).onsuccess=function(r){var o=r.target.result;if(o)return n();var i={digest:e,body:t},a=l.put(i);a.onsuccess=n}}(i,o,d)}})}(e,t,n,o,a,c);O(e,t,n,o,a,c)}function O(e,t,n,o,i,a){var l=e.data,f=e.metadata;function h(i){var a=e.stemmedRevs||[];o&&r.auto_compaction&&(a=a.concat(compactTree(e.metadata))),a&&a.length&&compactRevs(a,e.metadata.id,c),f.seq=i.target.result,delete f.rev;var u=encodeMetadata(f,t,n);s.put(u).onsuccess=p}function p(){m[i]={ok:!0,id:f.id,rev:t},g.set(e.metadata.id,e.metadata),function(e,t,n){var r=0,o=Object.keys(e.data._attachments||{});if(!o.length)return n();function i(){++r===o.length&&n()}function a(n){var r=e.data._attachments[n].digest,o=d.put({seq:t,digestSeq:r+"::"+t});o.onsuccess=i,o.onerror=function(e){e.preventDefault(),e.stopPropagation(),i()}}for(var c=0;c<o.length;c++)a(o[c])}(e,f.seq,a)}l._doc_id_rev=f.id+"::"+f.rev,delete l._id,delete l._rev;var _=u.put(l);_.onsuccess=h,_.onerror=function(e){e.preventDefault(),e.stopPropagation(),u.index("_doc_id_rev").getKey(l._doc_id_rev).onsuccess=function(e){u.put(l,e.target.result).onsuccess=h}}}preprocessAttachments(h,S,function(t){if(t)return a(t);!function(){var t=openTransactionSafely(o,[DOC_STORE,BY_SEQ_STORE,ATTACH_STORE,LOCAL_STORE,ATTACH_AND_SEQ_STORE],"readwrite");if(t.error)return a(t.error);(c=t.txn).onabort=idbError(a),c.ontimeout=idbError(a),c.oncomplete=T,s=c.objectStore(DOC_STORE),u=c.objectStore(BY_SEQ_STORE),l=c.objectStore(ATTACH_STORE),d=c.objectStore(ATTACH_AND_SEQ_STORE),function(e){var t=[];if(h.forEach(function(e){e.data&&e.data._attachments&&Object.keys(e.data._attachments).forEach(function(n){var r=e.data._attachments[n];r.stub&&t.push(r.digest)})}),!t.length)return e();var n,r=0;t.forEach(function(o){!function(e,t){l.get(e).onsuccess=function(n){if(n.target.result)t();else{var r=createError(MISSING_STUB,"unknown stub attachment with digest "+e);r.status=412,t(r)}}}(o,function(o){o&&!n&&(n=o),++r===t.length&&e(n)})})}(function(t){if(t)return y=!0,a(t);!function(){if(!h.length)return;var t=0;function o(){++t===h.length&&processDocs(e.revs_limit,h,r,g,c,m,b,n)}function i(e){var t=decodeMetadata(e.target.result);t&&g.set(t.id,t),o()}for(var a=0,u=h.length;a<u;a++){var l=h[a];if(l._id&&isLocalId(l._id))o();else{var d=s.get(l.metadata.id);d.onsuccess=i}}}()})}()})}function createKeyRange(e,t,n,r,o){try{if(e&&t)return o?IDBKeyRange.bound(t,e,!n,!1):IDBKeyRange.bound(e,t,!1,!n);if(e)return o?IDBKeyRange.upperBound(e):IDBKeyRange.lowerBound(e);if(t)return o?IDBKeyRange.lowerBound(t,!n):IDBKeyRange.upperBound(t,!n);if(r)return IDBKeyRange.only(r)}catch(e){return{error:e}}return null}function handleKeyRangeError(e,t,n,r){if("DataError"===n.name&&0===n.code)return r(null,{total_rows:e._meta.docCount,offset:t.skip,rows:[]});r(createError(IDB_ERROR,n.name,n.message))}function idbAllDocs(e,t,n,r){function o(e,r){var o="startkey"in e&&e.startkey,i="endkey"in e&&e.endkey,a="key"in e&&e.key,c=e.skip||0,s="number"==typeof e.limit?e.limit:-1,u=!1!==e.inclusive_end,l="descending"in e&&e.descending?"prev":null,d=createKeyRange(o,i,u,a,l);if(d&&d.error)return handleKeyRangeError(t,e,d.error,r);var f=[DOC_STORE,BY_SEQ_STORE];e.attachments&&f.push(ATTACH_STORE);var h=openTransactionSafely(n,f,"readonly");if(h.error)return r(h.error);var p=h.txn,_=p.objectStore(DOC_STORE),v=p.objectStore(BY_SEQ_STORE),E=l?_.openCursor(d,l):_.openCursor(d),m=v.index("_doc_id_rev"),g=[],y=0;function S(t,n,r){var o=t.id+"::"+r;m.get(o).onsuccess=function(r){n.doc=decodeDoc(r.target.result),e.conflicts&&(n.doc._conflicts=collectConflicts(t)),fetchAttachmentsIfNecessary(n.doc,e,p)}}function T(){r(null,{total_rows:y,offset:e.skip,rows:g})}p.oncomplete=function(){e.attachments?postProcessAttachments(g,e.binary).then(T):T()},E.onsuccess=function(n){y=t._meta.docCount;var r=n.target.result;if(r){var o=decodeMetadata(r.value);!function(t,n,r){var o={id:r.id,key:r.id,value:{rev:n}},i=r.deleted;if("ok"===e.deleted)g.push(o),i?(o.value.deleted=!0,o.doc=null):e.include_docs&&S(r,o,n);else if(!i&&c--<=0&&(g.push(o),e.include_docs&&S(r,o,n),0==--s))return;t.continue()}(r,o.winningRev,o)}}}!function(e,n){if(0===e.limit)return n(null,{total_rows:t._meta.docCount,offset:e.skip,rows:[]});o(e,n)}(e,r)}function checkBlobSupport(e){return new PouchPromise(function(t){var n=createBlob([""]);e.objectStore(DETECT_BLOB_SUPPORT_STORE).put(n,"key"),e.onabort=function(e){e.preventDefault(),e.stopPropagation(),t(!1)},e.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);t(n||!e||parseInt(e[1],10)>=43)}}).catch(function(){return!1})}var blobSupportPromise,cachedDBs=new pouchdbCollections.Map,idbChanges=new Changes$1,openReqList=new pouchdbCollections.Map;function IdbPouch(e,t){var n=this;taskQueue.queue.push({action:function(t){init(n,e,t)},callback:t}),applyNext(n.constructor)}function init(e,t,n){var r=t.name,o=null;function i(e,t){var n=e.objectStore(DOC_STORE);n.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),n.openCursor().onsuccess=function(e){var r=e.target.result;if(r){var o=r.value,i=isDeleted(o);o.deletedOrLocal=i?"1":"0",n.put(o),r.continue()}else t()}}function a(e,t){var n=e.objectStore(LOCAL_STORE),r=e.objectStore(DOC_STORE),o=e.objectStore(BY_SEQ_STORE);r.openCursor().onsuccess=function(e){var i=e.target.result;if(i){var a=i.value,c=a.id,s=isLocalId(c),u=winningRev(a);if(s){var l=c+"::"+u,d=c+"::",f=c+"::~",h=o.index("_doc_id_rev"),p=IDBKeyRange.bound(d,f,!1,!1),_=h.openCursor(p);_.onsuccess=function(e){if(_=e.target.result){var t=_.value;t._doc_id_rev===l&&n.put(t),o.delete(_.primaryKey),_.continue()}else r.delete(i.primaryKey),i.continue()}}else i.continue()}else t&&t()}}function c(e,t){var n=e.objectStore(BY_SEQ_STORE),r=e.objectStore(ATTACH_STORE),o=e.objectStore(ATTACH_AND_SEQ_STORE);r.count().onsuccess=function(e){if(!e.target.result)return t();n.openCursor().onsuccess=function(e){var n=e.target.result;if(!n)return t();for(var r=n.value,i=n.primaryKey,a=Object.keys(r._attachments||{}),c={},s=0;s<a.length;s++){c[r._attachments[a[s]].digest]=!0}var u=Object.keys(c);for(s=0;s<u.length;s++){var l=u[s];o.put({seq:i,digestSeq:l+"::"+i})}n.continue()}}}function s(e){var t=e.objectStore(BY_SEQ_STORE),n=e.objectStore(DOC_STORE);n.openCursor().onsuccess=function(e){var r=e.target.result;if(r){var o,i,a,c,s=(o=r.value).data?decodeMetadata(o):(o.deleted="1"===o.deletedOrLocal,o);if(s.winningRev=s.winningRev||winningRev(s),s.seq)return u();i=s.id+"::",a=s.id+"::￿",c=0,t.index("_doc_id_rev").openCursor(IDBKeyRange.bound(i,a)).onsuccess=function(e){var t=e.target.result;if(!t)return s.seq=c,u();var n=t.primaryKey;n>c&&(c=n),t.continue()}}function u(){var e=encodeMetadata(s,s.winningRev,s.deleted);n.put(e).onsuccess=function(){r.continue()}}}}e._meta=null,e.type=function(){return"idb"},e._id=toPromise(function(t){t(null,e._meta.instanceId)}),e._bulkDocs=function(n,r,i){idbBulkDocs(t,n,r,e,o,idbChanges,i)},e._get=function(e,t,n){var r,i,a,c=t.ctx;if(!c){var s=openTransactionSafely(o,[DOC_STORE,BY_SEQ_STORE,ATTACH_STORE],"readonly");if(s.error)return n(s.error);c=s.txn}function u(){n(a,{doc:r,metadata:i,ctx:c})}c.objectStore(DOC_STORE).get(e).onsuccess=function(e){if(!(i=decodeMetadata(e.target.result)))return a=createError(MISSING_DOC,"missing"),u();if(isDeleted(i)&&!t.rev)return a=createError(MISSING_DOC,"deleted"),u();var n=c.objectStore(BY_SEQ_STORE),o=t.rev||i.winningRev,s=i.id+"::"+o;n.index("_doc_id_rev").get(s).onsuccess=function(e){if((r=e.target.result)&&(r=decodeDoc(r)),!r)return a=createError(MISSING_DOC,"missing"),u();u()}}},e._getAttachment=function(e,t,n,r,i){var a;if(r.ctx)a=r.ctx;else{var c=openTransactionSafely(o,[DOC_STORE,BY_SEQ_STORE,ATTACH_STORE],"readonly");if(c.error)return i(c.error);a=c.txn}var s=n.digest,u=n.content_type;a.objectStore(ATTACH_STORE).get(s).onsuccess=function(e){readBlobData(e.target.result.body,u,r.binary,function(e){i(null,e)})}},e._info=function(t){if(null===o||!cachedDBs.has(r)){var n=new Error("db isn't open");return n.id="idbNull",t(n)}var i,a,c=openTransactionSafely(o,[BY_SEQ_STORE],"readonly");if(c.error)return t(c.error);var s=c.txn;s.objectStore(BY_SEQ_STORE).openCursor(null,"prev").onsuccess=function(t){var n=t.target.result;i=n?n.key:0,a=e._meta.docCount},s.oncomplete=function(){t(null,{doc_count:a,update_seq:i,idb_attachment_format:e._meta.blobSupport?"binary":"base64"})}},e._allDocs=function(t,n){idbAllDocs(t,e,o,n)},e._changes=function(t){if((t=clone(t)).continuous){var n=r+":"+uuid();return idbChanges.addListener(r,n,e,t),idbChanges.notify(r),{cancel:function(){idbChanges.removeListener(r,n)}}}var i=t.doc_ids&&new pouchdbCollections.Set(t.doc_ids);t.since=t.since||0;var a,c=t.since,s="limit"in t?t.limit:-1;0===s&&(s=1),a="return_docs"in t?t.return_docs:!("returnDocs"in t)||t.returnDocs;var u,l,d,f,h=[],p=0,_=filterChange(t),v=new pouchdbCollections.Map;function E(e){var n,r=decodeDoc(e.value),o=e.key;if(i&&!i.has(r._id))return e.continue();function l(){return n.seq!==o?e.continue():(c=o,n.winningRev===r._rev?E(r):(t=r._id+"::"+n.winningRev,void(f.get(t).onsuccess=function(e){E(decodeDoc(e.target.result))})));var t}function E(r){var o=t.processChange(r,n,t);o.seq=n.seq;var i=_(o);if("object"==typeof i)return t.complete(i);i&&(p++,a&&h.push(o),t.attachments&&t.include_docs?fetchAttachmentsIfNecessary(r,t,u,function(){postProcessAttachments([o],t.binary).then(function(){t.onChange(o)})}):t.onChange(o)),p!==s&&e.continue()}if(n=v.get(r._id))return l();d.get(r._id).onsuccess=function(e){n=decodeMetadata(e.target.result),v.set(r._id,n),l()}}function m(e){var t=e.target.result;t&&E(t)}function g(){function e(){t.complete(null,{results:h,last_seq:c})}!t.continuous&&t.attachments?postProcessAttachments(h).then(e):e()}!function(){var e=[DOC_STORE,BY_SEQ_STORE];t.attachments&&e.push(ATTACH_STORE);var n=openTransactionSafely(o,e,"readonly");if(n.error)return t.complete(n.error);(u=n.txn).onabort=idbError(t.complete),u.oncomplete=g,l=u.objectStore(BY_SEQ_STORE),d=u.objectStore(DOC_STORE),f=l.index("_doc_id_rev"),(t.descending?l.openCursor(null,"prev"):l.openCursor(IDBKeyRange.lowerBound(t.since,!0))).onsuccess=m}()},e._close=function(e){if(null===o)return e(createError(NOT_OPEN));o.close(),cachedDBs.delete(r),o=null,e()},e._getRevisionTree=function(e,t){var n=openTransactionSafely(o,[DOC_STORE],"readonly");if(n.error)return t(n.error);n.txn.objectStore(DOC_STORE).get(e).onsuccess=function(e){var n=decodeMetadata(e.target.result);n?t(null,n.rev_tree):t(createError(MISSING_DOC))}},e._doCompaction=function(e,t,n){var r=openTransactionSafely(o,[DOC_STORE,BY_SEQ_STORE,ATTACH_STORE,ATTACH_AND_SEQ_STORE],"readwrite");if(r.error)return n(r.error);var i=r.txn;i.objectStore(DOC_STORE).get(e).onsuccess=function(n){var r=decodeMetadata(n.target.result);traverseRevTree(r.rev_tree,function(e,n,r,o,i){var a=n+"-"+r;-1!==t.indexOf(a)&&(i.status="missing")}),compactRevs(t,e,i);var o=r.winningRev,a=r.deleted;i.objectStore(DOC_STORE).put(encodeMetadata(r,o,a))},i.onabort=idbError(n),i.oncomplete=function(){n()}},e._getLocal=function(e,t){var n=openTransactionSafely(o,[LOCAL_STORE],"readonly");if(n.error)return t(n.error);var r=n.txn.objectStore(LOCAL_STORE).get(e);r.onerror=idbError(t),r.onsuccess=function(e){var n=e.target.result;n?(delete n._doc_id_rev,t(null,n)):t(createError(MISSING_DOC))}},e._putLocal=function(e,t,n){"function"==typeof t&&(n=t,t={}),delete e._revisions;var r=e._rev,i=e._id;e._rev=r?"0-"+(parseInt(r.split("-")[1],10)+1):"0-1";var a,c=t.ctx;if(!c){var s=openTransactionSafely(o,[LOCAL_STORE],"readwrite");if(s.error)return n(s.error);(c=s.txn).onerror=idbError(n),c.oncomplete=function(){a&&n(null,a)}}var u,l=c.objectStore(LOCAL_STORE);r?(u=l.get(i)).onsuccess=function(o){var i=o.target.result;i&&i._rev===r?l.put(e).onsuccess=function(){a={ok:!0,id:e._id,rev:e._rev},t.ctx&&n(null,a)}:n(createError(REV_CONFLICT))}:((u=l.add(e)).onerror=function(e){n(createError(REV_CONFLICT)),e.preventDefault(),e.stopPropagation()},u.onsuccess=function(){a={ok:!0,id:e._id,rev:e._rev},t.ctx&&n(null,a)})},e._removeLocal=function(e,t,n){"function"==typeof t&&(n=t,t={});var r,i=t.ctx;if(!i){var a=openTransactionSafely(o,[LOCAL_STORE],"readwrite");if(a.error)return n(a.error);(i=a.txn).oncomplete=function(){r&&n(null,r)}}var c=e._id,s=i.objectStore(LOCAL_STORE),u=s.get(c);u.onerror=idbError(n),u.onsuccess=function(o){var i=o.target.result;i&&i._rev===e._rev?(s.delete(c),r={ok:!0,id:c,rev:"0-0"},t.ctx&&n(null,r)):n(createError(MISSING_DOC))}},e._destroy=function(e,t){idbChanges.removeAllListeners(r);var n=openReqList.get(r);n&&n.result&&(n.result.close(),cachedDBs.delete(r));var o=indexedDB.deleteDatabase(r);o.onsuccess=function(){openReqList.delete(r),hasLocalStorage()&&r in localStorage&&delete localStorage[r],t(null,{ok:!0})},o.onerror=idbError(t)};var u,l=cachedDBs.get(r);if(l)return o=l.idb,e._meta=l.global,void process.nextTick(function(){n(null,e)});u=t.storage?tryStorageOption(r,t.storage):indexedDB.open(r,ADAPTER_VERSION),openReqList.set(r,u),u.onupgradeneeded=function(e){var t=e.target.result;if(e.oldVersion<1)return function(e){var t=e.createObjectStore(DOC_STORE,{keyPath:"id"});e.createObjectStore(BY_SEQ_STORE,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),e.createObjectStore(ATTACH_STORE,{keyPath:"digest"}),e.createObjectStore(META_STORE,{keyPath:"id",autoIncrement:!1}),e.createObjectStore(DETECT_BLOB_SUPPORT_STORE),t.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),e.createObjectStore(LOCAL_STORE,{keyPath:"_id"});var n=e.createObjectStore(ATTACH_AND_SEQ_STORE,{autoIncrement:!0});n.createIndex("seq","seq"),n.createIndex("digestSeq","digestSeq",{unique:!0})}(t);var n=e.currentTarget.transaction;e.oldVersion<3&&function(e){e.createObjectStore(LOCAL_STORE,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}(t),e.oldVersion<4&&function(e){var t=e.createObjectStore(ATTACH_AND_SEQ_STORE,{autoIncrement:!0});t.createIndex("seq","seq"),t.createIndex("digestSeq","digestSeq",{unique:!0})}(t);var r=[i,a,c,s],o=e.oldVersion;!function e(){var t=r[o-1];o++,t&&t(n,e)}()},u.onsuccess=function(t){(o=t.target.result).onversionchange=function(){o.close(),cachedDBs.delete(r)},o.onabort=function(e){guardedConsole("error","Database has a global failure",e.target.error),o.close(),cachedDBs.delete(r)};var i=o.transaction([META_STORE,DETECT_BLOB_SUPPORT_STORE,DOC_STORE],"readwrite"),a=null,c=null,s=null;i.objectStore(META_STORE).get(META_STORE).onsuccess=function(t){var u=function(){null!==a&&null!==c&&null!==s&&(e._meta={name:r,instanceId:s,blobSupport:a,docCount:c},cachedDBs.set(r,{idb:o,global:e._meta}),n(null,e))},l=t.target.result||{id:META_STORE};r+"_id"in l?(s=l[r+"_id"],u()):(s=uuid(),l[r+"_id"]=s,i.objectStore(META_STORE).put(l).onsuccess=function(){u()}),blobSupportPromise||(blobSupportPromise=checkBlobSupport(i)),blobSupportPromise.then(function(e){a=e,u()}),i.objectStore(DOC_STORE).index("deletedOrLocal").count(IDBKeyRange.only("0")).onsuccess=function(e){c=e.target.result,u()}}},u.onerror=function(){var e="Failed to open indexedDB, are you in private browsing mode?";guardedConsole("error",e),n(createError(IDB_ERROR,e))}}function tryStorageOption(e,t){try{return indexedDB.open(e,{version:ADAPTER_VERSION,storage:t})}catch(t){return indexedDB.open(e,ADAPTER_VERSION)}}function IDBPouch(e){e.adapter("idb",IdbPouch,!0)}function decodeUtf8(e){return decodeURIComponent(escape(e))}function hexToInt(e){return e<65?e-48:e-55}function parseHexUtf8(e,t,n){for(var r="";t<n;)r+=String.fromCharCode(hexToInt(e.charCodeAt(t++))<<4|hexToInt(e.charCodeAt(t++)));return r}function parseHexUtf16(e,t,n){for(var r="";t<n;)r+=String.fromCharCode(hexToInt(e.charCodeAt(t+2))<<12|hexToInt(e.charCodeAt(t+3))<<8|hexToInt(e.charCodeAt(t))<<4|hexToInt(e.charCodeAt(t+1))),t+=4;return r}function parseHexString(e,t){return"UTF-8"===t?decodeUtf8(parseHexUtf8(e,0,e.length)):parseHexUtf16(e,0,e.length)}function quote(e){return"'"+e+"'"}IdbPouch.valid=function(){return!("undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform))&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange};var ADAPTER_VERSION$1=7,DOC_STORE$1=quote("document-store"),BY_SEQ_STORE$1=quote("by-sequence"),ATTACH_STORE$1=quote("attach-store"),LOCAL_STORE$1=quote("local-store"),META_STORE$1=quote("metadata-store"),ATTACH_AND_SEQ_STORE$1=quote("attach-seq-store");function escapeBlob(e){return e.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"")}function unescapeBlob(e){return e.replace(/\u0001\u0001/g,"\0").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,"")}function stringifyDoc(e){return delete e._id,delete e._rev,JSON.stringify(e)}function unstringifyDoc(e,t,n){return(e=JSON.parse(e))._id=t,e._rev=n,e}function qMarks(e){for(var t="(";e--;)t+="?",e&&(t+=",");return t+")"}function select(e,t,n,r,o){return"SELECT "+e+" FROM "+("string"==typeof t?t:t.join(" JOIN "))+(n?" ON "+n:"")+(r?" WHERE "+("string"==typeof r?r:r.join(" AND ")):"")+(o?" ORDER BY "+o:"")}function compactRevs$1(e,t,n){if(e.length){var r=0,o=[];e.forEach(function(e){var r="SELECT seq FROM "+BY_SEQ_STORE$1+" WHERE doc_id=? AND rev=?";n.executeSql(r,[t,e],function(e,t){if(!t.rows.length)return i();var n=t.rows.item(0).seq;o.push(n),e.executeSql("DELETE FROM "+BY_SEQ_STORE$1+" WHERE seq=?",[n],i)})})}function i(){++r===e.length&&function(){if(!o.length)return;var e="SELECT DISTINCT digest AS digest FROM "+ATTACH_AND_SEQ_STORE$1+" WHERE seq IN "+qMarks(o.length);n.executeSql(e,o,function(e,t){for(var n=[],r=0;r<t.rows.length;r++)n.push(t.rows.item(r).digest);if(n.length){var i="DELETE FROM "+ATTACH_AND_SEQ_STORE$1+" WHERE seq IN ("+o.map(function(){return"?"}).join(",")+")";e.executeSql(i,o,function(e){var t="SELECT digest FROM "+ATTACH_AND_SEQ_STORE$1+" WHERE digest IN ("+n.map(function(){return"?"}).join(",")+")";e.executeSql(t,n,function(e,t){for(var r=new pouchdbCollections.Set,o=0;o<t.rows.length;o++)r.add(t.rows.item(o).digest);n.forEach(function(t){r.has(t)||(e.executeSql("DELETE FROM "+ATTACH_AND_SEQ_STORE$1+" WHERE digest=?",[t]),e.executeSql("DELETE FROM "+ATTACH_STORE$1+" WHERE digest=?",[t]))})})})}})}()}}function websqlError(e){return function(t){guardedConsole("error","WebSQL threw an error",t);var n=t&&t.constructor.toString().match(/function ([^\(]+)/),r=n&&n[1]||t.type,o=t.target||t.message;e(createError(WSQ_ERROR,o,r))}}function getSize(e){return"size"in e?1e6*e.size:"undefined"!=typeof navigator&&/Android/.test(navigator.userAgent)?5e6:1}function websqlBulkDocs(e,t,n,r,o,i,a){var c,s=n.new_edits,u=t.docs.map(function(e){return e._id&&isLocalId(e._id)?e:parseDoc(e,s)}),l=u.filter(function(e){return e.error});if(l.length)return a(l[0]);var d,f=new Array(u.length),h=new pouchdbCollections.Map;function p(){if(d)return a(d);i.notify(r._name),r._docCount=-1,a(null,f)}function _(e){var t=[];if(u.forEach(function(e){e.data&&e.data._attachments&&Object.keys(e.data._attachments).forEach(function(n){var r=e.data._attachments[n];r.stub&&t.push(r.digest)})}),!t.length)return e();var n,r=0;t.forEach(function(o){!function(e,t){var n="SELECT count(*) as cnt FROM "+ATTACH_STORE$1+" WHERE digest=?";c.executeSql(n,[e],function(n,r){if(0===r.rows.item(0).cnt){var o=createError(MISSING_STUB,"unknown stub attachment with digest "+e);t(o)}else t()})}(o,function(o){o&&!n&&(n=o),++r===t.length&&e(n)})})}function v(e,t,n,o,i,a,s,u){function l(){var t=e.data,n=o?1:0,r=t._id,i=t._rev,a=stringifyDoc(t),s="INSERT INTO "+BY_SEQ_STORE$1+" (doc_id, rev, json, deleted) VALUES (?, ?, ?, ?);",u=[r,i,a,n];function l(e,n){var r,o,i,a=0,s=Object.keys(t._attachments||{});if(!s.length)return n();function u(){return++a===s.length&&n(),!1}for(var l=0;l<s.length;l++)r=s[l],void 0,void 0,o="INSERT INTO "+ATTACH_AND_SEQ_STORE$1+" (digest, seq) VALUES (?,?)",i=[t._attachments[r].digest,e],c.executeSql(o,i,u,u)}c.executeSql(s,u,function(e,t){var n=t.insertId;l(n,function(){m(e,n)})},function(){var e=select("seq",BY_SEQ_STORE$1,null,"doc_id=? AND rev=?");return c.executeSql(e,[r,i],function(e,t){var o=t.rows.item(0).seq,c="UPDATE "+BY_SEQ_STORE$1+" SET json=?, deleted=? WHERE doc_id=? AND rev=?;",s=[a,n,r,i];e.executeSql(c,s,function(e){l(o,function(){m(e,o)})})}),!1})}function d(e){p||(e?u(p=e):_===v.length&&l())}var p=null,_=0;e.data._id=e.metadata.id,e.data._rev=e.metadata.rev;var v=Object.keys(e.data._attachments||{});function E(e){_++,d(e)}function m(n,o){var a=e.metadata.id,c=e.stemmedRevs||[];i&&r.auto_compaction&&(c=compactTree(e.metadata).concat(c)),c.length&&compactRevs$1(c,a,n),e.metadata.seq=o,delete e.metadata.rev;var l=i?"UPDATE "+DOC_STORE$1+" SET json=?, max_seq=?, winningseq=(SELECT seq FROM "+BY_SEQ_STORE$1+" WHERE doc_id="+DOC_STORE$1+".id AND rev=?) WHERE id=?":"INSERT INTO "+DOC_STORE$1+" (id, winningseq, max_seq, json) VALUES (?,?,?,?);",d=safeJsonStringify(e.metadata),p=i?[d,o,t,a]:[a,o,o,d];n.executeSql(l,p,function(){f[s]={ok:!0,id:e.metadata.id,rev:t},h.set(a,e.metadata),u()})}o&&(e.data._deleted=!0),v.forEach(function(n){var r=e.data._attachments[n];if(r.stub)_++,d();else{var o=r.data;delete r.data,r.revpos=parseInt(t,10),function(e,t,n){var r="SELECT digest FROM "+ATTACH_STORE$1+" WHERE digest=?";c.executeSql(r,[e],function(o,i){if(i.rows.length)return n();r="INSERT INTO "+ATTACH_STORE$1+" (digest, body, escaped) VALUES (?,?,1)",o.executeSql(r,[e,escapeBlob(t)],function(){n()},function(){return n(),!1})})}(r.digest,o,E)}}),v.length||l()}function E(){processDocs(e.revs_limit,u,r,h,c,f,v,n)}preprocessAttachments(u,"binary",function(e){if(e)return a(e);o.transaction(function(e){c=e,_(function(e){e?d=e:function(e){if(!u.length)return e();var t=0;function n(){++t===u.length&&e()}u.forEach(function(e){if(e._id&&isLocalId(e._id))return n();var t=e.metadata.id;c.executeSql("SELECT json FROM "+DOC_STORE$1+" WHERE id = ?",[t],function(e,r){if(r.rows.length){var o=safeJsonParse(r.rows.item(0).json);h.set(t,o)}n()})})}(E)})},websqlError(a),p)})}var cachedDatabases=new pouchdbCollections.Map;function openDatabaseWithOpts(e){return e.websql(e.name,e.version,e.description,e.size)}function openDBSafely(e){try{return{db:openDatabaseWithOpts(e)}}catch(e){return{error:e}}}function openDB(e){var t=cachedDatabases.get(e.name);return t||(t=openDBSafely(e),cachedDatabases.set(e.name,t),t.db&&(t.db._sqlitePlugin="undefined"!=typeof sqlitePlugin)),t}var websqlChanges=new Changes$1;function fetchAttachmentsIfNecessary$1(e,t,n,r,o){var i=Object.keys(e._attachments||{});if(!i.length)return o&&o();var a=0;function c(){++a===i.length&&o&&o()}i.forEach(function(o){t.attachments&&t.include_docs?function(e,o){var i=e._attachments[o],a={binary:t.binary,ctx:r};n._getAttachment(e._id,o,i,a,function(t,n){e._attachments[o]=jsExtend.extend(pick(i,["digest","content_type"]),{data:n}),c()})}(e,o):(e._attachments[o].stub=!0,c())})}var POUCH_VERSION=1,BY_SEQ_STORE_DELETED_INDEX_SQL="CREATE INDEX IF NOT EXISTS 'by-seq-deleted-idx' ON "+BY_SEQ_STORE$1+" (seq, deleted)",BY_SEQ_STORE_DOC_ID_REV_INDEX_SQL="CREATE UNIQUE INDEX IF NOT EXISTS 'by-seq-doc-id-rev' ON "+BY_SEQ_STORE$1+" (doc_id, rev)",DOC_STORE_WINNINGSEQ_INDEX_SQL="CREATE INDEX IF NOT EXISTS 'doc-winningseq-idx' ON "+DOC_STORE$1+" (winningseq)",ATTACH_AND_SEQ_STORE_SEQ_INDEX_SQL="CREATE INDEX IF NOT EXISTS 'attach-seq-seq-idx' ON "+ATTACH_AND_SEQ_STORE$1+" (seq)",ATTACH_AND_SEQ_STORE_ATTACH_INDEX_SQL="CREATE UNIQUE INDEX IF NOT EXISTS 'attach-seq-digest-idx' ON "+ATTACH_AND_SEQ_STORE$1+" (digest, seq)",DOC_STORE_AND_BY_SEQ_JOINER=BY_SEQ_STORE$1+".seq = "+DOC_STORE$1+".winningseq",SELECT_DOCS=BY_SEQ_STORE$1+".seq AS seq, "+BY_SEQ_STORE$1+".deleted AS deleted, "+BY_SEQ_STORE$1+".json AS data, "+BY_SEQ_STORE$1+".rev AS rev, "+DOC_STORE$1+".json AS metadata";function WebSqlPouch$1(e,t){var n,r=this,o=null,i=getSize(e),a=[];r._docCount=-1,r._name=e.name;var c=openDB(jsExtend.extend({},e,{version:POUCH_VERSION,description:e.name,size:i}));if(c.error)return websqlError(t)(c.error);var s=c.db;function u(){hasLocalStorage()&&(window.localStorage["_pouch__websqldb_"+r._name]=!0),t(null,r)}function l(e,t){e.executeSql(DOC_STORE_WINNINGSEQ_INDEX_SQL),e.executeSql("ALTER TABLE "+BY_SEQ_STORE$1+" ADD COLUMN deleted TINYINT(1) DEFAULT 0",[],function(){e.executeSql(BY_SEQ_STORE_DELETED_INDEX_SQL),e.executeSql("ALTER TABLE "+DOC_STORE$1+" ADD COLUMN local TINYINT(1) DEFAULT 0",[],function(){e.executeSql("CREATE INDEX IF NOT EXISTS 'doc-store-local-idx' ON "+DOC_STORE$1+" (local, id)");var n="SELECT "+DOC_STORE$1+".winningseq AS seq, "+DOC_STORE$1+".json AS metadata FROM "+BY_SEQ_STORE$1+" JOIN "+DOC_STORE$1+" ON "+BY_SEQ_STORE$1+".seq = "+DOC_STORE$1+".winningseq";e.executeSql(n,[],function(e,n){for(var r=[],o=[],i=0;i<n.rows.length;i++){var a=n.rows.item(i),c=a.seq,s=JSON.parse(a.metadata);isDeleted(s)&&r.push(c),isLocalId(s.id)&&o.push(s.id)}e.executeSql("UPDATE "+DOC_STORE$1+"SET local = 1 WHERE id IN "+qMarks(o.length),o,function(){e.executeSql("UPDATE "+BY_SEQ_STORE$1+" SET deleted = 1 WHERE seq IN "+qMarks(r.length),r,t)})})})})}function d(e,t){var n="CREATE TABLE IF NOT EXISTS "+LOCAL_STORE$1+" (id UNIQUE, rev, json)";e.executeSql(n,[],function(){var n="SELECT "+DOC_STORE$1+".id AS id, "+BY_SEQ_STORE$1+".json AS data FROM "+BY_SEQ_STORE$1+" JOIN "+DOC_STORE$1+" ON "+BY_SEQ_STORE$1+".seq = "+DOC_STORE$1+".winningseq WHERE local = 1";e.executeSql(n,[],function(e,n){for(var r=[],o=0;o<n.rows.length;o++)r.push(n.rows.item(o));!function n(){if(!r.length)return t(e);var o=r.shift(),i=JSON.parse(o.data)._rev;e.executeSql("INSERT INTO "+LOCAL_STORE$1+" (id, rev, json) VALUES (?,?,?)",[o.id,i,o.data],function(e){e.executeSql("DELETE FROM "+DOC_STORE$1+" WHERE id=?",[o.id],function(e){e.executeSql("DELETE FROM "+BY_SEQ_STORE$1+" WHERE seq=?",[o.seq],function(){n()})})})}()})})}function f(e,t){function r(r){!function o(){if(!r.length)return t(e);var i=parseHexString(r.shift().hex,n),a=i.lastIndexOf("::"),c=i.substring(0,a),s=i.substring(a+2),u="UPDATE "+BY_SEQ_STORE$1+" SET doc_id=?, rev=? WHERE doc_id_rev=?";e.executeSql(u,[c,s,i],function(){o()})}()}var o="ALTER TABLE "+BY_SEQ_STORE$1+" ADD COLUMN doc_id";e.executeSql(o,[],function(e){var t="ALTER TABLE "+BY_SEQ_STORE$1+" ADD COLUMN rev";e.executeSql(t,[],function(e){e.executeSql(BY_SEQ_STORE_DOC_ID_REV_INDEX_SQL,[],function(e){var t="SELECT hex(doc_id_rev) as hex FROM "+BY_SEQ_STORE$1;e.executeSql(t,[],function(e,t){for(var n=[],o=0;o<t.rows.length;o++)n.push(t.rows.item(o));r(n)})})})})}function h(e,t){function n(e){var n="SELECT COUNT(*) AS cnt FROM "+ATTACH_STORE$1;e.executeSql(n,[],function(e,n){if(!n.rows.item(0).cnt)return t(e);var r=0,o=10;!function n(){var i=select(SELECT_DOCS+", "+DOC_STORE$1+".id AS id",[DOC_STORE$1,BY_SEQ_STORE$1],DOC_STORE_AND_BY_SEQ_JOINER,null,DOC_STORE$1+".id ");i+=" LIMIT "+o+" OFFSET "+r,r+=o,e.executeSql(i,[],function(e,r){if(!r.rows.length)return t(e);for(var o,i,a,c={},s=0;s<r.rows.length;s++)for(var u=r.rows.item(s),l=unstringifyDoc(u.data,u.id,u.rev),d=Object.keys(l._attachments||{}),f=0;f<d.length;f++){var h=l._attachments[d[f]];o=h.digest,i=u.seq,a=void 0,-1===(a=c[o]=c[o]||[]).indexOf(i)&&a.push(i)}var p=[];if(Object.keys(c).forEach(function(e){c[e].forEach(function(t){p.push([e,t])})}),!p.length)return n();var _=0;p.forEach(function(t){var r="INSERT INTO "+ATTACH_AND_SEQ_STORE$1+" (digest, seq) VALUES (?,?)";e.executeSql(r,t,function(){++_===p.length&&n()})})})}()})}var r="CREATE TABLE IF NOT EXISTS "+ATTACH_AND_SEQ_STORE$1+" (digest, seq INTEGER)";e.executeSql(r,[],function(e){e.executeSql(ATTACH_AND_SEQ_STORE_ATTACH_INDEX_SQL,[],function(e){e.executeSql(ATTACH_AND_SEQ_STORE_SEQ_INDEX_SQL,[],n)})})}function p(e,t){var n="ALTER TABLE "+ATTACH_STORE$1+" ADD COLUMN escaped TINYINT(1) DEFAULT 0";e.executeSql(n,[],t)}function _(e,t){var n="ALTER TABLE "+DOC_STORE$1+" ADD COLUMN max_seq INTEGER";e.executeSql(n,[],function(e){var n="UPDATE "+DOC_STORE$1+" SET max_seq=(SELECT MAX(seq) FROM "+BY_SEQ_STORE$1+" WHERE doc_id=id)";e.executeSql(n,[],function(e){var n="CREATE UNIQUE INDEX IF NOT EXISTS 'doc-max-seq-idx' ON "+DOC_STORE$1+" (max_seq)";e.executeSql(n,[],t)})})}function v(){for(;a.length>0;){a.pop()(null,o)}}function E(e,t){if(0===t){var n="CREATE TABLE IF NOT EXISTS "+META_STORE$1+" (dbid, db_version INTEGER)",r="CREATE TABLE IF NOT EXISTS "+ATTACH_STORE$1+" (digest UNIQUE, escaped TINYINT(1), body BLOB)",i="CREATE TABLE IF NOT EXISTS "+ATTACH_AND_SEQ_STORE$1+" (digest, seq INTEGER)",a="CREATE TABLE IF NOT EXISTS "+DOC_STORE$1+" (id unique, json, winningseq, max_seq INTEGER UNIQUE)",c="CREATE TABLE IF NOT EXISTS "+BY_SEQ_STORE$1+" (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, json, deleted TINYINT(1), doc_id, rev)",s="CREATE TABLE IF NOT EXISTS "+LOCAL_STORE$1+" (id UNIQUE, rev, json)";e.executeSql(r),e.executeSql(s),e.executeSql(i,[],function(){e.executeSql(ATTACH_AND_SEQ_STORE_SEQ_INDEX_SQL),e.executeSql(ATTACH_AND_SEQ_STORE_ATTACH_INDEX_SQL)}),e.executeSql(a,[],function(){e.executeSql(DOC_STORE_WINNINGSEQ_INDEX_SQL),e.executeSql(c,[],function(){e.executeSql(BY_SEQ_STORE_DELETED_INDEX_SQL),e.executeSql(BY_SEQ_STORE_DOC_ID_REV_INDEX_SQL),e.executeSql(n,[],function(){var t="INSERT INTO "+META_STORE$1+" (db_version, dbid) VALUES (?,?)";o=uuid();var n=[ADAPTER_VERSION$1,o];e.executeSql(t,n,function(){v()})})})})}else{var u=[l,d,f,h,p,_,function(){t<ADAPTER_VERSION$1&&e.executeSql("UPDATE "+META_STORE$1+" SET db_version = "+ADAPTER_VERSION$1);var n="SELECT dbid FROM "+META_STORE$1;e.executeSql(n,[],function(e,t){o=t.rows.item(0).dbid,v()})}],E=t,m=function(e){u[E-1](e,m),E++};m(e)}}function m(e,t){if(-1!==r._docCount)return t(r._docCount);var n=select("COUNT("+DOC_STORE$1+".id) AS 'num'",[DOC_STORE$1,BY_SEQ_STORE$1],DOC_STORE_AND_BY_SEQ_JOINER,BY_SEQ_STORE$1+".deleted=0");e.executeSql(n,[],function(e,n){r._docCount=n.rows.item(0).num,t(r._docCount)})}"function"!=typeof s.readTransaction&&(s.readTransaction=s.transaction),s.transaction(function(e){!function(e,t){e.executeSql('SELECT HEX("a") AS hex',[],function(e,r){var o=r.rows.item(0).hex;n=2===o.length?"UTF-8":"UTF-16",t()})}(e,function(){!function(e){var t="SELECT sql FROM sqlite_master WHERE tbl_name = "+META_STORE$1;e.executeSql(t,[],function(e,t){t.rows.length?/db_version/.test(t.rows.item(0).sql)?e.executeSql("SELECT db_version FROM "+META_STORE$1,[],function(e,t){var n=t.rows.item(0).db_version;E(e,n)}):e.executeSql("ALTER TABLE "+META_STORE$1+" ADD COLUMN db_version INTEGER",[],function(){E(e,1)}):E(e,0)})}(e)})},websqlError(t),u),r.type=function(){return"websql"},r._id=toPromise(function(e){e(null,o)}),r._info=function(e){s.readTransaction(function(t){m(t,function(r){var o="SELECT MAX(seq) AS seq FROM "+BY_SEQ_STORE$1;t.executeSql(o,[],function(t,o){var i=o.rows.item(0).seq||0;e(null,{doc_count:r,update_seq:i,sqlite_plugin:s._sqlitePlugin,websql_encoding:n})})})},websqlError(e))},r._bulkDocs=function(t,n,o){websqlBulkDocs(e,t,n,r,s,websqlChanges,o)},r._get=function(e,t,n){var o,i,a,c,u,l=t.ctx;if(!l)return s.readTransaction(function(o){r._get(e,jsExtend.extend({ctx:o},t),n)});function d(){n(a,{doc:o,metadata:i,ctx:l})}t.rev?(c=select(SELECT_DOCS,[DOC_STORE$1,BY_SEQ_STORE$1],DOC_STORE$1+".id="+BY_SEQ_STORE$1+".doc_id",[BY_SEQ_STORE$1+".doc_id=?",BY_SEQ_STORE$1+".rev=?"]),u=[e,t.rev]):(c=select(SELECT_DOCS,[DOC_STORE$1,BY_SEQ_STORE$1],DOC_STORE_AND_BY_SEQ_JOINER,DOC_STORE$1+".id=?"),u=[e]),l.executeSql(c,u,function(e,n){if(!n.rows.length)return a=createError(MISSING_DOC,"missing"),d();var r=n.rows.item(0);if(i=safeJsonParse(r.metadata),r.deleted&&!t.rev)return a=createError(MISSING_DOC,"deleted"),d();o=unstringifyDoc(r.data,i.id,r.rev),d()})},r._allDocs=function(e,t){var n,o=[],i="startkey"in e&&e.startkey,a="endkey"in e&&e.endkey,c="key"in e&&e.key,u="descending"in e&&e.descending,l="limit"in e?e.limit:-1,d="skip"in e?e.skip:0,f=!1!==e.inclusive_end,h=[],p=[];if(!1!==c)p.push(DOC_STORE$1+".id = ?"),h.push(c);else if(!1!==i||!1!==a){if(!1!==i&&(p.push(DOC_STORE$1+".id "+(u?"<=":">=")+" ?"),h.push(i)),!1!==a){var _=u?">":"<";f&&(_+="="),p.push(DOC_STORE$1+".id "+_+" ?"),h.push(a)}!1!==c&&(p.push(DOC_STORE$1+".id = ?"),h.push(c))}"ok"!==e.deleted&&p.push(BY_SEQ_STORE$1+".deleted = 0"),s.readTransaction(function(t){m(t,function(i){if(n=i,0!==l){var a=select(SELECT_DOCS,[DOC_STORE$1,BY_SEQ_STORE$1],DOC_STORE_AND_BY_SEQ_JOINER,p,DOC_STORE$1+".id "+(u?"DESC":"ASC"));a+=" LIMIT "+l+" OFFSET "+d,t.executeSql(a,h,function(t,n){for(var i=0,a=n.rows.length;i<a;i++){var c=n.rows.item(i),s=safeJsonParse(c.metadata),u=s.id,l=unstringifyDoc(c.data,u,c.rev),d=l._rev,f={id:u,key:u,value:{rev:d}};if(e.include_docs&&(f.doc=l,f.doc._rev=d,e.conflicts&&(f.doc._conflicts=collectConflicts(s)),fetchAttachmentsIfNecessary$1(f.doc,e,r,t)),c.deleted){if("ok"!==e.deleted)continue;f.value.deleted=!0,f.doc=null}o.push(f)}})}})},websqlError(t),function(){t(null,{total_rows:n,offset:e.skip,rows:o})})},r._changes=function(e){if((e=clone(e)).continuous){var t=r._name+":"+uuid();return websqlChanges.addListener(r._name,t,r,e),websqlChanges.notify(r._name),{cancel:function(){websqlChanges.removeListener(r._name,t)}}}var n=e.descending;e.since=e.since&&!n?e.since:0;var o,i="limit"in e?e.limit:-1;0===i&&(i=1),o="return_docs"in e?e.return_docs:!("returnDocs"in e)||e.returnDocs;var a=[],c=0;!function(){var t=DOC_STORE$1+".json AS metadata, "+DOC_STORE$1+".max_seq AS maxSeq, "+BY_SEQ_STORE$1+".json AS winningDoc, "+BY_SEQ_STORE$1+".rev AS winningRev ",u=DOC_STORE$1+" JOIN "+BY_SEQ_STORE$1,l=DOC_STORE$1+".id="+BY_SEQ_STORE$1+".doc_id AND "+DOC_STORE$1+".winningseq="+BY_SEQ_STORE$1+".seq",d=["maxSeq > ?"],f=[e.since];e.doc_ids&&(d.push(DOC_STORE$1+".id IN "+qMarks(e.doc_ids.length)),f=f.concat(e.doc_ids));var h=select(t,u,l,d,"maxSeq "+(n?"DESC":"ASC")),p=filterChange(e);e.view||e.filter||(h+=" LIMIT "+i);var _=e.since||0;s.readTransaction(function(t){t.executeSql(h,f,function(t,n){function s(t){return function(){e.onChange(t)}}for(var u=0,l=n.rows.length;u<l;u++){var d=n.rows.item(u),f=safeJsonParse(d.metadata);_=d.maxSeq;var h=unstringifyDoc(d.winningDoc,f.id,d.winningRev),v=e.processChange(h,f,e);v.seq=d.maxSeq;var E=p(v);if("object"==typeof E)return e.complete(E);if(E&&(c++,o&&a.push(v),e.attachments&&e.include_docs?fetchAttachmentsIfNecessary$1(h,e,r,t,s(v)):s(v)()),c===i)break}})},websqlError(e.complete),function(){e.continuous||e.complete(null,{results:a,last_seq:_})})}()},r._close=function(e){e()},r._getAttachment=function(e,t,r,o,i){var a,c=o.ctx,s=r.digest,u=r.content_type,l="SELECT escaped, CASE WHEN escaped = 1 THEN body ELSE HEX(body) END AS body FROM "+ATTACH_STORE$1+" WHERE digest=?";c.executeSql(l,[s],function(e,t){var r=t.rows.item(0),c=r.escaped?unescapeBlob(r.body):parseHexString(r.body,n);a=o.binary?binStringToBluffer(c,u):btoa$1(c),i(null,a)})},r._getRevisionTree=function(e,t){s.readTransaction(function(n){var r="SELECT json AS metadata FROM "+DOC_STORE$1+" WHERE id = ?";n.executeSql(r,[e],function(e,n){if(n.rows.length){var r=safeJsonParse(n.rows.item(0).metadata);t(null,r.rev_tree)}else t(createError(MISSING_DOC))})})},r._doCompaction=function(e,t,n){if(!t.length)return n();s.transaction(function(n){var r="SELECT json AS metadata FROM "+DOC_STORE$1+" WHERE id = ?";n.executeSql(r,[e],function(n,r){var o=safeJsonParse(r.rows.item(0).metadata);traverseRevTree(o.rev_tree,function(e,n,r,o,i){var a=n+"-"+r;-1!==t.indexOf(a)&&(i.status="missing")});var i="UPDATE "+DOC_STORE$1+" SET json = ? WHERE id = ?";n.executeSql(i,[safeJsonStringify(o),e])}),compactRevs$1(t,e,n)},websqlError(n),function(){n()})},r._getLocal=function(e,t){s.readTransaction(function(n){var r="SELECT json, rev FROM "+LOCAL_STORE$1+" WHERE id=?";n.executeSql(r,[e],function(n,r){if(r.rows.length){var o=r.rows.item(0),i=unstringifyDoc(o.json,e,o.rev);t(null,i)}else t(createError(MISSING_DOC))})})},r._putLocal=function(e,t,n){"function"==typeof t&&(n=t,t={}),delete e._revisions;var r,o=e._rev,i=e._id;r=e._rev=o?"0-"+(parseInt(o.split("-")[1],10)+1):"0-1";var a,c=stringifyDoc(e);function u(e){var s,u;o?(s="UPDATE "+LOCAL_STORE$1+" SET rev=?, json=? WHERE id=? AND rev=?",u=[r,c,i,o]):(s="INSERT INTO "+LOCAL_STORE$1+" (id, rev, json) VALUES (?,?,?)",u=[i,r,c]),e.executeSql(s,u,function(e,o){o.rowsAffected?(a={ok:!0,id:i,rev:r},t.ctx&&n(null,a)):n(createError(REV_CONFLICT))},function(){return n(createError(REV_CONFLICT)),!1})}t.ctx?u(t.ctx):s.transaction(u,websqlError(n),function(){a&&n(null,a)})},r._removeLocal=function(e,t,n){var r;function o(o){var i="DELETE FROM "+LOCAL_STORE$1+" WHERE id=? AND rev=?",a=[e._id,e._rev];o.executeSql(i,a,function(o,i){if(!i.rowsAffected)return n(createError(MISSING_DOC));r={ok:!0,id:e._id,rev:"0-0"},t.ctx&&n(null,r)})}"function"==typeof t&&(n=t,t={}),t.ctx?o(t.ctx):s.transaction(o,websqlError(n),function(){r&&n(null,r)})},r._destroy=function(e,t){websqlChanges.removeAllListeners(r._name),s.transaction(function(e){[DOC_STORE$1,BY_SEQ_STORE$1,ATTACH_STORE$1,META_STORE$1,LOCAL_STORE$1,ATTACH_AND_SEQ_STORE$1].forEach(function(t){e.executeSql("DROP TABLE IF EXISTS "+t,[])})},websqlError(t),function(){hasLocalStorage()&&(delete window.localStorage["_pouch__websqldb_"+r._name],delete window.localStorage[r._name]),t(null,{ok:!0})})}}function canOpenTestDB(){try{return openDatabase("_pouch_validate_websql",1,"",1),!0}catch(e){return!1}}function isValidWebSQL(){if("undefined"==typeof indexedDB||null===indexedDB||!/iP(hone|od|ad)/.test(navigator.userAgent))return!0;var e=hasLocalStorage(),t="_pouch__websqldb_valid_"+navigator.userAgent;if(e&&localStorage[t])return"1"===localStorage[t];var n=canOpenTestDB();return e&&(localStorage[t]=n?"1":"0"),n}function validWithoutCheckingCordova(){return"undefined"!=typeof openDatabase&&("undefined"!=typeof sqlitePlugin||isValidWebSQL())}function valid(){return"undefined"!=typeof cordova||validWithoutCheckingCordova()}function createOpenDBFunction(e){return function(t,n,r,o){if("undefined"!=typeof sqlitePlugin){var i=jsExtend.extend({},e,{name:t,version:n,description:r,size:o});return sqlitePlugin.openDatabase(i)}return openDatabase(t,n,r,o)}}function WebSQLPouch(e,t){var n=createOpenDBFunction(e),r=jsExtend.extend({websql:n},e);"undefined"==typeof cordova||validWithoutCheckingCordova()||guardedConsole("error","PouchDB error: you must install a SQLite plugin in order for PouchDB to work on this platform. Options:\n - https://github.com/nolanlawson/cordova-plugin-sqlite-2\n - https://github.com/litehelpers/Cordova-sqlite-storage\n - https://github.com/Microsoft/cordova-plugin-websql"),WebSqlPouch$1.call(this,r,t)}function WebSqlPouch(e){e.adapter("websql",WebSQLPouch,!0)}function wrappedFetch(){for(var e={},t=new PouchPromise(function(t,n){e.resolve=t,e.reject=n}),n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.promise=t,PouchPromise.resolve().then(function(){return fetch.apply(null,n)}).then(function(t){e.resolve(t)}).catch(function(t){e.reject(t)}),e}function fetchRequest(e,t){var n,r,o,i=new Headers,a={method:e.method,credentials:"include",headers:i};return e.json&&(i.set("Accept","application/json"),i.set("Content-Type",e.headers["Content-Type"]||"application/json")),e.body&&e.body instanceof Blob?readAsArrayBuffer(e.body,function(e){a.body=e}):e.body&&e.processData&&"string"!=typeof e.body?a.body=JSON.stringify(e.body):a.body="body"in e?e.body:null,Object.keys(e.headers).forEach(function(t){e.headers.hasOwnProperty(t)&&i.set(t,e.headers[t])}),n=wrappedFetch(e.url,a),e.timeout>0&&(r=setTimeout(function(){n.reject(new Error("Load timeout for resource: "+e.url))},e.timeout)),n.promise.then(function(t){return o={statusCode:t.status},e.timeout>0&&clearTimeout(r),o.statusCode>=200&&o.statusCode<300?e.binary?t.blob():t.text():t.json()}).then(function(e){o.statusCode>=200&&o.statusCode<300?t(null,o,e):t(e,o)}).catch(function(e){t(e,o)}),{abort:n.reject}}function xhRequest(e,t){var n,r,o=!1,i=function(){o=!0,n.abort()};n=e.xhr?new e.xhr:new XMLHttpRequest;try{n.open(e.method,e.url)}catch(e){return t(new Error(e.name||"Url is invalid"))}for(var a in n.withCredentials=!("withCredentials"in e)||e.withCredentials,"GET"===e.method?delete e.headers["Content-Type"]:e.json&&(e.headers.Accept="application/json",e.headers["Content-Type"]=e.headers["Content-Type"]||"application/json",e.body&&e.processData&&"string"!=typeof e.body&&(e.body=JSON.stringify(e.body))),e.binary&&(n.responseType="arraybuffer"),"body"in e||(e.body=null),e.headers)e.headers.hasOwnProperty(a)&&n.setRequestHeader(a,e.headers[a]);return e.timeout>0&&(r=setTimeout(i,e.timeout),n.onprogress=function(){clearTimeout(r),4!==n.readyState&&(r=setTimeout(i,e.timeout))},void 0!==n.upload&&(n.upload.onprogress=n.onprogress)),n.onreadystatechange=function(){if(4===n.readyState){var r={statusCode:n.status};if(n.status>=200&&n.status<300){var i;i=e.binary?createBlob([n.response||""],{type:n.getResponseHeader("Content-Type")}):n.responseText,t(null,r,i)}else{var a={};if(o)(a=new Error("ETIMEDOUT")).code="ETIMEDOUT";else try{a=JSON.parse(n.response)}catch(e){}a.status=n.status,t(a)}}},e.body&&e.body instanceof Blob?readAsArrayBuffer(e.body,function(e){n.send(e)}):n.send(e.body),{abort:function(){n.abort()}}}function testXhr(){try{return new XMLHttpRequest,!0}catch(e){return!1}}WebSQLPouch.valid=valid,WebSQLPouch.use_prefix=!0;var hasXhr=testXhr();function ajax$1(e,t){return hasXhr||e.xhr?xhRequest(e,t):fetchRequest(e,t)}var res$2=function(){};function defaultBody(){return""}function ajaxCore(e,t){e=clone(e);return(e=jsExtend.extend({method:"GET",headers:{},json:!0,processData:!0,timeout:1e4,cache:!1},e)).json&&(e.binary||(e.headers.Accept="application/json"),e.headers["Content-Type"]=e.headers["Content-Type"]||"application/json"),e.binary&&(e.encoding=null,e.json=!1),e.processData||(e.json=!1),ajax$1(e,function(n,r,o){if(n)return t(generateErrorFromResponse(n));var i,a=r.headers&&r.headers["content-type"],c=o||defaultBody();if(!e.binary&&(e.json||!e.processData)&&"object"!=typeof c&&(/json/.test(a)||/^[\s]*\{/.test(c)&&/\}[\s]*$/.test(c)))try{c=JSON.parse(c.toString())}catch(e){}r.statusCode>=200&&r.statusCode<300?function(t,n,r){if(!e.binary&&e.json&&"string"==typeof t)try{t=JSON.parse(t)}catch(e){return r(e)}Array.isArray(t)&&(t=t.map(function(e){return e.error||e.missing?generateErrorFromResponse(e):e})),e.binary&&res$2(t,n),r(null,t,n)}(c,r,t):((i=generateErrorFromResponse(c)).status=r.statusCode,t(i))})}function ajax(e,t){var n=navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",r=-1!==n.indexOf("safari")&&-1===n.indexOf("chrome"),o=-1!==n.indexOf("msie"),i=-1!==n.indexOf("edge"),a=r||(o||i)&&"GET"===e.method,c=!("cache"in e)||e.cache;if(!/^blob:/.test(e.url)&&(a||!c)){var s=-1!==e.url.indexOf("?");e.url+=(s?"&":"?")+"_nonce="+Date.now()}return ajaxCore(e,t)}var CHANGES_BATCH_SIZE=25,MAX_SIMULTANEOUS_REVS=50,supportsBulkGetMap={},MAX_URL_LENGTH=1800,log$1=debug("pouchdb:http");function readAttachmentsAsBlobOrBuffer(e){var t=e.doc&&e.doc._attachments;t&&Object.keys(t).forEach(function(e){var n=t[e];n.data=b64ToBluffer(n.data,n.content_type)})}function encodeDocId(e){return/^_design/.test(e)?"_design/"+encodeURIComponent(e.slice(8)):/^_local/.test(e)?"_local/"+encodeURIComponent(e.slice(7)):encodeURIComponent(e)}function preprocessAttachments$1(e){return e._attachments&&Object.keys(e._attachments)?PouchPromise.all(Object.keys(e._attachments).map(function(t){var n=e._attachments[t];if(n.data&&"string"!=typeof n.data)return new PouchPromise(function(e){blobToBase64(n.data,e)}).then(function(e){n.data=e})})):PouchPromise.resolve()}function getHost(e){var t=parseUri(e);(t.user||t.password)&&(t.auth={username:t.user,password:t.password});var n=t.path.replace(/(^\/|\/$)/g,"").split("/");return t.db=n.pop(),-1===t.db.indexOf("%")&&(t.db=encodeURIComponent(t.db)),t.path=n.join("/"),t}function genDBUrl(e,t){return genUrl(e,e.db+"/"+t)}function genUrl(e,t){var n=e.path?"/":"";return e.protocol+"://"+e.host+(e.port?":"+e.port:"")+"/"+e.path+n+t}function paramsToStr(e){return"?"+Object.keys(e).map(function(t){return t+"="+encodeURIComponent(e[t])}).join("&")}function HttpPouch(e,t){var n=this,r=getHost;e.getHost&&(r=e.getHost);var o,i=r(e.name,e),a=genDBUrl(i,""),c=(e=clone(e)).ajax||{};if(n.getUrl=function(){return a},n.getHeaders=function(){return c.headers||{}},e.auth||i.auth){var s=e.auth||i.auth,u=s.username+":"+s.password,l=btoa$1(unescape(encodeURIComponent(u)));c.headers=c.headers||{},c.headers.Authorization="Basic "+l}function d(e,t,r){var o=e.ajax||{},i=jsExtend.extend(clone(c),o,t);return log$1(i.method+" "+i.url),n._ajax(i,r)}function f(e,t){return new PouchPromise(function(n,r){d(e,t,function(e,t){if(e)return r(e);n(t)})})}function h(e,t){return adapterFun(e,getArguments(function(e){p().then(function(){return t.apply(this,e)}).catch(function(t){e.pop()(t)})}))}function p(){return e.skipSetup||e.skip_setup?PouchPromise.resolve():o||((o=f({},{method:"GET",url:a}).catch(function(e){return e&&e.status&&404===e.status?(explainError(404,"PouchDB is just detecting if the remote exists."),f({},{method:"PUT",url:a})):PouchPromise.reject(e)}).catch(function(e){return!(!e||!e.status||412!==e.status)||PouchPromise.reject(e)})).catch(function(){o=null}),o)}function _(e){return e.split("/").map(encodeURIComponent).join("/")}n._ajax=ajax,setTimeout(function(){t(null,n)}),n.type=function(){return"http"},n.id=h("id",function(e){d({},{method:"GET",url:genUrl(i,"")},function(t,n){var r=n&&n.uuid?n.uuid+i.db:genDBUrl(i,"");e(null,r)})}),n.request=h("request",function(e,t){e.url=genDBUrl(i,e.url),d({},e,t)}),n.compact=h("compact",function(e,t){"function"==typeof e&&(t=e,e={}),d(e=clone(e),{url:genDBUrl(i,"_compact"),method:"POST"},function(){!function r(){n.info(function(n,o){o&&!o.compact_running?t(null,{ok:!0}):setTimeout(r,e.interval||200)})}()})}),n.bulkGet=adapterFun("bulkGet",function(e,t){var n=this;function r(t){var n={};e.revs&&(n.revs=!0),e.attachments&&(n.attachments=!0),d({},{url:genDBUrl(i,"_bulk_get"+paramsToStr(n)),method:"POST",body:{docs:e.docs}},t)}function o(){var r=MAX_SIMULTANEOUS_REVS,o=Math.ceil(e.docs.length/r),i=0,a=new Array(o);function s(e){return function(n,r){a[e]=r.results,++i===o&&t(null,{results:flatten(a)})}}for(var u=0;u<o;u++){var l=pick(e,["revs","attachments"]);l.ajax=c,l.docs=e.docs.slice(u*r,Math.min(e.docs.length,(u+1)*r)),bulkGet(n,l,s(u))}}var a=genUrl(i,""),s=supportsBulkGetMap[a];"boolean"!=typeof s?r(function(e,n){if(e){var r=Math.floor(e.status/100);4===r||5===r?(supportsBulkGetMap[a]=!1,explainError(e.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),o()):t(e)}else supportsBulkGetMap[a]=!0,t(null,n)}):s?r(t):o()}),n._info=function(e){p().then(function(){d({},{method:"GET",url:genDBUrl(i,"")},function(t,n){if(t)return e(t);n.host=genDBUrl(i,""),e(null,n)})}).catch(e)},n.get=h("get",function(e,t,n){"function"==typeof t&&(n=t,t={});var r={};(t=clone(t)).revs&&(r.revs=!0),t.revs_info&&(r.revs_info=!0),t.open_revs&&("all"!==t.open_revs&&(t.open_revs=JSON.stringify(t.open_revs)),r.open_revs=t.open_revs),t.rev&&(r.rev=t.rev),t.conflicts&&(r.conflicts=t.conflicts),e=encodeDocId(e);var o={method:"GET",url:genDBUrl(i,e+paramsToStr(r))};function a(e){var n=e._attachments,r=n&&Object.keys(n);if(n&&r.length)return new PromisePool(function(){if(!r.length)return null;var o=r.pop(),a=n[o],c=encodeDocId(e._id)+"/"+_(o)+"?rev="+e._rev;return f(t,{method:"GET",url:genDBUrl(i,c),binary:!0}).then(function(e){return t.binary?e:new PouchPromise(function(t){blobToBase64(e,t)})}).then(function(e){delete a.stub,delete a.length,a.data=e})},5,{promise:PouchPromise}).start()}f(t,o).then(function(e){return PouchPromise.resolve().then(function(){if(t.attachments)return n=e,Array.isArray(n)?PouchPromise.all(n.map(function(e){if(e.ok)return a(e.ok)})):a(n);var n}).then(function(){n(null,e)})}).catch(n)}),n.remove=h("remove",function(e,t,n,r){var o;"string"==typeof t?(o={_id:e,_rev:t},"function"==typeof n&&(r=n,n={})):(o=e,"function"==typeof t?(r=t,n={}):(r=n,n=t));var a=o._rev||n.rev;d(n,{method:"DELETE",url:genDBUrl(i,encodeDocId(o._id))+"?rev="+a},r)}),n.getAttachment=h("getAttachment",function(e,t,n,r){"function"==typeof n&&(r=n,n={});var o=n.rev?"?rev="+n.rev:"";d(n,{method:"GET",url:genDBUrl(i,encodeDocId(e))+"/"+_(t)+o,binary:!0},r)}),n.removeAttachment=h("removeAttachment",function(e,t,n,r){d({},{method:"DELETE",url:genDBUrl(i,encodeDocId(e)+"/"+_(t))+"?rev="+n},r)}),n.putAttachment=h("putAttachment",function(e,t,n,r,o,a){"function"==typeof o&&(a=o,o=r,r=n,n=null);var s=encodeDocId(e)+"/"+_(t),u=genDBUrl(i,s);if(n&&(u+="?rev="+n),"string"==typeof r){var l;try{l=atob$1(r)}catch(e){return a(createError(BAD_ARG,"Attachment is not a valid base64 string"))}r=l?binStringToBluffer(l,o):""}d({},{headers:{"Content-Type":o},method:"PUT",url:u,processData:!1,body:r,timeout:c.timeout||6e4},a)}),n._bulkDocs=function(e,t,n){e.new_edits=t.new_edits,p().then(function(){return PouchPromise.all(e.docs.map(preprocessAttachments$1))}).then(function(){d(t,{method:"POST",url:genDBUrl(i,"_bulk_docs"),body:e},function(e,t){if(e)return n(e);t.forEach(function(e){e.ok=!0}),n(null,t)})}).catch(n)},n.allDocs=h("allDocs",function(e,t){"function"==typeof e&&(t=e,e={});var n,r={},o="GET";(e=clone(e)).conflicts&&(r.conflicts=!0),e.descending&&(r.descending=!0),e.include_docs&&(r.include_docs=!0),e.attachments&&(r.attachments=!0),e.key&&(r.key=JSON.stringify(e.key)),e.start_key&&(e.startkey=e.start_key),e.startkey&&(r.startkey=JSON.stringify(e.startkey)),e.end_key&&(e.endkey=e.end_key),e.endkey&&(r.endkey=JSON.stringify(e.endkey)),void 0!==e.inclusive_end&&(r.inclusive_end=!!e.inclusive_end),void 0!==e.limit&&(r.limit=e.limit),void 0!==e.skip&&(r.skip=e.skip);var a=paramsToStr(r);if(void 0!==e.keys){var c="keys="+encodeURIComponent(JSON.stringify(e.keys));c.length+a.length+1<=MAX_URL_LENGTH?a+="&"+c:(o="POST",n={keys:e.keys})}f(e,{method:o,url:genDBUrl(i,"_all_docs"+a),body:n}).then(function(n){e.include_docs&&e.attachments&&e.binary&&n.rows.forEach(readAttachmentsAsBlobOrBuffer),t(null,n)}).catch(t)}),n._changes=function(e){var t="batch_size"in e?e.batch_size:CHANGES_BATCH_SIZE;(e=clone(e)).timeout="timeout"in e?e.timeout:"timeout"in c?c.timeout:3e4;var n,r=e.timeout?{timeout:e.timeout-5e3}:{},o=void 0!==e.limit&&e.limit;n="return_docs"in e?e.return_docs:!("returnDocs"in e)||e.returnDocs;var a=o;if(e.style&&(r.style=e.style),(e.include_docs||e.filter&&"function"==typeof e.filter)&&(r.include_docs=!0),e.attachments&&(r.attachments=!0),e.continuous&&(r.feed="longpoll"),e.conflicts&&(r.conflicts=!0),e.descending&&(r.descending=!0),"heartbeat"in e?e.heartbeat&&(r.heartbeat=e.heartbeat):r.heartbeat=1e4,e.filter&&"string"==typeof e.filter&&(r.filter=e.filter),e.view&&"string"==typeof e.view&&(r.filter="_view",r.view=e.view),e.query_params&&"object"==typeof e.query_params)for(var s in e.query_params)e.query_params.hasOwnProperty(s)&&(r[s]=e.query_params[s]);var u,l,f,h="GET";if(e.doc_ids){r.filter="_doc_ids";var _=JSON.stringify(e.doc_ids);_.length<MAX_URL_LENGTH?r.doc_ids=_:(h="POST",u={doc_ids:e.doc_ids})}var v=function(n,c){if(!e.aborted){r.since=n,"object"==typeof r.since&&(r.since=JSON.stringify(r.since)),e.descending?o&&(r.limit=a):r.limit=!o||a>t?t:a;var s={method:h,url:genDBUrl(i,"_changes"+paramsToStr(r)),timeout:e.timeout,body:u};f=n,e.aborted||p().then(function(){l=d(e,s,c)}).catch(c)}},E={results:[]},m=function(r,i){if(!e.aborted){var c=0;if(i&&i.results){c=i.results.length,E.last_seq=i.last_seq;e.query_params,i.results=i.results.filter(function(t){a--;var r=filterChange(e)(t);return r&&(e.include_docs&&e.attachments&&e.binary&&readAttachmentsAsBlobOrBuffer(t),n&&E.results.push(t),e.onChange(t)),r})}else if(r)return e.aborted=!0,void e.complete(r);i&&i.last_seq&&(f=i.last_seq);var s=o&&a<=0||i&&c<t||e.descending;(!e.continuous||o&&a<=0)&&s?e.complete(null,E):setTimeout(function(){v(f,m)},0)}};return v(e.since||0,m),{cancel:function(){e.aborted=!0,l&&l.abort()}}},n.revsDiff=h("revsDiff",function(e,t,n){"function"==typeof t&&(n=t,t={}),d(t,{method:"POST",url:genDBUrl(i,"_revs_diff"),body:e},n)}),n._close=function(e){e()},n._destroy=function(e,t){d(e,{url:genDBUrl(i,""),method:"DELETE"},function(e,n){if(e&&e.status&&404!==e.status)return t(e);t(null,n)})}}function HttpPouch$1(e){e.adapter("http",HttpPouch,!1),e.adapter("https",HttpPouch,!1)}function TaskQueue$1(){this.promise=new PouchPromise(function(e){e()})}function createView(e){var t,n=e.db,r=e.viewName,o=e.map,i=e.reduce,a=e.temporary,c=o.toString()+(i&&i.toString())+"undefined";if(!a&&(t=n._cachedViews=n._cachedViews||{})[c])return t[c];var s=n.info().then(function(e){var s=e.db_name+"-mrview-"+(a?"temp":stringMd5(c));return upsert(n,"_local/mrviews",function(e){e.views=e.views||{};var t=r;-1===t.indexOf("/")&&(t=r+"/"+r);var n=e.views[t]=e.views[t]||{};if(!n[s])return n[s]=!0,e}).then(function(){return n.registerDependentDatabase(s).then(function(e){var r=e.db;r.auto_compaction=!0;var a={name:s,db:r,sourceDB:n,adapter:n.adapter,mapFun:o,reduceFun:i};return a.db.get("_local/lastSeq").catch(function(e){if(404!==e.status)throw e}).then(function(e){return a.seq=e?e.seq:0,t&&a.db.once("destroyed",function(){delete t[c]}),a})})})});return t&&(t[c]=s),s}function evalfunc(e,t,n,r,o,i){return scopedEval("return ("+e.replace(/;\s*$/,"")+");",{emit:t,sum:n,log:r,isArray:o,toJSON:i})}HttpPouch.valid=function(){return!0},TaskQueue$1.prototype.add=function(e){return this.promise=this.promise.catch(function(){}).then(function(){return e()}),this.promise},TaskQueue$1.prototype.finish=function(){return this.promise};var promisedCallback=function(e,t){return t&&e.then(function(e){process.nextTick(function(){t(null,e)})},function(e){process.nextTick(function(){t(e)})}),e},callbackify=function(e){return getArguments(function(t){var n=t.pop(),r=e.apply(this,t);return"function"==typeof n&&promisedCallback(r,n),r})},fin=function(e,t){return e.then(function(e){return t().then(function(){return e})},function(e){return t().then(function(){throw e})})},sequentialize=function(e,t){return function(){var n=arguments,r=this;return e.add(function(){return t.apply(r,n)})}},uniq=function(e){for(var t={},n=0,r=e.length;n<r;n++)t["$"+e[n]]=!0;var o=Object.keys(t),i=new Array(o.length);for(n=0,r=o.length;n<r;n++)i[n]=o[n].substring(1);return i},persistentQueues={},tempViewQueue=new TaskQueue$1,CHANGES_BATCH_SIZE$1=50,log$2=guardedConsole.bind(null,"log");function parseViewName(e){return-1===e.indexOf("/")?[e,e]:e.split("/")}function isGenOne(e){return 1===e.length&&/^1-/.test(e[0].rev)}function emitError(e,t){try{e.emit("error",t)}catch(e){guardedConsole("error","The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),guardedConsole("error",t)}}function tryCode$1(e,t,n){try{return{output:t.apply(null,n)}}catch(t){return emitError(e,t),{error:t}}}function sortByKeyThenValue(e,t){var n=pouchdbCollate.collate(e.key,t.key);return 0!==n?n:pouchdbCollate.collate(e.value,t.value)}function sliceResults(e,t,n){return n=n||0,"number"==typeof t?e.slice(n,t+n):n>0?e.slice(n):e}function rowToDocId(e){var t=e.value;return t&&"object"==typeof t&&t._id||e.id}function readAttachmentsAsBlobOrBuffer$1(e){e.rows.forEach(function(e){var t=e.doc&&e.doc._attachments;t&&Object.keys(t).forEach(function(e){var n=t[e];t[e].data=b64ToBluffer(n.data,n.content_type)})})}function postprocessAttachments(e){return function(t){return e.include_docs&&e.attachments&&e.binary&&readAttachmentsAsBlobOrBuffer$1(t),t}}function createBuiltInError(e){return new BuiltInError("builtin "+e+" function requires map values to be numbers or number arrays")}function sum(e){for(var t=0,n=0,r=e.length;n<r;n++){var o=e[n];if("number"!=typeof o){if(!Array.isArray(o))throw createBuiltInError("_sum");t="number"==typeof t?[t]:t;for(var i=0,a=o.length;i<a;i++){var c=o[i];if("number"!=typeof c)throw createBuiltInError("_sum");void 0===t[i]?t.push(c):t[i]+=c}}else"number"==typeof t?t+=o:t[0]+=o}return t}var builtInReduce={_sum:function(e,t){return sum(t)},_count:function(e,t){return t.length},_stats:function(e,t){return{sum:sum(t),min:Math.min.apply(null,t),max:Math.max.apply(null,t),count:t.length,sumsqr:function(e){for(var t=0,n=0,r=e.length;n<r;n++){var o=e[n];t+=o*o}return t}(t)}}};function addHttpParam(e,t,n,r){var o=t[e];void 0!==o&&(r&&(o=encodeURIComponent(JSON.stringify(o))),n.push(e+"="+o))}function coerceInteger(e){if(void 0!==e){var t=Number(e);return isNaN(t)||t!==parseInt(e,10)?e:t}}function coerceOptions(e){return e.group_level=coerceInteger(e.group_level),e.limit=coerceInteger(e.limit),e.skip=coerceInteger(e.skip),e}function checkPositiveInteger(e){if(e){if("number"!=typeof e)return new QueryParseError('Invalid value for integer: "'+e+'"');if(e<0)return new QueryParseError('Invalid value for positive integer: "'+e+'"')}}function checkQueryParseError(e,t){var n=e.descending?"endkey":"startkey",r=e.descending?"startkey":"endkey";if(void 0!==e[n]&&void 0!==e[r]&&pouchdbCollate.collate(e[n],e[r])>0)throw new QueryParseError("No rows can match your key range, reverse your start_key and end_key or set {descending : true}");if(t.reduce&&!1!==e.reduce){if(e.include_docs)throw new QueryParseError("{include_docs:true} is invalid for reduce");if(e.keys&&e.keys.length>1&&!e.group&&!e.group_level)throw new QueryParseError("Multi-key fetches for reduce views must use {group: true}")}["group_level","limit","skip"].forEach(function(t){var n=checkPositiveInteger(e[t]);if(n)throw n})}function httpQuery(e,t,n){var r,o=[],i="GET";if(addHttpParam("reduce",n,o),addHttpParam("include_docs",n,o),addHttpParam("attachments",n,o),addHttpParam("limit",n,o),addHttpParam("descending",n,o),addHttpParam("group",n,o),addHttpParam("group_level",n,o),addHttpParam("skip",n,o),addHttpParam("stale",n,o),addHttpParam("conflicts",n,o),addHttpParam("startkey",n,o,!0),addHttpParam("start_key",n,o,!0),addHttpParam("endkey",n,o,!0),addHttpParam("end_key",n,o,!0),addHttpParam("inclusive_end",n,o),addHttpParam("key",n,o,!0),o=""===(o=o.join("&"))?"":"?"+o,void 0!==n.keys){var a="keys="+encodeURIComponent(JSON.stringify(n.keys));a.length+o.length+1<=2e3?o+=("?"===o[0]?"&":"?")+a:(i="POST","string"==typeof t?r={keys:n.keys}:t.keys=n.keys)}if("string"==typeof t){var c=parseViewName(t);return e.request({method:i,url:"_design/"+c[0]+"/_view/"+c[1]+o,body:r}).then(postprocessAttachments(n))}return r=r||{},Object.keys(t).forEach(function(e){Array.isArray(t[e])?r[e]=t[e]:r[e]=t[e].toString()}),e.request({method:"POST",url:"_temp_view"+o,body:r}).then(postprocessAttachments(n))}function customQuery(e,t,n){return new PouchPromise(function(r,o){e._query(t,n,function(e,t){if(e)return o(e);r(t)})})}function customViewCleanup(e){return new PouchPromise(function(t,n){e._viewCleanup(function(e,r){if(e)return n(e);t(r)})})}function defaultsTo(e){return function(t){if(404===t.status)return e;throw t}}function getDocsToPersist(e,t,n){var r="_local/doc_"+e,o={_id:r,keys:[]},i=n[e],a=i.indexableKeysToKeyValues;return(isGenOne(i.changes)?PouchPromise.resolve(o):t.db.get(r).catch(defaultsTo(o))).then(function(e){return function(e){return e.keys.length?t.db.allDocs({keys:e.keys,include_docs:!0}):PouchPromise.resolve({rows:[]})}(e).then(function(t){return function(e,t){for(var n=[],r={},o=0,i=t.rows.length;o<i;o++){var c=t.rows[o].doc;if(c&&(n.push(c),r[c._id]=!0,c._deleted=!a[c._id],!c._deleted)){var s=a[c._id];"value"in s&&(c.value=s.value)}}var u=Object.keys(a);return u.forEach(function(e){if(!r[e]){var t={_id:e},o=a[e];"value"in o&&(t.value=o.value),n.push(t)}}),e.keys=uniq(u.concat(e.keys)),n.push(e),n}(e,t)})})}function saveKeyValues(e,t,n){return e.db.get("_local/lastSeq").catch(defaultsTo({_id:"_local/lastSeq",seq:0})).then(function(r){var o=Object.keys(t);return PouchPromise.all(o.map(function(n){return getDocsToPersist(n,e,t)})).then(function(t){var o=flatten(t);return r.seq=n,o.push(r),e.db.bulkDocs({docs:o})})})}function getQueue(e){var t="string"==typeof e?e:e.name,n=persistentQueues[t];return n||(n=persistentQueues[t]=new TaskQueue$1),n}function updateView(e){return sequentialize(getQueue(e),function(){return updateViewInQueue(e)})()}function updateViewInQueue(e){var t,n,r;function o(e,r){var o={id:n._id,key:pouchdbCollate.normalizeKey(e)};void 0!==r&&null!==r&&(o.value=pouchdbCollate.normalizeKey(r)),t.push(o)}if("function"==typeof e.mapFun&&2===e.mapFun.length){var i=e.mapFun;r=function(e){return i(e,o)}}else r=evalfunc(e.mapFun.toString(),o,sum,log$2,Array.isArray,JSON.parse);var a=e.seq||0;var c=new TaskQueue$1;return new PouchPromise(function(o,i){function s(){c.finish().then(function(){e.seq=a,o()})}!function o(){e.sourceDB.changes({conflicts:!0,include_docs:!0,style:"all_docs",since:a,limit:CHANGES_BATCH_SIZE$1}).on("complete",function(i){var u=i.results;if(!u.length)return s();for(var l={},d=0,f=u.length;d<f;d++){var h=u[d];if("_"!==h.doc._id[0]){t=[],(n=h.doc)._deleted||tryCode$1(e.sourceDB,r,[n]),t.sort(sortByKeyThenValue);for(var p,_={},v=0,E=t.length;v<E;v++){var m=t[v],g=[m.key,m.id];0===pouchdbCollate.collate(m.key,p)&&g.push(v),_[pouchdbCollate.toIndexableString(g)]=m,p=m.key}l[h.doc._id]={indexableKeysToKeyValues:_,changes:h.changes}}a=h.seq}return c.add(function(t,n){return function(){return saveKeyValues(e,t,n)}}(l,a)),u.length<CHANGES_BATCH_SIZE$1?s():o()}).on("error",function(e){i(e)})}()})}function reduceView(e,t,n){0===n.group_level&&delete n.group_level;var r,o=n.group||n.group_level;r=builtInReduce[e.reduceFun]?builtInReduce[e.reduceFun]:evalfunc(e.reduceFun.toString(),null,sum,log$2,Array.isArray,JSON.parse);var i=[],a=isNaN(n.group_level)?Number.POSITIVE_INFINITY:n.group_level;t.forEach(function(e){var t=i[i.length-1],n=o?e.key:null;if(o&&Array.isArray(n)&&(n=n.slice(0,a)),t&&0===pouchdbCollate.collate(t.groupKey,n))return t.keys.push([e.key,e.id]),void t.values.push(e.value);i.push({keys:[[e.key,e.id]],values:[e.value],groupKey:n})}),t=[];for(var c=0,s=i.length;c<s;c++){var u=i[c],l=tryCode$1(e.sourceDB,r,[u.keys,u.values,!1]);if(l.error&&l.error instanceof BuiltInError)throw l.error;t.push({value:l.error?null:l.output,key:u.groupKey})}return{rows:sliceResults(t,n.limit,n.skip)}}function queryView(e,t){return sequentialize(getQueue(e),function(){return queryViewInQueue(e,t)})()}function queryViewInQueue(e,t){var n,r=e.reduceFun&&!1!==t.reduce,o=t.skip||0;function i(t){return t.include_docs=!0,e.db.allDocs(t).then(function(e){return n=e.total_rows,e.rows.map(function(e){if("value"in e.doc&&"object"==typeof e.doc.value&&null!==e.doc.value){var t=Object.keys(e.doc.value).sort(),n=["id","key","value"];if(!(t<n||t>n))return e.doc.value}var r=pouchdbCollate.parseIndexableString(e.doc._id);return{key:r[0],id:r[1],value:"value"in e.doc?e.doc.value:null}})})}function a(i){var a;if(a=r?reduceView(e,i,t):{total_rows:n,offset:o,rows:i},t.include_docs){var c=uniq(i.map(rowToDocId));return e.sourceDB.allDocs({keys:c,include_docs:!0,conflicts:t.conflicts,attachments:t.attachments,binary:t.binary}).then(function(e){var t={};return e.rows.forEach(function(e){e.doc&&(t["$"+e.id]=e.doc)}),i.forEach(function(e){var n=rowToDocId(e),r=t["$"+n];r&&(e.doc=r)}),a})}return a}if(void 0===t.keys||t.keys.length||(t.limit=0,delete t.keys),void 0!==t.keys){var c=t.keys.map(function(e){return i({startkey:pouchdbCollate.toIndexableString([e]),endkey:pouchdbCollate.toIndexableString([e,{}])})});return PouchPromise.all(c).then(flatten).then(a)}var s={descending:t.descending};if(t.start_key&&(t.startkey=t.start_key),t.end_key&&(t.endkey=t.end_key),void 0!==t.startkey&&(s.startkey=t.descending?pouchdbCollate.toIndexableString([t.startkey,{}]):pouchdbCollate.toIndexableString([t.startkey])),void 0!==t.endkey){var u=!1!==t.inclusive_end;t.descending&&(u=!u),s.endkey=pouchdbCollate.toIndexableString(u?[t.endkey,{}]:[t.endkey])}if(void 0!==t.key){var l=pouchdbCollate.toIndexableString([t.key]),d=pouchdbCollate.toIndexableString([t.key,{}]);s.descending?(s.endkey=l,s.startkey=d):(s.startkey=l,s.endkey=d)}return r||("number"==typeof t.limit&&(s.limit=t.limit),s.skip=o),i(s).then(a)}function httpViewCleanup(e){return e.request({method:"POST",url:"_view_cleanup"})}function localViewCleanup(e){return e.get("_local/mrviews").then(function(t){var n={};Object.keys(t.views).forEach(function(e){var t=parseViewName(e),r="_design/"+t[0],o=t[1];n[r]=n[r]||{},n[r][o]=!0});var r={keys:Object.keys(n),include_docs:!0};return e.allDocs(r).then(function(r){var o={};r.rows.forEach(function(e){var r=e.key.substring(8);Object.keys(n[e.key]).forEach(function(n){var i=r+"/"+n;t.views[i]||(i=n);var a=Object.keys(t.views[i]),c=e.doc&&e.doc.views&&e.doc.views[n];a.forEach(function(e){o[e]=o[e]||c})})});var i=Object.keys(o).filter(function(e){return!o[e]}).map(function(t){return sequentialize(getQueue(t),function(){return new e.constructor(t,e.__opts).destroy()})()});return PouchPromise.all(i).then(function(){return{ok:!0}})})},defaultsTo({ok:!0}))}var viewCleanup=callbackify(function(){var e=this;return"http"===e.type()?httpViewCleanup(e):"function"==typeof e._viewCleanup?customViewCleanup(e):localViewCleanup(e)});function queryPromised(e,t,n){if("http"===e.type())return httpQuery(e,t,n);if("function"==typeof e._query)return customQuery(e,t,n);if("string"!=typeof t){checkQueryParseError(n,t);var r={db:e,viewName:"temp_view/temp_view",map:t.map,reduce:t.reduce,temporary:!0};return tempViewQueue.add(function(){return createView(r).then(function(e){return fin(updateView(e).then(function(){return queryView(e,n)}),function(){return e.db.destroy()})})}),tempViewQueue.finish()}var o=t,i=parseViewName(o),a=i[0],c=i[1];return e.get("_design/"+a).then(function(t){var r=t.views&&t.views[c];if(!r||"string"!=typeof r.map)throw new NotFoundError("ddoc "+a+" has no view named "+c);return checkQueryParseError(n,r),createView({db:e,viewName:o,map:r.map,reduce:r.reduce}).then(function(e){return"ok"===n.stale||"update_after"===n.stale?("update_after"===n.stale&&process.nextTick(function(){updateView(e)}),queryView(e,n)):updateView(e).then(function(){return queryView(e,n)})})})}var query=function(e,t,n){"function"==typeof t&&(n=t,t={}),t=t?coerceOptions(t):{},"function"==typeof e&&(e={map:e});var r=this,o=PouchPromise.resolve().then(function(){return queryPromised(r,e,t)});return promisedCallback(o,n),o};function QueryParseError(e){this.status=400,this.name="query_parse_error",this.message=e,this.error=!0;try{Error.captureStackTrace(this,QueryParseError)}catch(e){}}function NotFoundError(e){this.status=404,this.name="not_found",this.message=e,this.error=!0;try{Error.captureStackTrace(this,NotFoundError)}catch(e){}}function BuiltInError(e){this.status=500,this.name="invalid_value",this.message=e,this.error=!0;try{Error.captureStackTrace(this,BuiltInError)}catch(e){}}inherits(QueryParseError,Error),inherits(NotFoundError,Error),inherits(BuiltInError,Error);var mapreduce={query:query,viewCleanup:viewCleanup};function isGenOne$1(e){return/^1-/.test(e)}function fileHasChanged(e,t,n){return!e._attachments||!e._attachments[n]||e._attachments[n].digest!==t._attachments[n].digest}function getDocAttachments(e,t){var n=Object.keys(t._attachments);return PouchPromise.all(n.map(function(n){return e.getAttachment(t._id,n,{rev:t._rev})}))}function getDocAttachmentsFromTargetOrSource(e,t,n){var r="http"===t.type()&&"http"!==e.type(),o=Object.keys(n._attachments);return r?e.get(n._id).then(function(r){return PouchPromise.all(o.map(function(o){return fileHasChanged(r,n,o)?t.getAttachment(n._id,o):e.getAttachment(r._id,o)}))}).catch(function(e){if(404!==e.status)throw e;return getDocAttachments(t,n)}):getDocAttachments(t,n)}function createBulkGetOpts(e){var t=[];return Object.keys(e).forEach(function(n){e[n].missing.forEach(function(e){t.push({id:n,rev:e})})}),{docs:t,revs:!0}}function getDocs(e,t,n,r){n=clone(n);var o=[],i=!0;function a(t){return e.allDocs({keys:t,include_docs:!0}).then(function(e){if(r.cancelled)throw new Error("cancelled");e.rows.forEach(function(e){var t;e.deleted||!e.doc||!isGenOne$1(e.value.rev)||(t=e.doc)._attachments&&Object.keys(t._attachments).length>0||(o.push(e.doc),delete n[e.id])})})}return PouchPromise.resolve().then(function(){var e=Object.keys(n).filter(function(e){var t=n[e].missing;return 1===t.length&&isGenOne$1(t[0])});if(e.length>0)return a(e)}).then(function(){var a=createBulkGetOpts(n);if(a.docs.length)return e.bulkGet(a).then(function(n){if(r.cancelled)throw new Error("cancelled");return PouchPromise.all(n.results.map(function(n){return PouchPromise.all(n.docs.map(function(n){var r=n.ok;return n.error&&(i=!1),r&&r._attachments?getDocAttachmentsFromTargetOrSource(t,e,r).then(function(e){var t=Object.keys(r._attachments);return e.forEach(function(e,n){var o=r._attachments[t[n]];delete o.stub,delete o.length,o.data=e}),r}):r}))})).then(function(e){o=o.concat(flatten(e).filter(Boolean))})})}).then(function(){return{ok:i,docs:o}})}var CHECKPOINT_VERSION=1,REPLICATOR="pouchdb",CHECKPOINT_HISTORY_SIZE=5,LOWEST_SEQ=0;function updateCheckpoint(e,t,n,r,o){return e.get(t).catch(function(n){if(404===n.status)return"http"===e.type()&&explainError(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:r,_id:t,history:[],replicator:REPLICATOR,version:CHECKPOINT_VERSION};throw n}).then(function(i){if(!o.cancelled)return i.history=(i.history||[]).filter(function(e){return e.session_id!==r}),i.history.unshift({last_seq:n,session_id:r}),i.history=i.history.slice(0,CHECKPOINT_HISTORY_SIZE),i.version=CHECKPOINT_VERSION,i.replicator=REPLICATOR,i.session_id=r,i.last_seq=n,e.put(i).catch(function(i){if(409===i.status)return updateCheckpoint(e,t,n,r,o);throw i})})}function Checkpointer(e,t,n,r){this.src=e,this.target=t,this.id=n,this.returnValue=r}Checkpointer.prototype.writeCheckpoint=function(e,t){var n=this;return this.updateTarget(e,t).then(function(){return n.updateSource(e,t)})},Checkpointer.prototype.updateTarget=function(e,t){return updateCheckpoint(this.target,this.id,e,t,this.returnValue)},Checkpointer.prototype.updateSource=function(e,t){var n=this;return this.readOnlySource?PouchPromise.resolve(!0):updateCheckpoint(this.src,this.id,e,t,this.returnValue).catch(function(e){if(isForbiddenError(e))return n.readOnlySource=!0,!0;throw e})};var comparisons={undefined:function(e,t){return 0===pouchdbCollate.collate(e.last_seq,t.last_seq)?t.last_seq:0},1:function(e,t){return compareReplicationLogs(t,e).last_seq}};function compareReplicationLogs(e,t){return e.session_id===t.session_id?{last_seq:e.last_seq,history:e.history}:compareReplicationHistory(e.history,t.history)}function compareReplicationHistory(e,t){var n=e[0],r=e.slice(1),o=t[0],i=t.slice(1);return n&&0!==t.length?hasSessionId(n.session_id,t)?{last_seq:n.last_seq,history:e}:hasSessionId(o.session_id,r)?{last_seq:o.last_seq,history:i}:compareReplicationHistory(r,i):{last_seq:LOWEST_SEQ,history:[]}}function hasSessionId(e,t){var n=t[0],r=t.slice(1);return!(!e||0===t.length)&&(e===n.session_id||hasSessionId(e,r))}function isForbiddenError(e){return"number"==typeof e.status&&4===Math.floor(e.status/100)}Checkpointer.prototype.getCheckpoint=function(){var e=this;return e.target.get(e.id).then(function(t){return e.readOnlySource?PouchPromise.resolve(t.last_seq):e.src.get(e.id).then(function(e){return t.version!==e.version?LOWEST_SEQ:(n=t.version?t.version.toString():"undefined")in comparisons?comparisons[n](t,e):LOWEST_SEQ;var n},function(n){if(404===n.status&&t.last_seq)return e.src.put({_id:e.id,last_seq:LOWEST_SEQ}).then(function(){return LOWEST_SEQ},function(n){return isForbiddenError(n)?(e.readOnlySource=!0,t.last_seq):LOWEST_SEQ});throw n})}).catch(function(e){if(404!==e.status)throw e;return LOWEST_SEQ})};var STARTING_BACK_OFF=0;function backOff(e,t,n,r){if(!1===e.retry)return t.emit("error",n),void t.removeAllListeners();if("function"!=typeof e.back_off_function&&(e.back_off_function=defaultBackOff),t.emit("requestError",n),"active"===t.state||"pending"===t.state){t.emit("paused",n),t.state="stopped";var o=function(){e.current_back_off=STARTING_BACK_OFF};t.once("paused",function(){t.removeListener("active",o)}),t.once("active",o)}e.current_back_off=e.current_back_off||STARTING_BACK_OFF,e.current_back_off=e.back_off_function(e.current_back_off),setTimeout(r,e.current_back_off)}function sortObjectPropertiesByKey(e){return Object.keys(e).sort(pouchdbCollate.collate).reduce(function(t,n){return t[n]=e[n],t},{})}function generateReplicationId(e,t,n){var r=n.doc_ids?n.doc_ids.sort(pouchdbCollate.collate):"",o=n.filter?n.filter.toString():"",i="",a="";return n.filter&&n.query_params&&(i=JSON.stringify(sortObjectPropertiesByKey(n.query_params))),n.filter&&"_view"===n.filter&&(a=n.view.toString()),PouchPromise.all([e.id(),t.id()]).then(function(e){var t=e[0]+e[1]+o+a+i+r;return new PouchPromise(function(e){binaryMd5(t,e)})}).then(function(e){return"_local/"+(e=e.replace(/\//g,".").replace(/\+/g,"_"))})}function replicate$1(e,t,n,r,o){var i,a,c=[],s={seq:0,changes:[],docs:[]},u=!1,l=!1,d=!1,f=0,h=n.continuous||n.live||!1,p=n.batch_size||100,_=n.batches_limit||10,v=!1,E=n.doc_ids,m=[],g=[],y=uuid();o=o||{ok:!0,start_time:new Date,docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var S={};function T(){return a?PouchPromise.resolve():generateReplicationId(e,t,n).then(function(n){a=new Checkpointer(e,t,n,r)})}function b(){if(g=[],0!==i.docs.length){var e=i.docs;return t.bulkDocs({docs:e,new_edits:!1}).then(function(t){if(r.cancelled)throw w(),new Error("cancelled");var n=[],a={};t.forEach(function(e){e.error&&(o.doc_write_failures++,n.push(e),a[e.id]=e)}),m=m.concat(n),o.docs_written+=i.docs.length-n.length;var c=n.filter(function(e){return"unauthorized"!==e.name&&"forbidden"!==e.name});if(e.forEach(function(e){var t=a[e._id];t?r.emit("denied",clone(t)):g.push(e)}),c.length>0){var s=new Error("bulkDocs error");throw s.other_errors=n,C("target.bulkDocs failed to write docs",s),new Error("bulkWrite partial failure")}},function(t){throw o.doc_write_failures+=e.length,t})}}function O(){if(i.error)throw new Error("There was a problem getting docs.");o.last_seq=f=i.seq;var e=clone(o);return g.length&&(e.docs=g,r.emit("change",e)),u=!0,a.writeCheckpoint(i.seq,y).then(function(){if(u=!1,r.cancelled)throw w(),new Error("cancelled");i=void 0,q()}).catch(N)}function R(){return getDocs(e,t,i.diffs,r).then(function(e){i.error=!e.ok,e.docs.forEach(function(e){delete i.diffs[e._id],o.docs_read++,i.docs.push(e)})})}function D(){var e;r.cancelled||i||(0!==c.length?(i=c.shift(),(e={},i.changes.forEach(function(t){"_user/"!==t.id&&(e[t.id]=t.changes.map(function(e){return e.rev}))}),t.revsDiff(e).then(function(e){if(r.cancelled)throw w(),new Error("cancelled");i.diffs=e})).then(R).then(b).then(O).then(D).catch(function(e){C("batch processing terminated with error",e)})):A(!0))}function A(e){0!==s.changes.length?(e||l||s.changes.length>=p)&&(c.push(s),s={seq:0,changes:[],docs:[]},"pending"!==r.state&&"stopped"!==r.state||(r.state="active",r.emit("active")),D()):0!==c.length||i||((h&&S.live||l)&&(r.state="pending",r.emit("paused")),l&&w())}function C(e,t){d||(t.message||(t.message=e),o.ok=!1,o.status="aborting",o.errors.push(t),m=m.concat(t),c=[],s={seq:0,changes:[],docs:[]},w())}function w(){if(!d&&(!r.cancelled||(o.status="cancelled",!u)))if(o.status=o.status||"complete",o.end_time=new Date,o.last_seq=f,d=!0,m.filter(function(e){return"unauthorized"!==e.name&&"forbidden"!==e.name}).length>0){var i=m.pop();m.length>0&&(i.other_errors=m),i.result=o,backOff(n,r,i,function(){replicate$1(e,t,n,r)})}else o.errors=m,r.emit("complete",o),r.removeAllListeners()}function k(e){if(r.cancelled)return w();filterChange(n)(e)&&(s.seq=e.seq,s.changes.push(e),A(0===c.length&&S.live))}function I(e){if(v=!1,r.cancelled)return w();if(e.results.length>0)S.since=e.last_seq,q(),A(!0);else{var t=function(){h?(S.live=!0,q()):l=!0,A(!0)};i||0!==e.results.length?t():(u=!0,a.writeCheckpoint(e.last_seq,y).then(function(){u=!1,o.last_seq=f=e.last_seq,t()}).catch(N))}}function B(e){if(v=!1,r.cancelled)return w();C("changes rejected",e)}function q(){if(!v&&!l&&c.length<_){v=!0,r._changes&&(r.removeListener("cancel",r._abortChanges),r._changes.cancel()),r.once("cancel",o);var t=e.changes(S).on("change",k);t.then(i,i),t.then(I).catch(B),n.retry&&(r._changes=t,r._abortChanges=o)}function o(){t.cancel()}function i(){r.removeListener("cancel",o)}}function P(){T().then(function(){if(!r.cancelled)return a.getCheckpoint().then(function(e){S={since:f=e,limit:p,batch_size:p,style:"all_docs",doc_ids:E,return_docs:!0},n.filter&&("string"!=typeof n.filter?S.include_docs=!0:S.filter=n.filter),"heartbeat"in n&&(S.heartbeat=n.heartbeat),"timeout"in n&&(S.timeout=n.timeout),n.query_params&&(S.query_params=n.query_params),n.view&&(S.view=n.view),q()});w()}).catch(function(e){C("getCheckpoint rejected with ",e)})}function N(e){throw u=!1,C("writeCheckpoint completed with error",e),e}r.ready(e,t),r.cancelled?w():(r._addedListeners||(r.once("cancel",w),"function"==typeof n.complete&&(r.once("error",n.complete),r.once("complete",function(e){n.complete(null,e)})),r._addedListeners=!0),void 0===n.since?P():T().then(function(){return u=!0,a.writeCheckpoint(n.since,y)}).then(function(){u=!1,r.cancelled?w():(f=n.since,P())}).catch(N))}function Replication(){events.EventEmitter.call(this),this.cancelled=!1,this.state="pending";var e=this,t=new PouchPromise(function(t,n){e.once("complete",t),e.once("error",n)});e.then=function(e,n){return t.then(e,n)},e.catch=function(e){return t.catch(e)},e.catch(function(){})}function toPouch(e,t){var n=t.PouchConstructor;return"string"==typeof e?new n(e,t):e}function replicate(e,t,n,r){if("function"==typeof n&&(r=n,n={}),void 0===n&&(n={}),n.doc_ids&&!Array.isArray(n.doc_ids))throw createError(BAD_REQUEST,"`doc_ids` filter parameter is not a list.");n.complete=r,(n=clone(n)).continuous=n.continuous||n.live,n.retry="retry"in n&&n.retry,n.PouchConstructor=n.PouchConstructor||this;var o=new Replication(n);return replicate$1(toPouch(e,n),toPouch(t,n),n,o),o}function sync(e,t,n,r){return"function"==typeof n&&(r=n,n={}),void 0===n&&(n={}),(n=clone(n)).PouchConstructor=n.PouchConstructor||this,new Sync(e=toPouch(e,n),t=toPouch(t,n),n,r)}function Sync(e,t,n,r){var o=this;this.canceled=!1;var i=n.push?jsExtend.extend({},n,n.push):n,a=n.pull?jsExtend.extend({},n,n.pull):n;function c(e){o.emit("change",{direction:"pull",change:e})}function s(e){o.emit("change",{direction:"push",change:e})}function u(e){o.emit("denied",{direction:"push",doc:e})}function l(e){o.emit("denied",{direction:"pull",doc:e})}function d(){o.pushPaused=!0,o.pullPaused&&o.emit("paused")}function f(){o.pullPaused=!0,o.pushPaused&&o.emit("paused")}function h(){o.pushPaused=!1,o.pullPaused&&o.emit("active",{direction:"push"})}function p(){o.pullPaused=!1,o.pushPaused&&o.emit("active",{direction:"pull"})}this.push=replicate(e,t,i),this.pull=replicate(t,e,a),this.pushPaused=!0,this.pullPaused=!0;var _={};function v(e){return function(t,n){("change"===t&&(n===c||n===s)||"denied"===t&&(n===l||n===u)||"paused"===t&&(n===f||n===d)||"active"===t&&(n===p||n===h))&&(t in _||(_[t]={}),_[t][e]=!0,2===Object.keys(_[t]).length&&o.removeAllListeners(t))}}n.live&&(this.push.on("complete",o.pull.cancel.bind(o.pull)),this.pull.on("complete",o.push.cancel.bind(o.push))),this.on("newListener",function(e){"change"===e?(o.pull.on("change",c),o.push.on("change",s)):"denied"===e?(o.pull.on("denied",l),o.push.on("denied",u)):"active"===e?(o.pull.on("active",p),o.push.on("active",h)):"paused"===e&&(o.pull.on("paused",f),o.push.on("paused",d))}),this.on("removeListener",function(e){"change"===e?(o.pull.removeListener("change",c),o.push.removeListener("change",s)):"denied"===e?(o.pull.removeListener("denied",l),o.push.removeListener("denied",u)):"active"===e?(o.pull.removeListener("active",p),o.push.removeListener("active",h)):"paused"===e&&(o.pull.removeListener("paused",f),o.push.removeListener("paused",d))}),this.pull.on("removeListener",v("pull")),this.push.on("removeListener",v("push"));var E=PouchPromise.all([this.push,this.pull]).then(function(e){var t={push:e[0],pull:e[1]};return o.emit("complete",t),r&&r(null,t),o.removeAllListeners(),t},function(e){if(o.cancel(),r?r(e):o.emit("error",e),o.removeAllListeners(),r)throw e});this.then=function(e,t){return E.then(e,t)},this.catch=function(e){return E.catch(e)}}function replication(e){e.replicate=replicate,e.sync=sync}inherits(Replication,events.EventEmitter),Replication.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},Replication.prototype.ready=function(e,t){var n=this;function r(){n.cancel()}n._readyCalled||(n._readyCalled=!0,e.once("destroyed",r),t.once("destroyed",r),n.once("complete",function(){e.removeListener("destroyed",r),t.removeListener("destroyed",r)}))},inherits(Sync,events.EventEmitter),Sync.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())},PouchDB.plugin(IDBPouch).plugin(WebSqlPouch).plugin(HttpPouch$1).plugin(mapreduce).plugin(replication),module.exports=PouchDB;

}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"_process":140,"argsarray":48,"debug":128,"es6-promise-pool":64,"events":65,"inherits":130,"js-extend":97,"lie":113,"pouchdb-collate":122,"pouchdb-collections":124,"scope-eval":285,"spark-md5":286,"vuvuzela":310}],128:[function(require,module,exports){
function useColors(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function formatArgs(){var o=arguments,e=this.useColors;if(o[0]=(e?"%c":"")+this.namespace+(e?" %c":" ")+o[0]+(e?"%c ":" ")+"+"+exports.humanize(this.diff),!e)return o;var r="color: "+this.color,t=0,s=0;return(o=[o[0],r,"color: inherit"].concat(Array.prototype.slice.call(o,1)))[0].replace(/%[a-z%]/g,function(o){"%%"!==o&&"%c"===o&&(s=++t)}),o.splice(s,0,r),o}function log(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function save(o){try{null==o?exports.storage.removeItem("debug"):exports.storage.debug=o}catch(o){}}function load(){var o;try{o=exports.storage.debug}catch(o){}return o}function localstorage(){try{return window.localStorage}catch(o){}}exports=module.exports=require("./debug"),exports.log=log,exports.formatArgs=formatArgs,exports.save=save,exports.load=load,exports.useColors=useColors,exports.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:localstorage(),exports.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],exports.formatters.j=function(o){return JSON.stringify(o)},exports.enable(load());

},{"./debug":129}],129:[function(require,module,exports){
exports=module.exports=debug,exports.coerce=coerce,exports.disable=disable,exports.enable=enable,exports.enabled=enabled,exports.humanize=require("ms"),exports.names=[],exports.skips=[],exports.formatters={};var prevTime,prevColor=0;function selectColor(){return exports.colors[prevColor++%exports.colors.length]}function debug(e){function r(){}function o(){var e=o,r=+new Date,s=r-(prevTime||r);e.diff=s,e.prev=prevTime,e.curr=r,prevTime=r,null==e.useColors&&(e.useColors=exports.useColors()),null==e.color&&e.useColors&&(e.color=selectColor());var t=Array.prototype.slice.call(arguments);t[0]=exports.coerce(t[0]),"string"!=typeof t[0]&&(t=["%o"].concat(t));var n=0;t[0]=t[0].replace(/%([a-z%])/g,function(r,o){if("%%"===r)return r;n++;var s=exports.formatters[o];if("function"==typeof s){var p=t[n];r=s.call(e,p),t.splice(n,1),n--}return r}),"function"==typeof exports.formatArgs&&(t=exports.formatArgs.apply(e,t)),(o.log||exports.log||console.log.bind(console)).apply(e,t)}r.enabled=!1,o.enabled=!0;var s=exports.enabled(e)?o:r;return s.namespace=e,s}function enable(e){exports.save(e);for(var r=(e||"").split(/[\s,]+/),o=r.length,s=0;s<o;s++)r[s]&&("-"===(e=r[s].replace(/\*/g,".*?"))[0]?exports.skips.push(new RegExp("^"+e.substr(1)+"$")):exports.names.push(new RegExp("^"+e+"$")))}function disable(){exports.enable("")}function enabled(e){var r,o;for(r=0,o=exports.skips.length;r<o;r++)if(exports.skips[r].test(e))return!1;for(r=0,o=exports.names.length;r<o;r++)if(exports.names[r].test(e))return!0;return!1}function coerce(e){return e instanceof Error?e.stack||e.message:e}

},{"ms":131}],130:[function(require,module,exports){
"function"==typeof Object.create?module.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:module.exports=function(t,e){t.super_=e;var o=function(){};o.prototype=e.prototype,t.prototype=new o,t.prototype.constructor=t};

},{}],131:[function(require,module,exports){
var s=1e3,m=60*s,h=60*m,d=24*h,y=365.25*d;function parse(e){if(!((e=""+e).length>1e4)){var a=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(a){var r=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return r*y;case"days":case"day":case"d":return r*d;case"hours":case"hour":case"hrs":case"hr":case"h":return r*h;case"minutes":case"minute":case"mins":case"min":case"m":return r*m;case"seconds":case"second":case"secs":case"sec":case"s":return r*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r}}}}function short(e){return e>=d?Math.round(e/d)+"d":e>=h?Math.round(e/h)+"h":e>=m?Math.round(e/m)+"m":e>=s?Math.round(e/s)+"s":e+"ms"}function long(e){return plural(e,d,"day")||plural(e,h,"hour")||plural(e,m,"minute")||plural(e,s,"second")||e+" ms"}function plural(s,e,a){if(!(s<e))return s<1.5*e?Math.floor(s/e)+" "+a:Math.ceil(s/e)+" "+a+"s"}module.exports=function(s,e){return e=e||{},"string"==typeof s?parse(s):e.long?long(s):short(s)};

},{}],132:[function(require,module,exports){
(function (process){
"use strict";function nextTick(e,n,c,r){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var s,t,o=arguments.length;switch(o){case 0:case 1:return process.nextTick(e);case 2:return process.nextTick(function(){e.call(null,n)});case 3:return process.nextTick(function(){e.call(null,n,c)});case 4:return process.nextTick(function(){e.call(null,n,c,r)});default:for(s=new Array(o-1),t=0;t<s.length;)s[t++]=arguments[t];return process.nextTick(function(){e.apply(null,s)})}}!process.version||0===process.version.indexOf("v0.")||0===process.version.indexOf("v1.")&&0!==process.version.indexOf("v1.8.")?module.exports=nextTick:module.exports=process.nextTick;

}).call(this,require('_process'))
},{"_process":140}],133:[function(require,module,exports){
"use strict";var objectKeys=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};module.exports=Duplex;var processNextTick=require("process-nextick-args"),util=require("core-util-is");util.inherits=require("inherits");var Readable=require("./_stream_readable"),Writable=require("./_stream_writable");util.inherits(Duplex,Readable);for(var keys=objectKeys(Writable.prototype),v=0;v<keys.length;v++){var method=keys[v];Duplex.prototype[method]||(Duplex.prototype[method]=Writable.prototype[method])}function Duplex(e){if(!(this instanceof Duplex))return new Duplex(e);Readable.call(this,e),Writable.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",onend)}function onend(){this.allowHalfOpen||this._writableState.ended||processNextTick(onEndNT,this)}function onEndNT(e){e.end()}function forEach(e,t){for(var r=0,i=e.length;r<i;r++)t(e[r],r)}

},{"./_stream_readable":134,"./_stream_writable":136,"core-util-is":53,"inherits":130,"process-nextick-args":132}],134:[function(require,module,exports){
(function (process){
"use strict";module.exports=Readable;var processNextTick=require("process-nextick-args"),isArray=require("isarray"),Buffer=require("buffer").Buffer;Readable.ReadableState=ReadableState;var Stream,EE=require("events"),EElistenerCount=function(e,t){return e.listeners(t).length};!function(){try{Stream=require("stream")}catch(e){}finally{Stream||(Stream=require("events").EventEmitter)}}();Buffer=require("buffer").Buffer;var util=require("core-util-is");util.inherits=require("inherits");var StringDecoder,Duplex,debugUtil=require("util"),debug=void 0;function ReadableState(e,t){Duplex=Duplex||require("./_stream_duplex"),e=e||{},this.objectMode=!!e.objectMode,t instanceof Duplex&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var r=e.highWaterMark,n=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:n,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(StringDecoder||(StringDecoder=require("string_decoder/").StringDecoder),this.decoder=new StringDecoder(e.encoding),this.encoding=e.encoding)}function Readable(e){if(Duplex=Duplex||require("./_stream_duplex"),!(this instanceof Readable))return new Readable(e);this._readableState=new ReadableState(e,this),this.readable=!0,e&&"function"==typeof e.read&&(this._read=e.read),Stream.call(this)}function readableAddChunk(e,t,r,n,i){var a=chunkInvalid(t,r);if(a)e.emit("error",a);else if(null===r)t.reading=!1,onEofChunk(e,t);else if(t.objectMode||r&&r.length>0)if(t.ended&&!i){var d=new Error("stream.push() after EOF");e.emit("error",d)}else if(t.endEmitted&&i){d=new Error("stream.unshift() after end event");e.emit("error",d)}else{var o;!t.decoder||i||n||(r=t.decoder.write(r),o=!t.objectMode&&0===r.length),i||(t.reading=!1),o||(t.flowing&&0===t.length&&!t.sync?(e.emit("data",r),e.read(0)):(t.length+=t.objectMode?1:r.length,i?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&emitReadable(e))),maybeReadMore(e,t)}else i||(t.reading=!1);return needMoreData(t)}function needMoreData(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}debug=debugUtil&&debugUtil.debuglog?debugUtil.debuglog("stream"):function(){},util.inherits(Readable,Stream),Readable.prototype.push=function(e,t){var r=this._readableState;return r.objectMode||"string"!=typeof e||(t=t||r.defaultEncoding)!==r.encoding&&(e=new Buffer(e,t),t=""),readableAddChunk(this,r,e,t,!1)},Readable.prototype.unshift=function(e){return readableAddChunk(this,this._readableState,e,"",!0)},Readable.prototype.isPaused=function(){return!1===this._readableState.flowing},Readable.prototype.setEncoding=function(e){return StringDecoder||(StringDecoder=require("string_decoder/").StringDecoder),this._readableState.decoder=new StringDecoder(e),this._readableState.encoding=e,this};var MAX_HWM=8388608;function computeNewHighWaterMark(e){return e>=MAX_HWM?e=MAX_HWM:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}function howMuchToRead(e,t){return 0===t.length&&t.ended?0:t.objectMode?0===e?0:1:null===e||isNaN(e)?t.flowing&&t.buffer.length?t.buffer[0].length:t.length:e<=0?0:(e>t.highWaterMark&&(t.highWaterMark=computeNewHighWaterMark(e)),e>t.length?t.ended?t.length:(t.needReadable=!0,0):e)}function chunkInvalid(e,t){var r=null;return Buffer.isBuffer(t)||"string"==typeof t||null===t||void 0===t||e.objectMode||(r=new TypeError("Invalid non-string/buffer chunk")),r}function onEofChunk(e,t){if(!t.ended){if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,emitReadable(e)}}function emitReadable(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(debug("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?processNextTick(emitReadable_,e):emitReadable_(e))}function emitReadable_(e){debug("emit readable"),e.emit("readable"),flow(e)}function maybeReadMore(e,t){t.readingMore||(t.readingMore=!0,processNextTick(maybeReadMore_,e,t))}function maybeReadMore_(e,t){for(var r=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(debug("maybeReadMore read 0"),e.read(0),r!==t.length);)r=t.length;t.readingMore=!1}function pipeOnDrain(e){return function(){var t=e._readableState;debug("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&EElistenerCount(e,"data")&&(t.flowing=!0,flow(e))}}function nReadingNextTick(e){debug("readable nexttick read 0"),e.read(0)}function resume(e,t){t.resumeScheduled||(t.resumeScheduled=!0,processNextTick(resume_,e,t))}function resume_(e,t){t.reading||(debug("resume read 0"),e.read(0)),t.resumeScheduled=!1,e.emit("resume"),flow(e),t.flowing&&!t.reading&&e.read(0)}function flow(e){var t=e._readableState;if(debug("flow",t.flowing),t.flowing)do{var r=e.read()}while(null!==r&&t.flowing)}function fromList(e,t){var r,n=t.buffer,i=t.length,a=!!t.decoder,d=!!t.objectMode;if(0===n.length)return null;if(0===i)r=null;else if(d)r=n.shift();else if(!e||e>=i)r=a?n.join(""):1===n.length?n[0]:Buffer.concat(n,i),n.length=0;else{if(e<n[0].length)r=(s=n[0]).slice(0,e),n[0]=s.slice(e);else if(e===n[0].length)r=n.shift();else{r=a?"":new Buffer(e);for(var o=0,l=0,u=n.length;l<u&&o<e;l++){var s=n[0],h=Math.min(e-o,s.length);a?r+=s.slice(0,h):s.copy(r,o,0,h),h<s.length?n[0]=s.slice(h):n.shift(),o+=h}}}return r}function endReadable(e){var t=e._readableState;if(t.length>0)throw new Error("endReadable called on non-empty stream");t.endEmitted||(t.ended=!0,processNextTick(endReadableNT,t,e))}function endReadableNT(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function forEach(e,t){for(var r=0,n=e.length;r<n;r++)t(e[r],r)}function indexOf(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}Readable.prototype.read=function(e){debug("read",e);var t=this._readableState,r=e;if(("number"!=typeof e||e>0)&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return debug("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?endReadable(this):emitReadable(this),null;if(0===(e=howMuchToRead(e,t))&&t.ended)return 0===t.length&&endReadable(this),null;var n,i=t.needReadable;return debug("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&debug("length less than watermark",i=!0),(t.ended||t.reading)&&debug("reading or ended",i=!1),i&&(debug("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1),i&&!t.reading&&(e=howMuchToRead(r,t)),null===(n=e>0?fromList(e,t):null)&&(t.needReadable=!0,e=0),t.length-=e,0!==t.length||t.ended||(t.needReadable=!0),r!==e&&t.ended&&0===t.length&&endReadable(this),null!==n&&this.emit("data",n),n},Readable.prototype._read=function(e){this.emit("error",new Error("not implemented"))},Readable.prototype.pipe=function(e,t){var r=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=e;break;case 1:n.pipes=[n.pipes,e];break;default:n.pipes.push(e)}n.pipesCount+=1,debug("pipe count=%d opts=%j",n.pipesCount,t);var i=(!t||!1!==t.end)&&e!==process.stdout&&e!==process.stderr?d:u;function a(e){debug("onunpipe"),e===r&&u()}function d(){debug("onend"),e.end()}n.endEmitted?processNextTick(i):r.once("end",i),e.on("unpipe",a);var o=pipeOnDrain(r);e.on("drain",o);var l=!1;function u(){debug("cleanup"),e.removeListener("close",f),e.removeListener("finish",p),e.removeListener("drain",o),e.removeListener("error",h),e.removeListener("unpipe",a),r.removeListener("end",d),r.removeListener("end",u),r.removeListener("data",s),l=!0,!n.awaitDrain||e._writableState&&!e._writableState.needDrain||o()}function s(t){debug("ondata"),!1===e.write(t)&&(1!==n.pipesCount||n.pipes[0]!==e||1!==r.listenerCount("data")||l||(debug("false write response, pause",r._readableState.awaitDrain),r._readableState.awaitDrain++),r.pause())}function h(t){debug("onerror",t),c(),e.removeListener("error",h),0===EElistenerCount(e,"error")&&e.emit("error",t)}function f(){e.removeListener("finish",p),c()}function p(){debug("onfinish"),e.removeListener("close",f),c()}function c(){debug("unpipe"),r.unpipe(e)}return r.on("data",s),e._events&&e._events.error?isArray(e._events.error)?e._events.error.unshift(h):e._events.error=[h,e._events.error]:e.on("error",h),e.once("close",f),e.once("finish",p),e.emit("pipe",r),n.flowing||(debug("pipe resume"),r.resume()),e},Readable.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this),this);if(!e){var r=t.pipes,n=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var i=0;i<n;i++)r[i].emit("unpipe",this);return this}var a=indexOf(t.pipes,e);return-1===a?this:(t.pipes.splice(a,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this),this)},Readable.prototype.on=function(e,t){var r=Stream.prototype.on.call(this,e,t);if("data"===e&&!1!==this._readableState.flowing&&this.resume(),"readable"===e&&!this._readableState.endEmitted){var n=this._readableState;n.readableListening||(n.readableListening=!0,n.emittedReadable=!1,n.needReadable=!0,n.reading?n.length&&emitReadable(this,n):processNextTick(nReadingNextTick,this))}return r},Readable.prototype.addListener=Readable.prototype.on,Readable.prototype.resume=function(){var e=this._readableState;return e.flowing||(debug("resume"),e.flowing=!0,resume(this,e)),this},Readable.prototype.pause=function(){return debug("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(debug("pause"),this._readableState.flowing=!1,this.emit("pause")),this},Readable.prototype.wrap=function(e){var t=this._readableState,r=!1,n=this;for(var i in e.on("end",function(){if(debug("wrapped end"),t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&n.push(e)}n.push(null)}),e.on("data",function(i){(debug("wrapped data"),t.decoder&&(i=t.decoder.write(i)),!t.objectMode||null!==i&&void 0!==i)&&((t.objectMode||i&&i.length)&&(n.push(i)||(r=!0,e.pause())))}),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));return forEach(["error","close","destroy","pause","resume"],function(t){e.on(t,n.emit.bind(n,t))}),n._read=function(t){debug("wrapped _read",t),r&&(r=!1,e.resume())},n},Readable._fromList=fromList;

}).call(this,require('_process'))
},{"./_stream_duplex":133,"_process":140,"buffer":52,"core-util-is":53,"events":65,"inherits":130,"isarray":96,"process-nextick-args":132,"stream":287,"string_decoder/":288,"util":51}],135:[function(require,module,exports){
"use strict";module.exports=Transform;var Duplex=require("./_stream_duplex"),util=require("core-util-is");function TransformState(r){this.afterTransform=function(t,n){return afterTransform(r,t,n)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function afterTransform(r,t,n){var e=r._transformState;e.transforming=!1;var i=e.writecb;if(!i)return r.emit("error",new Error("no writecb in Transform class"));e.writechunk=null,e.writecb=null,null!==n&&void 0!==n&&r.push(n),i(t);var a=r._readableState;a.reading=!1,(a.needReadable||a.length<a.highWaterMark)&&r._read(a.highWaterMark)}function Transform(r){if(!(this instanceof Transform))return new Transform(r);Duplex.call(this,r),this._transformState=new TransformState(this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,r&&("function"==typeof r.transform&&(this._transform=r.transform),"function"==typeof r.flush&&(this._flush=r.flush)),this.once("prefinish",function(){"function"==typeof this._flush?this._flush(function(r){done(t,r)}):done(t)})}function done(r,t){if(t)return r.emit("error",t);var n=r._writableState,e=r._transformState;if(n.length)throw new Error("calling transform done when ws.length != 0");if(e.transforming)throw new Error("calling transform done when still transforming");return r.push(null)}util.inherits=require("inherits"),util.inherits(Transform,Duplex),Transform.prototype.push=function(r,t){return this._transformState.needTransform=!1,Duplex.prototype.push.call(this,r,t)},Transform.prototype._transform=function(r,t,n){throw new Error("not implemented")},Transform.prototype._write=function(r,t,n){var e=this._transformState;if(e.writecb=n,e.writechunk=r,e.writeencoding=t,!e.transforming){var i=this._readableState;(e.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},Transform.prototype._read=function(r){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0};

},{"./_stream_duplex":133,"core-util-is":53,"inherits":130}],136:[function(require,module,exports){
(function (process){
"use strict";module.exports=Writable;var processNextTick=require("process-nextick-args"),asyncWrite=!process.browser&&["v0.10","v0.9."].indexOf(process.version.slice(0,5))>-1?setImmediate:processNextTick,Buffer=require("buffer").Buffer;Writable.WritableState=WritableState;var util=require("core-util-is");util.inherits=require("inherits");var Stream,internalUtil={deprecate:require("util-deprecate")};!function(){try{Stream=require("stream")}catch(e){}finally{Stream||(Stream=require("events").EventEmitter)}}();var Duplex;Buffer=require("buffer").Buffer;function nop(){}function WriteReq(e,t,r){this.chunk=e,this.encoding=t,this.callback=r,this.next=null}function WritableState(e,t){Duplex=Duplex||require("./_stream_duplex"),e=e||{},this.objectMode=!!e.objectMode,t instanceof Duplex&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var r=e.highWaterMark,i=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:i,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var n=!1===e.decodeStrings;this.decodeStrings=!n,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){onwrite(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new CorkedRequest(this),this.corkedRequestsFree.next=new CorkedRequest(this)}function Writable(e){if(Duplex=Duplex||require("./_stream_duplex"),!(this instanceof Writable||this instanceof Duplex))return new Writable(e);this._writableState=new WritableState(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev)),Stream.call(this)}function writeAfterEnd(e,t){var r=new Error("write after end");e.emit("error",r),processNextTick(t,r)}function validChunk(e,t,r,i){var n=!0;if(!Buffer.isBuffer(r)&&"string"!=typeof r&&null!==r&&void 0!==r&&!t.objectMode){var s=new TypeError("Invalid non-string/buffer chunk");e.emit("error",s),processNextTick(i,s),n=!1}return n}function decodeChunk(e,t,r){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=new Buffer(t,r)),t}function writeOrBuffer(e,t,r,i,n){r=decodeChunk(t,r,i),Buffer.isBuffer(r)&&(i="buffer");var s=t.objectMode?1:r.length;t.length+=s;var f=t.length<t.highWaterMark;if(f||(t.needDrain=!0),t.writing||t.corked){var u=t.lastBufferedRequest;t.lastBufferedRequest=new WriteReq(r,i,n),u?u.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else doWrite(e,t,!1,s,r,i,n);return f}function doWrite(e,t,r,i,n,s,f){t.writelen=i,t.writecb=f,t.writing=!0,t.sync=!0,r?e._writev(n,t.onwrite):e._write(n,s,t.onwrite),t.sync=!1}function onwriteError(e,t,r,i,n){--t.pendingcb,r?processNextTick(n,i):n(i),e._writableState.errorEmitted=!0,e.emit("error",i)}function onwriteStateUpdate(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function onwrite(e,t){var r=e._writableState,i=r.sync,n=r.writecb;if(onwriteStateUpdate(r),t)onwriteError(e,r,i,t,n);else{var s=needFinish(r);s||r.corked||r.bufferProcessing||!r.bufferedRequest||clearBuffer(e,r),i?asyncWrite(afterWrite,e,r,s,n):afterWrite(e,r,s,n)}}function afterWrite(e,t,r,i){r||onwriteDrain(e,t),t.pendingcb--,i(),finishMaybe(e,t)}function onwriteDrain(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}function clearBuffer(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var i=t.bufferedRequestCount,n=new Array(i),s=t.corkedRequestsFree;s.entry=r;for(var f=0;r;)n[f]=r,r=r.next,f+=1;doWrite(e,t,!0,t.length,n,"",s.finish),t.pendingcb++,t.lastBufferedRequest=null,t.corkedRequestsFree=s.next,s.next=null}else{for(;r;){var u=r.chunk,o=r.encoding,a=r.callback;if(doWrite(e,t,!1,t.objectMode?1:u.length,u,o,a),r=r.next,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequestCount=0,t.bufferedRequest=r,t.bufferProcessing=!1}function needFinish(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function prefinish(e,t){t.prefinished||(t.prefinished=!0,e.emit("prefinish"))}function finishMaybe(e,t){var r=needFinish(t);return r&&(0===t.pendingcb?(prefinish(e,t),t.finished=!0,e.emit("finish")):prefinish(e,t)),r}function endWritable(e,t,r){t.ending=!0,finishMaybe(e,t),r&&(t.finished?processNextTick(r):e.once("finish",r)),t.ended=!0,e.writable=!1}function CorkedRequest(e){var t=this;this.next=null,this.entry=null,this.finish=function(r){var i=t.entry;for(t.entry=null;i;){var n=i.callback;e.pendingcb--,n(r),i=i.next}e.corkedRequestsFree?e.corkedRequestsFree.next=t:e.corkedRequestsFree=t}}util.inherits(Writable,Stream),WritableState.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(WritableState.prototype,"buffer",{get:internalUtil.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")})}catch(e){}}(),Writable.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},Writable.prototype.write=function(e,t,r){var i=this._writableState,n=!1;return"function"==typeof t&&(r=t,t=null),Buffer.isBuffer(e)?t="buffer":t||(t=i.defaultEncoding),"function"!=typeof r&&(r=nop),i.ended?writeAfterEnd(this,r):validChunk(this,i,e,r)&&(i.pendingcb++,n=writeOrBuffer(this,i,e,t,r)),n},Writable.prototype.cork=function(){this._writableState.corked++},Writable.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||clearBuffer(this,e))},Writable.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);this._writableState.defaultEncoding=e},Writable.prototype._write=function(e,t,r){r(new Error("not implemented"))},Writable.prototype._writev=null,Writable.prototype.end=function(e,t,r){var i=this._writableState;"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!==e&&void 0!==e&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),i.ending||i.finished||endWritable(this,i,r)};

}).call(this,require('_process'))
},{"./_stream_duplex":133,"_process":140,"buffer":52,"core-util-is":53,"events":65,"inherits":130,"process-nextick-args":132,"stream":287,"util-deprecate":306}],137:[function(require,module,exports){
module.exports=require("./lib/_stream_transform.js");

},{"./lib/_stream_transform.js":135}],138:[function(require,module,exports){
(function (process){
var Transform=require("readable-stream/transform"),inherits=require("util").inherits,xtend=require("xtend");function DestroyableTransform(r){Transform.call(this,r),this._destroyed=!1}function noop(r,t,o){o(null,r)}function through2(r){return function(t,o,e){return"function"==typeof t&&(e=o,o=t,t={}),"function"!=typeof o&&(o=noop),"function"!=typeof e&&(e=null),r(t,o,e)}}inherits(DestroyableTransform,Transform),DestroyableTransform.prototype.destroy=function(r){if(!this._destroyed){this._destroyed=!0;var t=this;process.nextTick(function(){r&&t.emit("error",r),t.emit("close")})}},module.exports=through2(function(r,t,o){var e=new DestroyableTransform(r);return e._transform=t,o&&(e._flush=o),e}),module.exports.ctor=through2(function(r,t,o){function e(t){if(!(this instanceof e))return new e(t);this.options=xtend(r,t),DestroyableTransform.call(this,this.options)}return inherits(e,DestroyableTransform),e.prototype._transform=t,o&&(e.prototype._flush=o),e}),module.exports.obj=through2(function(r,t,o){var e=new DestroyableTransform(xtend({objectMode:!0,highWaterMark:16},r));return e._transform=t,o&&(e._flush=o),e});

}).call(this,require('_process'))
},{"_process":140,"readable-stream/transform":137,"util":309,"xtend":311}],139:[function(require,module,exports){
(function (process){
"use strict";function nextTick(e,n,c,r){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var s,t,o=arguments.length;switch(o){case 0:case 1:return process.nextTick(e);case 2:return process.nextTick(function(){e.call(null,n)});case 3:return process.nextTick(function(){e.call(null,n,c)});case 4:return process.nextTick(function(){e.call(null,n,c,r)});default:for(s=new Array(o-1),t=0;t<s.length;)s[t++]=arguments[t];return process.nextTick(function(){e.apply(null,s)})}}!process.version||0===process.version.indexOf("v0.")||0===process.version.indexOf("v1.")&&0!==process.version.indexOf("v1.8.")?module.exports={nextTick:nextTick}:module.exports=process;

}).call(this,require('_process'))
},{"_process":140}],140:[function(require,module,exports){
var cachedSetTimeout,cachedClearTimeout,process=module.exports={};function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(e){if(cachedSetTimeout===setTimeout)return setTimeout(e,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(e,0);try{return cachedSetTimeout(e,0)}catch(t){try{return cachedSetTimeout.call(null,e,0)}catch(t){return cachedSetTimeout.call(this,e,0)}}}function runClearTimeout(e){if(cachedClearTimeout===clearTimeout)return clearTimeout(e);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(e);try{return cachedClearTimeout(e)}catch(t){try{return cachedClearTimeout.call(null,e)}catch(t){return cachedClearTimeout.call(this,e)}}}!function(){try{cachedSetTimeout="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){cachedSetTimeout=defaultSetTimout}try{cachedClearTimeout="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){cachedClearTimeout=defaultClearTimeout}}();var currentQueue,queue=[],draining=!1,queueIndex=-1;function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var e=runTimeout(cleanUpNextTick);draining=!0;for(var t=queue.length;t;){for(currentQueue=queue,queue=[];++queueIndex<t;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,t=queue.length}currentQueue=null,draining=!1,runClearTimeout(e)}}function Item(e,t){this.fun=e,this.array=t}function noop(){}process.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];queue.push(new Item(e,t)),1!==queue.length||draining||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.prependListener=noop,process.prependOnceListener=noop,process.listeners=function(e){return[]},process.binding=function(e){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(e){throw new Error("process.chdir is not supported")},process.umask=function(){return 0};

},{}],141:[function(require,module,exports){
!function(e,n,r){"undefined"!=typeof module&&module.exports?module.exports=r():n.prr=r()}(0,this,function(){var e="function"==typeof Object.defineProperty?function(e,n,r){return Object.defineProperty(e,n,r),e}:function(e,n,r){return e[n]=r.value,e};return function(n,r,t,o){var u;if(o=function(e,n){var r="object"==typeof n,t=!r&&"string"==typeof n,o=function(e){return r?!!n[e]:!!t&&n.indexOf(e[0])>-1};return{enumerable:o("enumerable"),configurable:o("configurable"),writable:o("writable"),value:e}}(t,o),"object"==typeof r){for(u in r)Object.hasOwnProperty.call(r,u)&&(o.value=r[u],e(n,u,o));return n}return e(n,r,o)}});

},{}],142:[function(require,module,exports){
"use strict";module.exports=require("react/lib/ReactDOM");

},{"react/lib/ReactDOM":177}],143:[function(require,module,exports){
"use strict";var ReactMount=require("./ReactMount"),findDOMNode=require("./findDOMNode"),focusNode=require("fbjs/lib/focusNode"),Mixin={componentDidMount:function(){this.props.autoFocus&&focusNode(findDOMNode(this))}},AutoFocusUtils={Mixin:Mixin,focusDOMComponent:function(){focusNode(ReactMount.getNode(this._rootNodeID))}};module.exports=AutoFocusUtils;

},{"./ReactMount":205,"./findDOMNode":248,"fbjs/lib/focusNode":75}],144:[function(require,module,exports){
"use strict";var EventConstants=require("./EventConstants"),EventPropagators=require("./EventPropagators"),ExecutionEnvironment=require("fbjs/lib/ExecutionEnvironment"),FallbackCompositionState=require("./FallbackCompositionState"),SyntheticCompositionEvent=require("./SyntheticCompositionEvent"),SyntheticInputEvent=require("./SyntheticInputEvent"),keyOf=require("fbjs/lib/keyOf"),END_KEYCODES=[9,13,27,32],START_KEYCODE=229,canUseCompositionEvent=ExecutionEnvironment.canUseDOM&&"CompositionEvent"in window,documentMode=null;ExecutionEnvironment.canUseDOM&&"documentMode"in document&&(documentMode=document.documentMode);var canUseTextInputEvent=ExecutionEnvironment.canUseDOM&&"TextEvent"in window&&!documentMode&&!isPresto(),useFallbackCompositionData=ExecutionEnvironment.canUseDOM&&(!canUseCompositionEvent||documentMode&&documentMode>8&&documentMode<=11);function isPresto(){var e=window.opera;return"object"==typeof e&&"function"==typeof e.version&&parseInt(e.version(),10)<=12}var SPACEBAR_CODE=32,SPACEBAR_CHAR=String.fromCharCode(SPACEBAR_CODE),topLevelTypes=EventConstants.topLevelTypes,eventTypes={beforeInput:{phasedRegistrationNames:{bubbled:keyOf({onBeforeInput:null}),captured:keyOf({onBeforeInputCapture:null})},dependencies:[topLevelTypes.topCompositionEnd,topLevelTypes.topKeyPress,topLevelTypes.topTextInput,topLevelTypes.topPaste]},compositionEnd:{phasedRegistrationNames:{bubbled:keyOf({onCompositionEnd:null}),captured:keyOf({onCompositionEndCapture:null})},dependencies:[topLevelTypes.topBlur,topLevelTypes.topCompositionEnd,topLevelTypes.topKeyDown,topLevelTypes.topKeyPress,topLevelTypes.topKeyUp,topLevelTypes.topMouseDown]},compositionStart:{phasedRegistrationNames:{bubbled:keyOf({onCompositionStart:null}),captured:keyOf({onCompositionStartCapture:null})},dependencies:[topLevelTypes.topBlur,topLevelTypes.topCompositionStart,topLevelTypes.topKeyDown,topLevelTypes.topKeyPress,topLevelTypes.topKeyUp,topLevelTypes.topMouseDown]},compositionUpdate:{phasedRegistrationNames:{bubbled:keyOf({onCompositionUpdate:null}),captured:keyOf({onCompositionUpdateCapture:null})},dependencies:[topLevelTypes.topBlur,topLevelTypes.topCompositionUpdate,topLevelTypes.topKeyDown,topLevelTypes.topKeyPress,topLevelTypes.topKeyUp,topLevelTypes.topMouseDown]}},hasSpaceKeypress=!1;function isKeypressCommand(e){return(e.ctrlKey||e.altKey||e.metaKey)&&!(e.ctrlKey&&e.altKey)}function getCompositionEventType(e){switch(e){case topLevelTypes.topCompositionStart:return eventTypes.compositionStart;case topLevelTypes.topCompositionEnd:return eventTypes.compositionEnd;case topLevelTypes.topCompositionUpdate:return eventTypes.compositionUpdate}}function isFallbackCompositionStart(e,t){return e===topLevelTypes.topKeyDown&&t.keyCode===START_KEYCODE}function isFallbackCompositionEnd(e,t){switch(e){case topLevelTypes.topKeyUp:return-1!==END_KEYCODES.indexOf(t.keyCode);case topLevelTypes.topKeyDown:return t.keyCode!==START_KEYCODE;case topLevelTypes.topKeyPress:case topLevelTypes.topMouseDown:case topLevelTypes.topBlur:return!0;default:return!1}}function getDataFromCustomEvent(e){var t=e.detail;return"object"==typeof t&&"data"in t?t.data:null}var currentComposition=null;function extractCompositionEvent(e,t,o,n,p){var s,i;if(canUseCompositionEvent?s=getCompositionEventType(e):currentComposition?isFallbackCompositionEnd(e,n)&&(s=eventTypes.compositionEnd):isFallbackCompositionStart(e,n)&&(s=eventTypes.compositionStart),!s)return null;useFallbackCompositionData&&(currentComposition||s!==eventTypes.compositionStart?s===eventTypes.compositionEnd&&currentComposition&&(i=currentComposition.getData()):currentComposition=FallbackCompositionState.getPooled(t));var r=SyntheticCompositionEvent.getPooled(s,o,n,p);if(i)r.data=i;else{var a=getDataFromCustomEvent(n);null!==a&&(r.data=a)}return EventPropagators.accumulateTwoPhaseDispatches(r),r}function getNativeBeforeInputChars(e,t){switch(e){case topLevelTypes.topCompositionEnd:return getDataFromCustomEvent(t);case topLevelTypes.topKeyPress:return t.which!==SPACEBAR_CODE?null:(hasSpaceKeypress=!0,SPACEBAR_CHAR);case topLevelTypes.topTextInput:var o=t.data;return o===SPACEBAR_CHAR&&hasSpaceKeypress?null:o;default:return null}}function getFallbackBeforeInputChars(e,t){if(currentComposition){if(e===topLevelTypes.topCompositionEnd||isFallbackCompositionEnd(e,t)){var o=currentComposition.getData();return FallbackCompositionState.release(currentComposition),currentComposition=null,o}return null}switch(e){case topLevelTypes.topPaste:return null;case topLevelTypes.topKeyPress:return t.which&&!isKeypressCommand(t)?String.fromCharCode(t.which):null;case topLevelTypes.topCompositionEnd:return useFallbackCompositionData?null:t.data;default:return null}}function extractBeforeInputEvent(e,t,o,n,p){var s;if(!(s=canUseTextInputEvent?getNativeBeforeInputChars(e,n):getFallbackBeforeInputChars(e,n)))return null;var i=SyntheticInputEvent.getPooled(eventTypes.beforeInput,o,n,p);return i.data=s,EventPropagators.accumulateTwoPhaseDispatches(i),i}var BeforeInputEventPlugin={eventTypes:eventTypes,extractEvents:function(e,t,o,n,p){return[extractCompositionEvent(e,t,o,n,p),extractBeforeInputEvent(e,t,o,n,p)]}};module.exports=BeforeInputEventPlugin;

},{"./EventConstants":156,"./EventPropagators":160,"./FallbackCompositionState":161,"./SyntheticCompositionEvent":230,"./SyntheticInputEvent":234,"fbjs/lib/ExecutionEnvironment":67,"fbjs/lib/keyOf":85}],145:[function(require,module,exports){
"use strict";var isUnitlessNumber={animationIterationCount:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,stopOpacity:!0,strokeDashoffset:!0,strokeOpacity:!0,strokeWidth:!0};function prefixKey(o,r){return o+r.charAt(0).toUpperCase()+r.substring(1)}var prefixes=["Webkit","ms","Moz","O"];Object.keys(isUnitlessNumber).forEach(function(o){prefixes.forEach(function(r){isUnitlessNumber[prefixKey(r,o)]=isUnitlessNumber[o]})});var shorthandPropertyExpansions={background:{backgroundAttachment:!0,backgroundColor:!0,backgroundImage:!0,backgroundPositionX:!0,backgroundPositionY:!0,backgroundRepeat:!0},backgroundPosition:{backgroundPositionX:!0,backgroundPositionY:!0},border:{borderWidth:!0,borderStyle:!0,borderColor:!0},borderBottom:{borderBottomWidth:!0,borderBottomStyle:!0,borderBottomColor:!0},borderLeft:{borderLeftWidth:!0,borderLeftStyle:!0,borderLeftColor:!0},borderRight:{borderRightWidth:!0,borderRightStyle:!0,borderRightColor:!0},borderTop:{borderTopWidth:!0,borderTopStyle:!0,borderTopColor:!0},font:{fontStyle:!0,fontVariant:!0,fontWeight:!0,fontSize:!0,lineHeight:!0,fontFamily:!0},outline:{outlineWidth:!0,outlineStyle:!0,outlineColor:!0}},CSSProperty={isUnitlessNumber:isUnitlessNumber,shorthandPropertyExpansions:shorthandPropertyExpansions};module.exports=CSSProperty;

},{}],146:[function(require,module,exports){
"use strict";var badVendoredStyleNamePattern,badStyleValueWithSemicolonPattern,warnedStyleNames,warnedStyleValues,warnHyphenatedStyleName,warnBadVendoredStyleName,warnStyleValueWithSemicolon,warnValidStyle,CSSProperty=require("./CSSProperty"),ExecutionEnvironment=require("fbjs/lib/ExecutionEnvironment"),ReactPerf=require("./ReactPerf"),camelizeStyleName=require("fbjs/lib/camelizeStyleName"),dangerousStyleValue=require("./dangerousStyleValue"),hyphenateStyleName=require("fbjs/lib/hyphenateStyleName"),memoizeStringOnly=require("fbjs/lib/memoizeStringOnly"),warning=require("fbjs/lib/warning"),processStyleName=memoizeStringOnly(function(e){return hyphenateStyleName(e)}),hasShorthandPropertyBug=!1,styleFloatAccessor="cssFloat";if(ExecutionEnvironment.canUseDOM){var tempStyle=document.createElement("div").style;try{tempStyle.font=""}catch(e){hasShorthandPropertyBug=!0}void 0===document.documentElement.style.cssFloat&&(styleFloatAccessor="styleFloat")}var CSSPropertyOperations={createMarkupForStyles:function(e){var r="";for(var t in e)if(e.hasOwnProperty(t)){var a=e[t];0,null!=a&&(r+=processStyleName(t)+":",r+=dangerousStyleValue(t,a)+";")}return r||null},setValueForStyles:function(e,r){var t=e.style;for(var a in r)if(r.hasOwnProperty(a)){0;var n=dangerousStyleValue(a,r[a]);if("float"===a&&(a=styleFloatAccessor),n)t[a]=n;else{var l=hasShorthandPropertyBug&&CSSProperty.shorthandPropertyExpansions[a];if(l)for(var o in l)t[o]="";else t[a]=""}}}};ReactPerf.measureMethods(CSSPropertyOperations,"CSSPropertyOperations",{setValueForStyles:"setValueForStyles"}),module.exports=CSSPropertyOperations;

},{"./CSSProperty":145,"./ReactPerf":211,"./dangerousStyleValue":245,"fbjs/lib/ExecutionEnvironment":67,"fbjs/lib/camelizeStyleName":69,"fbjs/lib/hyphenateStyleName":80,"fbjs/lib/memoizeStringOnly":87,"fbjs/lib/warning":90}],147:[function(require,module,exports){
"use strict";var PooledClass=require("./PooledClass"),assign=require("./Object.assign"),invariant=require("fbjs/lib/invariant");function CallbackQueue(){this._callbacks=null,this._contexts=null}assign(CallbackQueue.prototype,{enqueue:function(t,l){this._callbacks=this._callbacks||[],this._contexts=this._contexts||[],this._callbacks.push(t),this._contexts.push(l)},notifyAll:function(){var t=this._callbacks,l=this._contexts;if(t){t.length!==l.length&&invariant(!1),this._callbacks=null,this._contexts=null;for(var s=0;s<t.length;s++)t[s].call(l[s]);t.length=0,l.length=0}},reset:function(){this._callbacks=null,this._contexts=null},destructor:function(){this.reset()}}),PooledClass.addPoolingTo(CallbackQueue),module.exports=CallbackQueue;

},{"./Object.assign":164,"./PooledClass":165,"fbjs/lib/invariant":81}],148:[function(require,module,exports){
"use strict";var EventConstants=require("./EventConstants"),EventPluginHub=require("./EventPluginHub"),EventPropagators=require("./EventPropagators"),ExecutionEnvironment=require("fbjs/lib/ExecutionEnvironment"),ReactUpdates=require("./ReactUpdates"),SyntheticEvent=require("./SyntheticEvent"),getEventTarget=require("./getEventTarget"),isEventSupported=require("./isEventSupported"),isTextInputElement=require("./isTextInputElement"),keyOf=require("fbjs/lib/keyOf"),topLevelTypes=EventConstants.topLevelTypes,eventTypes={change:{phasedRegistrationNames:{bubbled:keyOf({onChange:null}),captured:keyOf({onChangeCapture:null})},dependencies:[topLevelTypes.topBlur,topLevelTypes.topChange,topLevelTypes.topClick,topLevelTypes.topFocus,topLevelTypes.topInput,topLevelTypes.topKeyDown,topLevelTypes.topKeyUp,topLevelTypes.topSelectionChange]}},activeElement=null,activeElementID=null,activeElementValue=null,activeElementValueProp=null;function shouldUseChangeEvent(e){var t=e.nodeName&&e.nodeName.toLowerCase();return"select"===t||"input"===t&&"file"===e.type}var doesChangeEventBubble=!1;function manualDispatchChangeEvent(e){var t=SyntheticEvent.getPooled(eventTypes.change,activeElementID,e,getEventTarget(e));EventPropagators.accumulateTwoPhaseDispatches(t),ReactUpdates.batchedUpdates(runEventInBatch,t)}function runEventInBatch(e){EventPluginHub.enqueueEvents(e),EventPluginHub.processEventQueue(!1)}function startWatchingForChangeEventIE8(e,t){activeElementID=t,(activeElement=e).attachEvent("onchange",manualDispatchChangeEvent)}function stopWatchingForChangeEventIE8(){activeElement&&(activeElement.detachEvent("onchange",manualDispatchChangeEvent),activeElement=null,activeElementID=null)}function getTargetIDForChangeEvent(e,t,n){if(e===topLevelTypes.topChange)return n}function handleEventsForChangeEventIE8(e,t,n){e===topLevelTypes.topFocus?(stopWatchingForChangeEventIE8(),startWatchingForChangeEventIE8(t,n)):e===topLevelTypes.topBlur&&stopWatchingForChangeEventIE8()}ExecutionEnvironment.canUseDOM&&(doesChangeEventBubble=isEventSupported("change")&&(!("documentMode"in document)||document.documentMode>8));var isInputEventSupported=!1;ExecutionEnvironment.canUseDOM&&(isInputEventSupported=isEventSupported("input")&&(!("documentMode"in document)||document.documentMode>9));var newValueProp={get:function(){return activeElementValueProp.get.call(this)},set:function(e){activeElementValue=""+e,activeElementValueProp.set.call(this,e)}};function startWatchingForValueChange(e,t){activeElement=e,activeElementID=t,activeElementValue=e.value,activeElementValueProp=Object.getOwnPropertyDescriptor(e.constructor.prototype,"value"),Object.defineProperty(activeElement,"value",newValueProp),activeElement.attachEvent("onpropertychange",handlePropertyChange)}function stopWatchingForValueChange(){activeElement&&(delete activeElement.value,activeElement.detachEvent("onpropertychange",handlePropertyChange),activeElement=null,activeElementID=null,activeElementValue=null,activeElementValueProp=null)}function handlePropertyChange(e){if("value"===e.propertyName){var t=e.srcElement.value;t!==activeElementValue&&(activeElementValue=t,manualDispatchChangeEvent(e))}}function getTargetIDForInputEvent(e,t,n){if(e===topLevelTypes.topInput)return n}function handleEventsForInputEventIE(e,t,n){e===topLevelTypes.topFocus?(stopWatchingForValueChange(),startWatchingForValueChange(t,n)):e===topLevelTypes.topBlur&&stopWatchingForValueChange()}function getTargetIDForInputEventIE(e,t,n){if((e===topLevelTypes.topSelectionChange||e===topLevelTypes.topKeyUp||e===topLevelTypes.topKeyDown)&&activeElement&&activeElement.value!==activeElementValue)return activeElementValue=activeElement.value,activeElementID}function shouldUseClickEvent(e){return e.nodeName&&"input"===e.nodeName.toLowerCase()&&("checkbox"===e.type||"radio"===e.type)}function getTargetIDForClickEvent(e,t,n){if(e===topLevelTypes.topClick)return n}var ChangeEventPlugin={eventTypes:eventTypes,extractEvents:function(e,t,n,a,o){var l,u;if(shouldUseChangeEvent(t)?doesChangeEventBubble?l=getTargetIDForChangeEvent:u=handleEventsForChangeEventIE8:isTextInputElement(t)?isInputEventSupported?l=getTargetIDForInputEvent:(l=getTargetIDForInputEventIE,u=handleEventsForInputEventIE):shouldUseClickEvent(t)&&(l=getTargetIDForClickEvent),l){var v=l(e,t,n);if(v){var p=SyntheticEvent.getPooled(eventTypes.change,v,a,o);return p.type="change",EventPropagators.accumulateTwoPhaseDispatches(p),p}}u&&u(e,t,n)}};module.exports=ChangeEventPlugin;

},{"./EventConstants":156,"./EventPluginHub":157,"./EventPropagators":160,"./ReactUpdates":223,"./SyntheticEvent":232,"./getEventTarget":254,"./isEventSupported":259,"./isTextInputElement":260,"fbjs/lib/ExecutionEnvironment":67,"fbjs/lib/keyOf":85}],149:[function(require,module,exports){
"use strict";var nextReactRootIndex=0,ClientReactRootIndex={createReactRootIndex:function(){return nextReactRootIndex++}};module.exports=ClientReactRootIndex;

},{}],150:[function(require,module,exports){
"use strict";var Danger=require("./Danger"),ReactMultiChildUpdateTypes=require("./ReactMultiChildUpdateTypes"),ReactPerf=require("./ReactPerf"),setInnerHTML=require("./setInnerHTML"),setTextContent=require("./setTextContent"),invariant=require("fbjs/lib/invariant");function insertChildAt(e,t,n){var r=n>=e.childNodes.length?null:e.childNodes.item(n);e.insertBefore(t,r)}var DOMChildrenOperations={dangerouslyReplaceNodeWithMarkup:Danger.dangerouslyReplaceNodeWithMarkup,updateTextContent:setTextContent,processUpdates:function(e,t){for(var n,r,a=null,i=null,d=0;d<e.length;d++)if((n=e[d]).type===ReactMultiChildUpdateTypes.MOVE_EXISTING||n.type===ReactMultiChildUpdateTypes.REMOVE_NODE){var l=n.fromIndex,p=n.parentNode.childNodes[l],s=n.parentID;p||invariant(!1),(a=a||{})[s]=a[s]||[],a[s][l]=p,(i=i||[]).push(p)}if(r=t.length&&"string"==typeof t[0]?Danger.dangerouslyRenderMarkup(t):t,i)for(var o=0;o<i.length;o++)i[o].parentNode.removeChild(i[o]);for(var u=0;u<e.length;u++)switch((n=e[u]).type){case ReactMultiChildUpdateTypes.INSERT_MARKUP:insertChildAt(n.parentNode,r[n.markupIndex],n.toIndex);break;case ReactMultiChildUpdateTypes.MOVE_EXISTING:insertChildAt(n.parentNode,a[n.parentID][n.fromIndex],n.toIndex);break;case ReactMultiChildUpdateTypes.SET_MARKUP:setInnerHTML(n.parentNode,n.content);break;case ReactMultiChildUpdateTypes.TEXT_CONTENT:setTextContent(n.parentNode,n.content);break;case ReactMultiChildUpdateTypes.REMOVE_NODE:}}};ReactPerf.measureMethods(DOMChildrenOperations,"DOMChildrenOperations",{updateTextContent:"updateTextContent"}),module.exports=DOMChildrenOperations;

},{"./Danger":153,"./ReactMultiChildUpdateTypes":207,"./ReactPerf":211,"./setInnerHTML":264,"./setTextContent":265,"fbjs/lib/invariant":81}],151:[function(require,module,exports){
"use strict";var invariant=require("fbjs/lib/invariant");function checkMask(t,e){return(t&e)===e}var DOMPropertyInjection={MUST_USE_ATTRIBUTE:1,MUST_USE_PROPERTY:2,HAS_SIDE_EFFECTS:4,HAS_BOOLEAN_VALUE:8,HAS_NUMERIC_VALUE:16,HAS_POSITIVE_NUMERIC_VALUE:48,HAS_OVERLOADED_BOOLEAN_VALUE:64,injectDOMPropertyConfig:function(t){var e=DOMPropertyInjection,r=t.Properties||{},a=t.DOMAttributeNamespaces||{},o=t.DOMAttributeNames||{},i=t.DOMPropertyNames||{},s=t.DOMMutationMethods||{};for(var u in t.isCustomAttribute&&DOMProperty._isCustomAttributeFunctions.push(t.isCustomAttribute),r){DOMProperty.properties.hasOwnProperty(u)&&invariant(!1);var n=u.toLowerCase(),c=r[u],E={attributeName:n,attributeNamespace:null,propertyName:u,mutationMethod:null,mustUseAttribute:checkMask(c,e.MUST_USE_ATTRIBUTE),mustUseProperty:checkMask(c,e.MUST_USE_PROPERTY),hasSideEffects:checkMask(c,e.HAS_SIDE_EFFECTS),hasBooleanValue:checkMask(c,e.HAS_BOOLEAN_VALUE),hasNumericValue:checkMask(c,e.HAS_NUMERIC_VALUE),hasPositiveNumericValue:checkMask(c,e.HAS_POSITIVE_NUMERIC_VALUE),hasOverloadedBooleanValue:checkMask(c,e.HAS_OVERLOADED_BOOLEAN_VALUE)};if(E.mustUseAttribute&&E.mustUseProperty&&invariant(!1),!E.mustUseProperty&&E.hasSideEffects&&invariant(!1),E.hasBooleanValue+E.hasNumericValue+E.hasOverloadedBooleanValue<=1||invariant(!1),o.hasOwnProperty(u)){var A=o[u];E.attributeName=A}a.hasOwnProperty(u)&&(E.attributeNamespace=a[u]),i.hasOwnProperty(u)&&(E.propertyName=i[u]),s.hasOwnProperty(u)&&(E.mutationMethod=s[u]),DOMProperty.properties[u]=E}}},defaultValueCache={},DOMProperty={ID_ATTRIBUTE_NAME:"data-reactid",properties:{},getPossibleStandardName:null,_isCustomAttributeFunctions:[],isCustomAttribute:function(t){for(var e=0;e<DOMProperty._isCustomAttributeFunctions.length;e++){if((0,DOMProperty._isCustomAttributeFunctions[e])(t))return!0}return!1},getDefaultValueForProperty:function(t,e){var r,a=defaultValueCache[t];return a||(defaultValueCache[t]=a={}),e in a||(r=document.createElement(t),a[e]=r[e]),a[e]},injection:DOMPropertyInjection};module.exports=DOMProperty;

},{"fbjs/lib/invariant":81}],152:[function(require,module,exports){
"use strict";var reactProps,warnedProperties,warnUnknownProperty,DOMProperty=require("./DOMProperty"),ReactPerf=require("./ReactPerf"),quoteAttributeValueForBrowser=require("./quoteAttributeValueForBrowser"),warning=require("fbjs/lib/warning"),VALID_ATTRIBUTE_NAME_REGEX=/^[a-zA-Z_][\w\.\-]*$/,illegalAttributeNameCache={},validatedAttributeNameCache={};function isAttributeNameSafe(e){return!!validatedAttributeNameCache.hasOwnProperty(e)||!illegalAttributeNameCache.hasOwnProperty(e)&&(VALID_ATTRIBUTE_NAME_REGEX.test(e)?(validatedAttributeNameCache[e]=!0,!0):(illegalAttributeNameCache[e]=!0,!1))}function shouldIgnoreValue(e,t){return null==t||e.hasBooleanValue&&!t||e.hasNumericValue&&isNaN(t)||e.hasPositiveNumericValue&&t<1||e.hasOverloadedBooleanValue&&!1===t}var DOMPropertyOperations={createMarkupForID:function(e){return DOMProperty.ID_ATTRIBUTE_NAME+"="+quoteAttributeValueForBrowser(e)},setAttributeForID:function(e,t){e.setAttribute(DOMProperty.ID_ATTRIBUTE_NAME,t)},createMarkupForProperty:function(e,t){var r=DOMProperty.properties.hasOwnProperty(e)?DOMProperty.properties[e]:null;if(r){if(shouldIgnoreValue(r,t))return"";var o=r.attributeName;return r.hasBooleanValue||r.hasOverloadedBooleanValue&&!0===t?o+'=""':o+"="+quoteAttributeValueForBrowser(t)}return DOMProperty.isCustomAttribute(e)?null==t?"":e+"="+quoteAttributeValueForBrowser(t):null},createMarkupForCustomAttribute:function(e,t){return isAttributeNameSafe(e)&&null!=t?e+"="+quoteAttributeValueForBrowser(t):""},setValueForProperty:function(e,t,r){var o=DOMProperty.properties.hasOwnProperty(t)?DOMProperty.properties[t]:null;if(o){var a=o.mutationMethod;if(a)a(e,r);else if(shouldIgnoreValue(o,r))this.deleteValueForProperty(e,t);else if(o.mustUseAttribute){var u=o.attributeName,i=o.attributeNamespace;i?e.setAttributeNS(i,u,""+r):o.hasBooleanValue||o.hasOverloadedBooleanValue&&!0===r?e.setAttribute(u,""):e.setAttribute(u,""+r)}else{var s=o.propertyName;o.hasSideEffects&&""+e[s]==""+r||(e[s]=r)}}else DOMProperty.isCustomAttribute(t)&&DOMPropertyOperations.setValueForAttribute(e,t,r)},setValueForAttribute:function(e,t,r){isAttributeNameSafe(t)&&(null==r?e.removeAttribute(t):e.setAttribute(t,""+r))},deleteValueForProperty:function(e,t){var r=DOMProperty.properties.hasOwnProperty(t)?DOMProperty.properties[t]:null;if(r){var o=r.mutationMethod;if(o)o(e,void 0);else if(r.mustUseAttribute)e.removeAttribute(r.attributeName);else{var a=r.propertyName,u=DOMProperty.getDefaultValueForProperty(e.nodeName,a);r.hasSideEffects&&""+e[a]===u||(e[a]=u)}}else DOMProperty.isCustomAttribute(t)&&e.removeAttribute(t)}};ReactPerf.measureMethods(DOMPropertyOperations,"DOMPropertyOperations",{setValueForProperty:"setValueForProperty",setValueForAttribute:"setValueForAttribute",deleteValueForProperty:"deleteValueForProperty"}),module.exports=DOMPropertyOperations;

},{"./DOMProperty":151,"./ReactPerf":211,"./quoteAttributeValueForBrowser":262,"fbjs/lib/warning":90}],153:[function(require,module,exports){
"use strict";var ExecutionEnvironment=require("fbjs/lib/ExecutionEnvironment"),createNodesFromMarkup=require("fbjs/lib/createNodesFromMarkup"),emptyFunction=require("fbjs/lib/emptyFunction"),getMarkupWrap=require("fbjs/lib/getMarkupWrap"),invariant=require("fbjs/lib/invariant"),OPEN_TAG_NAME_EXP=/^(<[^ \/>]+)/,RESULT_INDEX_ATTR="data-danger-index";function getNodeName(e){return e.substring(1,e.indexOf(" "))}var Danger={dangerouslyRenderMarkup:function(e){var r;ExecutionEnvironment.canUseDOM||invariant(!1);for(var n={},t=0;t<e.length;t++)e[t]||invariant(!1),r=getNodeName(e[t]),n[r=getMarkupWrap(r)?r:"*"]=n[r]||[],n[r][t]=e[t];var a=[],i=0;for(r in n)if(n.hasOwnProperty(r)){var o,u=n[r];for(o in u)if(u.hasOwnProperty(o)){var p=u[o];u[o]=p.replace(OPEN_TAG_NAME_EXP,"$1 "+RESULT_INDEX_ATTR+'="'+o+'" ')}for(var s=createNodesFromMarkup(u.join(""),emptyFunction),v=0;v<s.length;++v){var E=s[v];E.hasAttribute&&E.hasAttribute(RESULT_INDEX_ATTR)&&(o=+E.getAttribute(RESULT_INDEX_ATTR),E.removeAttribute(RESULT_INDEX_ATTR),a.hasOwnProperty(o)&&invariant(!1),a[o]=E,i+=1)}}return i!==a.length&&invariant(!1),a.length!==e.length&&invariant(!1),a},dangerouslyReplaceNodeWithMarkup:function(e,r){var n;ExecutionEnvironment.canUseDOM||invariant(!1),r||invariant(!1),"html"===e.tagName.toLowerCase()&&invariant(!1),n="string"==typeof r?createNodesFromMarkup(r,emptyFunction)[0]:r,e.parentNode.replaceChild(n,e)}};module.exports=Danger;

},{"fbjs/lib/ExecutionEnvironment":67,"fbjs/lib/createNodesFromMarkup":72,"fbjs/lib/emptyFunction":73,"fbjs/lib/getMarkupWrap":77,"fbjs/lib/invariant":81}],154:[function(require,module,exports){
"use strict";var keyOf=require("fbjs/lib/keyOf"),DefaultEventPluginOrder=[keyOf({ResponderEventPlugin:null}),keyOf({SimpleEventPlugin:null}),keyOf({TapEventPlugin:null}),keyOf({EnterLeaveEventPlugin:null}),keyOf({ChangeEventPlugin:null}),keyOf({SelectEventPlugin:null}),keyOf({BeforeInputEventPlugin:null})];module.exports=DefaultEventPluginOrder;

},{"fbjs/lib/keyOf":85}],155:[function(require,module,exports){
"use strict";var EventConstants=require("./EventConstants"),EventPropagators=require("./EventPropagators"),SyntheticMouseEvent=require("./SyntheticMouseEvent"),ReactMount=require("./ReactMount"),keyOf=require("fbjs/lib/keyOf"),topLevelTypes=EventConstants.topLevelTypes,getFirstReactDOM=ReactMount.getFirstReactDOM,eventTypes={mouseEnter:{registrationName:keyOf({onMouseEnter:null}),dependencies:[topLevelTypes.topMouseOut,topLevelTypes.topMouseOver]},mouseLeave:{registrationName:keyOf({onMouseLeave:null}),dependencies:[topLevelTypes.topMouseOut,topLevelTypes.topMouseOver]}},extractedEvents=[null,null],EnterLeaveEventPlugin={eventTypes:eventTypes,extractEvents:function(e,t,n,o,r){if(e===topLevelTypes.topMouseOver&&(o.relatedTarget||o.fromElement))return null;if(e!==topLevelTypes.topMouseOut&&e!==topLevelTypes.topMouseOver)return null;var s,a,u;if(t.window===t)s=t;else{var v=t.ownerDocument;s=v?v.defaultView||v.parentWindow:window}var p="",l="";if(e===topLevelTypes.topMouseOut?(a=t,p=n,(u=getFirstReactDOM(o.relatedTarget||o.toElement))?l=ReactMount.getID(u):u=s,u=u||s):(a=s,u=t,l=n),a===u)return null;var i=SyntheticMouseEvent.getPooled(eventTypes.mouseLeave,p,o,r);i.type="mouseleave",i.target=a,i.relatedTarget=u;var y=SyntheticMouseEvent.getPooled(eventTypes.mouseEnter,l,o,r);return y.type="mouseenter",y.target=u,y.relatedTarget=a,EventPropagators.accumulateEnterLeaveDispatches(i,y,p,l),extractedEvents[0]=i,extractedEvents[1]=y,extractedEvents}};module.exports=EnterLeaveEventPlugin;

},{"./EventConstants":156,"./EventPropagators":160,"./ReactMount":205,"./SyntheticMouseEvent":236,"fbjs/lib/keyOf":85}],156:[function(require,module,exports){
"use strict";var keyMirror=require("fbjs/lib/keyMirror"),PropagationPhases=keyMirror({bubbled:null,captured:null}),topLevelTypes=keyMirror({topAbort:null,topBlur:null,topCanPlay:null,topCanPlayThrough:null,topChange:null,topClick:null,topCompositionEnd:null,topCompositionStart:null,topCompositionUpdate:null,topContextMenu:null,topCopy:null,topCut:null,topDoubleClick:null,topDrag:null,topDragEnd:null,topDragEnter:null,topDragExit:null,topDragLeave:null,topDragOver:null,topDragStart:null,topDrop:null,topDurationChange:null,topEmptied:null,topEncrypted:null,topEnded:null,topError:null,topFocus:null,topInput:null,topKeyDown:null,topKeyPress:null,topKeyUp:null,topLoad:null,topLoadedData:null,topLoadedMetadata:null,topLoadStart:null,topMouseDown:null,topMouseMove:null,topMouseOut:null,topMouseOver:null,topMouseUp:null,topPaste:null,topPause:null,topPlay:null,topPlaying:null,topProgress:null,topRateChange:null,topReset:null,topScroll:null,topSeeked:null,topSeeking:null,topSelectionChange:null,topStalled:null,topSubmit:null,topSuspend:null,topTextInput:null,topTimeUpdate:null,topTouchCancel:null,topTouchEnd:null,topTouchMove:null,topTouchStart:null,topVolumeChange:null,topWaiting:null,topWheel:null}),EventConstants={topLevelTypes:topLevelTypes,PropagationPhases:PropagationPhases};module.exports=EventConstants;

},{"fbjs/lib/keyMirror":84}],157:[function(require,module,exports){
"use strict";var EventPluginRegistry=require("./EventPluginRegistry"),EventPluginUtils=require("./EventPluginUtils"),ReactErrorUtils=require("./ReactErrorUtils"),accumulateInto=require("./accumulateInto"),forEachAccumulated=require("./forEachAccumulated"),invariant=require("fbjs/lib/invariant"),warning=require("fbjs/lib/warning"),listenerBank={},eventQueue=null,executeDispatchesAndRelease=function(e,n){e&&(EventPluginUtils.executeDispatchesInOrder(e,n),e.isPersistent()||e.constructor.release(e))},executeDispatchesAndReleaseSimulated=function(e){return executeDispatchesAndRelease(e,!0)},executeDispatchesAndReleaseTopLevel=function(e){return executeDispatchesAndRelease(e,!1)},InstanceHandle=null;function validateInstanceHandle(){InstanceHandle&&InstanceHandle.traverseTwoPhase&&InstanceHandle.traverseEnterLeave}var EventPluginHub={injection:{injectMount:EventPluginUtils.injection.injectMount,injectInstanceHandle:function(e){InstanceHandle=e},getInstanceHandle:function(){return InstanceHandle},injectEventPluginOrder:EventPluginRegistry.injectEventPluginOrder,injectEventPluginsByName:EventPluginRegistry.injectEventPluginsByName},eventNameDispatchConfigs:EventPluginRegistry.eventNameDispatchConfigs,registrationNameModules:EventPluginRegistry.registrationNameModules,putListener:function(e,n,t){"function"!=typeof t&&invariant(!1),(listenerBank[n]||(listenerBank[n]={}))[e]=t;var i=EventPluginRegistry.registrationNameModules[n];i&&i.didPutListener&&i.didPutListener(e,n,t)},getListener:function(e,n){var t=listenerBank[n];return t&&t[e]},deleteListener:function(e,n){var t=EventPluginRegistry.registrationNameModules[n];t&&t.willDeleteListener&&t.willDeleteListener(e,n);var i=listenerBank[n];i&&delete i[e]},deleteAllListeners:function(e){for(var n in listenerBank)if(listenerBank[n][e]){var t=EventPluginRegistry.registrationNameModules[n];t&&t.willDeleteListener&&t.willDeleteListener(e,n),delete listenerBank[n][e]}},extractEvents:function(e,n,t,i,r){for(var a,u=EventPluginRegistry.plugins,s=0;s<u.length;s++){var l=u[s];if(l){var c=l.extractEvents(e,n,t,i,r);c&&(a=accumulateInto(a,c))}}return a},enqueueEvents:function(e){e&&(eventQueue=accumulateInto(eventQueue,e))},processEventQueue:function(e){var n=eventQueue;eventQueue=null,forEachAccumulated(n,e?executeDispatchesAndReleaseSimulated:executeDispatchesAndReleaseTopLevel),eventQueue&&invariant(!1),ReactErrorUtils.rethrowCaughtError()},__purge:function(){listenerBank={}},__getListenerBank:function(){return listenerBank}};module.exports=EventPluginHub;

},{"./EventPluginRegistry":158,"./EventPluginUtils":159,"./ReactErrorUtils":196,"./accumulateInto":242,"./forEachAccumulated":250,"fbjs/lib/invariant":81,"fbjs/lib/warning":90}],158:[function(require,module,exports){
"use strict";var invariant=require("fbjs/lib/invariant"),EventPluginOrder=null,namesToPlugins={};function recomputePluginOrdering(){if(EventPluginOrder)for(var e in namesToPlugins){var n=namesToPlugins[e],i=EventPluginOrder.indexOf(e);if(i>-1||invariant(!1),!EventPluginRegistry.plugins[i]){n.extractEvents||invariant(!1),EventPluginRegistry.plugins[i]=n;var r=n.eventTypes;for(var t in r)publishEventForPlugin(r[t],n,t)||invariant(!1)}}}function publishEventForPlugin(e,n,i){EventPluginRegistry.eventNameDispatchConfigs.hasOwnProperty(i)&&invariant(!1),EventPluginRegistry.eventNameDispatchConfigs[i]=e;var r=e.phasedRegistrationNames;if(r){for(var t in r){if(r.hasOwnProperty(t))publishRegistrationName(r[t],n,i)}return!0}return!!e.registrationName&&(publishRegistrationName(e.registrationName,n,i),!0)}function publishRegistrationName(e,n,i){EventPluginRegistry.registrationNameModules[e]&&invariant(!1),EventPluginRegistry.registrationNameModules[e]=n,EventPluginRegistry.registrationNameDependencies[e]=n.eventTypes[i].dependencies}var EventPluginRegistry={plugins:[],eventNameDispatchConfigs:{},registrationNameModules:{},registrationNameDependencies:{},injectEventPluginOrder:function(e){EventPluginOrder&&invariant(!1),EventPluginOrder=Array.prototype.slice.call(e),recomputePluginOrdering()},injectEventPluginsByName:function(e){var n=!1;for(var i in e)if(e.hasOwnProperty(i)){var r=e[i];namesToPlugins.hasOwnProperty(i)&&namesToPlugins[i]===r||(namesToPlugins[i]&&invariant(!1),namesToPlugins[i]=r,n=!0)}n&&recomputePluginOrdering()},getPluginModuleForEvent:function(e){var n=e.dispatchConfig;if(n.registrationName)return EventPluginRegistry.registrationNameModules[n.registrationName]||null;for(var i in n.phasedRegistrationNames)if(n.phasedRegistrationNames.hasOwnProperty(i)){var r=EventPluginRegistry.registrationNameModules[n.phasedRegistrationNames[i]];if(r)return r}return null},_resetEventPlugins:function(){for(var e in EventPluginOrder=null,namesToPlugins)namesToPlugins.hasOwnProperty(e)&&delete namesToPlugins[e];EventPluginRegistry.plugins.length=0;var n=EventPluginRegistry.eventNameDispatchConfigs;for(var i in n)n.hasOwnProperty(i)&&delete n[i];var r=EventPluginRegistry.registrationNameModules;for(var t in r)r.hasOwnProperty(t)&&delete r[t]}};module.exports=EventPluginRegistry;

},{"fbjs/lib/invariant":81}],159:[function(require,module,exports){
"use strict";var validateEventDispatches,EventConstants=require("./EventConstants"),ReactErrorUtils=require("./ReactErrorUtils"),invariant=require("fbjs/lib/invariant"),warning=require("fbjs/lib/warning"),injection={Mount:null,injectMount:function(e){injection.Mount=e}},topLevelTypes=EventConstants.topLevelTypes;function isEndish(e){return e===topLevelTypes.topMouseUp||e===topLevelTypes.topTouchEnd||e===topLevelTypes.topTouchCancel}function isMoveish(e){return e===topLevelTypes.topMouseMove||e===topLevelTypes.topTouchMove}function isStartish(e){return e===topLevelTypes.topMouseDown||e===topLevelTypes.topTouchStart}function executeDispatch(e,t,i,n){var s=e.type||"unknown-event";e.currentTarget=injection.Mount.getNode(n),t?ReactErrorUtils.invokeGuardedCallbackWithCatch(s,i,e,n):ReactErrorUtils.invokeGuardedCallback(s,i,e,n),e.currentTarget=null}function executeDispatchesInOrder(e,t){var i=e._dispatchListeners,n=e._dispatchIDs;if(Array.isArray(i))for(var s=0;s<i.length&&!e.isPropagationStopped();s++)executeDispatch(e,t,i[s],n[s]);else i&&executeDispatch(e,t,i,n);e._dispatchListeners=null,e._dispatchIDs=null}function executeDispatchesInOrderStopAtTrueImpl(e){var t=e._dispatchListeners,i=e._dispatchIDs;if(Array.isArray(t)){for(var n=0;n<t.length&&!e.isPropagationStopped();n++)if(t[n](e,i[n]))return i[n]}else if(t&&t(e,i))return i;return null}function executeDispatchesInOrderStopAtTrue(e){var t=executeDispatchesInOrderStopAtTrueImpl(e);return e._dispatchIDs=null,e._dispatchListeners=null,t}function executeDirectDispatch(e){var t=e._dispatchListeners,i=e._dispatchIDs;Array.isArray(t)&&invariant(!1);var n=t?t(e,i):null;return e._dispatchListeners=null,e._dispatchIDs=null,n}function hasDispatches(e){return!!e._dispatchListeners}var EventPluginUtils={isEndish:isEndish,isMoveish:isMoveish,isStartish:isStartish,executeDirectDispatch:executeDirectDispatch,executeDispatchesInOrder:executeDispatchesInOrder,executeDispatchesInOrderStopAtTrue:executeDispatchesInOrderStopAtTrue,hasDispatches:hasDispatches,getNode:function(e){return injection.Mount.getNode(e)},getID:function(e){return injection.Mount.getID(e)},injection:injection};module.exports=EventPluginUtils;

},{"./EventConstants":156,"./ReactErrorUtils":196,"fbjs/lib/invariant":81,"fbjs/lib/warning":90}],160:[function(require,module,exports){
"use strict";var EventConstants=require("./EventConstants"),EventPluginHub=require("./EventPluginHub"),warning=require("fbjs/lib/warning"),accumulateInto=require("./accumulateInto"),forEachAccumulated=require("./forEachAccumulated"),PropagationPhases=EventConstants.PropagationPhases,getListener=EventPluginHub.getListener;function listenerAtPhase(e,a,t){var c=a.dispatchConfig.phasedRegistrationNames[t];return getListener(e,c)}function accumulateDirectionalDispatches(e,a,t){var c=listenerAtPhase(e,t,a?PropagationPhases.bubbled:PropagationPhases.captured);c&&(t._dispatchListeners=accumulateInto(t._dispatchListeners,c),t._dispatchIDs=accumulateInto(t._dispatchIDs,e))}function accumulateTwoPhaseDispatchesSingle(e){e&&e.dispatchConfig.phasedRegistrationNames&&EventPluginHub.injection.getInstanceHandle().traverseTwoPhase(e.dispatchMarker,accumulateDirectionalDispatches,e)}function accumulateTwoPhaseDispatchesSingleSkipTarget(e){e&&e.dispatchConfig.phasedRegistrationNames&&EventPluginHub.injection.getInstanceHandle().traverseTwoPhaseSkipTarget(e.dispatchMarker,accumulateDirectionalDispatches,e)}function accumulateDispatches(e,a,t){if(t&&t.dispatchConfig.registrationName){var c=t.dispatchConfig.registrationName,s=getListener(e,c);s&&(t._dispatchListeners=accumulateInto(t._dispatchListeners,s),t._dispatchIDs=accumulateInto(t._dispatchIDs,e))}}function accumulateDirectDispatchesSingle(e){e&&e.dispatchConfig.registrationName&&accumulateDispatches(e.dispatchMarker,null,e)}function accumulateTwoPhaseDispatches(e){forEachAccumulated(e,accumulateTwoPhaseDispatchesSingle)}function accumulateTwoPhaseDispatchesSkipTarget(e){forEachAccumulated(e,accumulateTwoPhaseDispatchesSingleSkipTarget)}function accumulateEnterLeaveDispatches(e,a,t,c){EventPluginHub.injection.getInstanceHandle().traverseEnterLeave(t,c,accumulateDispatches,e,a)}function accumulateDirectDispatches(e){forEachAccumulated(e,accumulateDirectDispatchesSingle)}var EventPropagators={accumulateTwoPhaseDispatches:accumulateTwoPhaseDispatches,accumulateTwoPhaseDispatchesSkipTarget:accumulateTwoPhaseDispatchesSkipTarget,accumulateDirectDispatches:accumulateDirectDispatches,accumulateEnterLeaveDispatches:accumulateEnterLeaveDispatches};module.exports=EventPropagators;

},{"./EventConstants":156,"./EventPluginHub":157,"./accumulateInto":242,"./forEachAccumulated":250,"fbjs/lib/warning":90}],161:[function(require,module,exports){
"use strict";var PooledClass=require("./PooledClass"),assign=require("./Object.assign"),getTextContentAccessor=require("./getTextContentAccessor");function FallbackCompositionState(t){this._root=t,this._startText=this.getText(),this._fallbackText=null}assign(FallbackCompositionState.prototype,{destructor:function(){this._root=null,this._startText=null,this._fallbackText=null},getText:function(){return"value"in this._root?this._root.value:this._root[getTextContentAccessor()]},getData:function(){if(this._fallbackText)return this._fallbackText;var t,e,o=this._startText,s=o.length,a=this.getText(),l=a.length;for(t=0;t<s&&o[t]===a[t];t++);var i=s-t;for(e=1;e<=i&&o[s-e]===a[l-e];e++);var r=e>1?1-e:void 0;return this._fallbackText=a.slice(t,r),this._fallbackText}}),PooledClass.addPoolingTo(FallbackCompositionState),module.exports=FallbackCompositionState;

},{"./Object.assign":164,"./PooledClass":165,"./getTextContentAccessor":257}],162:[function(require,module,exports){
"use strict";var hasSVG,DOMProperty=require("./DOMProperty"),ExecutionEnvironment=require("fbjs/lib/ExecutionEnvironment"),MUST_USE_ATTRIBUTE=DOMProperty.injection.MUST_USE_ATTRIBUTE,MUST_USE_PROPERTY=DOMProperty.injection.MUST_USE_PROPERTY,HAS_BOOLEAN_VALUE=DOMProperty.injection.HAS_BOOLEAN_VALUE,HAS_SIDE_EFFECTS=DOMProperty.injection.HAS_SIDE_EFFECTS,HAS_NUMERIC_VALUE=DOMProperty.injection.HAS_NUMERIC_VALUE,HAS_POSITIVE_NUMERIC_VALUE=DOMProperty.injection.HAS_POSITIVE_NUMERIC_VALUE,HAS_OVERLOADED_BOOLEAN_VALUE=DOMProperty.injection.HAS_OVERLOADED_BOOLEAN_VALUE;if(ExecutionEnvironment.canUseDOM){var implementation=document.implementation;hasSVG=implementation&&implementation.hasFeature&&implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")}var HTMLDOMPropertyConfig={isCustomAttribute:RegExp.prototype.test.bind(/^(data|aria)-[a-z_][a-z\d_.\-]*$/),Properties:{accept:null,acceptCharset:null,accessKey:null,action:null,allowFullScreen:MUST_USE_ATTRIBUTE|HAS_BOOLEAN_VALUE,allowTransparency:MUST_USE_ATTRIBUTE,alt:null,async:HAS_BOOLEAN_VALUE,autoComplete:null,autoPlay:HAS_BOOLEAN_VALUE,capture:MUST_USE_ATTRIBUTE|HAS_BOOLEAN_VALUE,cellPadding:null,cellSpacing:null,charSet:MUST_USE_ATTRIBUTE,challenge:MUST_USE_ATTRIBUTE,checked:MUST_USE_PROPERTY|HAS_BOOLEAN_VALUE,classID:MUST_USE_ATTRIBUTE,className:hasSVG?MUST_USE_ATTRIBUTE:MUST_USE_PROPERTY,cols:MUST_USE_ATTRIBUTE|HAS_POSITIVE_NUMERIC_VALUE,colSpan:null,content:null,contentEditable:null,contextMenu:MUST_USE_ATTRIBUTE,controls:MUST_USE_PROPERTY|HAS_BOOLEAN_VALUE,coords:null,crossOrigin:null,data:null,dateTime:MUST_USE_ATTRIBUTE,default:HAS_BOOLEAN_VALUE,defer:HAS_BOOLEAN_VALUE,dir:null,disabled:MUST_USE_ATTRIBUTE|HAS_BOOLEAN_VALUE,download:HAS_OVERLOADED_BOOLEAN_VALUE,draggable:null,encType:null,form:MUST_USE_ATTRIBUTE,formAction:MUST_USE_ATTRIBUTE,formEncType:MUST_USE_ATTRIBUTE,formMethod:MUST_USE_ATTRIBUTE,formNoValidate:HAS_BOOLEAN_VALUE,formTarget:MUST_USE_ATTRIBUTE,frameBorder:MUST_USE_ATTRIBUTE,headers:null,height:MUST_USE_ATTRIBUTE,hidden:MUST_USE_ATTRIBUTE|HAS_BOOLEAN_VALUE,high:null,href:null,hrefLang:null,htmlFor:null,httpEquiv:null,icon:null,id:MUST_USE_PROPERTY,inputMode:MUST_USE_ATTRIBUTE,integrity:null,is:MUST_USE_ATTRIBUTE,keyParams:MUST_USE_ATTRIBUTE,keyType:MUST_USE_ATTRIBUTE,kind:null,label:null,lang:null,list:MUST_USE_ATTRIBUTE,loop:MUST_USE_PROPERTY|HAS_BOOLEAN_VALUE,low:null,manifest:MUST_USE_ATTRIBUTE,marginHeight:null,marginWidth:null,max:null,maxLength:MUST_USE_ATTRIBUTE,media:MUST_USE_ATTRIBUTE,mediaGroup:null,method:null,min:null,minLength:MUST_USE_ATTRIBUTE,multiple:MUST_USE_PROPERTY|HAS_BOOLEAN_VALUE,muted:MUST_USE_PROPERTY|HAS_BOOLEAN_VALUE,name:null,nonce:MUST_USE_ATTRIBUTE,noValidate:HAS_BOOLEAN_VALUE,open:HAS_BOOLEAN_VALUE,optimum:null,pattern:null,placeholder:null,poster:null,preload:null,radioGroup:null,readOnly:MUST_USE_PROPERTY|HAS_BOOLEAN_VALUE,rel:null,required:HAS_BOOLEAN_VALUE,reversed:HAS_BOOLEAN_VALUE,role:MUST_USE_ATTRIBUTE,rows:MUST_USE_ATTRIBUTE|HAS_POSITIVE_NUMERIC_VALUE,rowSpan:null,sandbox:null,scope:null,scoped:HAS_BOOLEAN_VALUE,scrolling:null,seamless:MUST_USE_ATTRIBUTE|HAS_BOOLEAN_VALUE,selected:MUST_USE_PROPERTY|HAS_BOOLEAN_VALUE,shape:null,size:MUST_USE_ATTRIBUTE|HAS_POSITIVE_NUMERIC_VALUE,sizes:MUST_USE_ATTRIBUTE,span:HAS_POSITIVE_NUMERIC_VALUE,spellCheck:null,src:null,srcDoc:MUST_USE_PROPERTY,srcLang:null,srcSet:MUST_USE_ATTRIBUTE,start:HAS_NUMERIC_VALUE,step:null,style:null,summary:null,tabIndex:null,target:null,title:null,type:null,useMap:null,value:MUST_USE_PROPERTY|HAS_SIDE_EFFECTS,width:MUST_USE_ATTRIBUTE,wmode:MUST_USE_ATTRIBUTE,wrap:null,about:MUST_USE_ATTRIBUTE,datatype:MUST_USE_ATTRIBUTE,inlist:MUST_USE_ATTRIBUTE,prefix:MUST_USE_ATTRIBUTE,property:MUST_USE_ATTRIBUTE,resource:MUST_USE_ATTRIBUTE,typeof:MUST_USE_ATTRIBUTE,vocab:MUST_USE_ATTRIBUTE,autoCapitalize:MUST_USE_ATTRIBUTE,autoCorrect:MUST_USE_ATTRIBUTE,autoSave:null,color:null,itemProp:MUST_USE_ATTRIBUTE,itemScope:MUST_USE_ATTRIBUTE|HAS_BOOLEAN_VALUE,itemType:MUST_USE_ATTRIBUTE,itemID:MUST_USE_ATTRIBUTE,itemRef:MUST_USE_ATTRIBUTE,results:null,security:MUST_USE_ATTRIBUTE,unselectable:MUST_USE_ATTRIBUTE},DOMAttributeNames:{acceptCharset:"accept-charset",className:"class",htmlFor:"for",httpEquiv:"http-equiv"},DOMPropertyNames:{autoComplete:"autocomplete",autoFocus:"autofocus",autoPlay:"autoplay",autoSave:"autosave",encType:"encoding",hrefLang:"hreflang",radioGroup:"radiogroup",spellCheck:"spellcheck",srcDoc:"srcdoc",srcSet:"srcset"}};module.exports=HTMLDOMPropertyConfig;

},{"./DOMProperty":151,"fbjs/lib/ExecutionEnvironment":67}],163:[function(require,module,exports){
"use strict";var ReactPropTypes=require("./ReactPropTypes"),ReactPropTypeLocations=require("./ReactPropTypeLocations"),invariant=require("fbjs/lib/invariant"),warning=require("fbjs/lib/warning"),hasReadOnlyValue={button:!0,checkbox:!0,image:!0,hidden:!0,radio:!0,reset:!0,submit:!0};function _assertSingleLink(e){null!=e.checkedLink&&null!=e.valueLink&&invariant(!1)}function _assertValueLink(e){_assertSingleLink(e),(null!=e.value||null!=e.onChange)&&invariant(!1)}function _assertCheckedLink(e){_assertSingleLink(e),(null!=e.checked||null!=e.onChange)&&invariant(!1)}var propTypes={value:function(e,n,a){return!e[n]||hasReadOnlyValue[e.type]||e.onChange||e.readOnly||e.disabled?null:new Error("You provided a `value` prop to a form field without an `onChange` handler. This will render a read-only field. If the field should be mutable use `defaultValue`. Otherwise, set either `onChange` or `readOnly`.")},checked:function(e,n,a){return!e[n]||e.onChange||e.readOnly||e.disabled?null:new Error("You provided a `checked` prop to a form field without an `onChange` handler. This will render a read-only field. If the field should be mutable use `defaultChecked`. Otherwise, set either `onChange` or `readOnly`.")},onChange:ReactPropTypes.func},loggedTypeFailures={};function getDeclarationErrorAddendum(e){if(e){var n=e.getName();if(n)return" Check the render method of `"+n+"`."}return""}var LinkedValueUtils={checkPropTypes:function(e,n,a){for(var r in propTypes){if(propTypes.hasOwnProperty(r))var i=propTypes[r](n,r,e,ReactPropTypeLocations.prop,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED");if(i instanceof Error&&!(i.message in loggedTypeFailures)){loggedTypeFailures[i.message]=!0;getDeclarationErrorAddendum(a)}}},getValue:function(e){return e.valueLink?(_assertValueLink(e),e.valueLink.value):e.value},getChecked:function(e){return e.checkedLink?(_assertCheckedLink(e),e.checkedLink.value):e.checked},executeOnChange:function(e,n){return e.valueLink?(_assertValueLink(e),e.valueLink.requestChange(n.target.value)):e.checkedLink?(_assertCheckedLink(e),e.checkedLink.requestChange(n.target.checked)):e.onChange?e.onChange.call(void 0,n):void 0}};module.exports=LinkedValueUtils;

},{"./ReactPropTypeLocations":213,"./ReactPropTypes":214,"fbjs/lib/invariant":81,"fbjs/lib/warning":90}],164:[function(require,module,exports){
"use strict";function assign(r,e){if(null==r)throw new TypeError("Object.assign target cannot be null or undefined");for(var n=Object(r),t=Object.prototype.hasOwnProperty,o=1;o<arguments.length;o++){var a=arguments[o];if(null!=a){var l=Object(a);for(var s in l)t.call(l,s)&&(n[s]=l[s])}}return n}module.exports=assign;

},{}],165:[function(require,module,exports){
"use strict";var invariant=require("fbjs/lib/invariant"),oneArgumentPooler=function(o){if(this.instancePool.length){var e=this.instancePool.pop();return this.call(e,o),e}return new this(o)},twoArgumentPooler=function(o,e){if(this.instancePool.length){var n=this.instancePool.pop();return this.call(n,o,e),n}return new this(o,e)},threeArgumentPooler=function(o,e,n){if(this.instancePool.length){var t=this.instancePool.pop();return this.call(t,o,e,n),t}return new this(o,e,n)},fourArgumentPooler=function(o,e,n,t){if(this.instancePool.length){var r=this.instancePool.pop();return this.call(r,o,e,n,t),r}return new this(o,e,n,t)},fiveArgumentPooler=function(o,e,n,t,r){if(this.instancePool.length){var i=this.instancePool.pop();return this.call(i,o,e,n,t,r),i}return new this(o,e,n,t,r)},standardReleaser=function(o){o instanceof this||invariant(!1),o.destructor(),this.instancePool.length<this.poolSize&&this.instancePool.push(o)},DEFAULT_POOL_SIZE=10,DEFAULT_POOLER=oneArgumentPooler,addPoolingTo=function(o,e){var n=o;return n.instancePool=[],n.getPooled=e||DEFAULT_POOLER,n.poolSize||(n.poolSize=DEFAULT_POOL_SIZE),n.release=standardReleaser,n},PooledClass={addPoolingTo:addPoolingTo,oneArgumentPooler:oneArgumentPooler,twoArgumentPooler:twoArgumentPooler,threeArgumentPooler:threeArgumentPooler,fourArgumentPooler:fourArgumentPooler,fiveArgumentPooler:fiveArgumentPooler};module.exports=PooledClass;

},{"fbjs/lib/invariant":81}],166:[function(require,module,exports){
"use strict";var ReactDOM=require("./ReactDOM"),ReactDOMServer=require("./ReactDOMServer"),ReactIsomorphic=require("./ReactIsomorphic"),assign=require("./Object.assign"),deprecated=require("./deprecated"),React={};assign(React,ReactIsomorphic),assign(React,{findDOMNode:deprecated("findDOMNode","ReactDOM","react-dom",ReactDOM,ReactDOM.findDOMNode),render:deprecated("render","ReactDOM","react-dom",ReactDOM,ReactDOM.render),unmountComponentAtNode:deprecated("unmountComponentAtNode","ReactDOM","react-dom",ReactDOM,ReactDOM.unmountComponentAtNode),renderToString:deprecated("renderToString","ReactDOMServer","react-dom/server",ReactDOMServer,ReactDOMServer.renderToString),renderToStaticMarkup:deprecated("renderToStaticMarkup","ReactDOMServer","react-dom/server",ReactDOMServer,ReactDOMServer.renderToStaticMarkup)}),React.__SECRET_DOM_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ReactDOM,React.__SECRET_DOM_SERVER_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ReactDOMServer,module.exports=React;

},{"./Object.assign":164,"./ReactDOM":177,"./ReactDOMServer":187,"./ReactIsomorphic":203,"./deprecated":246}],167:[function(require,module,exports){
"use strict";var ReactInstanceMap=require("./ReactInstanceMap"),findDOMNode=require("./findDOMNode"),warning=require("fbjs/lib/warning"),didWarnKey="_getDOMNodeDidWarn",ReactBrowserComponentMixin={getDOMNode:function(){return this.constructor[didWarnKey]=!0,findDOMNode(this)}};module.exports=ReactBrowserComponentMixin;

},{"./ReactInstanceMap":202,"./findDOMNode":248,"fbjs/lib/warning":90}],168:[function(require,module,exports){
"use strict";var EventConstants=require("./EventConstants"),EventPluginHub=require("./EventPluginHub"),EventPluginRegistry=require("./EventPluginRegistry"),ReactEventEmitterMixin=require("./ReactEventEmitterMixin"),ReactPerf=require("./ReactPerf"),ViewportMetrics=require("./ViewportMetrics"),assign=require("./Object.assign"),isEventSupported=require("./isEventSupported"),alreadyListeningTo={},isMonitoringScrollValue=!1,reactTopListenersCounter=0,topEventMapping={topAbort:"abort",topBlur:"blur",topCanPlay:"canplay",topCanPlayThrough:"canplaythrough",topChange:"change",topClick:"click",topCompositionEnd:"compositionend",topCompositionStart:"compositionstart",topCompositionUpdate:"compositionupdate",topContextMenu:"contextmenu",topCopy:"copy",topCut:"cut",topDoubleClick:"dblclick",topDrag:"drag",topDragEnd:"dragend",topDragEnter:"dragenter",topDragExit:"dragexit",topDragLeave:"dragleave",topDragOver:"dragover",topDragStart:"dragstart",topDrop:"drop",topDurationChange:"durationchange",topEmptied:"emptied",topEncrypted:"encrypted",topEnded:"ended",topError:"error",topFocus:"focus",topInput:"input",topKeyDown:"keydown",topKeyPress:"keypress",topKeyUp:"keyup",topLoadedData:"loadeddata",topLoadedMetadata:"loadedmetadata",topLoadStart:"loadstart",topMouseDown:"mousedown",topMouseMove:"mousemove",topMouseOut:"mouseout",topMouseOver:"mouseover",topMouseUp:"mouseup",topPaste:"paste",topPause:"pause",topPlay:"play",topPlaying:"playing",topProgress:"progress",topRateChange:"ratechange",topScroll:"scroll",topSeeked:"seeked",topSeeking:"seeking",topSelectionChange:"selectionchange",topStalled:"stalled",topSuspend:"suspend",topTextInput:"textInput",topTimeUpdate:"timeupdate",topTouchCancel:"touchcancel",topTouchEnd:"touchend",topTouchMove:"touchmove",topTouchStart:"touchstart",topVolumeChange:"volumechange",topWaiting:"waiting",topWheel:"wheel"},topListenersIDKey="_reactListenersID"+String(Math.random()).slice(2);function getListeningForDocument(e){return Object.prototype.hasOwnProperty.call(e,topListenersIDKey)||(e[topListenersIDKey]=reactTopListenersCounter++,alreadyListeningTo[e[topListenersIDKey]]={}),alreadyListeningTo[e[topListenersIDKey]]}var ReactBrowserEventEmitter=assign({},ReactEventEmitterMixin,{ReactEventListener:null,injection:{injectReactEventListener:function(e){e.setHandleTopLevel(ReactBrowserEventEmitter.handleTopLevel),ReactBrowserEventEmitter.ReactEventListener=e}},setEnabled:function(e){ReactBrowserEventEmitter.ReactEventListener&&ReactBrowserEventEmitter.ReactEventListener.setEnabled(e)},isEnabled:function(){return!(!ReactBrowserEventEmitter.ReactEventListener||!ReactBrowserEventEmitter.ReactEventListener.isEnabled())},listenTo:function(e,t){for(var r=t,n=getListeningForDocument(r),o=EventPluginRegistry.registrationNameDependencies[e],a=EventConstants.topLevelTypes,i=0;i<o.length;i++){var s=o[i];n.hasOwnProperty(s)&&n[s]||(s===a.topWheel?isEventSupported("wheel")?ReactBrowserEventEmitter.ReactEventListener.trapBubbledEvent(a.topWheel,"wheel",r):isEventSupported("mousewheel")?ReactBrowserEventEmitter.ReactEventListener.trapBubbledEvent(a.topWheel,"mousewheel",r):ReactBrowserEventEmitter.ReactEventListener.trapBubbledEvent(a.topWheel,"DOMMouseScroll",r):s===a.topScroll?isEventSupported("scroll",!0)?ReactBrowserEventEmitter.ReactEventListener.trapCapturedEvent(a.topScroll,"scroll",r):ReactBrowserEventEmitter.ReactEventListener.trapBubbledEvent(a.topScroll,"scroll",ReactBrowserEventEmitter.ReactEventListener.WINDOW_HANDLE):s===a.topFocus||s===a.topBlur?(isEventSupported("focus",!0)?(ReactBrowserEventEmitter.ReactEventListener.trapCapturedEvent(a.topFocus,"focus",r),ReactBrowserEventEmitter.ReactEventListener.trapCapturedEvent(a.topBlur,"blur",r)):isEventSupported("focusin")&&(ReactBrowserEventEmitter.ReactEventListener.trapBubbledEvent(a.topFocus,"focusin",r),ReactBrowserEventEmitter.ReactEventListener.trapBubbledEvent(a.topBlur,"focusout",r)),n[a.topBlur]=!0,n[a.topFocus]=!0):topEventMapping.hasOwnProperty(s)&&ReactBrowserEventEmitter.ReactEventListener.trapBubbledEvent(s,topEventMapping[s],r),n[s]=!0)}},trapBubbledEvent:function(e,t,r){return ReactBrowserEventEmitter.ReactEventListener.trapBubbledEvent(e,t,r)},trapCapturedEvent:function(e,t,r){return ReactBrowserEventEmitter.ReactEventListener.trapCapturedEvent(e,t,r)},ensureScrollValueMonitoring:function(){if(!isMonitoringScrollValue){var e=ViewportMetrics.refreshScrollValues;ReactBrowserEventEmitter.ReactEventListener.monitorScrollValue(e),isMonitoringScrollValue=!0}},eventNameDispatchConfigs:EventPluginHub.eventNameDispatchConfigs,registrationNameModules:EventPluginHub.registrationNameModules,putListener:EventPluginHub.putListener,getListener:EventPluginHub.getListener,deleteListener:EventPluginHub.deleteListener,deleteAllListeners:EventPluginHub.deleteAllListeners});ReactPerf.measureMethods(ReactBrowserEventEmitter,"ReactBrowserEventEmitter",{putListener:"putListener",deleteListener:"deleteListener"}),module.exports=ReactBrowserEventEmitter;

},{"./EventConstants":156,"./EventPluginHub":157,"./EventPluginRegistry":158,"./Object.assign":164,"./ReactEventEmitterMixin":197,"./ReactPerf":211,"./ViewportMetrics":241,"./isEventSupported":259}],169:[function(require,module,exports){
"use strict";var ReactReconciler=require("./ReactReconciler"),instantiateReactComponent=require("./instantiateReactComponent"),shouldUpdateReactComponent=require("./shouldUpdateReactComponent"),traverseAllChildren=require("./traverseAllChildren"),warning=require("fbjs/lib/warning");function instantiateChild(e,n,t){var r=void 0===e[t];null!=n&&r&&(e[t]=instantiateReactComponent(n,null))}var ReactChildReconciler={instantiateChildren:function(e,n,t){if(null==e)return null;var r={};return traverseAllChildren(e,instantiateChild,r),r},updateChildren:function(e,n,t,r){if(!n&&!e)return null;var i;for(i in n)if(n.hasOwnProperty(i)){var a=e&&e[i],o=a&&a._currentElement,l=n[i];if(null!=a&&shouldUpdateReactComponent(o,l))ReactReconciler.receiveComponent(a,l,t,r),n[i]=a;else{a&&ReactReconciler.unmountComponent(a,i);var c=instantiateReactComponent(l,null);n[i]=c}}for(i in e)!e.hasOwnProperty(i)||n&&n.hasOwnProperty(i)||ReactReconciler.unmountComponent(e[i]);return n},unmountChildren:function(e){for(var n in e)if(e.hasOwnProperty(n)){var t=e[n];ReactReconciler.unmountComponent(t)}}};module.exports=ReactChildReconciler;

},{"./ReactReconciler":216,"./instantiateReactComponent":258,"./shouldUpdateReactComponent":266,"./traverseAllChildren":267,"fbjs/lib/warning":90}],170:[function(require,module,exports){
"use strict";var PooledClass=require("./PooledClass"),ReactElement=require("./ReactElement"),emptyFunction=require("fbjs/lib/emptyFunction"),traverseAllChildren=require("./traverseAllChildren"),twoArgumentPooler=PooledClass.twoArgumentPooler,fourArgumentPooler=PooledClass.fourArgumentPooler,userProvidedKeyEscapeRegex=/\/(?!\/)/g;function escapeUserProvidedKey(e){return(""+e).replace(userProvidedKeyEscapeRegex,"//")}function ForEachBookKeeping(e,n){this.func=e,this.context=n,this.count=0}function forEachSingleChild(e,n,t){var r=e.func,o=e.context;r.call(o,n,e.count++)}function forEachChildren(e,n,t){if(null==e)return e;var r=ForEachBookKeeping.getPooled(n,t);traverseAllChildren(e,forEachSingleChild,r),ForEachBookKeeping.release(r)}function MapBookKeeping(e,n,t,r){this.result=e,this.keyPrefix=n,this.func=t,this.context=r,this.count=0}function mapSingleChildIntoContext(e,n,t){var r=e.result,o=e.keyPrefix,l=e.func,i=e.context,u=l.call(i,n,e.count++);Array.isArray(u)?mapIntoWithKeyPrefixInternal(u,r,t,emptyFunction.thatReturnsArgument):null!=u&&(ReactElement.isValidElement(u)&&(u=ReactElement.cloneAndReplaceKey(u,o+(u!==n?escapeUserProvidedKey(u.key||"")+"/":"")+t)),r.push(u))}function mapIntoWithKeyPrefixInternal(e,n,t,r,o){var l="";null!=t&&(l=escapeUserProvidedKey(t)+"/");var i=MapBookKeeping.getPooled(n,l,r,o);traverseAllChildren(e,mapSingleChildIntoContext,i),MapBookKeeping.release(i)}function mapChildren(e,n,t){if(null==e)return e;var r=[];return mapIntoWithKeyPrefixInternal(e,r,null,n,t),r}function forEachSingleChildDummy(e,n,t){return null}function countChildren(e,n){return traverseAllChildren(e,forEachSingleChildDummy,null)}function toArray(e){var n=[];return mapIntoWithKeyPrefixInternal(e,n,null,emptyFunction.thatReturnsArgument),n}ForEachBookKeeping.prototype.destructor=function(){this.func=null,this.context=null,this.count=0},PooledClass.addPoolingTo(ForEachBookKeeping,twoArgumentPooler),MapBookKeeping.prototype.destructor=function(){this.result=null,this.keyPrefix=null,this.func=null,this.context=null,this.count=0},PooledClass.addPoolingTo(MapBookKeeping,fourArgumentPooler);var ReactChildren={forEach:forEachChildren,map:mapChildren,mapIntoWithKeyPrefixInternal:mapIntoWithKeyPrefixInternal,count:countChildren,toArray:toArray};module.exports=ReactChildren;

},{"./PooledClass":165,"./ReactElement":192,"./traverseAllChildren":267,"fbjs/lib/emptyFunction":73}],171:[function(require,module,exports){
"use strict";var ReactComponent=require("./ReactComponent"),ReactElement=require("./ReactElement"),ReactPropTypeLocations=require("./ReactPropTypeLocations"),ReactPropTypeLocationNames=require("./ReactPropTypeLocationNames"),ReactNoopUpdateQueue=require("./ReactNoopUpdateQueue"),assign=require("./Object.assign"),emptyObject=require("fbjs/lib/emptyObject"),invariant=require("fbjs/lib/invariant"),keyMirror=require("fbjs/lib/keyMirror"),keyOf=require("fbjs/lib/keyOf"),warning=require("fbjs/lib/warning"),MIXINS_KEY=keyOf({mixins:null}),SpecPolicy=keyMirror({DEFINE_ONCE:null,DEFINE_MANY:null,OVERRIDE_BASE:null,DEFINE_MANY_MERGED:null}),injectedMixins=[],warnedSetProps=!1;function warnSetProps(){warnedSetProps||(warnedSetProps=!0)}var ReactClassInterface={mixins:SpecPolicy.DEFINE_MANY,statics:SpecPolicy.DEFINE_MANY,propTypes:SpecPolicy.DEFINE_MANY,contextTypes:SpecPolicy.DEFINE_MANY,childContextTypes:SpecPolicy.DEFINE_MANY,getDefaultProps:SpecPolicy.DEFINE_MANY_MERGED,getInitialState:SpecPolicy.DEFINE_MANY_MERGED,getChildContext:SpecPolicy.DEFINE_MANY_MERGED,render:SpecPolicy.DEFINE_ONCE,componentWillMount:SpecPolicy.DEFINE_MANY,componentDidMount:SpecPolicy.DEFINE_MANY,componentWillReceiveProps:SpecPolicy.DEFINE_MANY,shouldComponentUpdate:SpecPolicy.DEFINE_ONCE,componentWillUpdate:SpecPolicy.DEFINE_MANY,componentDidUpdate:SpecPolicy.DEFINE_MANY,componentWillUnmount:SpecPolicy.DEFINE_MANY,updateComponent:SpecPolicy.OVERRIDE_BASE},RESERVED_SPEC_KEYS={displayName:function(e,t){e.displayName=t},mixins:function(e,t){if(t)for(var n=0;n<t.length;n++)mixSpecIntoComponent(e,t[n])},childContextTypes:function(e,t){e.childContextTypes=assign({},e.childContextTypes,t)},contextTypes:function(e,t){e.contextTypes=assign({},e.contextTypes,t)},getDefaultProps:function(e,t){e.getDefaultProps?e.getDefaultProps=createMergedResultFunction(e.getDefaultProps,t):e.getDefaultProps=t},propTypes:function(e,t){e.propTypes=assign({},e.propTypes,t)},statics:function(e,t){mixStaticSpecIntoComponent(e,t)},autobind:function(){}};function validateTypeDef(e,t,n){for(var i in t)t.hasOwnProperty(i)}function validateMethodOverride(e,t){var n=ReactClassInterface.hasOwnProperty(t)?ReactClassInterface[t]:null;ReactClassMixin.hasOwnProperty(t)&&n!==SpecPolicy.OVERRIDE_BASE&&invariant(!1),e.hasOwnProperty(t)&&n!==SpecPolicy.DEFINE_MANY&&n!==SpecPolicy.DEFINE_MANY_MERGED&&invariant(!1)}function mixSpecIntoComponent(e,t){if(t){"function"==typeof t&&invariant(!1),ReactElement.isValidElement(t)&&invariant(!1);var n=e.prototype;for(var i in t.hasOwnProperty(MIXINS_KEY)&&RESERVED_SPEC_KEYS.mixins(e,t.mixins),t)if(t.hasOwnProperty(i)&&i!==MIXINS_KEY){var o=t[i];if(validateMethodOverride(n,i),RESERVED_SPEC_KEYS.hasOwnProperty(i))RESERVED_SPEC_KEYS[i](e,o);else{var a=ReactClassInterface.hasOwnProperty(i),r=n.hasOwnProperty(i);if("function"==typeof o&&!a&&!r&&!1!==t.autobind)n.__reactAutoBindMap||(n.__reactAutoBindMap={}),n.__reactAutoBindMap[i]=o,n[i]=o;else if(r){var c=ReactClassInterface[i];(!a||c!==SpecPolicy.DEFINE_MANY_MERGED&&c!==SpecPolicy.DEFINE_MANY)&&invariant(!1),c===SpecPolicy.DEFINE_MANY_MERGED?n[i]=createMergedResultFunction(n[i],o):c===SpecPolicy.DEFINE_MANY&&(n[i]=createChainedFunction(n[i],o))}else n[i]=o}}}}function mixStaticSpecIntoComponent(e,t){if(t)for(var n in t){var i=t[n];if(t.hasOwnProperty(n))n in RESERVED_SPEC_KEYS&&invariant(!1),n in e&&invariant(!1),e[n]=i}}function mergeIntoWithNoDuplicateKeys(e,t){for(var n in e&&t&&"object"==typeof e&&"object"==typeof t||invariant(!1),t)t.hasOwnProperty(n)&&(void 0!==e[n]&&invariant(!1),e[n]=t[n]);return e}function createMergedResultFunction(e,t){return function(){var n=e.apply(this,arguments),i=t.apply(this,arguments);if(null==n)return i;if(null==i)return n;var o={};return mergeIntoWithNoDuplicateKeys(o,n),mergeIntoWithNoDuplicateKeys(o,i),o}}function createChainedFunction(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function bindAutoBindMethod(e,t){var n=t.bind(e);return n}function bindAutoBindMethods(e){for(var t in e.__reactAutoBindMap)if(e.__reactAutoBindMap.hasOwnProperty(t)){var n=e.__reactAutoBindMap[t];e[t]=bindAutoBindMethod(e,n)}}var ReactClassMixin={replaceState:function(e,t){this.updater.enqueueReplaceState(this,e),t&&this.updater.enqueueCallback(this,t)},isMounted:function(){return this.updater.isMounted(this)},setProps:function(e,t){this.updater.enqueueSetProps(this,e),t&&this.updater.enqueueCallback(this,t)},replaceProps:function(e,t){this.updater.enqueueReplaceProps(this,e),t&&this.updater.enqueueCallback(this,t)}},ReactClassComponent=function(){};assign(ReactClassComponent.prototype,ReactComponent.prototype,ReactClassMixin);var ReactClass={createClass:function(e){var t=function(e,t,n){this.__reactAutoBindMap&&bindAutoBindMethods(this),this.props=e,this.context=t,this.refs=emptyObject,this.updater=n||ReactNoopUpdateQueue,this.state=null;var i=this.getInitialState?this.getInitialState():null;("object"!=typeof i||Array.isArray(i))&&invariant(!1),this.state=i};for(var n in t.prototype=new ReactClassComponent,t.prototype.constructor=t,injectedMixins.forEach(mixSpecIntoComponent.bind(null,t)),mixSpecIntoComponent(t,e),t.getDefaultProps&&(t.defaultProps=t.getDefaultProps()),t.prototype.render||invariant(!1),ReactClassInterface)t.prototype[n]||(t.prototype[n]=null);return t},injection:{injectMixin:function(e){injectedMixins.push(e)}}};module.exports=ReactClass;

},{"./Object.assign":164,"./ReactComponent":172,"./ReactElement":192,"./ReactNoopUpdateQueue":209,"./ReactPropTypeLocationNames":212,"./ReactPropTypeLocations":213,"fbjs/lib/emptyObject":74,"fbjs/lib/invariant":81,"fbjs/lib/keyMirror":84,"fbjs/lib/keyOf":85,"fbjs/lib/warning":90}],172:[function(require,module,exports){
"use strict";var deprecatedAPIs,defineDeprecationWarning,fnName,ReactNoopUpdateQueue=require("./ReactNoopUpdateQueue"),canDefineProperty=require("./canDefineProperty"),emptyObject=require("fbjs/lib/emptyObject"),invariant=require("fbjs/lib/invariant"),warning=require("fbjs/lib/warning");function ReactComponent(e,t,n){this.props=e,this.context=t,this.refs=emptyObject,this.updater=n||ReactNoopUpdateQueue}ReactComponent.prototype.isReactComponent={},ReactComponent.prototype.setState=function(e,t){"object"!=typeof e&&"function"!=typeof e&&null!=e&&invariant(!1),this.updater.enqueueSetState(this,e),t&&this.updater.enqueueCallback(this,t)},ReactComponent.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this),e&&this.updater.enqueueCallback(this,e)},module.exports=ReactComponent;

},{"./ReactNoopUpdateQueue":209,"./canDefineProperty":244,"fbjs/lib/emptyObject":74,"fbjs/lib/invariant":81,"fbjs/lib/warning":90}],173:[function(require,module,exports){
"use strict";var ReactDOMIDOperations=require("./ReactDOMIDOperations"),ReactMount=require("./ReactMount"),ReactComponentBrowserEnvironment={processChildrenUpdates:ReactDOMIDOperations.dangerouslyProcessChildrenUpdates,replaceNodeWithMarkupByID:ReactDOMIDOperations.dangerouslyReplaceNodeWithMarkupByID,unmountIDFromEnvironment:function(e){ReactMount.purgeID(e)}};module.exports=ReactComponentBrowserEnvironment;

},{"./ReactDOMIDOperations":182,"./ReactMount":205}],174:[function(require,module,exports){
"use strict";var invariant=require("fbjs/lib/invariant"),injected=!1,ReactComponentEnvironment={unmountIDFromEnvironment:null,replaceNodeWithMarkupByID:null,processChildrenUpdates:null,injection:{injectEnvironment:function(n){injected&&invariant(!1),ReactComponentEnvironment.unmountIDFromEnvironment=n.unmountIDFromEnvironment,ReactComponentEnvironment.replaceNodeWithMarkupByID=n.replaceNodeWithMarkupByID,ReactComponentEnvironment.processChildrenUpdates=n.processChildrenUpdates,injected=!0}}};module.exports=ReactComponentEnvironment;

},{"fbjs/lib/invariant":81}],175:[function(require,module,exports){
"use strict";var ReactComponentEnvironment=require("./ReactComponentEnvironment"),ReactCurrentOwner=require("./ReactCurrentOwner"),ReactElement=require("./ReactElement"),ReactInstanceMap=require("./ReactInstanceMap"),ReactPerf=require("./ReactPerf"),ReactPropTypeLocations=require("./ReactPropTypeLocations"),ReactPropTypeLocationNames=require("./ReactPropTypeLocationNames"),ReactReconciler=require("./ReactReconciler"),ReactUpdateQueue=require("./ReactUpdateQueue"),assign=require("./Object.assign"),emptyObject=require("fbjs/lib/emptyObject"),invariant=require("fbjs/lib/invariant"),shouldUpdateReactComponent=require("./shouldUpdateReactComponent"),warning=require("fbjs/lib/warning");function getDeclarationErrorAddendum(e){var t=e._currentElement._owner||null;if(t){var n=t.getName();if(n)return" Check the render method of `"+n+"`."}return""}function StatelessComponent(e){}StatelessComponent.prototype.render=function(){return(0,ReactInstanceMap.get(this)._currentElement.type)(this.props,this.context,this.updater)};var nextMountID=1,ReactCompositeComponentMixin={construct:function(e){this._currentElement=e,this._rootNodeID=null,this._instance=null,this._pendingElement=null,this._pendingStateQueue=null,this._pendingReplaceState=!1,this._pendingForceUpdate=!1,this._renderedComponent=null,this._context=null,this._mountOrder=0,this._topLevelWrapper=null,this._pendingCallbacks=null},mountComponent:function(e,t,n){this._context=n,this._mountOrder=nextMountID++,this._rootNodeID=e;var o,i,r=this._processProps(this._currentElement.props),a=this._processContext(n),s=this._currentElement.type,c="prototype"in s;c&&(o=new s(r,a,ReactUpdateQueue)),c&&null!==o&&!1!==o&&!ReactElement.isValidElement(o)||(i=o,o=new StatelessComponent(s)),o.props=r,o.context=a,o.refs=emptyObject,o.updater=ReactUpdateQueue,this._instance=o,ReactInstanceMap.set(o,this);var p=o.state;void 0===p&&(o.state=p=null),("object"!=typeof p||Array.isArray(p))&&invariant(!1),this._pendingStateQueue=null,this._pendingReplaceState=!1,this._pendingForceUpdate=!1,o.componentWillMount&&(o.componentWillMount(),this._pendingStateQueue&&(o.state=this._processPendingState(o.props,o.context))),void 0===i&&(i=this._renderValidatedComponent()),this._renderedComponent=this._instantiateReactComponent(i);var u=ReactReconciler.mountComponent(this._renderedComponent,e,t,this._processChildContext(n));return o.componentDidMount&&t.getReactMountReady().enqueue(o.componentDidMount,o),u},unmountComponent:function(){var e=this._instance;e.componentWillUnmount&&e.componentWillUnmount(),ReactReconciler.unmountComponent(this._renderedComponent),this._renderedComponent=null,this._instance=null,this._pendingStateQueue=null,this._pendingReplaceState=!1,this._pendingForceUpdate=!1,this._pendingCallbacks=null,this._pendingElement=null,this._context=null,this._rootNodeID=null,this._topLevelWrapper=null,ReactInstanceMap.remove(e)},_maskContext:function(e){var t=null,n=this._currentElement.type.contextTypes;if(!n)return emptyObject;for(var o in t={},n)t[o]=e[o];return t},_processContext:function(e){var t=this._maskContext(e);return t},_processChildContext:function(e){var t=this._currentElement.type,n=this._instance,o=n.getChildContext&&n.getChildContext();if(o){for(var i in"object"!=typeof t.childContextTypes&&invariant(!1),o)i in t.childContextTypes||invariant(!1);return assign({},e,o)}return e},_processProps:function(e){return e},_checkPropTypes:function(e,t,n){var o=this.getName();for(var i in e)if(e.hasOwnProperty(i)){var r;try{"function"!=typeof e[i]&&invariant(!1),r=e[i](t,i,o,n,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(e){r=e}if(r instanceof Error){getDeclarationErrorAddendum(this);ReactPropTypeLocations.prop}}},receiveComponent:function(e,t,n){var o=this._currentElement,i=this._context;this._pendingElement=null,this.updateComponent(t,o,e,i,n)},performUpdateIfNecessary:function(e){null!=this._pendingElement&&ReactReconciler.receiveComponent(this,this._pendingElement||this._currentElement,e,this._context),(null!==this._pendingStateQueue||this._pendingForceUpdate)&&this.updateComponent(e,this._currentElement,this._currentElement,this._context,this._context)},updateComponent:function(e,t,n,o,i){var r,a=this._instance,s=this._context===i?a.context:this._processContext(i);t===n?r=n.props:(r=this._processProps(n.props),a.componentWillReceiveProps&&a.componentWillReceiveProps(r,s));var c=this._processPendingState(r,s),p=this._pendingForceUpdate||!a.shouldComponentUpdate||a.shouldComponentUpdate(r,c,s);p?(this._pendingForceUpdate=!1,this._performComponentUpdate(n,r,c,s,e,i)):(this._currentElement=n,this._context=i,a.props=r,a.state=c,a.context=s)},_processPendingState:function(e,t){var n=this._instance,o=this._pendingStateQueue,i=this._pendingReplaceState;if(this._pendingReplaceState=!1,this._pendingStateQueue=null,!o)return n.state;if(i&&1===o.length)return o[0];for(var r=assign({},i?o[0]:n.state),a=i?1:0;a<o.length;a++){var s=o[a];assign(r,"function"==typeof s?s.call(n,r,e,t):s)}return r},_performComponentUpdate:function(e,t,n,o,i,r){var a,s,c,p=this._instance,u=Boolean(p.componentDidUpdate);u&&(a=p.props,s=p.state,c=p.context),p.componentWillUpdate&&p.componentWillUpdate(t,n,o),this._currentElement=e,this._context=r,p.props=t,p.state=n,p.context=o,this._updateRenderedComponent(i,r),u&&i.getReactMountReady().enqueue(p.componentDidUpdate.bind(p,a,s,c),p)},_updateRenderedComponent:function(e,t){var n=this._renderedComponent,o=n._currentElement,i=this._renderValidatedComponent();if(shouldUpdateReactComponent(o,i))ReactReconciler.receiveComponent(n,i,e,this._processChildContext(t));else{var r=this._rootNodeID,a=n._rootNodeID;ReactReconciler.unmountComponent(n),this._renderedComponent=this._instantiateReactComponent(i);var s=ReactReconciler.mountComponent(this._renderedComponent,r,e,this._processChildContext(t));this._replaceNodeWithMarkupByID(a,s)}},_replaceNodeWithMarkupByID:function(e,t){ReactComponentEnvironment.replaceNodeWithMarkupByID(e,t)},_renderValidatedComponentWithoutOwnerOrContext:function(){var e=this._instance,t=e.render();return t},_renderValidatedComponent:function(){var e;ReactCurrentOwner.current=this;try{e=this._renderValidatedComponentWithoutOwnerOrContext()}finally{ReactCurrentOwner.current=null}return null===e||!1===e||ReactElement.isValidElement(e)||invariant(!1),e},attachRef:function(e,t){var n=this.getPublicInstance();null==n&&invariant(!1);var o=t.getPublicInstance();(n.refs===emptyObject?n.refs={}:n.refs)[e]=o},detachRef:function(e){delete this.getPublicInstance().refs[e]},getName:function(){var e=this._currentElement.type,t=this._instance&&this._instance.constructor;return e.displayName||t&&t.displayName||e.name||t&&t.name||null},getPublicInstance:function(){var e=this._instance;return e instanceof StatelessComponent?null:e},_instantiateReactComponent:null};ReactPerf.measureMethods(ReactCompositeComponentMixin,"ReactCompositeComponent",{mountComponent:"mountComponent",updateComponent:"updateComponent",_renderValidatedComponent:"_renderValidatedComponent"});var ReactCompositeComponent={Mixin:ReactCompositeComponentMixin};module.exports=ReactCompositeComponent;

},{"./Object.assign":164,"./ReactComponentEnvironment":174,"./ReactCurrentOwner":176,"./ReactElement":192,"./ReactInstanceMap":202,"./ReactPerf":211,"./ReactPropTypeLocationNames":212,"./ReactPropTypeLocations":213,"./ReactReconciler":216,"./ReactUpdateQueue":222,"./shouldUpdateReactComponent":266,"fbjs/lib/emptyObject":74,"fbjs/lib/invariant":81,"fbjs/lib/warning":90}],176:[function(require,module,exports){
"use strict";var ReactCurrentOwner={current:null};module.exports=ReactCurrentOwner;

},{}],177:[function(require,module,exports){
"use strict";var ReactCurrentOwner=require("./ReactCurrentOwner"),ReactDOMTextComponent=require("./ReactDOMTextComponent"),ReactDefaultInjection=require("./ReactDefaultInjection"),ReactInstanceHandles=require("./ReactInstanceHandles"),ReactMount=require("./ReactMount"),ReactPerf=require("./ReactPerf"),ReactReconciler=require("./ReactReconciler"),ReactUpdates=require("./ReactUpdates"),ReactVersion=require("./ReactVersion"),findDOMNode=require("./findDOMNode"),renderSubtreeIntoContainer=require("./renderSubtreeIntoContainer"),warning=require("fbjs/lib/warning");ReactDefaultInjection.inject();var ExecutionEnvironment,ieCompatibilityMode,expectedFeatures,i,render=ReactPerf.measure("React","render",ReactMount.render),React={findDOMNode:findDOMNode,render:render,unmountComponentAtNode:ReactMount.unmountComponentAtNode,version:ReactVersion,unstable_batchedUpdates:ReactUpdates.batchedUpdates,unstable_renderSubtreeIntoContainer:renderSubtreeIntoContainer};"undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.inject&&__REACT_DEVTOOLS_GLOBAL_HOOK__.inject({CurrentOwner:ReactCurrentOwner,InstanceHandles:ReactInstanceHandles,Mount:ReactMount,Reconciler:ReactReconciler,TextComponent:ReactDOMTextComponent}),module.exports=React;

},{"./ReactCurrentOwner":176,"./ReactDOMTextComponent":188,"./ReactDefaultInjection":191,"./ReactInstanceHandles":201,"./ReactMount":205,"./ReactPerf":211,"./ReactReconciler":216,"./ReactUpdates":223,"./ReactVersion":224,"./findDOMNode":248,"./renderSubtreeIntoContainer":263,"fbjs/lib/warning":90}],178:[function(require,module,exports){
"use strict";var mouseListenerNames={onClick:!0,onDoubleClick:!0,onMouseDown:!0,onMouseMove:!0,onMouseUp:!0,onClickCapture:!0,onDoubleClickCapture:!0,onMouseDownCapture:!0,onMouseMoveCapture:!0,onMouseUpCapture:!0},ReactDOMButton={getNativeProps:function(e,o,n){if(!o.disabled)return o;var t={};for(var u in o)o.hasOwnProperty(u)&&!mouseListenerNames[u]&&(t[u]=o[u]);return t}};module.exports=ReactDOMButton;

},{}],179:[function(require,module,exports){
"use strict";var legacyPropsDescriptor,AutoFocusUtils=require("./AutoFocusUtils"),CSSPropertyOperations=require("./CSSPropertyOperations"),DOMProperty=require("./DOMProperty"),DOMPropertyOperations=require("./DOMPropertyOperations"),EventConstants=require("./EventConstants"),ReactBrowserEventEmitter=require("./ReactBrowserEventEmitter"),ReactComponentBrowserEnvironment=require("./ReactComponentBrowserEnvironment"),ReactDOMButton=require("./ReactDOMButton"),ReactDOMInput=require("./ReactDOMInput"),ReactDOMOption=require("./ReactDOMOption"),ReactDOMSelect=require("./ReactDOMSelect"),ReactDOMTextarea=require("./ReactDOMTextarea"),ReactMount=require("./ReactMount"),ReactMultiChild=require("./ReactMultiChild"),ReactPerf=require("./ReactPerf"),ReactUpdateQueue=require("./ReactUpdateQueue"),assign=require("./Object.assign"),canDefineProperty=require("./canDefineProperty"),escapeTextContentForBrowser=require("./escapeTextContentForBrowser"),invariant=require("fbjs/lib/invariant"),isEventSupported=require("./isEventSupported"),keyOf=require("fbjs/lib/keyOf"),setInnerHTML=require("./setInnerHTML"),setTextContent=require("./setTextContent"),shallowEqual=require("fbjs/lib/shallowEqual"),validateDOMNesting=require("./validateDOMNesting"),warning=require("fbjs/lib/warning"),deleteListener=ReactBrowserEventEmitter.deleteListener,listenTo=ReactBrowserEventEmitter.listenTo,registrationNameModules=ReactBrowserEventEmitter.registrationNameModules,CONTENT_TYPES={string:!0,number:!0},CHILDREN=keyOf({children:null}),STYLE=keyOf({style:null}),HTML=keyOf({__html:null}),ELEMENT_NODE_TYPE=1;function getDeclarationErrorAddendum(e){if(e){var t=e._currentElement._owner||null;if(t){var r=t.getName();if(r)return" This DOM node was rendered by `"+r+"`."}}return""}function legacyGetDOMNode(){return this}function legacyIsMounted(){var e=this._reactInternalComponent;return!!e}function legacySetStateEtc(){}function legacySetProps(e,t){var r=this._reactInternalComponent;r&&(ReactUpdateQueue.enqueueSetPropsInternal(r,e),t&&ReactUpdateQueue.enqueueCallbackInternal(r,t))}function legacyReplaceProps(e,t){var r=this._reactInternalComponent;r&&(ReactUpdateQueue.enqueueReplacePropsInternal(r,e),t&&ReactUpdateQueue.enqueueCallbackInternal(r,t))}function friendlyStringify(e){if("object"==typeof e){if(Array.isArray(e))return"["+e.map(friendlyStringify).join(", ")+"]";var t=[];for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=/^[a-z$_][\w$_]*$/i.test(r)?r:JSON.stringify(r);t.push(n+": "+friendlyStringify(e[r]))}return"{"+t.join(", ")+"}"}return"string"==typeof e?JSON.stringify(e):"function"==typeof e?"[function object]":String(e)}var styleMutationWarning={};function checkAndWarnForMutatedStyle(e,t,r){if(null!=e&&null!=t&&!shallowEqual(e,t)){var n,a=r._tag,o=r._currentElement._owner;o&&(n=o.getName());var i=n+"|"+a;styleMutationWarning.hasOwnProperty(i)||(styleMutationWarning[i]=!0)}}function assertValidProps(e,t){t&&(null!=t.dangerouslySetInnerHTML&&(null!=t.children&&invariant(!1),"object"==typeof t.dangerouslySetInnerHTML&&HTML in t.dangerouslySetInnerHTML||invariant(!1)),null!=t.style&&"object"!=typeof t.style&&invariant(!1))}function enqueuePutListener(e,t,r,n){var a=ReactMount.findReactContainerForID(e);if(a){var o=a.nodeType===ELEMENT_NODE_TYPE?a.ownerDocument:a;listenTo(t,o)}n.getReactMountReady().enqueue(putListener,{id:e,registrationName:t,listener:r})}function putListener(){ReactBrowserEventEmitter.putListener(this.id,this.registrationName,this.listener)}var mediaEvents={topAbort:"abort",topCanPlay:"canplay",topCanPlayThrough:"canplaythrough",topDurationChange:"durationchange",topEmptied:"emptied",topEncrypted:"encrypted",topEnded:"ended",topError:"error",topLoadedData:"loadeddata",topLoadedMetadata:"loadedmetadata",topLoadStart:"loadstart",topPause:"pause",topPlay:"play",topPlaying:"playing",topProgress:"progress",topRateChange:"ratechange",topSeeked:"seeked",topSeeking:"seeking",topStalled:"stalled",topSuspend:"suspend",topTimeUpdate:"timeupdate",topVolumeChange:"volumechange",topWaiting:"waiting"};function trapBubbledEventsLocal(){this._rootNodeID||invariant(!1);var e=ReactMount.getNode(this._rootNodeID);switch(e||invariant(!1),this._tag){case"iframe":this._wrapperState.listeners=[ReactBrowserEventEmitter.trapBubbledEvent(EventConstants.topLevelTypes.topLoad,"load",e)];break;case"video":case"audio":for(var t in this._wrapperState.listeners=[],mediaEvents)mediaEvents.hasOwnProperty(t)&&this._wrapperState.listeners.push(ReactBrowserEventEmitter.trapBubbledEvent(EventConstants.topLevelTypes[t],mediaEvents[t],e));break;case"img":this._wrapperState.listeners=[ReactBrowserEventEmitter.trapBubbledEvent(EventConstants.topLevelTypes.topError,"error",e),ReactBrowserEventEmitter.trapBubbledEvent(EventConstants.topLevelTypes.topLoad,"load",e)];break;case"form":this._wrapperState.listeners=[ReactBrowserEventEmitter.trapBubbledEvent(EventConstants.topLevelTypes.topReset,"reset",e),ReactBrowserEventEmitter.trapBubbledEvent(EventConstants.topLevelTypes.topSubmit,"submit",e)]}}function mountReadyInputWrapper(){ReactDOMInput.mountReadyWrapper(this)}function postUpdateSelectWrapper(){ReactDOMSelect.postUpdateWrapper(this)}var omittedCloseTags={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},newlineEatingTags={listing:!0,pre:!0,textarea:!0},voidElementTags=assign({menuitem:!0},omittedCloseTags),VALID_TAG_REGEX=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,validatedTagCache={},hasOwnProperty={}.hasOwnProperty;function validateDangerousTag(e){hasOwnProperty.call(validatedTagCache,e)||(VALID_TAG_REGEX.test(e)||invariant(!1),validatedTagCache[e]=!0)}function processChildContextDev(e,t){var r=(e=assign({},e))[validateDOMNesting.ancestorInfoContextKey];return e[validateDOMNesting.ancestorInfoContextKey]=validateDOMNesting.updatedAncestorInfo(r,t._tag,t),e}function isCustomComponent(e,t){return e.indexOf("-")>=0||null!=t.is}function ReactDOMComponent(e){validateDangerousTag(e),this._tag=e.toLowerCase(),this._renderedChildren=null,this._previousStyle=null,this._previousStyleCopy=null,this._rootNodeID=null,this._wrapperState=null,this._topLevelWrapper=null,this._nodeWithLegacyProperties=null}ReactDOMComponent.displayName="ReactDOMComponent",ReactDOMComponent.Mixin={construct:function(e){this._currentElement=e},mountComponent:function(e,t,r){this._rootNodeID=e;var n,a=this._currentElement.props;switch(this._tag){case"iframe":case"img":case"form":case"video":case"audio":this._wrapperState={listeners:null},t.getReactMountReady().enqueue(trapBubbledEventsLocal,this);break;case"button":a=ReactDOMButton.getNativeProps(this,a,r);break;case"input":ReactDOMInput.mountWrapper(this,a,r),a=ReactDOMInput.getNativeProps(this,a,r);break;case"option":ReactDOMOption.mountWrapper(this,a,r),a=ReactDOMOption.getNativeProps(this,a,r);break;case"select":ReactDOMSelect.mountWrapper(this,a,r),a=ReactDOMSelect.getNativeProps(this,a,r),r=ReactDOMSelect.processChildContext(this,a,r);break;case"textarea":ReactDOMTextarea.mountWrapper(this,a,r),a=ReactDOMTextarea.getNativeProps(this,a,r)}if(assertValidProps(this,a),t.useCreateElement){var o=r[ReactMount.ownerDocumentContextKey].createElement(this._currentElement.type);DOMPropertyOperations.setAttributeForID(o,this._rootNodeID),ReactMount.getID(o),this._updateDOMProperties({},a,t,o),this._createInitialChildren(t,a,r,o),n=o}else{var i=this._createOpenTagMarkupAndPutListeners(t,a),s=this._createContentMarkup(t,a,r);n=!s&&omittedCloseTags[this._tag]?i+"/>":i+">"+s+"</"+this._currentElement.type+">"}switch(this._tag){case"input":t.getReactMountReady().enqueue(mountReadyInputWrapper,this);case"button":case"select":case"textarea":a.autoFocus&&t.getReactMountReady().enqueue(AutoFocusUtils.focusDOMComponent,this)}return n},_createOpenTagMarkupAndPutListeners:function(e,t){var r="<"+this._currentElement.type;for(var n in t)if(t.hasOwnProperty(n)){var a=t[n];if(null!=a)if(registrationNameModules.hasOwnProperty(n))a&&enqueuePutListener(this._rootNodeID,n,a,e);else{n===STYLE&&(a&&(a=this._previousStyleCopy=assign({},t.style)),a=CSSPropertyOperations.createMarkupForStyles(a));var o=null;null!=this._tag&&isCustomComponent(this._tag,t)?n!==CHILDREN&&(o=DOMPropertyOperations.createMarkupForCustomAttribute(n,a)):o=DOMPropertyOperations.createMarkupForProperty(n,a),o&&(r+=" "+o)}}return e.renderToStaticMarkup?r:r+" "+DOMPropertyOperations.createMarkupForID(this._rootNodeID)},_createContentMarkup:function(e,t,r){var n="",a=t.dangerouslySetInnerHTML;if(null!=a)null!=a.__html&&(n=a.__html);else{var o=CONTENT_TYPES[typeof t.children]?t.children:null,i=null!=o?null:t.children;if(null!=o)n=escapeTextContentForBrowser(o);else if(null!=i){n=this.mountChildren(i,e,r).join("")}}return newlineEatingTags[this._tag]&&"\n"===n.charAt(0)?"\n"+n:n},_createInitialChildren:function(e,t,r,n){var a=t.dangerouslySetInnerHTML;if(null!=a)null!=a.__html&&setInnerHTML(n,a.__html);else{var o=CONTENT_TYPES[typeof t.children]?t.children:null,i=null!=o?null:t.children;if(null!=o)setTextContent(n,o);else if(null!=i)for(var s=this.mountChildren(i,e,r),p=0;p<s.length;p++)n.appendChild(s[p])}},receiveComponent:function(e,t,r){var n=this._currentElement;this._currentElement=e,this.updateComponent(t,n,e,r)},updateComponent:function(e,t,r,n){var a=t.props,o=this._currentElement.props;switch(this._tag){case"button":a=ReactDOMButton.getNativeProps(this,a),o=ReactDOMButton.getNativeProps(this,o);break;case"input":ReactDOMInput.updateWrapper(this),a=ReactDOMInput.getNativeProps(this,a),o=ReactDOMInput.getNativeProps(this,o);break;case"option":a=ReactDOMOption.getNativeProps(this,a),o=ReactDOMOption.getNativeProps(this,o);break;case"select":a=ReactDOMSelect.getNativeProps(this,a),o=ReactDOMSelect.getNativeProps(this,o);break;case"textarea":ReactDOMTextarea.updateWrapper(this),a=ReactDOMTextarea.getNativeProps(this,a),o=ReactDOMTextarea.getNativeProps(this,o)}assertValidProps(this,o),this._updateDOMProperties(a,o,e,null),this._updateDOMChildren(a,o,e,n),!canDefineProperty&&this._nodeWithLegacyProperties&&(this._nodeWithLegacyProperties.props=o),"select"===this._tag&&e.getReactMountReady().enqueue(postUpdateSelectWrapper,this)},_updateDOMProperties:function(e,t,r,n){var a,o,i;for(a in e)if(!t.hasOwnProperty(a)&&e.hasOwnProperty(a))if(a===STYLE){var s=this._previousStyleCopy;for(o in s)s.hasOwnProperty(o)&&((i=i||{})[o]="");this._previousStyleCopy=null}else registrationNameModules.hasOwnProperty(a)?e[a]&&deleteListener(this._rootNodeID,a):(DOMProperty.properties[a]||DOMProperty.isCustomAttribute(a))&&(n||(n=ReactMount.getNode(this._rootNodeID)),DOMPropertyOperations.deleteValueForProperty(n,a));for(a in t){var p=t[a],l=a===STYLE?this._previousStyleCopy:e[a];if(t.hasOwnProperty(a)&&p!==l)if(a===STYLE)if(p?p=this._previousStyleCopy=assign({},p):this._previousStyleCopy=null,l){for(o in l)!l.hasOwnProperty(o)||p&&p.hasOwnProperty(o)||((i=i||{})[o]="");for(o in p)p.hasOwnProperty(o)&&l[o]!==p[o]&&((i=i||{})[o]=p[o])}else i=p;else registrationNameModules.hasOwnProperty(a)?p?enqueuePutListener(this._rootNodeID,a,p,r):l&&deleteListener(this._rootNodeID,a):isCustomComponent(this._tag,t)?(n||(n=ReactMount.getNode(this._rootNodeID)),a===CHILDREN&&(p=null),DOMPropertyOperations.setValueForAttribute(n,a,p)):(DOMProperty.properties[a]||DOMProperty.isCustomAttribute(a))&&(n||(n=ReactMount.getNode(this._rootNodeID)),null!=p?DOMPropertyOperations.setValueForProperty(n,a,p):DOMPropertyOperations.deleteValueForProperty(n,a))}i&&(n||(n=ReactMount.getNode(this._rootNodeID)),CSSPropertyOperations.setValueForStyles(n,i))},_updateDOMChildren:function(e,t,r,n){var a=CONTENT_TYPES[typeof e.children]?e.children:null,o=CONTENT_TYPES[typeof t.children]?t.children:null,i=e.dangerouslySetInnerHTML&&e.dangerouslySetInnerHTML.__html,s=t.dangerouslySetInnerHTML&&t.dangerouslySetInnerHTML.__html,p=null!=a?null:e.children,l=null!=o?null:t.children,u=null!=a||null!=i,c=null!=o||null!=s;null!=p&&null==l?this.updateChildren(null,r,n):u&&!c&&this.updateTextContent(""),null!=o?a!==o&&this.updateTextContent(""+o):null!=s?i!==s&&this.updateMarkup(""+s):null!=l&&this.updateChildren(l,r,n)},unmountComponent:function(){switch(this._tag){case"iframe":case"img":case"form":case"video":case"audio":var e=this._wrapperState.listeners;if(e)for(var t=0;t<e.length;t++)e[t].remove();break;case"input":ReactDOMInput.unmountWrapper(this);break;case"html":case"head":case"body":invariant(!1)}(this.unmountChildren(),ReactBrowserEventEmitter.deleteAllListeners(this._rootNodeID),ReactComponentBrowserEnvironment.unmountIDFromEnvironment(this._rootNodeID),this._rootNodeID=null,this._wrapperState=null,this._nodeWithLegacyProperties)&&(this._nodeWithLegacyProperties._reactInternalComponent=null,this._nodeWithLegacyProperties=null)},getPublicInstance:function(){if(!this._nodeWithLegacyProperties){var e=ReactMount.getNode(this._rootNodeID);e._reactInternalComponent=this,e.getDOMNode=legacyGetDOMNode,e.isMounted=legacyIsMounted,e.setState=legacySetStateEtc,e.replaceState=legacySetStateEtc,e.forceUpdate=legacySetStateEtc,e.setProps=legacySetProps,e.replaceProps=legacyReplaceProps,e.props=this._currentElement.props,this._nodeWithLegacyProperties=e}return this._nodeWithLegacyProperties}},ReactPerf.measureMethods(ReactDOMComponent,"ReactDOMComponent",{mountComponent:"mountComponent",updateComponent:"updateComponent"}),assign(ReactDOMComponent.prototype,ReactDOMComponent.Mixin,ReactMultiChild.Mixin),module.exports=ReactDOMComponent;

},{"./AutoFocusUtils":143,"./CSSPropertyOperations":146,"./DOMProperty":151,"./DOMPropertyOperations":152,"./EventConstants":156,"./Object.assign":164,"./ReactBrowserEventEmitter":168,"./ReactComponentBrowserEnvironment":173,"./ReactDOMButton":178,"./ReactDOMInput":183,"./ReactDOMOption":184,"./ReactDOMSelect":185,"./ReactDOMTextarea":189,"./ReactMount":205,"./ReactMultiChild":206,"./ReactPerf":211,"./ReactUpdateQueue":222,"./canDefineProperty":244,"./escapeTextContentForBrowser":247,"./isEventSupported":259,"./setInnerHTML":264,"./setTextContent":265,"./validateDOMNesting":268,"fbjs/lib/invariant":81,"fbjs/lib/keyOf":85,"fbjs/lib/shallowEqual":88,"fbjs/lib/warning":90}],180:[function(require,module,exports){
"use strict";var ReactElement=require("./ReactElement"),ReactElementValidator=require("./ReactElementValidator"),mapObject=require("fbjs/lib/mapObject");function createDOMFactory(e){return ReactElement.createFactory(e)}var ReactDOMFactories=mapObject({a:"a",abbr:"abbr",address:"address",area:"area",article:"article",aside:"aside",audio:"audio",b:"b",base:"base",bdi:"bdi",bdo:"bdo",big:"big",blockquote:"blockquote",body:"body",br:"br",button:"button",canvas:"canvas",caption:"caption",cite:"cite",code:"code",col:"col",colgroup:"colgroup",data:"data",datalist:"datalist",dd:"dd",del:"del",details:"details",dfn:"dfn",dialog:"dialog",div:"div",dl:"dl",dt:"dt",em:"em",embed:"embed",fieldset:"fieldset",figcaption:"figcaption",figure:"figure",footer:"footer",form:"form",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",head:"head",header:"header",hgroup:"hgroup",hr:"hr",html:"html",i:"i",iframe:"iframe",img:"img",input:"input",ins:"ins",kbd:"kbd",keygen:"keygen",label:"label",legend:"legend",li:"li",link:"link",main:"main",map:"map",mark:"mark",menu:"menu",menuitem:"menuitem",meta:"meta",meter:"meter",nav:"nav",noscript:"noscript",object:"object",ol:"ol",optgroup:"optgroup",option:"option",output:"output",p:"p",param:"param",picture:"picture",pre:"pre",progress:"progress",q:"q",rp:"rp",rt:"rt",ruby:"ruby",s:"s",samp:"samp",script:"script",section:"section",select:"select",small:"small",source:"source",span:"span",strong:"strong",style:"style",sub:"sub",summary:"summary",sup:"sup",table:"table",tbody:"tbody",td:"td",textarea:"textarea",tfoot:"tfoot",th:"th",thead:"thead",time:"time",title:"title",tr:"tr",track:"track",u:"u",ul:"ul",var:"var",video:"video",wbr:"wbr",circle:"circle",clipPath:"clipPath",defs:"defs",ellipse:"ellipse",g:"g",image:"image",line:"line",linearGradient:"linearGradient",mask:"mask",path:"path",pattern:"pattern",polygon:"polygon",polyline:"polyline",radialGradient:"radialGradient",rect:"rect",stop:"stop",svg:"svg",text:"text",tspan:"tspan"},createDOMFactory);module.exports=ReactDOMFactories;

},{"./ReactElement":192,"./ReactElementValidator":193,"fbjs/lib/mapObject":86}],181:[function(require,module,exports){
"use strict";var ReactDOMFeatureFlags={useCreateElement:!1};module.exports=ReactDOMFeatureFlags;

},{}],182:[function(require,module,exports){
"use strict";var DOMChildrenOperations=require("./DOMChildrenOperations"),DOMPropertyOperations=require("./DOMPropertyOperations"),ReactMount=require("./ReactMount"),ReactPerf=require("./ReactPerf"),invariant=require("fbjs/lib/invariant"),INVALID_PROPERTY_ERRORS={dangerouslySetInnerHTML:"`dangerouslySetInnerHTML` must be set using `updateInnerHTMLByID()`.",style:"`style` must be set using `updateStylesByID()`."},ReactDOMIDOperations={updatePropertyByID:function(e,r,t){var a=ReactMount.getNode(e);INVALID_PROPERTY_ERRORS.hasOwnProperty(r)&&invariant(!1),null!=t?DOMPropertyOperations.setValueForProperty(a,r,t):DOMPropertyOperations.deleteValueForProperty(a,r)},dangerouslyReplaceNodeWithMarkupByID:function(e,r){var t=ReactMount.getNode(e);DOMChildrenOperations.dangerouslyReplaceNodeWithMarkup(t,r)},dangerouslyProcessChildrenUpdates:function(e,r){for(var t=0;t<e.length;t++)e[t].parentNode=ReactMount.getNode(e[t].parentID);DOMChildrenOperations.processUpdates(e,r)}};ReactPerf.measureMethods(ReactDOMIDOperations,"ReactDOMIDOperations",{dangerouslyReplaceNodeWithMarkupByID:"dangerouslyReplaceNodeWithMarkupByID",dangerouslyProcessChildrenUpdates:"dangerouslyProcessChildrenUpdates"}),module.exports=ReactDOMIDOperations;

},{"./DOMChildrenOperations":150,"./DOMPropertyOperations":152,"./ReactMount":205,"./ReactPerf":211,"fbjs/lib/invariant":81}],183:[function(require,module,exports){
"use strict";var ReactDOMIDOperations=require("./ReactDOMIDOperations"),LinkedValueUtils=require("./LinkedValueUtils"),ReactMount=require("./ReactMount"),ReactUpdates=require("./ReactUpdates"),assign=require("./Object.assign"),invariant=require("fbjs/lib/invariant"),instancesByReactID={};function forceUpdateIfMounted(){this._rootNodeID&&ReactDOMInput.updateWrapper(this)}var ReactDOMInput={getNativeProps:function(e,t,a){var n=LinkedValueUtils.getValue(t),r=LinkedValueUtils.getChecked(t);return assign({},t,{defaultChecked:void 0,defaultValue:void 0,value:null!=n?n:e._wrapperState.initialValue,checked:null!=r?r:e._wrapperState.initialChecked,onChange:e._wrapperState.onChange})},mountWrapper:function(e,t){var a=t.defaultValue;e._wrapperState={initialChecked:t.defaultChecked||!1,initialValue:null!=a?a:null,onChange:_handleChange.bind(e)}},mountReadyWrapper:function(e){instancesByReactID[e._rootNodeID]=e},unmountWrapper:function(e){delete instancesByReactID[e._rootNodeID]},updateWrapper:function(e){var t=e._currentElement.props,a=t.checked;null!=a&&ReactDOMIDOperations.updatePropertyByID(e._rootNodeID,"checked",a||!1);var n=LinkedValueUtils.getValue(t);null!=n&&ReactDOMIDOperations.updatePropertyByID(e._rootNodeID,"value",""+n)}};function _handleChange(e){var t=this._currentElement.props,a=LinkedValueUtils.executeOnChange(t,e);ReactUpdates.asap(forceUpdateIfMounted,this);var n=t.name;if("radio"===t.type&&null!=n){for(var r=ReactMount.getNode(this._rootNodeID),i=r;i.parentNode;)i=i.parentNode;for(var u=i.querySelectorAll("input[name="+JSON.stringify(""+n)+'][type="radio"]'),o=0;o<u.length;o++){var l=u[o];if(l!==r&&l.form===r.form){var d=ReactMount.getID(l);d||invariant(!1);var p=instancesByReactID[d];p||invariant(!1),ReactUpdates.asap(forceUpdateIfMounted,p)}}}return a}module.exports=ReactDOMInput;

},{"./LinkedValueUtils":163,"./Object.assign":164,"./ReactDOMIDOperations":182,"./ReactMount":205,"./ReactUpdates":223,"fbjs/lib/invariant":81}],184:[function(require,module,exports){
"use strict";var ReactChildren=require("./ReactChildren"),ReactDOMSelect=require("./ReactDOMSelect"),assign=require("./Object.assign"),warning=require("fbjs/lib/warning"),valueContextKey=ReactDOMSelect.valueContextKey,ReactDOMOption={mountWrapper:function(e,t,r){var a=r[valueContextKey],n=null;if(null!=a)if(n=!1,Array.isArray(a)){for(var l=0;l<a.length;l++)if(""+a[l]==""+t.value){n=!0;break}}else n=""+a==""+t.value;e._wrapperState={selected:n}},getNativeProps:function(e,t,r){var a=assign({selected:void 0,children:void 0},t);null!=e._wrapperState.selected&&(a.selected=e._wrapperState.selected);var n="";return ReactChildren.forEach(t.children,function(e){null!=e&&("string"!=typeof e&&"number"!=typeof e||(n+=e))}),n&&(a.children=n),a}};module.exports=ReactDOMOption;

},{"./Object.assign":164,"./ReactChildren":170,"./ReactDOMSelect":185,"fbjs/lib/warning":90}],185:[function(require,module,exports){
"use strict";var LinkedValueUtils=require("./LinkedValueUtils"),ReactMount=require("./ReactMount"),ReactUpdates=require("./ReactUpdates"),assign=require("./Object.assign"),warning=require("fbjs/lib/warning"),valueContextKey="__ReactDOMSelect_value$"+Math.random().toString(36).slice(2);function updateOptionsIfPendingUpdateAndMounted(){if(this._rootNodeID&&this._wrapperState.pendingUpdate){this._wrapperState.pendingUpdate=!1;var e=this._currentElement.props,t=LinkedValueUtils.getValue(e);null!=t&&updateOptions(this,Boolean(e.multiple),t)}}function getDeclarationErrorAddendum(e){if(e){var t=e.getName();if(t)return" Check the render method of `"+t+"`."}return""}var valuePropNames=["value","defaultValue"];function checkSelectPropTypes(e,t){var a=e._currentElement._owner;LinkedValueUtils.checkPropTypes("select",t,a);for(var n=0;n<valuePropNames.length;n++){var l=valuePropNames[n];null!=t[l]&&t.multiple}}function updateOptions(e,t,a){var n,l,r=ReactMount.getNode(e._rootNodeID).options;if(t){for(n={},l=0;l<a.length;l++)n[""+a[l]]=!0;for(l=0;l<r.length;l++){var i=n.hasOwnProperty(r[l].value);r[l].selected!==i&&(r[l].selected=i)}}else{for(n=""+a,l=0;l<r.length;l++)if(r[l].value===n)return void(r[l].selected=!0);r.length&&(r[0].selected=!0)}}var ReactDOMSelect={valueContextKey:valueContextKey,getNativeProps:function(e,t,a){return assign({},t,{onChange:e._wrapperState.onChange,value:void 0})},mountWrapper:function(e,t){var a=LinkedValueUtils.getValue(t);e._wrapperState={pendingUpdate:!1,initialValue:null!=a?a:t.defaultValue,onChange:_handleChange.bind(e),wasMultiple:Boolean(t.multiple)}},processChildContext:function(e,t,a){var n=assign({},a);return n[valueContextKey]=e._wrapperState.initialValue,n},postUpdateWrapper:function(e){var t=e._currentElement.props;e._wrapperState.initialValue=void 0;var a=e._wrapperState.wasMultiple;e._wrapperState.wasMultiple=Boolean(t.multiple);var n=LinkedValueUtils.getValue(t);null!=n?(e._wrapperState.pendingUpdate=!1,updateOptions(e,Boolean(t.multiple),n)):a!==Boolean(t.multiple)&&(null!=t.defaultValue?updateOptions(e,Boolean(t.multiple),t.defaultValue):updateOptions(e,Boolean(t.multiple),t.multiple?[]:""))}};function _handleChange(e){var t=this._currentElement.props,a=LinkedValueUtils.executeOnChange(t,e);return this._wrapperState.pendingUpdate=!0,ReactUpdates.asap(updateOptionsIfPendingUpdateAndMounted,this),a}module.exports=ReactDOMSelect;

},{"./LinkedValueUtils":163,"./Object.assign":164,"./ReactMount":205,"./ReactUpdates":223,"fbjs/lib/warning":90}],186:[function(require,module,exports){
"use strict";var ExecutionEnvironment=require("fbjs/lib/ExecutionEnvironment"),getNodeForCharacterOffset=require("./getNodeForCharacterOffset"),getTextContentAccessor=require("./getTextContentAccessor");function isCollapsed(e,t,n,o){return e===n&&t===o}function getIEOffsets(e){var t=document.selection.createRange(),n=t.text.length,o=t.duplicate();o.moveToElementText(e),o.setEndPoint("EndToStart",t);var s=o.text.length;return{start:s,end:s+n}}function getModernOffsets(e){var t=window.getSelection&&window.getSelection();if(!t||0===t.rangeCount)return null;var n=t.anchorNode,o=t.anchorOffset,s=t.focusNode,r=t.focusOffset,a=t.getRangeAt(0);try{a.startContainer.nodeType,a.endContainer.nodeType}catch(e){return null}var f=isCollapsed(t.anchorNode,t.anchorOffset,t.focusNode,t.focusOffset)?0:a.toString().length,d=a.cloneRange();d.selectNodeContents(e),d.setEnd(a.startContainer,a.startOffset);var c=isCollapsed(d.startContainer,d.startOffset,d.endContainer,d.endOffset)?0:d.toString().length,i=c+f,l=document.createRange();l.setStart(n,o),l.setEnd(s,r);var g=l.collapsed;return{start:g?i:c,end:g?c:i}}function setIEOffsets(e,t){var n,o,s=document.selection.createRange().duplicate();void 0===t.end?o=n=t.start:t.start>t.end?(n=t.end,o=t.start):(n=t.start,o=t.end),s.moveToElementText(e),s.moveStart("character",n),s.setEndPoint("EndToStart",s),s.moveEnd("character",o-n),s.select()}function setModernOffsets(e,t){if(window.getSelection){var n=window.getSelection(),o=e[getTextContentAccessor()].length,s=Math.min(t.start,o),r=void 0===t.end?s:Math.min(t.end,o);if(!n.extend&&s>r){var a=r;r=s,s=a}var f=getNodeForCharacterOffset(e,s),d=getNodeForCharacterOffset(e,r);if(f&&d){var c=document.createRange();c.setStart(f.node,f.offset),n.removeAllRanges(),s>r?(n.addRange(c),n.extend(d.node,d.offset)):(c.setEnd(d.node,d.offset),n.addRange(c))}}}var useIEOffsets=ExecutionEnvironment.canUseDOM&&"selection"in document&&!("getSelection"in window),ReactDOMSelection={getOffsets:useIEOffsets?getIEOffsets:getModernOffsets,setOffsets:useIEOffsets?setIEOffsets:setModernOffsets};module.exports=ReactDOMSelection;

},{"./getNodeForCharacterOffset":256,"./getTextContentAccessor":257,"fbjs/lib/ExecutionEnvironment":67}],187:[function(require,module,exports){
"use strict";var ReactDefaultInjection=require("./ReactDefaultInjection"),ReactServerRendering=require("./ReactServerRendering"),ReactVersion=require("./ReactVersion");ReactDefaultInjection.inject();var ReactDOMServer={renderToString:ReactServerRendering.renderToString,renderToStaticMarkup:ReactServerRendering.renderToStaticMarkup,version:ReactVersion};module.exports=ReactDOMServer;

},{"./ReactDefaultInjection":191,"./ReactServerRendering":220,"./ReactVersion":224}],188:[function(require,module,exports){
"use strict";var DOMChildrenOperations=require("./DOMChildrenOperations"),DOMPropertyOperations=require("./DOMPropertyOperations"),ReactComponentBrowserEnvironment=require("./ReactComponentBrowserEnvironment"),ReactMount=require("./ReactMount"),assign=require("./Object.assign"),escapeTextContentForBrowser=require("./escapeTextContentForBrowser"),setTextContent=require("./setTextContent"),validateDOMNesting=require("./validateDOMNesting"),ReactDOMTextComponent=function(e){};assign(ReactDOMTextComponent.prototype,{construct:function(e){this._currentElement=e,this._stringText=""+e,this._rootNodeID=null,this._mountIndex=0},mountComponent:function(e,t,n){if(this._rootNodeID=e,t.useCreateElement){var r=n[ReactMount.ownerDocumentContextKey].createElement("span");return DOMPropertyOperations.setAttributeForID(r,e),ReactMount.getID(r),setTextContent(r,this._stringText),r}var o=escapeTextContentForBrowser(this._stringText);return t.renderToStaticMarkup?o:"<span "+DOMPropertyOperations.createMarkupForID(e)+">"+o+"</span>"},receiveComponent:function(e,t){if(e!==this._currentElement){this._currentElement=e;var n=""+e;if(n!==this._stringText){this._stringText=n;var r=ReactMount.getNode(this._rootNodeID);DOMChildrenOperations.updateTextContent(r,n)}}},unmountComponent:function(){ReactComponentBrowserEnvironment.unmountIDFromEnvironment(this._rootNodeID)}}),module.exports=ReactDOMTextComponent;

},{"./DOMChildrenOperations":150,"./DOMPropertyOperations":152,"./Object.assign":164,"./ReactComponentBrowserEnvironment":173,"./ReactMount":205,"./escapeTextContentForBrowser":247,"./setTextContent":265,"./validateDOMNesting":268}],189:[function(require,module,exports){
"use strict";var LinkedValueUtils=require("./LinkedValueUtils"),ReactDOMIDOperations=require("./ReactDOMIDOperations"),ReactUpdates=require("./ReactUpdates"),assign=require("./Object.assign"),invariant=require("fbjs/lib/invariant"),warning=require("fbjs/lib/warning");function forceUpdateIfMounted(){this._rootNodeID&&ReactDOMTextarea.updateWrapper(this)}var ReactDOMTextarea={getNativeProps:function(e,a,t){return null!=a.dangerouslySetInnerHTML&&invariant(!1),assign({},a,{defaultValue:void 0,value:void 0,children:e._wrapperState.initialValue,onChange:e._wrapperState.onChange})},mountWrapper:function(e,a){var t=a.defaultValue,n=a.children;null!=n&&(null!=t&&invariant(!1),Array.isArray(n)&&(n.length<=1||invariant(!1),n=n[0]),t=""+n),null==t&&(t="");var r=LinkedValueUtils.getValue(a);e._wrapperState={initialValue:""+(null!=r?r:t),onChange:_handleChange.bind(e)}},updateWrapper:function(e){var a=e._currentElement.props,t=LinkedValueUtils.getValue(a);null!=t&&ReactDOMIDOperations.updatePropertyByID(e._rootNodeID,"value",""+t)}};function _handleChange(e){var a=this._currentElement.props,t=LinkedValueUtils.executeOnChange(a,e);return ReactUpdates.asap(forceUpdateIfMounted,this),t}module.exports=ReactDOMTextarea;

},{"./LinkedValueUtils":163,"./Object.assign":164,"./ReactDOMIDOperations":182,"./ReactUpdates":223,"fbjs/lib/invariant":81,"fbjs/lib/warning":90}],190:[function(require,module,exports){
"use strict";var ReactUpdates=require("./ReactUpdates"),Transaction=require("./Transaction"),assign=require("./Object.assign"),emptyFunction=require("fbjs/lib/emptyFunction"),RESET_BATCHED_UPDATES={initialize:emptyFunction,close:function(){ReactDefaultBatchingStrategy.isBatchingUpdates=!1}},FLUSH_BATCHED_UPDATES={initialize:emptyFunction,close:ReactUpdates.flushBatchedUpdates.bind(ReactUpdates)},TRANSACTION_WRAPPERS=[FLUSH_BATCHED_UPDATES,RESET_BATCHED_UPDATES];function ReactDefaultBatchingStrategyTransaction(){this.reinitializeTransaction()}assign(ReactDefaultBatchingStrategyTransaction.prototype,Transaction.Mixin,{getTransactionWrappers:function(){return TRANSACTION_WRAPPERS}});var transaction=new ReactDefaultBatchingStrategyTransaction,ReactDefaultBatchingStrategy={isBatchingUpdates:!1,batchedUpdates:function(t,a,e,i,n,c){var r=ReactDefaultBatchingStrategy.isBatchingUpdates;ReactDefaultBatchingStrategy.isBatchingUpdates=!0,r?t(a,e,i,n,c):transaction.perform(t,null,a,e,i,n,c)}};module.exports=ReactDefaultBatchingStrategy;

},{"./Object.assign":164,"./ReactUpdates":223,"./Transaction":240,"fbjs/lib/emptyFunction":73}],191:[function(require,module,exports){
"use strict";var BeforeInputEventPlugin=require("./BeforeInputEventPlugin"),ChangeEventPlugin=require("./ChangeEventPlugin"),ClientReactRootIndex=require("./ClientReactRootIndex"),DefaultEventPluginOrder=require("./DefaultEventPluginOrder"),EnterLeaveEventPlugin=require("./EnterLeaveEventPlugin"),ExecutionEnvironment=require("fbjs/lib/ExecutionEnvironment"),HTMLDOMPropertyConfig=require("./HTMLDOMPropertyConfig"),ReactBrowserComponentMixin=require("./ReactBrowserComponentMixin"),ReactComponentBrowserEnvironment=require("./ReactComponentBrowserEnvironment"),ReactDefaultBatchingStrategy=require("./ReactDefaultBatchingStrategy"),ReactDOMComponent=require("./ReactDOMComponent"),ReactDOMTextComponent=require("./ReactDOMTextComponent"),ReactEventListener=require("./ReactEventListener"),ReactInjection=require("./ReactInjection"),ReactInstanceHandles=require("./ReactInstanceHandles"),ReactMount=require("./ReactMount"),ReactReconcileTransaction=require("./ReactReconcileTransaction"),SelectEventPlugin=require("./SelectEventPlugin"),ServerReactRootIndex=require("./ServerReactRootIndex"),SimpleEventPlugin=require("./SimpleEventPlugin"),SVGDOMPropertyConfig=require("./SVGDOMPropertyConfig"),alreadyInjected=!1;function inject(){alreadyInjected||(alreadyInjected=!0,ReactInjection.EventEmitter.injectReactEventListener(ReactEventListener),ReactInjection.EventPluginHub.injectEventPluginOrder(DefaultEventPluginOrder),ReactInjection.EventPluginHub.injectInstanceHandle(ReactInstanceHandles),ReactInjection.EventPluginHub.injectMount(ReactMount),ReactInjection.EventPluginHub.injectEventPluginsByName({SimpleEventPlugin:SimpleEventPlugin,EnterLeaveEventPlugin:EnterLeaveEventPlugin,ChangeEventPlugin:ChangeEventPlugin,SelectEventPlugin:SelectEventPlugin,BeforeInputEventPlugin:BeforeInputEventPlugin}),ReactInjection.NativeComponent.injectGenericComponentClass(ReactDOMComponent),ReactInjection.NativeComponent.injectTextComponentClass(ReactDOMTextComponent),ReactInjection.Class.injectMixin(ReactBrowserComponentMixin),ReactInjection.DOMProperty.injectDOMPropertyConfig(HTMLDOMPropertyConfig),ReactInjection.DOMProperty.injectDOMPropertyConfig(SVGDOMPropertyConfig),ReactInjection.EmptyComponent.injectEmptyComponent("noscript"),ReactInjection.Updates.injectReconcileTransaction(ReactReconcileTransaction),ReactInjection.Updates.injectBatchingStrategy(ReactDefaultBatchingStrategy),ReactInjection.RootIndex.injectCreateReactRootIndex(ExecutionEnvironment.canUseDOM?ClientReactRootIndex.createReactRootIndex:ServerReactRootIndex.createReactRootIndex),ReactInjection.Component.injectEnvironment(ReactComponentBrowserEnvironment))}module.exports={inject:inject};

},{"./BeforeInputEventPlugin":144,"./ChangeEventPlugin":148,"./ClientReactRootIndex":149,"./DefaultEventPluginOrder":154,"./EnterLeaveEventPlugin":155,"./HTMLDOMPropertyConfig":162,"./ReactBrowserComponentMixin":167,"./ReactComponentBrowserEnvironment":173,"./ReactDOMComponent":179,"./ReactDOMTextComponent":188,"./ReactDefaultBatchingStrategy":190,"./ReactEventListener":198,"./ReactInjection":199,"./ReactInstanceHandles":201,"./ReactMount":205,"./ReactReconcileTransaction":215,"./SVGDOMPropertyConfig":225,"./SelectEventPlugin":226,"./ServerReactRootIndex":227,"./SimpleEventPlugin":228,"fbjs/lib/ExecutionEnvironment":67}],192:[function(require,module,exports){
"use strict";var ReactCurrentOwner=require("./ReactCurrentOwner"),assign=require("./Object.assign"),canDefineProperty=require("./canDefineProperty"),REACT_ELEMENT_TYPE="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,RESERVED_PROPS={key:!0,ref:!0,__self:!0,__source:!0},ReactElement=function(e,r,n,t,l,o,c){var a={$$typeof:REACT_ELEMENT_TYPE,type:e,key:r,ref:n,props:c,_owner:o};return a};ReactElement.createElement=function(e,r,n){var t,l={},o=null,c=null,a=null,u=null;if(null!=r)for(t in c=void 0===r.ref?null:r.ref,o=void 0===r.key?null:""+r.key,a=void 0===r.__self?null:r.__self,u=void 0===r.__source?null:r.__source,r)r.hasOwnProperty(t)&&!RESERVED_PROPS.hasOwnProperty(t)&&(l[t]=r[t]);var f=arguments.length-2;if(1===f)l.children=n;else if(f>1){for(var i=Array(f),E=0;E<f;E++)i[E]=arguments[E+2];l.children=i}if(e&&e.defaultProps){var s=e.defaultProps;for(t in s)void 0===l[t]&&(l[t]=s[t])}return ReactElement(e,o,c,a,u,ReactCurrentOwner.current,l)},ReactElement.createFactory=function(e){var r=ReactElement.createElement.bind(null,e);return r.type=e,r},ReactElement.cloneAndReplaceKey=function(e,r){return ReactElement(e.type,r,e.ref,e._self,e._source,e._owner,e.props)},ReactElement.cloneAndReplaceProps=function(e,r){var n=ReactElement(e.type,e.key,e.ref,e._self,e._source,e._owner,r);return n},ReactElement.cloneElement=function(e,r,n){var t,l=assign({},e.props),o=e.key,c=e.ref,a=e._self,u=e._source,f=e._owner;if(null!=r)for(t in void 0!==r.ref&&(c=r.ref,f=ReactCurrentOwner.current),void 0!==r.key&&(o=""+r.key),r)r.hasOwnProperty(t)&&!RESERVED_PROPS.hasOwnProperty(t)&&(l[t]=r[t]);var i=arguments.length-2;if(1===i)l.children=n;else if(i>1){for(var E=Array(i),s=0;s<i;s++)E[s]=arguments[s+2];l.children=E}return ReactElement(e.type,o,c,a,u,f,l)},ReactElement.isValidElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===REACT_ELEMENT_TYPE},module.exports=ReactElement;

},{"./Object.assign":164,"./ReactCurrentOwner":176,"./canDefineProperty":244}],193:[function(require,module,exports){
"use strict";var ReactElement=require("./ReactElement"),ReactPropTypeLocations=require("./ReactPropTypeLocations"),ReactPropTypeLocationNames=require("./ReactPropTypeLocationNames"),ReactCurrentOwner=require("./ReactCurrentOwner"),canDefineProperty=require("./canDefineProperty"),getIteratorFn=require("./getIteratorFn"),invariant=require("fbjs/lib/invariant"),warning=require("fbjs/lib/warning");function getDeclarationErrorAddendum(){if(ReactCurrentOwner.current){var e=ReactCurrentOwner.current.getName();if(e)return" Check the render method of `"+e+"`."}return""}var ownerHasKeyUseWarning={},loggedTypeFailures={};function validateExplicitKey(e,r){if(e._store&&!e._store.validated&&null==e.key){e._store.validated=!0;getAddendaForKeyUse("uniqueKey",e,r)}}function getAddendaForKeyUse(e,r,t){var a=getDeclarationErrorAddendum();if(!a){var n="string"==typeof t?t:t.displayName||t.name;n&&(a=" Check the top-level render call using <"+n+">.")}var i=ownerHasKeyUseWarning[e]||(ownerHasKeyUseWarning[e]={});if(i[a])return null;i[a]=!0;var o={parentOrOwner:a,url:" See https://fb.me/react-warning-keys for more information.",childOwner:null};return r&&r._owner&&r._owner!==ReactCurrentOwner.current&&(o.childOwner=" It was passed a child from "+r._owner.getName()+"."),o}function validateChildKeys(e,r){if("object"==typeof e)if(Array.isArray(e))for(var t=0;t<e.length;t++){var a=e[t];ReactElement.isValidElement(a)&&validateExplicitKey(a,r)}else if(ReactElement.isValidElement(e))e._store&&(e._store.validated=!0);else if(e){var n=getIteratorFn(e);if(n&&n!==e.entries)for(var i,o=n.call(e);!(i=o.next()).done;)ReactElement.isValidElement(i.value)&&validateExplicitKey(i.value,r)}}function checkPropTypes(e,r,t,a){for(var n in r)if(r.hasOwnProperty(n)){var i;try{"function"!=typeof r[n]&&invariant(!1),i=r[n](t,n,e,a,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(e){i=e}if(i instanceof Error&&!(i.message in loggedTypeFailures)){loggedTypeFailures[i.message]=!0;getDeclarationErrorAddendum()}}}function validatePropTypes(e){var r=e.type;if("function"==typeof r){var t=r.displayName||r.name;r.propTypes&&checkPropTypes(t,r.propTypes,e.props,ReactPropTypeLocations.prop),r.getDefaultProps}}var ReactElementValidator={createElement:function(e,r,t){var a="string"==typeof e||"function"==typeof e,n=ReactElement.createElement.apply(this,arguments);if(null==n)return n;if(a)for(var i=2;i<arguments.length;i++)validateChildKeys(arguments[i],e);return validatePropTypes(n),n},createFactory:function(e){var r=ReactElementValidator.createElement.bind(null,e);return r.type=e,r},cloneElement:function(e,r,t){for(var a=ReactElement.cloneElement.apply(this,arguments),n=2;n<arguments.length;n++)validateChildKeys(arguments[n],a.type);return validatePropTypes(a),a}};module.exports=ReactElementValidator;

},{"./ReactCurrentOwner":176,"./ReactElement":192,"./ReactPropTypeLocationNames":212,"./ReactPropTypeLocations":213,"./canDefineProperty":244,"./getIteratorFn":255,"fbjs/lib/invariant":81,"fbjs/lib/warning":90}],194:[function(require,module,exports){
"use strict";var placeholderElement,ReactElement=require("./ReactElement"),ReactEmptyComponentRegistry=require("./ReactEmptyComponentRegistry"),ReactReconciler=require("./ReactReconciler"),assign=require("./Object.assign"),ReactEmptyComponentInjection={injectEmptyComponent:function(e){placeholderElement=ReactElement.createElement(e)}};function registerNullComponentID(){ReactEmptyComponentRegistry.registerNullComponentID(this._rootNodeID)}var ReactEmptyComponent=function(e){this._currentElement=null,this._rootNodeID=null,this._renderedComponent=e(placeholderElement)};assign(ReactEmptyComponent.prototype,{construct:function(e){},mountComponent:function(e,t,n){return t.getReactMountReady().enqueue(registerNullComponentID,this),this._rootNodeID=e,ReactReconciler.mountComponent(this._renderedComponent,e,t,n)},receiveComponent:function(){},unmountComponent:function(e,t,n){ReactReconciler.unmountComponent(this._renderedComponent),ReactEmptyComponentRegistry.deregisterNullComponentID(this._rootNodeID),this._rootNodeID=null,this._renderedComponent=null}}),ReactEmptyComponent.injection=ReactEmptyComponentInjection,module.exports=ReactEmptyComponent;

},{"./Object.assign":164,"./ReactElement":192,"./ReactEmptyComponentRegistry":195,"./ReactReconciler":216}],195:[function(require,module,exports){
"use strict";var nullComponentIDsRegistry={};function isNullComponentID(e){return!!nullComponentIDsRegistry[e]}function registerNullComponentID(e){nullComponentIDsRegistry[e]=!0}function deregisterNullComponentID(e){delete nullComponentIDsRegistry[e]}var ReactEmptyComponentRegistry={isNullComponentID:isNullComponentID,registerNullComponentID:registerNullComponentID,deregisterNullComponentID:deregisterNullComponentID};module.exports=ReactEmptyComponentRegistry;

},{}],196:[function(require,module,exports){
"use strict";var caughtError=null;function invokeGuardedCallback(r,a,t,o){try{return a(t,o)}catch(r){return void(null===caughtError&&(caughtError=r))}}var fakeNode,ReactErrorUtils={invokeGuardedCallback:invokeGuardedCallback,invokeGuardedCallbackWithCatch:invokeGuardedCallback,rethrowCaughtError:function(){if(caughtError){var r=caughtError;throw caughtError=null,r}}};module.exports=ReactErrorUtils;

},{}],197:[function(require,module,exports){
"use strict";var EventPluginHub=require("./EventPluginHub");function runEventQueueInBatch(e){EventPluginHub.enqueueEvents(e),EventPluginHub.processEventQueue(!1)}var ReactEventEmitterMixin={handleTopLevel:function(e,n,t,u,i){runEventQueueInBatch(EventPluginHub.extractEvents(e,n,t,u,i))}};module.exports=ReactEventEmitterMixin;

},{"./EventPluginHub":157}],198:[function(require,module,exports){
"use strict";var EventListener=require("fbjs/lib/EventListener"),ExecutionEnvironment=require("fbjs/lib/ExecutionEnvironment"),PooledClass=require("./PooledClass"),ReactInstanceHandles=require("./ReactInstanceHandles"),ReactMount=require("./ReactMount"),ReactUpdates=require("./ReactUpdates"),assign=require("./Object.assign"),getEventTarget=require("./getEventTarget"),getUnboundedScrollPosition=require("fbjs/lib/getUnboundedScrollPosition"),DOCUMENT_FRAGMENT_NODE_TYPE=11;function findParent(e){var t=ReactMount.getID(e),n=ReactInstanceHandles.getReactRootIDFromNodeID(t),a=ReactMount.findReactContainerForID(n);return ReactMount.getFirstReactDOM(a)}function TopLevelCallbackBookKeeping(e,t){this.topLevelType=e,this.nativeEvent=t,this.ancestors=[]}function handleTopLevelImpl(e){handleTopLevelWithoutPath(e)}function handleTopLevelWithoutPath(e){for(var t=ReactMount.getFirstReactDOM(getEventTarget(e.nativeEvent))||window,n=t;n;)e.ancestors.push(n),n=findParent(n);for(var a=0;a<e.ancestors.length;a++){t=e.ancestors[a];var o=ReactMount.getID(t)||"";ReactEventListener._handleTopLevel(e.topLevelType,t,o,e.nativeEvent,getEventTarget(e.nativeEvent))}}function handleTopLevelWithPath(e){for(var t=e.nativeEvent.path,n=t[0],a=0,o=0;o<t.length;o++){var l=t[o];if(l.nodeType===DOCUMENT_FRAGMENT_NODE_TYPE&&(n=t[o+1]),ReactMount.getFirstReactDOM(l)===l){var i=ReactMount.getID(l),r=ReactInstanceHandles.getReactRootIDFromNodeID(i);e.ancestors.push(l);var s=ReactMount.getID(l)||"";for(a++,ReactEventListener._handleTopLevel(e.topLevelType,l,s,e.nativeEvent,n);i!==r;)l=t[++o],i=ReactMount.getID(l)}}0===a&&ReactEventListener._handleTopLevel(e.topLevelType,window,"",e.nativeEvent,getEventTarget(e.nativeEvent))}function scrollValueMonitor(e){e(getUnboundedScrollPosition(window))}assign(TopLevelCallbackBookKeeping.prototype,{destructor:function(){this.topLevelType=null,this.nativeEvent=null,this.ancestors.length=0}}),PooledClass.addPoolingTo(TopLevelCallbackBookKeeping,PooledClass.twoArgumentPooler);var ReactEventListener={_enabled:!0,_handleTopLevel:null,WINDOW_HANDLE:ExecutionEnvironment.canUseDOM?window:null,setHandleTopLevel:function(e){ReactEventListener._handleTopLevel=e},setEnabled:function(e){ReactEventListener._enabled=!!e},isEnabled:function(){return ReactEventListener._enabled},trapBubbledEvent:function(e,t,n){var a=n;return a?EventListener.listen(a,t,ReactEventListener.dispatchEvent.bind(null,e)):null},trapCapturedEvent:function(e,t,n){var a=n;return a?EventListener.capture(a,t,ReactEventListener.dispatchEvent.bind(null,e)):null},monitorScrollValue:function(e){var t=scrollValueMonitor.bind(null,e);EventListener.listen(window,"scroll",t)},dispatchEvent:function(e,t){if(ReactEventListener._enabled){var n=TopLevelCallbackBookKeeping.getPooled(e,t);try{ReactUpdates.batchedUpdates(handleTopLevelImpl,n)}finally{TopLevelCallbackBookKeeping.release(n)}}}};module.exports=ReactEventListener;

},{"./Object.assign":164,"./PooledClass":165,"./ReactInstanceHandles":201,"./ReactMount":205,"./ReactUpdates":223,"./getEventTarget":254,"fbjs/lib/EventListener":66,"fbjs/lib/ExecutionEnvironment":67,"fbjs/lib/getUnboundedScrollPosition":78}],199:[function(require,module,exports){
"use strict";var DOMProperty=require("./DOMProperty"),EventPluginHub=require("./EventPluginHub"),ReactComponentEnvironment=require("./ReactComponentEnvironment"),ReactClass=require("./ReactClass"),ReactEmptyComponent=require("./ReactEmptyComponent"),ReactBrowserEventEmitter=require("./ReactBrowserEventEmitter"),ReactNativeComponent=require("./ReactNativeComponent"),ReactPerf=require("./ReactPerf"),ReactRootIndex=require("./ReactRootIndex"),ReactUpdates=require("./ReactUpdates"),ReactInjection={Component:ReactComponentEnvironment.injection,Class:ReactClass.injection,DOMProperty:DOMProperty.injection,EmptyComponent:ReactEmptyComponent.injection,EventPluginHub:EventPluginHub.injection,EventEmitter:ReactBrowserEventEmitter.injection,NativeComponent:ReactNativeComponent.injection,Perf:ReactPerf.injection,RootIndex:ReactRootIndex.injection,Updates:ReactUpdates.injection};module.exports=ReactInjection;

},{"./DOMProperty":151,"./EventPluginHub":157,"./ReactBrowserEventEmitter":168,"./ReactClass":171,"./ReactComponentEnvironment":174,"./ReactEmptyComponent":194,"./ReactNativeComponent":208,"./ReactPerf":211,"./ReactRootIndex":218,"./ReactUpdates":223}],200:[function(require,module,exports){
"use strict";var ReactDOMSelection=require("./ReactDOMSelection"),containsNode=require("fbjs/lib/containsNode"),focusNode=require("fbjs/lib/focusNode"),getActiveElement=require("fbjs/lib/getActiveElement");function isInDocument(e){return containsNode(document.documentElement,e)}var ReactInputSelection={hasSelectionCapabilities:function(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&"text"===e.type||"textarea"===t||"true"===e.contentEditable)},getSelectionInformation:function(){var e=getActiveElement();return{focusedElem:e,selectionRange:ReactInputSelection.hasSelectionCapabilities(e)?ReactInputSelection.getSelection(e):null}},restoreSelection:function(e){var t=getActiveElement(),n=e.focusedElem,o=e.selectionRange;t!==n&&isInDocument(n)&&(ReactInputSelection.hasSelectionCapabilities(n)&&ReactInputSelection.setSelection(n,o),focusNode(n))},getSelection:function(e){var t;if("selectionStart"in e)t={start:e.selectionStart,end:e.selectionEnd};else if(document.selection&&e.nodeName&&"input"===e.nodeName.toLowerCase()){var n=document.selection.createRange();n.parentElement()===e&&(t={start:-n.moveStart("character",-e.value.length),end:-n.moveEnd("character",-e.value.length)})}else t=ReactDOMSelection.getOffsets(e);return t||{start:0,end:0}},setSelection:function(e,t){var n=t.start,o=t.end;if(void 0===o&&(o=n),"selectionStart"in e)e.selectionStart=n,e.selectionEnd=Math.min(o,e.value.length);else if(document.selection&&e.nodeName&&"input"===e.nodeName.toLowerCase()){var c=e.createTextRange();c.collapse(!0),c.moveStart("character",n),c.moveEnd("character",o-n),c.select()}else ReactDOMSelection.setOffsets(e,t)}};module.exports=ReactInputSelection;

},{"./ReactDOMSelection":186,"fbjs/lib/containsNode":70,"fbjs/lib/focusNode":75,"fbjs/lib/getActiveElement":76}],201:[function(require,module,exports){
"use strict";var ReactRootIndex=require("./ReactRootIndex"),invariant=require("fbjs/lib/invariant"),SEPARATOR=".",SEPARATOR_LENGTH=SEPARATOR.length,MAX_TREE_DEPTH=1e4;function getReactRootIDString(t){return SEPARATOR+t.toString(36)}function isBoundary(t,e){return t.charAt(e)===SEPARATOR||e===t.length}function isValidID(t){return""===t||t.charAt(0)===SEPARATOR&&t.charAt(t.length-1)!==SEPARATOR}function isAncestorIDOf(t,e){return 0===e.indexOf(t)&&isBoundary(e,t.length)}function getParentID(t){return t?t.substr(0,t.lastIndexOf(SEPARATOR)):""}function getNextDescendantID(t,e){if(isValidID(t)&&isValidID(e)||invariant(!1),isAncestorIDOf(t,e)||invariant(!1),t===e)return t;var r;for(r=t.length+SEPARATOR_LENGTH;r<e.length&&!isBoundary(e,r);r++);return e.substr(0,r)}function getFirstCommonAncestorID(t,e){var r=Math.min(t.length,e.length);if(0===r)return"";for(var n=0,a=0;a<=r;a++)if(isBoundary(t,a)&&isBoundary(e,a))n=a;else if(t.charAt(a)!==e.charAt(a))break;var i=t.substr(0,n);return isValidID(i)||invariant(!1),i}function traverseParentPath(t,e,r,n,a,i){(t=t||"")===(e=e||"")&&invariant(!1);var s=isAncestorIDOf(e,t);s||isAncestorIDOf(t,e)||invariant(!1);for(var o=0,c=s?getParentID:getNextDescendantID,R=t;;R=c(R,e)){var A;if(a&&R===t||i&&R===e||(A=r(R,s,n)),!1===A||R===e)break;o++<MAX_TREE_DEPTH||invariant(!1)}}var ReactInstanceHandles={createReactRootID:function(){return getReactRootIDString(ReactRootIndex.createReactRootIndex())},createReactID:function(t,e){return t+e},getReactRootIDFromNodeID:function(t){if(t&&t.charAt(0)===SEPARATOR&&t.length>1){var e=t.indexOf(SEPARATOR,1);return e>-1?t.substr(0,e):t}return null},traverseEnterLeave:function(t,e,r,n,a){var i=getFirstCommonAncestorID(t,e);i!==t&&traverseParentPath(t,i,r,n,!1,!0),i!==e&&traverseParentPath(i,e,r,a,!0,!1)},traverseTwoPhase:function(t,e,r){t&&(traverseParentPath("",t,e,r,!0,!1),traverseParentPath(t,"",e,r,!1,!0))},traverseTwoPhaseSkipTarget:function(t,e,r){t&&(traverseParentPath("",t,e,r,!0,!0),traverseParentPath(t,"",e,r,!0,!0))},traverseAncestors:function(t,e,r){traverseParentPath("",t,e,r,!0,!1)},getFirstCommonAncestorID:getFirstCommonAncestorID,_getNextDescendantID:getNextDescendantID,isAncestorIDOf:isAncestorIDOf,SEPARATOR:SEPARATOR};module.exports=ReactInstanceHandles;

},{"./ReactRootIndex":218,"fbjs/lib/invariant":81}],202:[function(require,module,exports){
"use strict";var ReactInstanceMap={remove:function(n){n._reactInternalInstance=void 0},get:function(n){return n._reactInternalInstance},has:function(n){return void 0!==n._reactInternalInstance},set:function(n,t){n._reactInternalInstance=t}};module.exports=ReactInstanceMap;

},{}],203:[function(require,module,exports){
"use strict";var ReactChildren=require("./ReactChildren"),ReactComponent=require("./ReactComponent"),ReactClass=require("./ReactClass"),ReactDOMFactories=require("./ReactDOMFactories"),ReactElement=require("./ReactElement"),ReactElementValidator=require("./ReactElementValidator"),ReactPropTypes=require("./ReactPropTypes"),ReactVersion=require("./ReactVersion"),assign=require("./Object.assign"),onlyChild=require("./onlyChild"),createElement=ReactElement.createElement,createFactory=ReactElement.createFactory,cloneElement=ReactElement.cloneElement;var React={Children:{map:ReactChildren.map,forEach:ReactChildren.forEach,count:ReactChildren.count,toArray:ReactChildren.toArray,only:onlyChild},Component:ReactComponent,createElement:createElement,cloneElement:cloneElement,isValidElement:ReactElement.isValidElement,PropTypes:ReactPropTypes,createClass:ReactClass.createClass,createFactory:createFactory,createMixin:function(e){return e},DOM:ReactDOMFactories,version:ReactVersion,__spread:assign};module.exports=React;

},{"./Object.assign":164,"./ReactChildren":170,"./ReactClass":171,"./ReactComponent":172,"./ReactDOMFactories":180,"./ReactElement":192,"./ReactElementValidator":193,"./ReactPropTypes":214,"./ReactVersion":224,"./onlyChild":261}],204:[function(require,module,exports){
"use strict";var adler32=require("./adler32"),TAG_END=/\/?>/,ReactMarkupChecksum={CHECKSUM_ATTR_NAME:"data-react-checksum",addChecksumToMarkup:function(e){var r=adler32(e);return e.replace(TAG_END," "+ReactMarkupChecksum.CHECKSUM_ATTR_NAME+'="'+r+'"$&')},canReuseMarkup:function(e,r){var a=r.getAttribute(ReactMarkupChecksum.CHECKSUM_ATTR_NAME);return a=a&&parseInt(a,10),adler32(e)===a}};module.exports=ReactMarkupChecksum;

},{"./adler32":243}],205:[function(require,module,exports){
"use strict";var rootElementsByReactRootID,DOMProperty=require("./DOMProperty"),ReactBrowserEventEmitter=require("./ReactBrowserEventEmitter"),ReactCurrentOwner=require("./ReactCurrentOwner"),ReactDOMFeatureFlags=require("./ReactDOMFeatureFlags"),ReactElement=require("./ReactElement"),ReactEmptyComponentRegistry=require("./ReactEmptyComponentRegistry"),ReactInstanceHandles=require("./ReactInstanceHandles"),ReactInstanceMap=require("./ReactInstanceMap"),ReactMarkupChecksum=require("./ReactMarkupChecksum"),ReactPerf=require("./ReactPerf"),ReactReconciler=require("./ReactReconciler"),ReactUpdateQueue=require("./ReactUpdateQueue"),ReactUpdates=require("./ReactUpdates"),assign=require("./Object.assign"),emptyObject=require("fbjs/lib/emptyObject"),containsNode=require("fbjs/lib/containsNode"),instantiateReactComponent=require("./instantiateReactComponent"),invariant=require("fbjs/lib/invariant"),setInnerHTML=require("./setInnerHTML"),shouldUpdateReactComponent=require("./shouldUpdateReactComponent"),validateDOMNesting=require("./validateDOMNesting"),warning=require("fbjs/lib/warning"),ATTR_NAME=DOMProperty.ID_ATTRIBUTE_NAME,nodeCache={},ELEMENT_NODE_TYPE=1,DOC_NODE_TYPE=9,DOCUMENT_FRAGMENT_NODE_TYPE=11,ownerDocumentContextKey="__ReactMount_ownerDocument$"+Math.random().toString(36).slice(2),instancesByReactRootID={},containersByReactRootID={},findComponentRootReusableArray=[];function firstDifferenceIndex(e,t){for(var n=Math.min(e.length,t.length),o=0;o<n;o++)if(e.charAt(o)!==t.charAt(o))return o;return e.length===t.length?-1:n}function getReactRootElementInContainer(e){return e?e.nodeType===DOC_NODE_TYPE?e.documentElement:e.firstChild:null}function getReactRootID(e){var t=getReactRootElementInContainer(e);return t&&ReactMount.getID(t)}function getID(e){var t=internalGetID(e);if(t)if(nodeCache.hasOwnProperty(t)){var n=nodeCache[t];n!==e&&(isValid(n,t)&&invariant(!1),nodeCache[t]=e)}else nodeCache[t]=e;return t}function internalGetID(e){return e&&e.getAttribute&&e.getAttribute(ATTR_NAME)||""}function setID(e,t){var n=internalGetID(e);n!==t&&delete nodeCache[n],e.setAttribute(ATTR_NAME,t),nodeCache[t]=e}function getNode(e){return nodeCache.hasOwnProperty(e)&&isValid(nodeCache[e],e)||(nodeCache[e]=ReactMount.findReactNodeByID(e)),nodeCache[e]}function getNodeFromInstance(e){var t=ReactInstanceMap.get(e)._rootNodeID;return ReactEmptyComponentRegistry.isNullComponentID(t)?null:(nodeCache.hasOwnProperty(t)&&isValid(nodeCache[t],t)||(nodeCache[t]=ReactMount.findReactNodeByID(t)),nodeCache[t])}function isValid(e,t){if(e){internalGetID(e)!==t&&invariant(!1);var n=ReactMount.findReactContainerForID(t);if(n&&containsNode(n,e))return!0}return!1}function purgeID(e){delete nodeCache[e]}var deepestNodeSoFar=null;function findDeepestCachedAncestorImpl(e){var t=nodeCache[e];if(!t||!isValid(t,e))return!1;deepestNodeSoFar=t}function findDeepestCachedAncestor(e){deepestNodeSoFar=null,ReactInstanceHandles.traverseAncestors(e,findDeepestCachedAncestorImpl);var t=deepestNodeSoFar;return deepestNodeSoFar=null,t}function mountComponentIntoNode(e,t,n,o,r,a){ReactDOMFeatureFlags.useCreateElement&&(a=assign({},a),n.nodeType===DOC_NODE_TYPE?a[ownerDocumentContextKey]=n:a[ownerDocumentContextKey]=n.ownerDocument);var c=ReactReconciler.mountComponent(e,t,o,a);e._renderedComponent._topLevelWrapper=e,ReactMount._mountImageIntoNode(c,n,r,o)}function batchedMountComponentIntoNode(e,t,n,o,r){var a=ReactUpdates.ReactReconcileTransaction.getPooled(o);a.perform(mountComponentIntoNode,null,e,t,n,a,o,r),ReactUpdates.ReactReconcileTransaction.release(a)}function unmountComponentFromNode(e,t){for(ReactReconciler.unmountComponent(e),t.nodeType===DOC_NODE_TYPE&&(t=t.documentElement);t.lastChild;)t.removeChild(t.lastChild)}function hasNonRootReactChild(e){var t=getReactRootID(e);return!!t&&t!==ReactInstanceHandles.getReactRootIDFromNodeID(t)}function findFirstReactDOMImpl(e){for(;e&&e.parentNode!==e;e=e.parentNode)if(1===e.nodeType){var t=internalGetID(e);if(t){var n,o=ReactInstanceHandles.getReactRootIDFromNodeID(t),r=e;do{if(n=internalGetID(r),null==(r=r.parentNode))return null}while(n!==o);if(r===containersByReactRootID[o])return e}}return null}var TopLevelWrapper=function(){};TopLevelWrapper.prototype.isReactComponent={},TopLevelWrapper.prototype.render=function(){return this.props};var ReactMount={TopLevelWrapper:TopLevelWrapper,_instancesByReactRootID:instancesByReactRootID,scrollMonitor:function(e,t){t()},_updateRootComponent:function(e,t,n,o){return ReactMount.scrollMonitor(n,function(){ReactUpdateQueue.enqueueElementInternal(e,t),o&&ReactUpdateQueue.enqueueCallbackInternal(e,o)}),e},_registerComponent:function(e,t){(!t||t.nodeType!==ELEMENT_NODE_TYPE&&t.nodeType!==DOC_NODE_TYPE&&t.nodeType!==DOCUMENT_FRAGMENT_NODE_TYPE)&&invariant(!1),ReactBrowserEventEmitter.ensureScrollValueMonitoring();var n=ReactMount.registerContainer(t);return instancesByReactRootID[n]=e,n},_renderNewRootComponent:function(e,t,n,o){var r=instantiateReactComponent(e,null),a=ReactMount._registerComponent(r,t);return ReactUpdates.batchedUpdates(batchedMountComponentIntoNode,r,a,t,n,o),r},renderSubtreeIntoContainer:function(e,t,n,o){return(null==e||null==e._reactInternalInstance)&&invariant(!1),ReactMount._renderSubtreeIntoContainer(e,t,n,o)},_renderSubtreeIntoContainer:function(e,t,n,o){ReactElement.isValidElement(t)||invariant(!1);var r=new ReactElement(TopLevelWrapper,null,null,null,null,null,t),a=instancesByReactRootID[getReactRootID(n)];if(a){var c=a._currentElement.props;if(shouldUpdateReactComponent(c,t)){var i=a._renderedComponent.getPublicInstance(),u=o&&function(){o.call(i)};return ReactMount._updateRootComponent(a,r,n,u),i}ReactMount.unmountComponentAtNode(n)}var R=getReactRootElementInContainer(n),d=R&&!!internalGetID(R),s=hasNonRootReactChild(n),l=d&&!a&&!s,p=ReactMount._renderNewRootComponent(r,n,l,null!=e?e._reactInternalInstance._processChildContext(e._reactInternalInstance._context):emptyObject)._renderedComponent.getPublicInstance();return o&&o.call(p),p},render:function(e,t,n){return ReactMount._renderSubtreeIntoContainer(null,e,t,n)},registerContainer:function(e){var t=getReactRootID(e);return t&&(t=ReactInstanceHandles.getReactRootIDFromNodeID(t)),t||(t=ReactInstanceHandles.createReactRootID()),containersByReactRootID[t]=e,t},unmountComponentAtNode:function(e){(!e||e.nodeType!==ELEMENT_NODE_TYPE&&e.nodeType!==DOC_NODE_TYPE&&e.nodeType!==DOCUMENT_FRAGMENT_NODE_TYPE)&&invariant(!1);var t=getReactRootID(e),n=instancesByReactRootID[t];if(!n){hasNonRootReactChild(e);var o=internalGetID(e);o&&ReactInstanceHandles.getReactRootIDFromNodeID(o);return!1}return ReactUpdates.batchedUpdates(unmountComponentFromNode,n,e),delete instancesByReactRootID[t],delete containersByReactRootID[t],!0},findReactContainerForID:function(e){var t=ReactInstanceHandles.getReactRootIDFromNodeID(e),n=containersByReactRootID[t];return n},findReactNodeByID:function(e){var t=ReactMount.findReactContainerForID(e);return ReactMount.findComponentRoot(t,e)},getFirstReactDOM:function(e){return findFirstReactDOMImpl(e)},findComponentRoot:function(e,t){var n=findComponentRootReusableArray,o=0,r=findDeepestCachedAncestor(t)||e;for(0,n[0]=r.firstChild,n.length=1;o<n.length;){for(var a,c=n[o++];c;){var i=ReactMount.getID(c);i?t===i?a=c:ReactInstanceHandles.isAncestorIDOf(i,t)&&(n.length=o=0,n.push(c.firstChild)):n.push(c.firstChild),c=c.nextSibling}if(a)return n.length=0,a}n.length=0,invariant(!1)},_mountImageIntoNode:function(e,t,n,o){if((!t||t.nodeType!==ELEMENT_NODE_TYPE&&t.nodeType!==DOC_NODE_TYPE&&t.nodeType!==DOCUMENT_FRAGMENT_NODE_TYPE)&&invariant(!1),n){var r=getReactRootElementInContainer(t);if(ReactMarkupChecksum.canReuseMarkup(e,r))return;var a=r.getAttribute(ReactMarkupChecksum.CHECKSUM_ATTR_NAME);r.removeAttribute(ReactMarkupChecksum.CHECKSUM_ATTR_NAME);var c=r.outerHTML;r.setAttribute(ReactMarkupChecksum.CHECKSUM_ATTR_NAME,a);var i=e,u=firstDifferenceIndex(i,c);i.substring(u-20,u+20),c.substring(u-20,u+20);t.nodeType===DOC_NODE_TYPE&&invariant(!1)}if(t.nodeType===DOC_NODE_TYPE&&invariant(!1),o.useCreateElement){for(;t.lastChild;)t.removeChild(t.lastChild);t.appendChild(e)}else setInnerHTML(t,e)},ownerDocumentContextKey:ownerDocumentContextKey,getReactRootID:getReactRootID,getID:getID,setID:setID,getNode:getNode,getNodeFromInstance:getNodeFromInstance,isValid:isValid,purgeID:purgeID};ReactPerf.measureMethods(ReactMount,"ReactMount",{_renderNewRootComponent:"_renderNewRootComponent",_mountImageIntoNode:"_mountImageIntoNode"}),module.exports=ReactMount;

},{"./DOMProperty":151,"./Object.assign":164,"./ReactBrowserEventEmitter":168,"./ReactCurrentOwner":176,"./ReactDOMFeatureFlags":181,"./ReactElement":192,"./ReactEmptyComponentRegistry":195,"./ReactInstanceHandles":201,"./ReactInstanceMap":202,"./ReactMarkupChecksum":204,"./ReactPerf":211,"./ReactReconciler":216,"./ReactUpdateQueue":222,"./ReactUpdates":223,"./instantiateReactComponent":258,"./setInnerHTML":264,"./shouldUpdateReactComponent":266,"./validateDOMNesting":268,"fbjs/lib/containsNode":70,"fbjs/lib/emptyObject":74,"fbjs/lib/invariant":81,"fbjs/lib/warning":90}],206:[function(require,module,exports){
"use strict";var ReactComponentEnvironment=require("./ReactComponentEnvironment"),ReactMultiChildUpdateTypes=require("./ReactMultiChildUpdateTypes"),ReactCurrentOwner=require("./ReactCurrentOwner"),ReactReconciler=require("./ReactReconciler"),ReactChildReconciler=require("./ReactChildReconciler"),flattenChildren=require("./flattenChildren"),updateDepth=0,updateQueue=[],markupQueue=[];function enqueueInsertMarkup(e,n,t){updateQueue.push({parentID:e,parentNode:null,type:ReactMultiChildUpdateTypes.INSERT_MARKUP,markupIndex:markupQueue.push(n)-1,content:null,fromIndex:null,toIndex:t})}function enqueueMove(e,n,t){updateQueue.push({parentID:e,parentNode:null,type:ReactMultiChildUpdateTypes.MOVE_EXISTING,markupIndex:null,content:null,fromIndex:n,toIndex:t})}function enqueueRemove(e,n){updateQueue.push({parentID:e,parentNode:null,type:ReactMultiChildUpdateTypes.REMOVE_NODE,markupIndex:null,content:null,fromIndex:n,toIndex:null})}function enqueueSetMarkup(e,n){updateQueue.push({parentID:e,parentNode:null,type:ReactMultiChildUpdateTypes.SET_MARKUP,markupIndex:null,content:n,fromIndex:null,toIndex:null})}function enqueueTextContent(e,n){updateQueue.push({parentID:e,parentNode:null,type:ReactMultiChildUpdateTypes.TEXT_CONTENT,markupIndex:null,content:n,fromIndex:null,toIndex:null})}function processQueue(){updateQueue.length&&(ReactComponentEnvironment.processChildrenUpdates(updateQueue,markupQueue),clearQueue())}function clearQueue(){updateQueue.length=0,markupQueue.length=0}var ReactMultiChild={Mixin:{_reconcilerInstantiateChildren:function(e,n,t){return ReactChildReconciler.instantiateChildren(e,n,t)},_reconcilerUpdateChildren:function(e,n,t,u){var r;return r=flattenChildren(n),ReactChildReconciler.updateChildren(e,r,t,u)},mountChildren:function(e,n,t){var u=this._reconcilerInstantiateChildren(e,n,t);this._renderedChildren=u;var r=[],i=0;for(var o in u)if(u.hasOwnProperty(o)){var d=u[o],l=this._rootNodeID+o,a=ReactReconciler.mountComponent(d,l,n,t);d._mountIndex=i++,r.push(a)}return r},updateTextContent:function(e){updateDepth++;var n=!0;try{var t=this._renderedChildren;for(var u in ReactChildReconciler.unmountChildren(t),t)t.hasOwnProperty(u)&&this._unmountChild(t[u]);this.setTextContent(e),n=!1}finally{--updateDepth||(n?clearQueue():processQueue())}},updateMarkup:function(e){updateDepth++;var n=!0;try{var t=this._renderedChildren;for(var u in ReactChildReconciler.unmountChildren(t),t)t.hasOwnProperty(u)&&this._unmountChildByName(t[u],u);this.setMarkup(e),n=!1}finally{--updateDepth||(n?clearQueue():processQueue())}},updateChildren:function(e,n,t){updateDepth++;var u=!0;try{this._updateChildren(e,n,t),u=!1}finally{--updateDepth||(u?clearQueue():processQueue())}},_updateChildren:function(e,n,t){var u=this._renderedChildren,r=this._reconcilerUpdateChildren(u,e,n,t);if(this._renderedChildren=r,r||u){var i,o=0,d=0;for(i in r)if(r.hasOwnProperty(i)){var l=u&&u[i],a=r[i];l===a?(this.moveChild(l,d,o),o=Math.max(l._mountIndex,o),l._mountIndex=d):(l&&(o=Math.max(l._mountIndex,o),this._unmountChild(l)),this._mountChildByNameAtIndex(a,i,d,n,t)),d++}for(i in u)!u.hasOwnProperty(i)||r&&r.hasOwnProperty(i)||this._unmountChild(u[i])}},unmountChildren:function(){var e=this._renderedChildren;ReactChildReconciler.unmountChildren(e),this._renderedChildren=null},moveChild:function(e,n,t){e._mountIndex<t&&enqueueMove(this._rootNodeID,e._mountIndex,n)},createChild:function(e,n){enqueueInsertMarkup(this._rootNodeID,n,e._mountIndex)},removeChild:function(e){enqueueRemove(this._rootNodeID,e._mountIndex)},setTextContent:function(e){enqueueTextContent(this._rootNodeID,e)},setMarkup:function(e){enqueueSetMarkup(this._rootNodeID,e)},_mountChildByNameAtIndex:function(e,n,t,u,r){var i=this._rootNodeID+n,o=ReactReconciler.mountComponent(e,i,u,r);e._mountIndex=t,this.createChild(e,o)},_unmountChild:function(e){this.removeChild(e),e._mountIndex=null}}};module.exports=ReactMultiChild;

},{"./ReactChildReconciler":169,"./ReactComponentEnvironment":174,"./ReactCurrentOwner":176,"./ReactMultiChildUpdateTypes":207,"./ReactReconciler":216,"./flattenChildren":249}],207:[function(require,module,exports){
"use strict";var keyMirror=require("fbjs/lib/keyMirror"),ReactMultiChildUpdateTypes=keyMirror({INSERT_MARKUP:null,MOVE_EXISTING:null,REMOVE_NODE:null,SET_MARKUP:null,TEXT_CONTENT:null});module.exports=ReactMultiChildUpdateTypes;

},{"fbjs/lib/keyMirror":84}],208:[function(require,module,exports){
"use strict";var assign=require("./Object.assign"),invariant=require("fbjs/lib/invariant"),autoGenerateWrapperClass=null,genericComponentClass=null,tagToComponentClass={},textComponentClass=null,ReactNativeComponentInjection={injectGenericComponentClass:function(n){genericComponentClass=n},injectTextComponentClass:function(n){textComponentClass=n},injectComponentClasses:function(n){assign(tagToComponentClass,n)}};function getComponentClassForElement(n){if("function"==typeof n.type)return n.type;var e=n.type,t=tagToComponentClass[e];return null==t&&(tagToComponentClass[e]=t=autoGenerateWrapperClass(e)),t}function createInternalComponent(n){return genericComponentClass||invariant(!1),new genericComponentClass(n.type,n.props)}function createInstanceForText(n){return new textComponentClass(n)}function isTextComponent(n){return n instanceof textComponentClass}var ReactNativeComponent={getComponentClassForElement:getComponentClassForElement,createInternalComponent:createInternalComponent,createInstanceForText:createInstanceForText,isTextComponent:isTextComponent,injection:ReactNativeComponentInjection};module.exports=ReactNativeComponent;

},{"./Object.assign":164,"fbjs/lib/invariant":81}],209:[function(require,module,exports){
"use strict";var warning=require("fbjs/lib/warning");function warnTDZ(e,n){0}var ReactNoopUpdateQueue={isMounted:function(e){return!1},enqueueCallback:function(e,n){},enqueueForceUpdate:function(e){warnTDZ(e,"forceUpdate")},enqueueReplaceState:function(e,n){warnTDZ(e,"replaceState")},enqueueSetState:function(e,n){warnTDZ(e,"setState")},enqueueSetProps:function(e,n){warnTDZ(e,"setProps")},enqueueReplaceProps:function(e,n){warnTDZ(e,"replaceProps")}};module.exports=ReactNoopUpdateQueue;

},{"fbjs/lib/warning":90}],210:[function(require,module,exports){
"use strict";var invariant=require("fbjs/lib/invariant"),ReactOwner={isValidOwner:function(e){return!(!e||"function"!=typeof e.attachRef||"function"!=typeof e.detachRef)},addComponentAsRefTo:function(e,n,t){ReactOwner.isValidOwner(t)||invariant(!1),t.attachRef(n,e)},removeComponentAsRefFrom:function(e,n,t){ReactOwner.isValidOwner(t)||invariant(!1),t.getPublicInstance().refs[n]===e.getPublicInstance()&&t.detachRef(n)}};module.exports=ReactOwner;

},{"fbjs/lib/invariant":81}],211:[function(require,module,exports){
"use strict";var ReactPerf={enableMeasure:!1,storedMeasure:_noMeasure,measureMethods:function(e,r,t){},measure:function(e,r,t){return t},injection:{injectMeasure:function(e){ReactPerf.storedMeasure=e}}};function _noMeasure(e,r,t){return t}module.exports=ReactPerf;

},{}],212:[function(require,module,exports){
"use strict";var ReactPropTypeLocationNames={};module.exports=ReactPropTypeLocationNames;

},{}],213:[function(require,module,exports){
"use strict";var keyMirror=require("fbjs/lib/keyMirror"),ReactPropTypeLocations=keyMirror({prop:null,context:null,childContext:null});module.exports=ReactPropTypeLocations;

},{"fbjs/lib/keyMirror":84}],214:[function(require,module,exports){
"use strict";var ReactElement=require("./ReactElement"),ReactPropTypeLocationNames=require("./ReactPropTypeLocationNames"),emptyFunction=require("fbjs/lib/emptyFunction"),getIteratorFn=require("./getIteratorFn"),ANONYMOUS="<<anonymous>>",ReactPropTypes={array:createPrimitiveTypeChecker("array"),bool:createPrimitiveTypeChecker("boolean"),func:createPrimitiveTypeChecker("function"),number:createPrimitiveTypeChecker("number"),object:createPrimitiveTypeChecker("object"),string:createPrimitiveTypeChecker("string"),any:createAnyTypeChecker(),arrayOf:createArrayOfTypeChecker,element:createElementTypeChecker(),instanceOf:createInstanceTypeChecker,node:createNodeChecker(),objectOf:createObjectOfTypeChecker,oneOf:createEnumTypeChecker,oneOfType:createUnionTypeChecker,shape:createShapeTypeChecker};function createChainableTypeChecker(e){function r(r,n,t,a,c,i){if(a=a||ANONYMOUS,i=i||t,null==n[t]){var o=ReactPropTypeLocationNames[c];return r?new Error("Required "+o+" `"+i+"` was not specified in `"+a+"`."):null}return e(n,t,a,c,i)}var n=r.bind(null,!1);return n.isRequired=r.bind(null,!0),n}function createPrimitiveTypeChecker(e){return createChainableTypeChecker(function(r,n,t,a,c){var i=r[n];if(getPropType(i)!==e){var o=ReactPropTypeLocationNames[a],u=getPreciseType(i);return new Error("Invalid "+o+" `"+c+"` of type `"+u+"` supplied to `"+t+"`, expected `"+e+"`.")}return null})}function createAnyTypeChecker(){return createChainableTypeChecker(emptyFunction.thatReturns(null))}function createArrayOfTypeChecker(e){return createChainableTypeChecker(function(r,n,t,a,c){var i=r[n];if(!Array.isArray(i)){var o=ReactPropTypeLocationNames[a],u=getPropType(i);return new Error("Invalid "+o+" `"+c+"` of type `"+u+"` supplied to `"+t+"`, expected an array.")}for(var p=0;p<i.length;p++){var l=e(i,p,t,a,c+"["+p+"]","SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED");if(l instanceof Error)return l}return null})}function createElementTypeChecker(){return createChainableTypeChecker(function(e,r,n,t,a){if(!ReactElement.isValidElement(e[r])){var c=ReactPropTypeLocationNames[t];return new Error("Invalid "+c+" `"+a+"` supplied to `"+n+"`, expected a single ReactElement.")}return null})}function createInstanceTypeChecker(e){return createChainableTypeChecker(function(r,n,t,a,c){if(!(r[n]instanceof e)){var i=ReactPropTypeLocationNames[a],o=e.name||ANONYMOUS,u=getClassName(r[n]);return new Error("Invalid "+i+" `"+c+"` of type `"+u+"` supplied to `"+t+"`, expected instance of `"+o+"`.")}return null})}function createEnumTypeChecker(e){if(!Array.isArray(e))return createChainableTypeChecker(function(){return new Error("Invalid argument supplied to oneOf, expected an instance of array.")});return createChainableTypeChecker(function(r,n,t,a,c){for(var i=r[n],o=0;o<e.length;o++)if(i===e[o])return null;var u=ReactPropTypeLocationNames[a],p=JSON.stringify(e);return new Error("Invalid "+u+" `"+c+"` of value `"+i+"` supplied to `"+t+"`, expected one of "+p+".")})}function createObjectOfTypeChecker(e){return createChainableTypeChecker(function(r,n,t,a,c){var i=r[n],o=getPropType(i);if("object"!==o){var u=ReactPropTypeLocationNames[a];return new Error("Invalid "+u+" `"+c+"` of type `"+o+"` supplied to `"+t+"`, expected an object.")}for(var p in i)if(i.hasOwnProperty(p)){var l=e(i,p,t,a,c+"."+p,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED");if(l instanceof Error)return l}return null})}function createUnionTypeChecker(e){if(!Array.isArray(e))return createChainableTypeChecker(function(){return new Error("Invalid argument supplied to oneOfType, expected an instance of array.")});return createChainableTypeChecker(function(r,n,t,a,c){for(var i=0;i<e.length;i++)if(null==(0,e[i])(r,n,t,a,c,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"))return null;var o=ReactPropTypeLocationNames[a];return new Error("Invalid "+o+" `"+c+"` supplied to `"+t+"`.")})}function createNodeChecker(){return createChainableTypeChecker(function(e,r,n,t,a){if(!isNode(e[r])){var c=ReactPropTypeLocationNames[t];return new Error("Invalid "+c+" `"+a+"` supplied to `"+n+"`, expected a ReactNode.")}return null})}function createShapeTypeChecker(e){return createChainableTypeChecker(function(r,n,t,a,c){var i=r[n],o=getPropType(i);if("object"!==o){var u=ReactPropTypeLocationNames[a];return new Error("Invalid "+u+" `"+c+"` of type `"+o+"` supplied to `"+t+"`, expected `object`.")}for(var p in e){var l=e[p];if(l){var y=l(i,p,t,a,c+"."+p,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED");if(y)return y}}return null})}function isNode(e){switch(typeof e){case"number":case"string":case"undefined":return!0;case"boolean":return!e;case"object":if(Array.isArray(e))return e.every(isNode);if(null===e||ReactElement.isValidElement(e))return!0;var r=getIteratorFn(e);if(!r)return!1;var n,t=r.call(e);if(r!==e.entries){for(;!(n=t.next()).done;)if(!isNode(n.value))return!1}else for(;!(n=t.next()).done;){var a=n.value;if(a&&!isNode(a[1]))return!1}return!0;default:return!1}}function getPropType(e){var r=typeof e;return Array.isArray(e)?"array":e instanceof RegExp?"object":r}function getPreciseType(e){var r=getPropType(e);if("object"===r){if(e instanceof Date)return"date";if(e instanceof RegExp)return"regexp"}return r}function getClassName(e){return e.constructor&&e.constructor.name?e.constructor.name:"<<anonymous>>"}module.exports=ReactPropTypes;

},{"./ReactElement":192,"./ReactPropTypeLocationNames":212,"./getIteratorFn":255,"fbjs/lib/emptyFunction":73}],215:[function(require,module,exports){
"use strict";var CallbackQueue=require("./CallbackQueue"),PooledClass=require("./PooledClass"),ReactBrowserEventEmitter=require("./ReactBrowserEventEmitter"),ReactDOMFeatureFlags=require("./ReactDOMFeatureFlags"),ReactInputSelection=require("./ReactInputSelection"),Transaction=require("./Transaction"),assign=require("./Object.assign"),SELECTION_RESTORATION={initialize:ReactInputSelection.getSelectionInformation,close:ReactInputSelection.restoreSelection},EVENT_SUPPRESSION={initialize:function(){var e=ReactBrowserEventEmitter.isEnabled();return ReactBrowserEventEmitter.setEnabled(!1),e},close:function(e){ReactBrowserEventEmitter.setEnabled(e)}},ON_DOM_READY_QUEUEING={initialize:function(){this.reactMountReady.reset()},close:function(){this.reactMountReady.notifyAll()}},TRANSACTION_WRAPPERS=[SELECTION_RESTORATION,EVENT_SUPPRESSION,ON_DOM_READY_QUEUEING];function ReactReconcileTransaction(e){this.reinitializeTransaction(),this.renderToStaticMarkup=!1,this.reactMountReady=CallbackQueue.getPooled(null),this.useCreateElement=!e&&ReactDOMFeatureFlags.useCreateElement}var Mixin={getTransactionWrappers:function(){return TRANSACTION_WRAPPERS},getReactMountReady:function(){return this.reactMountReady},destructor:function(){CallbackQueue.release(this.reactMountReady),this.reactMountReady=null}};assign(ReactReconcileTransaction.prototype,Transaction.Mixin,Mixin),PooledClass.addPoolingTo(ReactReconcileTransaction),module.exports=ReactReconcileTransaction;

},{"./CallbackQueue":147,"./Object.assign":164,"./PooledClass":165,"./ReactBrowserEventEmitter":168,"./ReactDOMFeatureFlags":181,"./ReactInputSelection":200,"./Transaction":240}],216:[function(require,module,exports){
"use strict";var ReactRef=require("./ReactRef");function attachRefs(){ReactRef.attachRefs(this,this._currentElement)}var ReactReconciler={mountComponent:function(e,t,n,c){var r=e.mountComponent(t,n,c);return e._currentElement&&null!=e._currentElement.ref&&n.getReactMountReady().enqueue(attachRefs,e),r},unmountComponent:function(e){ReactRef.detachRefs(e,e._currentElement),e.unmountComponent()},receiveComponent:function(e,t,n,c){var r=e._currentElement;if(t!==r||c!==e._context){var a=ReactRef.shouldUpdateRefs(r,t);a&&ReactRef.detachRefs(e,r),e.receiveComponent(t,n,c),a&&e._currentElement&&null!=e._currentElement.ref&&n.getReactMountReady().enqueue(attachRefs,e)}},performUpdateIfNecessary:function(e,t){e.performUpdateIfNecessary(t)}};module.exports=ReactReconciler;

},{"./ReactRef":217}],217:[function(require,module,exports){
"use strict";var ReactOwner=require("./ReactOwner"),ReactRef={};function attachRef(e,n,t){"function"==typeof e?e(n.getPublicInstance()):ReactOwner.addComponentAsRefTo(n,e,t)}function detachRef(e,n,t){"function"==typeof e?e(null):ReactOwner.removeComponentAsRefFrom(n,e,t)}ReactRef.attachRefs=function(e,n){if(null!==n&&!1!==n){var t=n.ref;null!=t&&attachRef(t,e,n._owner)}},ReactRef.shouldUpdateRefs=function(e,n){return null===e||!1===e||(null===n||!1===n)||n._owner!==e._owner||n.ref!==e.ref},ReactRef.detachRefs=function(e,n){if(null!==n&&!1!==n){var t=n.ref;null!=t&&detachRef(t,e,n._owner)}},module.exports=ReactRef;

},{"./ReactOwner":210}],218:[function(require,module,exports){
"use strict";var ReactRootIndexInjection={injectCreateReactRootIndex:function(e){ReactRootIndex.createReactRootIndex=e}},ReactRootIndex={createReactRootIndex:null,injection:ReactRootIndexInjection};module.exports=ReactRootIndex;

},{}],219:[function(require,module,exports){
"use strict";var ReactServerBatchingStrategy={isBatchingUpdates:!1,batchedUpdates:function(t){}};module.exports=ReactServerBatchingStrategy;

},{}],220:[function(require,module,exports){
"use strict";var ReactDefaultBatchingStrategy=require("./ReactDefaultBatchingStrategy"),ReactElement=require("./ReactElement"),ReactInstanceHandles=require("./ReactInstanceHandles"),ReactMarkupChecksum=require("./ReactMarkupChecksum"),ReactServerBatchingStrategy=require("./ReactServerBatchingStrategy"),ReactServerRenderingTransaction=require("./ReactServerRenderingTransaction"),ReactUpdates=require("./ReactUpdates"),emptyObject=require("fbjs/lib/emptyObject"),instantiateReactComponent=require("./instantiateReactComponent"),invariant=require("fbjs/lib/invariant");function renderToString(e){var t;ReactElement.isValidElement(e)||invariant(!1);try{ReactUpdates.injection.injectBatchingStrategy(ReactServerBatchingStrategy);var a=ReactInstanceHandles.createReactRootID();return(t=ReactServerRenderingTransaction.getPooled(!1)).perform(function(){var n=instantiateReactComponent(e,null).mountComponent(a,t,emptyObject);return ReactMarkupChecksum.addChecksumToMarkup(n)},null)}finally{ReactServerRenderingTransaction.release(t),ReactUpdates.injection.injectBatchingStrategy(ReactDefaultBatchingStrategy)}}function renderToStaticMarkup(e){var t;ReactElement.isValidElement(e)||invariant(!1);try{ReactUpdates.injection.injectBatchingStrategy(ReactServerBatchingStrategy);var a=ReactInstanceHandles.createReactRootID();return(t=ReactServerRenderingTransaction.getPooled(!0)).perform(function(){return instantiateReactComponent(e,null).mountComponent(a,t,emptyObject)},null)}finally{ReactServerRenderingTransaction.release(t),ReactUpdates.injection.injectBatchingStrategy(ReactDefaultBatchingStrategy)}}module.exports={renderToString:renderToString,renderToStaticMarkup:renderToStaticMarkup};

},{"./ReactDefaultBatchingStrategy":190,"./ReactElement":192,"./ReactInstanceHandles":201,"./ReactMarkupChecksum":204,"./ReactServerBatchingStrategy":219,"./ReactServerRenderingTransaction":221,"./ReactUpdates":223,"./instantiateReactComponent":258,"fbjs/lib/emptyObject":74,"fbjs/lib/invariant":81}],221:[function(require,module,exports){
"use strict";var PooledClass=require("./PooledClass"),CallbackQueue=require("./CallbackQueue"),Transaction=require("./Transaction"),assign=require("./Object.assign"),emptyFunction=require("fbjs/lib/emptyFunction"),ON_DOM_READY_QUEUEING={initialize:function(){this.reactMountReady.reset()},close:emptyFunction},TRANSACTION_WRAPPERS=[ON_DOM_READY_QUEUEING];function ReactServerRenderingTransaction(e){this.reinitializeTransaction(),this.renderToStaticMarkup=e,this.reactMountReady=CallbackQueue.getPooled(null),this.useCreateElement=!1}var Mixin={getTransactionWrappers:function(){return TRANSACTION_WRAPPERS},getReactMountReady:function(){return this.reactMountReady},destructor:function(){CallbackQueue.release(this.reactMountReady),this.reactMountReady=null}};assign(ReactServerRenderingTransaction.prototype,Transaction.Mixin,Mixin),PooledClass.addPoolingTo(ReactServerRenderingTransaction),module.exports=ReactServerRenderingTransaction;

},{"./CallbackQueue":147,"./Object.assign":164,"./PooledClass":165,"./Transaction":240,"fbjs/lib/emptyFunction":73}],222:[function(require,module,exports){
"use strict";var ReactCurrentOwner=require("./ReactCurrentOwner"),ReactElement=require("./ReactElement"),ReactInstanceMap=require("./ReactInstanceMap"),ReactUpdates=require("./ReactUpdates"),assign=require("./Object.assign"),invariant=require("fbjs/lib/invariant"),warning=require("fbjs/lib/warning");function enqueueUpdate(e){ReactUpdates.enqueueUpdate(e)}function getInternalInstanceReadyForUpdate(e,n){var t=ReactInstanceMap.get(e);return t||null}var ReactUpdateQueue={isMounted:function(e){var n=ReactInstanceMap.get(e);return!!n&&!!n._renderedComponent},enqueueCallback:function(e,n){"function"!=typeof n&&invariant(!1);var t=getInternalInstanceReadyForUpdate(e);if(!t)return null;t._pendingCallbacks?t._pendingCallbacks.push(n):t._pendingCallbacks=[n],enqueueUpdate(t)},enqueueCallbackInternal:function(e,n){"function"!=typeof n&&invariant(!1),e._pendingCallbacks?e._pendingCallbacks.push(n):e._pendingCallbacks=[n],enqueueUpdate(e)},enqueueForceUpdate:function(e){var n=getInternalInstanceReadyForUpdate(e,"forceUpdate");n&&(n._pendingForceUpdate=!0,enqueueUpdate(n))},enqueueReplaceState:function(e,n){var t=getInternalInstanceReadyForUpdate(e,"replaceState");t&&(t._pendingStateQueue=[n],t._pendingReplaceState=!0,enqueueUpdate(t))},enqueueSetState:function(e,n){var t=getInternalInstanceReadyForUpdate(e,"setState");t&&((t._pendingStateQueue||(t._pendingStateQueue=[])).push(n),enqueueUpdate(t))},enqueueSetProps:function(e,n){var t=getInternalInstanceReadyForUpdate(e,"setProps");t&&ReactUpdateQueue.enqueueSetPropsInternal(t,n)},enqueueSetPropsInternal:function(e,n){var t=e._topLevelWrapper;t||invariant(!1);var a=t._pendingElement||t._currentElement,r=a.props,u=assign({},r.props,n);t._pendingElement=ReactElement.cloneAndReplaceProps(a,ReactElement.cloneAndReplaceProps(r,u)),enqueueUpdate(t)},enqueueReplaceProps:function(e,n){var t=getInternalInstanceReadyForUpdate(e,"replaceProps");t&&ReactUpdateQueue.enqueueReplacePropsInternal(t,n)},enqueueReplacePropsInternal:function(e,n){var t=e._topLevelWrapper;t||invariant(!1);var a=t._pendingElement||t._currentElement,r=a.props;t._pendingElement=ReactElement.cloneAndReplaceProps(a,ReactElement.cloneAndReplaceProps(r,n)),enqueueUpdate(t)},enqueueElementInternal:function(e,n){e._pendingElement=n,enqueueUpdate(e)}};module.exports=ReactUpdateQueue;

},{"./Object.assign":164,"./ReactCurrentOwner":176,"./ReactElement":192,"./ReactInstanceMap":202,"./ReactUpdates":223,"fbjs/lib/invariant":81,"fbjs/lib/warning":90}],223:[function(require,module,exports){
"use strict";var CallbackQueue=require("./CallbackQueue"),PooledClass=require("./PooledClass"),ReactPerf=require("./ReactPerf"),ReactReconciler=require("./ReactReconciler"),Transaction=require("./Transaction"),assign=require("./Object.assign"),invariant=require("fbjs/lib/invariant"),dirtyComponents=[],asapCallbackQueue=CallbackQueue.getPooled(),asapEnqueued=!1,batchingStrategy=null;function ensureInjected(){ReactUpdates.ReactReconcileTransaction&&batchingStrategy||invariant(!1)}var NESTED_UPDATES={initialize:function(){this.dirtyComponentsLength=dirtyComponents.length},close:function(){this.dirtyComponentsLength!==dirtyComponents.length?(dirtyComponents.splice(0,this.dirtyComponentsLength),flushBatchedUpdates()):dirtyComponents.length=0}},UPDATE_QUEUEING={initialize:function(){this.callbackQueue.reset()},close:function(){this.callbackQueue.notifyAll()}},TRANSACTION_WRAPPERS=[NESTED_UPDATES,UPDATE_QUEUEING];function ReactUpdatesFlushTransaction(){this.reinitializeTransaction(),this.dirtyComponentsLength=null,this.callbackQueue=CallbackQueue.getPooled(),this.reconcileTransaction=ReactUpdates.ReactReconcileTransaction.getPooled(!1)}function batchedUpdates(e,t,a,n,i,c){ensureInjected(),batchingStrategy.batchedUpdates(e,t,a,n,i,c)}function mountOrderComparator(e,t){return e._mountOrder-t._mountOrder}function runBatchedUpdates(e){var t=e.dirtyComponentsLength;t!==dirtyComponents.length&&invariant(!1),dirtyComponents.sort(mountOrderComparator);for(var a=0;a<t;a++){var n=dirtyComponents[a],i=n._pendingCallbacks;if(n._pendingCallbacks=null,ReactReconciler.performUpdateIfNecessary(n,e.reconcileTransaction),i)for(var c=0;c<i.length;c++)e.callbackQueue.enqueue(i[c],n.getPublicInstance())}}assign(ReactUpdatesFlushTransaction.prototype,Transaction.Mixin,{getTransactionWrappers:function(){return TRANSACTION_WRAPPERS},destructor:function(){this.dirtyComponentsLength=null,CallbackQueue.release(this.callbackQueue),this.callbackQueue=null,ReactUpdates.ReactReconcileTransaction.release(this.reconcileTransaction),this.reconcileTransaction=null},perform:function(e,t,a){return Transaction.Mixin.perform.call(this,this.reconcileTransaction.perform,this.reconcileTransaction,e,t,a)}}),PooledClass.addPoolingTo(ReactUpdatesFlushTransaction);var flushBatchedUpdates=function(){for(;dirtyComponents.length||asapEnqueued;){if(dirtyComponents.length){var e=ReactUpdatesFlushTransaction.getPooled();e.perform(runBatchedUpdates,null,e),ReactUpdatesFlushTransaction.release(e)}if(asapEnqueued){asapEnqueued=!1;var t=asapCallbackQueue;asapCallbackQueue=CallbackQueue.getPooled(),t.notifyAll(),CallbackQueue.release(t)}}};function enqueueUpdate(e){ensureInjected(),batchingStrategy.isBatchingUpdates?dirtyComponents.push(e):batchingStrategy.batchedUpdates(enqueueUpdate,e)}function asap(e,t){batchingStrategy.isBatchingUpdates||invariant(!1),asapCallbackQueue.enqueue(e,t),asapEnqueued=!0}var ReactUpdatesInjection={injectReconcileTransaction:function(e){e||invariant(!1),ReactUpdates.ReactReconcileTransaction=e},injectBatchingStrategy:function(e){e||invariant(!1),"function"!=typeof e.batchedUpdates&&invariant(!1),"boolean"!=typeof e.isBatchingUpdates&&invariant(!1),batchingStrategy=e}},ReactUpdates={ReactReconcileTransaction:null,batchedUpdates:batchedUpdates,enqueueUpdate:enqueueUpdate,flushBatchedUpdates:flushBatchedUpdates=ReactPerf.measure("ReactUpdates","flushBatchedUpdates",flushBatchedUpdates),injection:ReactUpdatesInjection,asap:asap};module.exports=ReactUpdates;

},{"./CallbackQueue":147,"./Object.assign":164,"./PooledClass":165,"./ReactPerf":211,"./ReactReconciler":216,"./Transaction":240,"fbjs/lib/invariant":81}],224:[function(require,module,exports){
"use strict";module.exports="0.14.9";

},{}],225:[function(require,module,exports){
"use strict";var DOMProperty=require("./DOMProperty"),MUST_USE_ATTRIBUTE=DOMProperty.injection.MUST_USE_ATTRIBUTE,NS={xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace"},SVGDOMPropertyConfig={Properties:{clipPath:MUST_USE_ATTRIBUTE,cx:MUST_USE_ATTRIBUTE,cy:MUST_USE_ATTRIBUTE,d:MUST_USE_ATTRIBUTE,dx:MUST_USE_ATTRIBUTE,dy:MUST_USE_ATTRIBUTE,fill:MUST_USE_ATTRIBUTE,fillOpacity:MUST_USE_ATTRIBUTE,fontFamily:MUST_USE_ATTRIBUTE,fontSize:MUST_USE_ATTRIBUTE,fx:MUST_USE_ATTRIBUTE,fy:MUST_USE_ATTRIBUTE,gradientTransform:MUST_USE_ATTRIBUTE,gradientUnits:MUST_USE_ATTRIBUTE,markerEnd:MUST_USE_ATTRIBUTE,markerMid:MUST_USE_ATTRIBUTE,markerStart:MUST_USE_ATTRIBUTE,offset:MUST_USE_ATTRIBUTE,opacity:MUST_USE_ATTRIBUTE,patternContentUnits:MUST_USE_ATTRIBUTE,patternUnits:MUST_USE_ATTRIBUTE,points:MUST_USE_ATTRIBUTE,preserveAspectRatio:MUST_USE_ATTRIBUTE,r:MUST_USE_ATTRIBUTE,rx:MUST_USE_ATTRIBUTE,ry:MUST_USE_ATTRIBUTE,spreadMethod:MUST_USE_ATTRIBUTE,stopColor:MUST_USE_ATTRIBUTE,stopOpacity:MUST_USE_ATTRIBUTE,stroke:MUST_USE_ATTRIBUTE,strokeDasharray:MUST_USE_ATTRIBUTE,strokeLinecap:MUST_USE_ATTRIBUTE,strokeOpacity:MUST_USE_ATTRIBUTE,strokeWidth:MUST_USE_ATTRIBUTE,textAnchor:MUST_USE_ATTRIBUTE,transform:MUST_USE_ATTRIBUTE,version:MUST_USE_ATTRIBUTE,viewBox:MUST_USE_ATTRIBUTE,x1:MUST_USE_ATTRIBUTE,x2:MUST_USE_ATTRIBUTE,x:MUST_USE_ATTRIBUTE,xlinkActuate:MUST_USE_ATTRIBUTE,xlinkArcrole:MUST_USE_ATTRIBUTE,xlinkHref:MUST_USE_ATTRIBUTE,xlinkRole:MUST_USE_ATTRIBUTE,xlinkShow:MUST_USE_ATTRIBUTE,xlinkTitle:MUST_USE_ATTRIBUTE,xlinkType:MUST_USE_ATTRIBUTE,xmlBase:MUST_USE_ATTRIBUTE,xmlLang:MUST_USE_ATTRIBUTE,xmlSpace:MUST_USE_ATTRIBUTE,y1:MUST_USE_ATTRIBUTE,y2:MUST_USE_ATTRIBUTE,y:MUST_USE_ATTRIBUTE},DOMAttributeNamespaces:{xlinkActuate:NS.xlink,xlinkArcrole:NS.xlink,xlinkHref:NS.xlink,xlinkRole:NS.xlink,xlinkShow:NS.xlink,xlinkTitle:NS.xlink,xlinkType:NS.xlink,xmlBase:NS.xml,xmlLang:NS.xml,xmlSpace:NS.xml},DOMAttributeNames:{clipPath:"clip-path",fillOpacity:"fill-opacity",fontFamily:"font-family",fontSize:"font-size",gradientTransform:"gradientTransform",gradientUnits:"gradientUnits",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",patternContentUnits:"patternContentUnits",patternUnits:"patternUnits",preserveAspectRatio:"preserveAspectRatio",spreadMethod:"spreadMethod",stopColor:"stop-color",stopOpacity:"stop-opacity",strokeDasharray:"stroke-dasharray",strokeLinecap:"stroke-linecap",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",textAnchor:"text-anchor",viewBox:"viewBox",xlinkActuate:"xlink:actuate",xlinkArcrole:"xlink:arcrole",xlinkHref:"xlink:href",xlinkRole:"xlink:role",xlinkShow:"xlink:show",xlinkTitle:"xlink:title",xlinkType:"xlink:type",xmlBase:"xml:base",xmlLang:"xml:lang",xmlSpace:"xml:space"}};module.exports=SVGDOMPropertyConfig;

},{"./DOMProperty":151}],226:[function(require,module,exports){
"use strict";var EventConstants=require("./EventConstants"),EventPropagators=require("./EventPropagators"),ExecutionEnvironment=require("fbjs/lib/ExecutionEnvironment"),ReactInputSelection=require("./ReactInputSelection"),SyntheticEvent=require("./SyntheticEvent"),getActiveElement=require("fbjs/lib/getActiveElement"),isTextInputElement=require("./isTextInputElement"),keyOf=require("fbjs/lib/keyOf"),shallowEqual=require("fbjs/lib/shallowEqual"),topLevelTypes=EventConstants.topLevelTypes,skipSelectionChangeEvent=ExecutionEnvironment.canUseDOM&&"documentMode"in document&&document.documentMode<=11,eventTypes={select:{phasedRegistrationNames:{bubbled:keyOf({onSelect:null}),captured:keyOf({onSelectCapture:null})},dependencies:[topLevelTypes.topBlur,topLevelTypes.topContextMenu,topLevelTypes.topFocus,topLevelTypes.topKeyDown,topLevelTypes.topMouseDown,topLevelTypes.topMouseUp,topLevelTypes.topSelectionChange]}},activeElement=null,activeElementID=null,lastSelection=null,mouseDown=!1,hasListener=!1,ON_SELECT_KEY=keyOf({onSelect:null});function getSelection(e){if("selectionStart"in e&&ReactInputSelection.hasSelectionCapabilities(e))return{start:e.selectionStart,end:e.selectionEnd};if(window.getSelection){var t=window.getSelection();return{anchorNode:t.anchorNode,anchorOffset:t.anchorOffset,focusNode:t.focusNode,focusOffset:t.focusOffset}}if(document.selection){var n=document.selection.createRange();return{parentElement:n.parentElement(),text:n.text,top:n.boundingTop,left:n.boundingLeft}}}function constructSelectEvent(e,t){if(mouseDown||null==activeElement||activeElement!==getActiveElement())return null;var n=getSelection(activeElement);if(!lastSelection||!shallowEqual(lastSelection,n)){lastSelection=n;var o=SyntheticEvent.getPooled(eventTypes.select,activeElementID,e,t);return o.type="select",o.target=activeElement,EventPropagators.accumulateTwoPhaseDispatches(o),o}return null}var SelectEventPlugin={eventTypes:eventTypes,extractEvents:function(e,t,n,o,l){if(!hasListener)return null;switch(e){case topLevelTypes.topFocus:(isTextInputElement(t)||"true"===t.contentEditable)&&(activeElement=t,activeElementID=n,lastSelection=null);break;case topLevelTypes.topBlur:activeElement=null,activeElementID=null,lastSelection=null;break;case topLevelTypes.topMouseDown:mouseDown=!0;break;case topLevelTypes.topContextMenu:case topLevelTypes.topMouseUp:return mouseDown=!1,constructSelectEvent(o,l);case topLevelTypes.topSelectionChange:if(skipSelectionChangeEvent)break;case topLevelTypes.topKeyDown:case topLevelTypes.topKeyUp:return constructSelectEvent(o,l)}return null},didPutListener:function(e,t,n){t===ON_SELECT_KEY&&(hasListener=!0)}};module.exports=SelectEventPlugin;

},{"./EventConstants":156,"./EventPropagators":160,"./ReactInputSelection":200,"./SyntheticEvent":232,"./isTextInputElement":260,"fbjs/lib/ExecutionEnvironment":67,"fbjs/lib/getActiveElement":76,"fbjs/lib/keyOf":85,"fbjs/lib/shallowEqual":88}],227:[function(require,module,exports){
"use strict";var GLOBAL_MOUNT_POINT_MAX=Math.pow(2,53),ServerReactRootIndex={createReactRootIndex:function(){return Math.ceil(Math.random()*GLOBAL_MOUNT_POINT_MAX)}};module.exports=ServerReactRootIndex;

},{}],228:[function(require,module,exports){
"use strict";var EventConstants=require("./EventConstants"),EventListener=require("fbjs/lib/EventListener"),EventPropagators=require("./EventPropagators"),ReactMount=require("./ReactMount"),SyntheticClipboardEvent=require("./SyntheticClipboardEvent"),SyntheticEvent=require("./SyntheticEvent"),SyntheticFocusEvent=require("./SyntheticFocusEvent"),SyntheticKeyboardEvent=require("./SyntheticKeyboardEvent"),SyntheticMouseEvent=require("./SyntheticMouseEvent"),SyntheticDragEvent=require("./SyntheticDragEvent"),SyntheticTouchEvent=require("./SyntheticTouchEvent"),SyntheticUIEvent=require("./SyntheticUIEvent"),SyntheticWheelEvent=require("./SyntheticWheelEvent"),emptyFunction=require("fbjs/lib/emptyFunction"),getEventCharCode=require("./getEventCharCode"),invariant=require("fbjs/lib/invariant"),keyOf=require("fbjs/lib/keyOf"),topLevelTypes=EventConstants.topLevelTypes,eventTypes={abort:{phasedRegistrationNames:{bubbled:keyOf({onAbort:!0}),captured:keyOf({onAbortCapture:!0})}},blur:{phasedRegistrationNames:{bubbled:keyOf({onBlur:!0}),captured:keyOf({onBlurCapture:!0})}},canPlay:{phasedRegistrationNames:{bubbled:keyOf({onCanPlay:!0}),captured:keyOf({onCanPlayCapture:!0})}},canPlayThrough:{phasedRegistrationNames:{bubbled:keyOf({onCanPlayThrough:!0}),captured:keyOf({onCanPlayThroughCapture:!0})}},click:{phasedRegistrationNames:{bubbled:keyOf({onClick:!0}),captured:keyOf({onClickCapture:!0})}},contextMenu:{phasedRegistrationNames:{bubbled:keyOf({onContextMenu:!0}),captured:keyOf({onContextMenuCapture:!0})}},copy:{phasedRegistrationNames:{bubbled:keyOf({onCopy:!0}),captured:keyOf({onCopyCapture:!0})}},cut:{phasedRegistrationNames:{bubbled:keyOf({onCut:!0}),captured:keyOf({onCutCapture:!0})}},doubleClick:{phasedRegistrationNames:{bubbled:keyOf({onDoubleClick:!0}),captured:keyOf({onDoubleClickCapture:!0})}},drag:{phasedRegistrationNames:{bubbled:keyOf({onDrag:!0}),captured:keyOf({onDragCapture:!0})}},dragEnd:{phasedRegistrationNames:{bubbled:keyOf({onDragEnd:!0}),captured:keyOf({onDragEndCapture:!0})}},dragEnter:{phasedRegistrationNames:{bubbled:keyOf({onDragEnter:!0}),captured:keyOf({onDragEnterCapture:!0})}},dragExit:{phasedRegistrationNames:{bubbled:keyOf({onDragExit:!0}),captured:keyOf({onDragExitCapture:!0})}},dragLeave:{phasedRegistrationNames:{bubbled:keyOf({onDragLeave:!0}),captured:keyOf({onDragLeaveCapture:!0})}},dragOver:{phasedRegistrationNames:{bubbled:keyOf({onDragOver:!0}),captured:keyOf({onDragOverCapture:!0})}},dragStart:{phasedRegistrationNames:{bubbled:keyOf({onDragStart:!0}),captured:keyOf({onDragStartCapture:!0})}},drop:{phasedRegistrationNames:{bubbled:keyOf({onDrop:!0}),captured:keyOf({onDropCapture:!0})}},durationChange:{phasedRegistrationNames:{bubbled:keyOf({onDurationChange:!0}),captured:keyOf({onDurationChangeCapture:!0})}},emptied:{phasedRegistrationNames:{bubbled:keyOf({onEmptied:!0}),captured:keyOf({onEmptiedCapture:!0})}},encrypted:{phasedRegistrationNames:{bubbled:keyOf({onEncrypted:!0}),captured:keyOf({onEncryptedCapture:!0})}},ended:{phasedRegistrationNames:{bubbled:keyOf({onEnded:!0}),captured:keyOf({onEndedCapture:!0})}},error:{phasedRegistrationNames:{bubbled:keyOf({onError:!0}),captured:keyOf({onErrorCapture:!0})}},focus:{phasedRegistrationNames:{bubbled:keyOf({onFocus:!0}),captured:keyOf({onFocusCapture:!0})}},input:{phasedRegistrationNames:{bubbled:keyOf({onInput:!0}),captured:keyOf({onInputCapture:!0})}},keyDown:{phasedRegistrationNames:{bubbled:keyOf({onKeyDown:!0}),captured:keyOf({onKeyDownCapture:!0})}},keyPress:{phasedRegistrationNames:{bubbled:keyOf({onKeyPress:!0}),captured:keyOf({onKeyPressCapture:!0})}},keyUp:{phasedRegistrationNames:{bubbled:keyOf({onKeyUp:!0}),captured:keyOf({onKeyUpCapture:!0})}},load:{phasedRegistrationNames:{bubbled:keyOf({onLoad:!0}),captured:keyOf({onLoadCapture:!0})}},loadedData:{phasedRegistrationNames:{bubbled:keyOf({onLoadedData:!0}),captured:keyOf({onLoadedDataCapture:!0})}},loadedMetadata:{phasedRegistrationNames:{bubbled:keyOf({onLoadedMetadata:!0}),captured:keyOf({onLoadedMetadataCapture:!0})}},loadStart:{phasedRegistrationNames:{bubbled:keyOf({onLoadStart:!0}),captured:keyOf({onLoadStartCapture:!0})}},mouseDown:{phasedRegistrationNames:{bubbled:keyOf({onMouseDown:!0}),captured:keyOf({onMouseDownCapture:!0})}},mouseMove:{phasedRegistrationNames:{bubbled:keyOf({onMouseMove:!0}),captured:keyOf({onMouseMoveCapture:!0})}},mouseOut:{phasedRegistrationNames:{bubbled:keyOf({onMouseOut:!0}),captured:keyOf({onMouseOutCapture:!0})}},mouseOver:{phasedRegistrationNames:{bubbled:keyOf({onMouseOver:!0}),captured:keyOf({onMouseOverCapture:!0})}},mouseUp:{phasedRegistrationNames:{bubbled:keyOf({onMouseUp:!0}),captured:keyOf({onMouseUpCapture:!0})}},paste:{phasedRegistrationNames:{bubbled:keyOf({onPaste:!0}),captured:keyOf({onPasteCapture:!0})}},pause:{phasedRegistrationNames:{bubbled:keyOf({onPause:!0}),captured:keyOf({onPauseCapture:!0})}},play:{phasedRegistrationNames:{bubbled:keyOf({onPlay:!0}),captured:keyOf({onPlayCapture:!0})}},playing:{phasedRegistrationNames:{bubbled:keyOf({onPlaying:!0}),captured:keyOf({onPlayingCapture:!0})}},progress:{phasedRegistrationNames:{bubbled:keyOf({onProgress:!0}),captured:keyOf({onProgressCapture:!0})}},rateChange:{phasedRegistrationNames:{bubbled:keyOf({onRateChange:!0}),captured:keyOf({onRateChangeCapture:!0})}},reset:{phasedRegistrationNames:{bubbled:keyOf({onReset:!0}),captured:keyOf({onResetCapture:!0})}},scroll:{phasedRegistrationNames:{bubbled:keyOf({onScroll:!0}),captured:keyOf({onScrollCapture:!0})}},seeked:{phasedRegistrationNames:{bubbled:keyOf({onSeeked:!0}),captured:keyOf({onSeekedCapture:!0})}},seeking:{phasedRegistrationNames:{bubbled:keyOf({onSeeking:!0}),captured:keyOf({onSeekingCapture:!0})}},stalled:{phasedRegistrationNames:{bubbled:keyOf({onStalled:!0}),captured:keyOf({onStalledCapture:!0})}},submit:{phasedRegistrationNames:{bubbled:keyOf({onSubmit:!0}),captured:keyOf({onSubmitCapture:!0})}},suspend:{phasedRegistrationNames:{bubbled:keyOf({onSuspend:!0}),captured:keyOf({onSuspendCapture:!0})}},timeUpdate:{phasedRegistrationNames:{bubbled:keyOf({onTimeUpdate:!0}),captured:keyOf({onTimeUpdateCapture:!0})}},touchCancel:{phasedRegistrationNames:{bubbled:keyOf({onTouchCancel:!0}),captured:keyOf({onTouchCancelCapture:!0})}},touchEnd:{phasedRegistrationNames:{bubbled:keyOf({onTouchEnd:!0}),captured:keyOf({onTouchEndCapture:!0})}},touchMove:{phasedRegistrationNames:{bubbled:keyOf({onTouchMove:!0}),captured:keyOf({onTouchMoveCapture:!0})}},touchStart:{phasedRegistrationNames:{bubbled:keyOf({onTouchStart:!0}),captured:keyOf({onTouchStartCapture:!0})}},volumeChange:{phasedRegistrationNames:{bubbled:keyOf({onVolumeChange:!0}),captured:keyOf({onVolumeChangeCapture:!0})}},waiting:{phasedRegistrationNames:{bubbled:keyOf({onWaiting:!0}),captured:keyOf({onWaitingCapture:!0})}},wheel:{phasedRegistrationNames:{bubbled:keyOf({onWheel:!0}),captured:keyOf({onWheelCapture:!0})}}},topLevelEventsToDispatchConfig={topAbort:eventTypes.abort,topBlur:eventTypes.blur,topCanPlay:eventTypes.canPlay,topCanPlayThrough:eventTypes.canPlayThrough,topClick:eventTypes.click,topContextMenu:eventTypes.contextMenu,topCopy:eventTypes.copy,topCut:eventTypes.cut,topDoubleClick:eventTypes.doubleClick,topDrag:eventTypes.drag,topDragEnd:eventTypes.dragEnd,topDragEnter:eventTypes.dragEnter,topDragExit:eventTypes.dragExit,topDragLeave:eventTypes.dragLeave,topDragOver:eventTypes.dragOver,topDragStart:eventTypes.dragStart,topDrop:eventTypes.drop,topDurationChange:eventTypes.durationChange,topEmptied:eventTypes.emptied,topEncrypted:eventTypes.encrypted,topEnded:eventTypes.ended,topError:eventTypes.error,topFocus:eventTypes.focus,topInput:eventTypes.input,topKeyDown:eventTypes.keyDown,topKeyPress:eventTypes.keyPress,topKeyUp:eventTypes.keyUp,topLoad:eventTypes.load,topLoadedData:eventTypes.loadedData,topLoadedMetadata:eventTypes.loadedMetadata,topLoadStart:eventTypes.loadStart,topMouseDown:eventTypes.mouseDown,topMouseMove:eventTypes.mouseMove,topMouseOut:eventTypes.mouseOut,topMouseOver:eventTypes.mouseOver,topMouseUp:eventTypes.mouseUp,topPaste:eventTypes.paste,topPause:eventTypes.pause,topPlay:eventTypes.play,topPlaying:eventTypes.playing,topProgress:eventTypes.progress,topRateChange:eventTypes.rateChange,topReset:eventTypes.reset,topScroll:eventTypes.scroll,topSeeked:eventTypes.seeked,topSeeking:eventTypes.seeking,topStalled:eventTypes.stalled,topSubmit:eventTypes.submit,topSuspend:eventTypes.suspend,topTimeUpdate:eventTypes.timeUpdate,topTouchCancel:eventTypes.touchCancel,topTouchEnd:eventTypes.touchEnd,topTouchMove:eventTypes.touchMove,topTouchStart:eventTypes.touchStart,topVolumeChange:eventTypes.volumeChange,topWaiting:eventTypes.waiting,topWheel:eventTypes.wheel};for(var type in topLevelEventsToDispatchConfig)topLevelEventsToDispatchConfig[type].dependencies=[type];var ON_CLICK_KEY=keyOf({onClick:null}),onClickListeners={},SimpleEventPlugin={eventTypes:eventTypes,extractEvents:function(e,t,a,o,p){var s,n=topLevelEventsToDispatchConfig[e];if(!n)return null;switch(e){case topLevelTypes.topAbort:case topLevelTypes.topCanPlay:case topLevelTypes.topCanPlayThrough:case topLevelTypes.topDurationChange:case topLevelTypes.topEmptied:case topLevelTypes.topEncrypted:case topLevelTypes.topEnded:case topLevelTypes.topError:case topLevelTypes.topInput:case topLevelTypes.topLoad:case topLevelTypes.topLoadedData:case topLevelTypes.topLoadedMetadata:case topLevelTypes.topLoadStart:case topLevelTypes.topPause:case topLevelTypes.topPlay:case topLevelTypes.topPlaying:case topLevelTypes.topProgress:case topLevelTypes.topRateChange:case topLevelTypes.topReset:case topLevelTypes.topSeeked:case topLevelTypes.topSeeking:case topLevelTypes.topStalled:case topLevelTypes.topSubmit:case topLevelTypes.topSuspend:case topLevelTypes.topTimeUpdate:case topLevelTypes.topVolumeChange:case topLevelTypes.topWaiting:s=SyntheticEvent;break;case topLevelTypes.topKeyPress:if(0===getEventCharCode(o))return null;case topLevelTypes.topKeyDown:case topLevelTypes.topKeyUp:s=SyntheticKeyboardEvent;break;case topLevelTypes.topBlur:case topLevelTypes.topFocus:s=SyntheticFocusEvent;break;case topLevelTypes.topClick:if(2===o.button)return null;case topLevelTypes.topContextMenu:case topLevelTypes.topDoubleClick:case topLevelTypes.topMouseDown:case topLevelTypes.topMouseMove:case topLevelTypes.topMouseOut:case topLevelTypes.topMouseOver:case topLevelTypes.topMouseUp:s=SyntheticMouseEvent;break;case topLevelTypes.topDrag:case topLevelTypes.topDragEnd:case topLevelTypes.topDragEnter:case topLevelTypes.topDragExit:case topLevelTypes.topDragLeave:case topLevelTypes.topDragOver:case topLevelTypes.topDragStart:case topLevelTypes.topDrop:s=SyntheticDragEvent;break;case topLevelTypes.topTouchCancel:case topLevelTypes.topTouchEnd:case topLevelTypes.topTouchMove:case topLevelTypes.topTouchStart:s=SyntheticTouchEvent;break;case topLevelTypes.topScroll:s=SyntheticUIEvent;break;case topLevelTypes.topWheel:s=SyntheticWheelEvent;break;case topLevelTypes.topCopy:case topLevelTypes.topCut:case topLevelTypes.topPaste:s=SyntheticClipboardEvent}s||invariant(!1);var r=s.getPooled(n,a,o,p);return EventPropagators.accumulateTwoPhaseDispatches(r),r},didPutListener:function(e,t,a){if(t===ON_CLICK_KEY){var o=ReactMount.getNode(e);onClickListeners[e]||(onClickListeners[e]=EventListener.listen(o,"click",emptyFunction))}},willDeleteListener:function(e,t){t===ON_CLICK_KEY&&(onClickListeners[e].remove(),delete onClickListeners[e])}};module.exports=SimpleEventPlugin;

},{"./EventConstants":156,"./EventPropagators":160,"./ReactMount":205,"./SyntheticClipboardEvent":229,"./SyntheticDragEvent":231,"./SyntheticEvent":232,"./SyntheticFocusEvent":233,"./SyntheticKeyboardEvent":235,"./SyntheticMouseEvent":236,"./SyntheticTouchEvent":237,"./SyntheticUIEvent":238,"./SyntheticWheelEvent":239,"./getEventCharCode":251,"fbjs/lib/EventListener":66,"fbjs/lib/emptyFunction":73,"fbjs/lib/invariant":81,"fbjs/lib/keyOf":85}],229:[function(require,module,exports){
"use strict";var SyntheticEvent=require("./SyntheticEvent"),ClipboardEventInterface={clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}};function SyntheticClipboardEvent(t,e,n,a){SyntheticEvent.call(this,t,e,n,a)}SyntheticEvent.augmentClass(SyntheticClipboardEvent,ClipboardEventInterface),module.exports=SyntheticClipboardEvent;

},{"./SyntheticEvent":232}],230:[function(require,module,exports){
"use strict";var SyntheticEvent=require("./SyntheticEvent"),CompositionEventInterface={data:null};function SyntheticCompositionEvent(t,n,e,i){SyntheticEvent.call(this,t,n,e,i)}SyntheticEvent.augmentClass(SyntheticCompositionEvent,CompositionEventInterface),module.exports=SyntheticCompositionEvent;

},{"./SyntheticEvent":232}],231:[function(require,module,exports){
"use strict";var SyntheticMouseEvent=require("./SyntheticMouseEvent"),DragEventInterface={dataTransfer:null};function SyntheticDragEvent(t,e,n,a){SyntheticMouseEvent.call(this,t,e,n,a)}SyntheticMouseEvent.augmentClass(SyntheticDragEvent,DragEventInterface),module.exports=SyntheticDragEvent;

},{"./SyntheticMouseEvent":236}],232:[function(require,module,exports){
"use strict";var PooledClass=require("./PooledClass"),assign=require("./Object.assign"),emptyFunction=require("fbjs/lib/emptyFunction"),warning=require("fbjs/lib/warning"),EventInterface={type:null,target:null,currentTarget:emptyFunction.thatReturnsNull,eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null};function SyntheticEvent(t,e,n,r){this.dispatchConfig=t,this.dispatchMarker=e,this.nativeEvent=n;var s=this.constructor.Interface;for(var a in s)if(s.hasOwnProperty(a)){var i=s[a];i?this[a]=i(n):"target"===a?this.target=r:this[a]=n[a]}var o=null!=n.defaultPrevented?n.defaultPrevented:!1===n.returnValue;this.isDefaultPrevented=o?emptyFunction.thatReturnsTrue:emptyFunction.thatReturnsFalse,this.isPropagationStopped=emptyFunction.thatReturnsFalse}assign(SyntheticEvent.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():t.returnValue=!1,this.isDefaultPrevented=emptyFunction.thatReturnsTrue)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():t.cancelBubble=!0,this.isPropagationStopped=emptyFunction.thatReturnsTrue)},persist:function(){this.isPersistent=emptyFunction.thatReturnsTrue},isPersistent:emptyFunction.thatReturnsFalse,destructor:function(){var t=this.constructor.Interface;for(var e in t)this[e]=null;this.dispatchConfig=null,this.dispatchMarker=null,this.nativeEvent=null}}),SyntheticEvent.Interface=EventInterface,SyntheticEvent.augmentClass=function(t,e){var n=Object.create(this.prototype);assign(n,t.prototype),t.prototype=n,t.prototype.constructor=t,t.Interface=assign({},this.Interface,e),t.augmentClass=this.augmentClass,PooledClass.addPoolingTo(t,PooledClass.fourArgumentPooler)},PooledClass.addPoolingTo(SyntheticEvent,PooledClass.fourArgumentPooler),module.exports=SyntheticEvent;

},{"./Object.assign":164,"./PooledClass":165,"fbjs/lib/emptyFunction":73,"fbjs/lib/warning":90}],233:[function(require,module,exports){
"use strict";var SyntheticUIEvent=require("./SyntheticUIEvent"),FocusEventInterface={relatedTarget:null};function SyntheticFocusEvent(t,e,n,c){SyntheticUIEvent.call(this,t,e,n,c)}SyntheticUIEvent.augmentClass(SyntheticFocusEvent,FocusEventInterface),module.exports=SyntheticFocusEvent;

},{"./SyntheticUIEvent":238}],234:[function(require,module,exports){
"use strict";var SyntheticEvent=require("./SyntheticEvent"),InputEventInterface={data:null};function SyntheticInputEvent(t,n,e,c){SyntheticEvent.call(this,t,n,e,c)}SyntheticEvent.augmentClass(SyntheticInputEvent,InputEventInterface),module.exports=SyntheticInputEvent;

},{"./SyntheticEvent":232}],235:[function(require,module,exports){
"use strict";var SyntheticUIEvent=require("./SyntheticUIEvent"),getEventCharCode=require("./getEventCharCode"),getEventKey=require("./getEventKey"),getEventModifierState=require("./getEventModifierState"),KeyboardEventInterface={key:getEventKey,location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:getEventModifierState,charCode:function(e){return"keypress"===e.type?getEventCharCode(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?getEventCharCode(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}};function SyntheticKeyboardEvent(e,t,n,r){SyntheticUIEvent.call(this,e,t,n,r)}SyntheticUIEvent.augmentClass(SyntheticKeyboardEvent,KeyboardEventInterface),module.exports=SyntheticKeyboardEvent;

},{"./SyntheticUIEvent":238,"./getEventCharCode":251,"./getEventKey":252,"./getEventModifierState":253}],236:[function(require,module,exports){
"use strict";var SyntheticUIEvent=require("./SyntheticUIEvent"),ViewportMetrics=require("./ViewportMetrics"),getEventModifierState=require("./getEventModifierState"),MouseEventInterface={screenX:null,screenY:null,clientX:null,clientY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:getEventModifierState,button:function(e){var t=e.button;return"which"in e?t:2===t?2:4===t?1:0},buttons:null,relatedTarget:function(e){return e.relatedTarget||(e.fromElement===e.srcElement?e.toElement:e.fromElement)},pageX:function(e){return"pageX"in e?e.pageX:e.clientX+ViewportMetrics.currentScrollLeft},pageY:function(e){return"pageY"in e?e.pageY:e.clientY+ViewportMetrics.currentScrollTop}};function SyntheticMouseEvent(e,t,n,r){SyntheticUIEvent.call(this,e,t,n,r)}SyntheticUIEvent.augmentClass(SyntheticMouseEvent,MouseEventInterface),module.exports=SyntheticMouseEvent;

},{"./SyntheticUIEvent":238,"./ViewportMetrics":241,"./getEventModifierState":253}],237:[function(require,module,exports){
"use strict";var SyntheticUIEvent=require("./SyntheticUIEvent"),getEventModifierState=require("./getEventModifierState"),TouchEventInterface={touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:getEventModifierState};function SyntheticTouchEvent(e,t,n,c){SyntheticUIEvent.call(this,e,t,n,c)}SyntheticUIEvent.augmentClass(SyntheticTouchEvent,TouchEventInterface),module.exports=SyntheticTouchEvent;

},{"./SyntheticUIEvent":238,"./getEventModifierState":253}],238:[function(require,module,exports){
"use strict";var SyntheticEvent=require("./SyntheticEvent"),getEventTarget=require("./getEventTarget"),UIEventInterface={view:function(e){if(e.view)return e.view;var t=getEventTarget(e);if(null!=t&&t.window===t)return t;var n=t.ownerDocument;return n?n.defaultView||n.parentWindow:window},detail:function(e){return e.detail||0}};function SyntheticUIEvent(e,t,n,i){SyntheticEvent.call(this,e,t,n,i)}SyntheticEvent.augmentClass(SyntheticUIEvent,UIEventInterface),module.exports=SyntheticUIEvent;

},{"./SyntheticEvent":232,"./getEventTarget":254}],239:[function(require,module,exports){
"use strict";var SyntheticMouseEvent=require("./SyntheticMouseEvent"),WheelEventInterface={deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:null,deltaMode:null};function SyntheticWheelEvent(e,t,n,l){SyntheticMouseEvent.call(this,e,t,n,l)}SyntheticMouseEvent.augmentClass(SyntheticWheelEvent,WheelEventInterface),module.exports=SyntheticWheelEvent;

},{"./SyntheticMouseEvent":236}],240:[function(require,module,exports){
"use strict";var invariant=require("fbjs/lib/invariant"),Mixin={reinitializeTransaction:function(){this.transactionWrappers=this.getTransactionWrappers(),this.wrapperInitData?this.wrapperInitData.length=0:this.wrapperInitData=[],this._isInTransaction=!1},_isInTransaction:!1,getTransactionWrappers:null,isInTransaction:function(){return!!this._isInTransaction},perform:function(i,t,a,n,r,s,l,e){var c,o;this.isInTransaction()&&invariant(!1);try{this._isInTransaction=!0,c=!0,this.initializeAll(0),o=i.call(t,a,n,r,s,l,e),c=!1}finally{try{if(c)try{this.closeAll(0)}catch(i){}else this.closeAll(0)}finally{this._isInTransaction=!1}}return o},initializeAll:function(i){for(var t=this.transactionWrappers,a=i;a<t.length;a++){var n=t[a];try{this.wrapperInitData[a]=Transaction.OBSERVED_ERROR,this.wrapperInitData[a]=n.initialize?n.initialize.call(this):null}finally{if(this.wrapperInitData[a]===Transaction.OBSERVED_ERROR)try{this.initializeAll(a+1)}catch(i){}}}},closeAll:function(i){this.isInTransaction()||invariant(!1);for(var t=this.transactionWrappers,a=i;a<t.length;a++){var n,r=t[a],s=this.wrapperInitData[a];try{n=!0,s!==Transaction.OBSERVED_ERROR&&r.close&&r.close.call(this,s),n=!1}finally{if(n)try{this.closeAll(a+1)}catch(i){}}}this.wrapperInitData.length=0}},Transaction={Mixin:Mixin,OBSERVED_ERROR:{}};module.exports=Transaction;

},{"fbjs/lib/invariant":81}],241:[function(require,module,exports){
"use strict";var ViewportMetrics={currentScrollLeft:0,currentScrollTop:0,refreshScrollValues:function(r){ViewportMetrics.currentScrollLeft=r.x,ViewportMetrics.currentScrollTop=r.y}};module.exports=ViewportMetrics;

},{}],242:[function(require,module,exports){
"use strict";var invariant=require("fbjs/lib/invariant");function accumulateInto(r,a){if(null==a&&invariant(!1),null==r)return a;var n=Array.isArray(r),t=Array.isArray(a);return n&&t?(r.push.apply(r,a),r):n?(r.push(a),r):t?[r].concat(a):[r,a]}module.exports=accumulateInto;

},{"fbjs/lib/invariant":81}],243:[function(require,module,exports){
"use strict";var MOD=65521;function adler32(r){for(var e=1,t=0,o=0,a=r.length,d=-4&a;o<d;){for(;o<Math.min(o+4096,d);o+=4)t+=(e+=r.charCodeAt(o))+(e+=r.charCodeAt(o+1))+(e+=r.charCodeAt(o+2))+(e+=r.charCodeAt(o+3));e%=MOD,t%=MOD}for(;o<a;o++)t+=e+=r.charCodeAt(o);return(e%=MOD)|(t%=MOD)<<16}module.exports=adler32;

},{}],244:[function(require,module,exports){
"use strict";var canDefineProperty=!1;module.exports=canDefineProperty;

},{}],245:[function(require,module,exports){
"use strict";var CSSProperty=require("./CSSProperty"),isUnitlessNumber=CSSProperty.isUnitlessNumber;function dangerousStyleValue(e,r){return null==r||"boolean"==typeof r||""===r?"":isNaN(r)||0===r||isUnitlessNumber.hasOwnProperty(e)&&isUnitlessNumber[e]?""+r:("string"==typeof r&&(r=r.trim()),r+"px")}module.exports=dangerousStyleValue;

},{"./CSSProperty":145}],246:[function(require,module,exports){
"use strict";var assign=require("./Object.assign"),warning=require("fbjs/lib/warning");function deprecated(e,r,i,n,s){return s}module.exports=deprecated;

},{"./Object.assign":164,"fbjs/lib/warning":90}],247:[function(require,module,exports){
"use strict";var ESCAPE_LOOKUP={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#x27;"},ESCAPE_REGEX=/[&><"']/g;function escaper(e){return ESCAPE_LOOKUP[e]}function escapeTextContentForBrowser(e){return(""+e).replace(ESCAPE_REGEX,escaper)}module.exports=escapeTextContentForBrowser;

},{}],248:[function(require,module,exports){
"use strict";var ReactCurrentOwner=require("./ReactCurrentOwner"),ReactInstanceMap=require("./ReactInstanceMap"),ReactMount=require("./ReactMount"),invariant=require("fbjs/lib/invariant"),warning=require("fbjs/lib/warning");function findDOMNode(e){return null==e?null:1===e.nodeType?e:ReactInstanceMap.has(e)?ReactMount.getNodeFromInstance(e):(null!=e.render&&"function"==typeof e.render&&invariant(!1),void invariant(!1))}module.exports=findDOMNode;

},{"./ReactCurrentOwner":176,"./ReactInstanceMap":202,"./ReactMount":205,"fbjs/lib/invariant":81,"fbjs/lib/warning":90}],249:[function(require,module,exports){
"use strict";var traverseAllChildren=require("./traverseAllChildren"),warning=require("fbjs/lib/warning");function flattenSingleChildIntoContext(e,n,r){var l=e,t=void 0===l[r];t&&null!=n&&(l[r]=n)}function flattenChildren(e){if(null==e)return e;var n={};return traverseAllChildren(e,flattenSingleChildIntoContext,n),n}module.exports=flattenChildren;

},{"./traverseAllChildren":267,"fbjs/lib/warning":90}],250:[function(require,module,exports){
"use strict";var forEachAccumulated=function(c,r,a){Array.isArray(c)?c.forEach(r,a):c&&r.call(a,c)};module.exports=forEachAccumulated;

},{}],251:[function(require,module,exports){
"use strict";function getEventCharCode(e){var r,t=e.keyCode;return"charCode"in e?0===(r=e.charCode)&&13===t&&(r=13):r=t,r>=32||13===r?r:0}module.exports=getEventCharCode;

},{}],252:[function(require,module,exports){
"use strict";var getEventCharCode=require("./getEventCharCode"),normalizeKey={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},translateToKey={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"};function getEventKey(e){if(e.key){var r=normalizeKey[e.key]||e.key;if("Unidentified"!==r)return r}if("keypress"===e.type){var t=getEventCharCode(e);return 13===t?"Enter":String.fromCharCode(t)}return"keydown"===e.type||"keyup"===e.type?translateToKey[e.keyCode]||"Unidentified":""}module.exports=getEventKey;

},{"./getEventCharCode":251}],253:[function(require,module,exports){
"use strict";var modifierKeyToProp={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function modifierStateGetter(t){var e=this.nativeEvent;if(e.getModifierState)return e.getModifierState(t);var r=modifierKeyToProp[t];return!!r&&!!e[r]}function getEventModifierState(t){return modifierStateGetter}module.exports=getEventModifierState;

},{}],254:[function(require,module,exports){
"use strict";function getEventTarget(e){var t=e.target||e.srcElement||window;return 3===t.nodeType?t.parentNode:t}module.exports=getEventTarget;

},{}],255:[function(require,module,exports){
"use strict";var ITERATOR_SYMBOL="function"==typeof Symbol&&Symbol.iterator,FAUX_ITERATOR_SYMBOL="@@iterator";function getIteratorFn(t){var r=t&&(ITERATOR_SYMBOL&&t[ITERATOR_SYMBOL]||t[FAUX_ITERATOR_SYMBOL]);if("function"==typeof r)return r}module.exports=getIteratorFn;

},{}],256:[function(require,module,exports){
"use strict";function getLeafNode(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function getSiblingNode(e){for(;e;){if(e.nextSibling)return e.nextSibling;e=e.parentNode}}function getNodeForCharacterOffset(e,t){for(var o=getLeafNode(e),n=0,r=0;o;){if(3===o.nodeType){if(r=n+o.textContent.length,n<=t&&r>=t)return{node:o,offset:t-n};n=r}o=getLeafNode(getSiblingNode(o))}}module.exports=getNodeForCharacterOffset;

},{}],257:[function(require,module,exports){
"use strict";var ExecutionEnvironment=require("fbjs/lib/ExecutionEnvironment"),contentKey=null;function getTextContentAccessor(){return!contentKey&&ExecutionEnvironment.canUseDOM&&(contentKey="textContent"in document.documentElement?"textContent":"innerText"),contentKey}module.exports=getTextContentAccessor;

},{"fbjs/lib/ExecutionEnvironment":67}],258:[function(require,module,exports){
"use strict";var ReactCompositeComponent=require("./ReactCompositeComponent"),ReactEmptyComponent=require("./ReactEmptyComponent"),ReactNativeComponent=require("./ReactNativeComponent"),assign=require("./Object.assign"),invariant=require("fbjs/lib/invariant"),warning=require("fbjs/lib/warning"),ReactCompositeComponentWrapper=function(){};function getDeclarationErrorAddendum(e){if(e){var t=e.getName();if(t)return" Check the render method of `"+t+"`."}return""}function isInternalComponentType(e){return"function"==typeof e&&void 0!==e.prototype&&"function"==typeof e.prototype.mountComponent&&"function"==typeof e.prototype.receiveComponent}function instantiateReactComponent(e){var t;if(null===e||!1===e)t=new ReactEmptyComponent(instantiateReactComponent);else if("object"==typeof e){var n=e;(!n||"function"!=typeof n.type&&"string"!=typeof n.type)&&invariant(!1),t="string"==typeof n.type?ReactNativeComponent.createInternalComponent(n):isInternalComponentType(n.type)?new n.type(n):new ReactCompositeComponentWrapper}else"string"==typeof e||"number"==typeof e?t=ReactNativeComponent.createInstanceForText(e):invariant(!1);return t.construct(e),t._mountIndex=0,t._mountImage=null,t}assign(ReactCompositeComponentWrapper.prototype,ReactCompositeComponent.Mixin,{_instantiateReactComponent:instantiateReactComponent}),module.exports=instantiateReactComponent;

},{"./Object.assign":164,"./ReactCompositeComponent":175,"./ReactEmptyComponent":194,"./ReactNativeComponent":208,"fbjs/lib/invariant":81,"fbjs/lib/warning":90}],259:[function(require,module,exports){
"use strict";var useHasFeature,ExecutionEnvironment=require("fbjs/lib/ExecutionEnvironment");function isEventSupported(e,t){if(!ExecutionEnvironment.canUseDOM||t&&!("addEventListener"in document))return!1;var n="on"+e,u=n in document;if(!u){var i=document.createElement("div");i.setAttribute(n,"return;"),u="function"==typeof i[n]}return!u&&useHasFeature&&"wheel"===e&&(u=document.implementation.hasFeature("Events.wheel","3.0")),u}ExecutionEnvironment.canUseDOM&&(useHasFeature=document.implementation&&document.implementation.hasFeature&&!0!==document.implementation.hasFeature("","")),module.exports=isEventSupported;

},{"fbjs/lib/ExecutionEnvironment":67}],260:[function(require,module,exports){
"use strict";var supportedInputTypes={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function isTextInputElement(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&supportedInputTypes[e.type]||"textarea"===t)}module.exports=isTextInputElement;

},{}],261:[function(require,module,exports){
"use strict";var ReactElement=require("./ReactElement"),invariant=require("fbjs/lib/invariant");function onlyChild(e){return ReactElement.isValidElement(e)||invariant(!1),e}module.exports=onlyChild;

},{"./ReactElement":192,"fbjs/lib/invariant":81}],262:[function(require,module,exports){
"use strict";var escapeTextContentForBrowser=require("./escapeTextContentForBrowser");function quoteAttributeValueForBrowser(e){return'"'+escapeTextContentForBrowser(e)+'"'}module.exports=quoteAttributeValueForBrowser;

},{"./escapeTextContentForBrowser":247}],263:[function(require,module,exports){
"use strict";var ReactMount=require("./ReactMount");module.exports=ReactMount.renderSubtreeIntoContainer;

},{"./ReactMount":205}],264:[function(require,module,exports){
"use strict";var ExecutionEnvironment=require("fbjs/lib/ExecutionEnvironment"),WHITESPACE_TEST=/^[ \r\n\t\f]/,NONVISIBLE_TEST=/<(!--|link|noscript|meta|script|style)[ \r\n\t\f\/>]/,setInnerHTML=function(e,n){e.innerHTML=n};if("undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction&&(setInnerHTML=function(e,n){MSApp.execUnsafeLocalFunction(function(){e.innerHTML=n})}),ExecutionEnvironment.canUseDOM){var testElement=document.createElement("div");testElement.innerHTML=" ",""===testElement.innerHTML&&(setInnerHTML=function(e,n){if(e.parentNode&&e.parentNode.replaceChild(e,e),WHITESPACE_TEST.test(n)||"<"===n[0]&&NONVISIBLE_TEST.test(n)){e.innerHTML=String.fromCharCode(65279)+n;var t=e.firstChild;1===t.data.length?e.removeChild(t):t.deleteData(0,1)}else e.innerHTML=n})}module.exports=setInnerHTML;

},{"fbjs/lib/ExecutionEnvironment":67}],265:[function(require,module,exports){
"use strict";var ExecutionEnvironment=require("fbjs/lib/ExecutionEnvironment"),escapeTextContentForBrowser=require("./escapeTextContentForBrowser"),setInnerHTML=require("./setInnerHTML"),setTextContent=function(e,t){e.textContent=t};ExecutionEnvironment.canUseDOM&&("textContent"in document.documentElement||(setTextContent=function(e,t){setInnerHTML(e,escapeTextContentForBrowser(t))})),module.exports=setTextContent;

},{"./escapeTextContentForBrowser":247,"./setInnerHTML":264,"fbjs/lib/ExecutionEnvironment":67}],266:[function(require,module,exports){
"use strict";function shouldUpdateReactComponent(e,t){var n=null===e||!1===e,o=null===t||!1===t;if(n||o)return n===o;var r=typeof e,u=typeof t;return"string"===r||"number"===r?"string"===u||"number"===u:"object"===u&&e.type===t.type&&e.key===t.key}module.exports=shouldUpdateReactComponent;

},{}],267:[function(require,module,exports){
"use strict";var ReactCurrentOwner=require("./ReactCurrentOwner"),ReactElement=require("./ReactElement"),ReactInstanceHandles=require("./ReactInstanceHandles"),getIteratorFn=require("./getIteratorFn"),invariant=require("fbjs/lib/invariant"),warning=require("fbjs/lib/warning"),SEPARATOR=ReactInstanceHandles.SEPARATOR,SUBSEPARATOR=":",userProvidedKeyEscaperLookup={"=":"=0",".":"=1",":":"=2"},userProvidedKeyEscapeRegex=/[=.:]/g,didWarnAboutMaps=!1;function userProvidedKeyEscaper(e){return userProvidedKeyEscaperLookup[e]}function getComponentKey(e,r){return e&&null!=e.key?wrapUserProvidedKey(e.key):r.toString(36)}function escapeUserProvidedKey(e){return(""+e).replace(userProvidedKeyEscapeRegex,userProvidedKeyEscaper)}function wrapUserProvidedKey(e){return"$"+escapeUserProvidedKey(e)}function traverseAllChildrenImpl(e,r,n,t){var a,i=typeof e;if("undefined"!==i&&"boolean"!==i||(e=null),null===e||"string"===i||"number"===i||ReactElement.isValidElement(e))return n(t,e,""===r?SEPARATOR+getComponentKey(e,0):r),1;var l=0,o=""===r?SEPARATOR:r+SUBSEPARATOR;if(Array.isArray(e))for(var s=0;s<e.length;s++)l+=traverseAllChildrenImpl(a=e[s],o+getComponentKey(a,s),n,t);else{var d=getIteratorFn(e);if(d){var u,v=d.call(e);if(d!==e.entries)for(var c=0;!(u=v.next()).done;)l+=traverseAllChildrenImpl(a=u.value,o+getComponentKey(a,c++),n,t);else for(0;!(u=v.next()).done;){var p=u.value;p&&(l+=traverseAllChildrenImpl(a=p[1],o+wrapUserProvidedKey(p[0])+SUBSEPARATOR+getComponentKey(a,0),n,t))}}else if("object"===i){String(e);invariant(!1)}}return l}function traverseAllChildren(e,r,n){return null==e?0:traverseAllChildrenImpl(e,"",r,n)}module.exports=traverseAllChildren;

},{"./ReactCurrentOwner":176,"./ReactElement":192,"./ReactInstanceHandles":201,"./getIteratorFn":255,"fbjs/lib/invariant":81,"fbjs/lib/warning":90}],268:[function(require,module,exports){
"use strict";var specialTags,inScopeTags,buttonScopeTags,impliedEndTags,emptyAncestorInfo,updatedAncestorInfo,isTagValidWithParent,findInvalidAncestorForTag,findOwnerStack,didWarn,assign=require("./Object.assign"),emptyFunction=require("fbjs/lib/emptyFunction"),warning=require("fbjs/lib/warning"),validateDOMNesting=emptyFunction;module.exports=validateDOMNesting;

},{"./Object.assign":164,"fbjs/lib/emptyFunction":73,"fbjs/lib/warning":90}],269:[function(require,module,exports){
"use strict";module.exports=require("./lib/React");

},{"./lib/React":166}],270:[function(require,module,exports){
module.exports=require("./lib/_stream_duplex.js");

},{"./lib/_stream_duplex.js":271}],271:[function(require,module,exports){
"use strict";var pna=require("process-nextick-args"),objectKeys=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};module.exports=Duplex;var util=require("core-util-is");util.inherits=require("inherits");var Readable=require("./_stream_readable"),Writable=require("./_stream_writable");util.inherits(Duplex,Readable);for(var keys=objectKeys(Writable.prototype),v=0;v<keys.length;v++){var method=keys[v];Duplex.prototype[method]||(Duplex.prototype[method]=Writable.prototype[method])}function Duplex(e){if(!(this instanceof Duplex))return new Duplex(e);Readable.call(this,e),Writable.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",onend)}function onend(){this.allowHalfOpen||this._writableState.ended||pna.nextTick(onEndNT,this)}function onEndNT(e){e.end()}Object.defineProperty(Duplex.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(Duplex.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),Duplex.prototype._destroy=function(e,t){this.push(null),this.end(),pna.nextTick(t,e)};

},{"./_stream_readable":273,"./_stream_writable":275,"core-util-is":53,"inherits":94,"process-nextick-args":139}],272:[function(require,module,exports){
"use strict";module.exports=PassThrough;var Transform=require("./_stream_transform"),util=require("core-util-is");function PassThrough(r){if(!(this instanceof PassThrough))return new PassThrough(r);Transform.call(this,r)}util.inherits=require("inherits"),util.inherits(PassThrough,Transform),PassThrough.prototype._transform=function(r,s,i){i(null,r)};

},{"./_stream_transform":274,"core-util-is":53,"inherits":94}],273:[function(require,module,exports){
(function (process,global){
"use strict";var pna=require("process-nextick-args");module.exports=Readable;var Duplex,isArray=require("isarray");Readable.ReadableState=ReadableState;var EE=require("events").EventEmitter,EElistenerCount=function(e,t){return e.listeners(t).length},Stream=require("./internal/streams/stream"),Buffer=require("safe-buffer").Buffer,OurUint8Array=global.Uint8Array||function(){};function _uint8ArrayToBuffer(e){return Buffer.from(e)}function _isUint8Array(e){return Buffer.isBuffer(e)||e instanceof OurUint8Array}var util=require("core-util-is");util.inherits=require("inherits");var debugUtil=require("util"),debug=void 0;debug=debugUtil&&debugUtil.debuglog?debugUtil.debuglog("stream"):function(){};var StringDecoder,BufferList=require("./internal/streams/BufferList"),destroyImpl=require("./internal/streams/destroy");util.inherits(Readable,Stream);var kProxyEvents=["error","close","destroy","pause","resume"];function prependListener(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?isArray(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}function ReadableState(e,t){Duplex=Duplex||require("./_stream_duplex"),e=e||{};var r=t instanceof Duplex;this.objectMode=!!e.objectMode,r&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var n=e.highWaterMark,a=e.readableHighWaterMark,i=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:r&&(a||0===a)?a:i,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new BufferList,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(StringDecoder||(StringDecoder=require("string_decoder/").StringDecoder),this.decoder=new StringDecoder(e.encoding),this.encoding=e.encoding)}function Readable(e){if(Duplex=Duplex||require("./_stream_duplex"),!(this instanceof Readable))return new Readable(e);this._readableState=new ReadableState(e,this),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),Stream.call(this)}function readableAddChunk(e,t,r,n,a){var i,d=e._readableState;null===t?(d.reading=!1,onEofChunk(e,d)):(a||(i=chunkInvalid(d,t)),i?e.emit("error",i):d.objectMode||t&&t.length>0?("string"==typeof t||d.objectMode||Object.getPrototypeOf(t)===Buffer.prototype||(t=_uint8ArrayToBuffer(t)),n?d.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):addChunk(e,d,t,!0):d.ended?e.emit("error",new Error("stream.push() after EOF")):(d.reading=!1,d.decoder&&!r?(t=d.decoder.write(t),d.objectMode||0!==t.length?addChunk(e,d,t,!1):maybeReadMore(e,d)):addChunk(e,d,t,!1))):n||(d.reading=!1));return needMoreData(d)}function addChunk(e,t,r,n){t.flowing&&0===t.length&&!t.sync?(e.emit("data",r),e.read(0)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&emitReadable(e)),maybeReadMore(e,t)}function chunkInvalid(e,t){var r;return _isUint8Array(t)||"string"==typeof t||void 0===t||e.objectMode||(r=new TypeError("Invalid non-string/buffer chunk")),r}function needMoreData(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}Object.defineProperty(Readable.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),Readable.prototype.destroy=destroyImpl.destroy,Readable.prototype._undestroy=destroyImpl.undestroy,Readable.prototype._destroy=function(e,t){this.push(null),t(e)},Readable.prototype.push=function(e,t){var r,n=this._readableState;return n.objectMode?r=!0:"string"==typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=Buffer.from(e,t),t=""),r=!0),readableAddChunk(this,e,t,!1,r)},Readable.prototype.unshift=function(e){return readableAddChunk(this,e,null,!0,!1)},Readable.prototype.isPaused=function(){return!1===this._readableState.flowing},Readable.prototype.setEncoding=function(e){return StringDecoder||(StringDecoder=require("string_decoder/").StringDecoder),this._readableState.decoder=new StringDecoder(e),this._readableState.encoding=e,this};var MAX_HWM=8388608;function computeNewHighWaterMark(e){return e>=MAX_HWM?e=MAX_HWM:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}function howMuchToRead(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=computeNewHighWaterMark(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function onEofChunk(e,t){if(!t.ended){if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,emitReadable(e)}}function emitReadable(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(debug("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?pna.nextTick(emitReadable_,e):emitReadable_(e))}function emitReadable_(e){debug("emit readable"),e.emit("readable"),flow(e)}function maybeReadMore(e,t){t.readingMore||(t.readingMore=!0,pna.nextTick(maybeReadMore_,e,t))}function maybeReadMore_(e,t){for(var r=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(debug("maybeReadMore read 0"),e.read(0),r!==t.length);)r=t.length;t.readingMore=!1}function pipeOnDrain(e){return function(){var t=e._readableState;debug("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&EElistenerCount(e,"data")&&(t.flowing=!0,flow(e))}}function nReadingNextTick(e){debug("readable nexttick read 0"),e.read(0)}function resume(e,t){t.resumeScheduled||(t.resumeScheduled=!0,pna.nextTick(resume_,e,t))}function resume_(e,t){t.reading||(debug("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),flow(e),t.flowing&&!t.reading&&e.read(0)}function flow(e){var t=e._readableState;for(debug("flow",t.flowing);t.flowing&&null!==e.read(););}function fromList(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):r=fromListPartial(e,t.buffer,t.decoder),r);var r}function fromListPartial(e,t,r){var n;return e<t.head.data.length?(n=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):n=e===t.head.data.length?t.shift():r?copyFromBufferString(e,t):copyFromBuffer(e,t),n}function copyFromBufferString(e,t){var r=t.head,n=1,a=r.data;for(e-=a.length;r=r.next;){var i=r.data,d=e>i.length?i.length:e;if(d===i.length?a+=i:a+=i.slice(0,e),0===(e-=d)){d===i.length?(++n,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=i.slice(d));break}++n}return t.length-=n,a}function copyFromBuffer(e,t){var r=Buffer.allocUnsafe(e),n=t.head,a=1;for(n.data.copy(r),e-=n.data.length;n=n.next;){var i=n.data,d=e>i.length?i.length:e;if(i.copy(r,r.length-e,0,d),0===(e-=d)){d===i.length?(++a,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=i.slice(d));break}++a}return t.length-=a,r}function endReadable(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,pna.nextTick(endReadableNT,t,e))}function endReadableNT(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function indexOf(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}Readable.prototype.read=function(e){debug("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return debug("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?endReadable(this):emitReadable(this),null;if(0===(e=howMuchToRead(e,t))&&t.ended)return 0===t.length&&endReadable(this),null;var n,a=t.needReadable;return debug("need readable",a),(0===t.length||t.length-e<t.highWaterMark)&&debug("length less than watermark",a=!0),t.ended||t.reading?debug("reading or ended",a=!1):a&&(debug("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=howMuchToRead(r,t))),null===(n=e>0?fromList(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&endReadable(this)),null!==n&&this.emit("data",n),n},Readable.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},Readable.prototype.pipe=function(e,t){var r=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=e;break;case 1:n.pipes=[n.pipes,e];break;default:n.pipes.push(e)}n.pipesCount+=1,debug("pipe count=%d opts=%j",n.pipesCount,t);var a=(!t||!1!==t.end)&&e!==process.stdout&&e!==process.stderr?d:b;function i(t,a){debug("onunpipe"),t===r&&a&&!1===a.hasUnpiped&&(a.hasUnpiped=!0,debug("cleanup"),e.removeListener("close",f),e.removeListener("finish",p),e.removeListener("drain",o),e.removeListener("error",h),e.removeListener("unpipe",i),r.removeListener("end",d),r.removeListener("end",b),r.removeListener("data",s),u=!0,!n.awaitDrain||e._writableState&&!e._writableState.needDrain||o())}function d(){debug("onend"),e.end()}n.endEmitted?pna.nextTick(a):r.once("end",a),e.on("unpipe",i);var o=pipeOnDrain(r);e.on("drain",o);var u=!1;var l=!1;function s(t){debug("ondata"),l=!1,!1!==e.write(t)||l||((1===n.pipesCount&&n.pipes===e||n.pipesCount>1&&-1!==indexOf(n.pipes,e))&&!u&&(debug("false write response, pause",r._readableState.awaitDrain),r._readableState.awaitDrain++,l=!0),r.pause())}function h(t){debug("onerror",t),b(),e.removeListener("error",h),0===EElistenerCount(e,"error")&&e.emit("error",t)}function f(){e.removeListener("finish",p),b()}function p(){debug("onfinish"),e.removeListener("close",f),b()}function b(){debug("unpipe"),r.unpipe(e)}return r.on("data",s),prependListener(e,"error",h),e.once("close",f),e.once("finish",p),e.emit("pipe",r),n.flowing||(debug("pipe resume"),r.resume()),e},Readable.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r),this);if(!e){var n=t.pipes,a=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var i=0;i<a;i++)n[i].emit("unpipe",this,r);return this}var d=indexOf(t.pipes,e);return-1===d?this:(t.pipes.splice(d,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r),this)},Readable.prototype.on=function(e,t){var r=Stream.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var n=this._readableState;n.endEmitted||n.readableListening||(n.readableListening=n.needReadable=!0,n.emittedReadable=!1,n.reading?n.length&&emitReadable(this):pna.nextTick(nReadingNextTick,this))}return r},Readable.prototype.addListener=Readable.prototype.on,Readable.prototype.resume=function(){var e=this._readableState;return e.flowing||(debug("resume"),e.flowing=!0,resume(this,e)),this},Readable.prototype.pause=function(){return debug("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(debug("pause"),this._readableState.flowing=!1,this.emit("pause")),this},Readable.prototype.wrap=function(e){var t=this,r=this._readableState,n=!1;for(var a in e.on("end",function(){if(debug("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)}),e.on("data",function(a){(debug("wrapped data"),r.decoder&&(a=r.decoder.write(a)),!r.objectMode||null!==a&&void 0!==a)&&((r.objectMode||a&&a.length)&&(t.push(a)||(n=!0,e.pause())))}),e)void 0===this[a]&&"function"==typeof e[a]&&(this[a]=function(t){return function(){return e[t].apply(e,arguments)}}(a));for(var i=0;i<kProxyEvents.length;i++)e.on(kProxyEvents[i],this.emit.bind(this,kProxyEvents[i]));return this._read=function(t){debug("wrapped _read",t),n&&(n=!1,e.resume())},this},Object.defineProperty(Readable.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Readable._fromList=fromList;

}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"./_stream_duplex":271,"./internal/streams/BufferList":276,"./internal/streams/destroy":277,"./internal/streams/stream":278,"_process":140,"core-util-is":53,"events":65,"inherits":94,"isarray":96,"process-nextick-args":139,"safe-buffer":284,"string_decoder/":279,"util":51}],274:[function(require,module,exports){
"use strict";module.exports=Transform;var Duplex=require("./_stream_duplex"),util=require("core-util-is");function afterTransform(r,t){var n=this._transformState;n.transforming=!1;var e=n.writecb;if(!e)return this.emit("error",new Error("write callback called multiple times"));n.writechunk=null,n.writecb=null,null!=t&&this.push(t),e(r);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function Transform(r){if(!(this instanceof Transform))return new Transform(r);Duplex.call(this,r),this._transformState={afterTransform:afterTransform.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,r&&("function"==typeof r.transform&&(this._transform=r.transform),"function"==typeof r.flush&&(this._flush=r.flush)),this.on("prefinish",prefinish)}function prefinish(){var r=this;"function"==typeof this._flush?this._flush(function(t,n){done(r,t,n)}):done(this,null,null)}function done(r,t,n){if(t)return r.emit("error",t);if(null!=n&&r.push(n),r._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(r._transformState.transforming)throw new Error("Calling transform done when still transforming");return r.push(null)}util.inherits=require("inherits"),util.inherits(Transform,Duplex),Transform.prototype.push=function(r,t){return this._transformState.needTransform=!1,Duplex.prototype.push.call(this,r,t)},Transform.prototype._transform=function(r,t,n){throw new Error("_transform() is not implemented")},Transform.prototype._write=function(r,t,n){var e=this._transformState;if(e.writecb=n,e.writechunk=r,e.writeencoding=t,!e.transforming){var i=this._readableState;(e.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},Transform.prototype._read=function(r){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},Transform.prototype._destroy=function(r,t){var n=this;Duplex.prototype._destroy.call(this,r,function(r){t(r),n.emit("close")})};

},{"./_stream_duplex":271,"core-util-is":53,"inherits":94}],275:[function(require,module,exports){
(function (process,global){
"use strict";var pna=require("process-nextick-args");function WriteReq(e,t,r){this.chunk=e,this.encoding=t,this.callback=r,this.next=null}function CorkedRequest(e){var t=this;this.next=null,this.entry=null,this.finish=function(){onCorkedFinish(t,e)}}module.exports=Writable;var Duplex,asyncWrite=!process.browser&&["v0.10","v0.9."].indexOf(process.version.slice(0,5))>-1?setImmediate:pna.nextTick;Writable.WritableState=WritableState;var util=require("core-util-is");util.inherits=require("inherits");var internalUtil={deprecate:require("util-deprecate")},Stream=require("./internal/streams/stream"),Buffer=require("safe-buffer").Buffer,OurUint8Array=global.Uint8Array||function(){};function _uint8ArrayToBuffer(e){return Buffer.from(e)}function _isUint8Array(e){return Buffer.isBuffer(e)||e instanceof OurUint8Array}var realHasInstance,destroyImpl=require("./internal/streams/destroy");function nop(){}function WritableState(e,t){Duplex=Duplex||require("./_stream_duplex"),e=e||{};var r=t instanceof Duplex;this.objectMode=!!e.objectMode,r&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var i=e.highWaterMark,n=e.writableHighWaterMark,o=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:r&&(n||0===n)?n:o,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var a=!1===e.decodeStrings;this.decodeStrings=!a,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){onwrite(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new CorkedRequest(this)}function Writable(e){if(Duplex=Duplex||require("./_stream_duplex"),!(realHasInstance.call(Writable,this)||this instanceof Duplex))return new Writable(e);this._writableState=new WritableState(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),Stream.call(this)}function writeAfterEnd(e,t){var r=new Error("write after end");e.emit("error",r),pna.nextTick(t,r)}function validChunk(e,t,r,i){var n=!0,o=!1;return null===r?o=new TypeError("May not write null values to stream"):"string"==typeof r||void 0===r||t.objectMode||(o=new TypeError("Invalid non-string/buffer chunk")),o&&(e.emit("error",o),pna.nextTick(i,o),n=!1),n}function decodeChunk(e,t,r){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=Buffer.from(t,r)),t}function writeOrBuffer(e,t,r,i,n,o){if(!r){var a=decodeChunk(t,i,n);i!==a&&(r=!0,n="buffer",i=a)}var s=t.objectMode?1:i.length;t.length+=s;var f=t.length<t.highWaterMark;if(f||(t.needDrain=!0),t.writing||t.corked){var u=t.lastBufferedRequest;t.lastBufferedRequest={chunk:i,encoding:n,isBuf:r,callback:o,next:null},u?u.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else doWrite(e,t,!1,s,i,n,o);return f}function doWrite(e,t,r,i,n,o,a){t.writelen=i,t.writecb=a,t.writing=!0,t.sync=!0,r?e._writev(n,t.onwrite):e._write(n,o,t.onwrite),t.sync=!1}function onwriteError(e,t,r,i,n){--t.pendingcb,r?(pna.nextTick(n,i),pna.nextTick(finishMaybe,e,t),e._writableState.errorEmitted=!0,e.emit("error",i)):(n(i),e._writableState.errorEmitted=!0,e.emit("error",i),finishMaybe(e,t))}function onwriteStateUpdate(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function onwrite(e,t){var r=e._writableState,i=r.sync,n=r.writecb;if(onwriteStateUpdate(r),t)onwriteError(e,r,i,t,n);else{var o=needFinish(r);o||r.corked||r.bufferProcessing||!r.bufferedRequest||clearBuffer(e,r),i?asyncWrite(afterWrite,e,r,o,n):afterWrite(e,r,o,n)}}function afterWrite(e,t,r,i){r||onwriteDrain(e,t),t.pendingcb--,i(),finishMaybe(e,t)}function onwriteDrain(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}function clearBuffer(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var i=t.bufferedRequestCount,n=new Array(i),o=t.corkedRequestsFree;o.entry=r;for(var a=0,s=!0;r;)n[a]=r,r.isBuf||(s=!1),r=r.next,a+=1;n.allBuffers=s,doWrite(e,t,!0,t.length,n,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new CorkedRequest(t),t.bufferedRequestCount=0}else{for(;r;){var f=r.chunk,u=r.encoding,l=r.callback;if(doWrite(e,t,!1,t.objectMode?1:f.length,f,u,l),r=r.next,t.bufferedRequestCount--,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequest=r,t.bufferProcessing=!1}function needFinish(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function callFinal(e,t){e._final(function(r){t.pendingcb--,r&&e.emit("error",r),t.prefinished=!0,e.emit("prefinish"),finishMaybe(e,t)})}function prefinish(e,t){t.prefinished||t.finalCalled||("function"==typeof e._final?(t.pendingcb++,t.finalCalled=!0,pna.nextTick(callFinal,e,t)):(t.prefinished=!0,e.emit("prefinish")))}function finishMaybe(e,t){var r=needFinish(t);return r&&(prefinish(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),r}function endWritable(e,t,r){t.ending=!0,finishMaybe(e,t),r&&(t.finished?pna.nextTick(r):e.once("finish",r)),t.ended=!0,e.writable=!1}function onCorkedFinish(e,t,r){var i=e.entry;for(e.entry=null;i;){var n=i.callback;t.pendingcb--,n(r),i=i.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}util.inherits(Writable,Stream),WritableState.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(WritableState.prototype,"buffer",{get:internalUtil.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(realHasInstance=Function.prototype[Symbol.hasInstance],Object.defineProperty(Writable,Symbol.hasInstance,{value:function(e){return!!realHasInstance.call(this,e)||this===Writable&&(e&&e._writableState instanceof WritableState)}})):realHasInstance=function(e){return e instanceof this},Writable.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},Writable.prototype.write=function(e,t,r){var i=this._writableState,n=!1,o=!i.objectMode&&_isUint8Array(e);return o&&!Buffer.isBuffer(e)&&(e=_uint8ArrayToBuffer(e)),"function"==typeof t&&(r=t,t=null),o?t="buffer":t||(t=i.defaultEncoding),"function"!=typeof r&&(r=nop),i.ended?writeAfterEnd(this,r):(o||validChunk(this,i,e,r))&&(i.pendingcb++,n=writeOrBuffer(this,i,o,e,t,r)),n},Writable.prototype.cork=function(){this._writableState.corked++},Writable.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||clearBuffer(this,e))},Writable.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(Writable.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Writable.prototype._write=function(e,t,r){r(new Error("_write() is not implemented"))},Writable.prototype._writev=null,Writable.prototype.end=function(e,t,r){var i=this._writableState;"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!==e&&void 0!==e&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),i.ending||i.finished||endWritable(this,i,r)},Object.defineProperty(Writable.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),Writable.prototype.destroy=destroyImpl.destroy,Writable.prototype._undestroy=destroyImpl.undestroy,Writable.prototype._destroy=function(e,t){this.end(),t(e)};

}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"./_stream_duplex":271,"./internal/streams/destroy":277,"./internal/streams/stream":278,"_process":140,"core-util-is":53,"inherits":94,"process-nextick-args":139,"safe-buffer":284,"util-deprecate":306}],276:[function(require,module,exports){
"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Buffer=require("safe-buffer").Buffer,util=require("util");function copyBuffer(t,e,i){t.copy(e,i)}module.exports=function(){function t(){_classCallCheck(this,t),this.head=null,this.tail=null,this.length=0}return t.prototype.push=function(t){var e={data:t,next:null};this.length>0?this.tail.next=e:this.head=e,this.tail=e,++this.length},t.prototype.unshift=function(t){var e={data:t,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length},t.prototype.shift=function(){if(0!==this.length){var t=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,t}},t.prototype.clear=function(){this.head=this.tail=null,this.length=0},t.prototype.join=function(t){if(0===this.length)return"";for(var e=this.head,i=""+e.data;e=e.next;)i+=t+e.data;return i},t.prototype.concat=function(t){if(0===this.length)return Buffer.alloc(0);if(1===this.length)return this.head.data;for(var e=Buffer.allocUnsafe(t>>>0),i=this.head,n=0;i;)copyBuffer(i.data,e,n),n+=i.data.length,i=i.next;return e},t}(),util&&util.inspect&&util.inspect.custom&&(module.exports.prototype[util.inspect.custom]=function(){var t=util.inspect({length:this.length});return this.constructor.name+" "+t});

},{"safe-buffer":284,"util":51}],277:[function(require,module,exports){
"use strict";var pna=require("process-nextick-args");function destroy(t,e){var r=this,a=this._readableState&&this._readableState.destroyed,i=this._writableState&&this._writableState.destroyed;return a||i?(e?e(t):!t||this._writableState&&this._writableState.errorEmitted||pna.nextTick(emitErrorNT,this,t),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(t){!e&&t?(pna.nextTick(emitErrorNT,r,t),r._writableState&&(r._writableState.errorEmitted=!0)):e&&e(t)}),this)}function undestroy(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function emitErrorNT(t,e){t.emit("error",e)}module.exports={destroy:destroy,undestroy:undestroy};

},{"process-nextick-args":139}],278:[function(require,module,exports){
module.exports=require("events").EventEmitter;

},{"events":65}],279:[function(require,module,exports){
"use strict";var Buffer=require("safe-buffer").Buffer,isEncoding=Buffer.isEncoding||function(t){switch((t=""+t)&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function _normalizeEncoding(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}function normalizeEncoding(t){var e=_normalizeEncoding(t);if("string"!=typeof e&&(Buffer.isEncoding===isEncoding||!isEncoding(t)))throw new Error("Unknown encoding: "+t);return e||t}function StringDecoder(t){var e;switch(this.encoding=normalizeEncoding(t),this.encoding){case"utf16le":this.text=utf16Text,this.end=utf16End,e=4;break;case"utf8":this.fillLast=utf8FillLast,e=4;break;case"base64":this.text=base64Text,this.end=base64End,e=3;break;default:return this.write=simpleWrite,void(this.end=simpleEnd)}this.lastNeed=0,this.lastTotal=0,this.lastChar=Buffer.allocUnsafe(e)}function utf8CheckByte(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:t>>6==2?-1:-2}function utf8CheckIncomplete(t,e,s){var i=e.length-1;if(i<s)return 0;var n=utf8CheckByte(e[i]);return n>=0?(n>0&&(t.lastNeed=n-1),n):--i<s||-2===n?0:(n=utf8CheckByte(e[i]))>=0?(n>0&&(t.lastNeed=n-2),n):--i<s||-2===n?0:(n=utf8CheckByte(e[i]))>=0?(n>0&&(2===n?n=0:t.lastNeed=n-3),n):0}function utf8CheckExtraBytes(t,e,s){if(128!=(192&e[0]))return t.lastNeed=0,"�";if(t.lastNeed>1&&e.length>1){if(128!=(192&e[1]))return t.lastNeed=1,"�";if(t.lastNeed>2&&e.length>2&&128!=(192&e[2]))return t.lastNeed=2,"�"}}function utf8FillLast(t){var e=this.lastTotal-this.lastNeed,s=utf8CheckExtraBytes(this,t,e);return void 0!==s?s:this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length))}function utf8Text(t,e){var s=utf8CheckIncomplete(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=s;var i=t.length-(s-this.lastNeed);return t.copy(this.lastChar,0,i),t.toString("utf8",e,i)}function utf8End(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"�":e}function utf16Text(t,e){if((t.length-e)%2==0){var s=t.toString("utf16le",e);if(s){var i=s.charCodeAt(s.length-1);if(i>=55296&&i<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],s.slice(0,-1)}return s}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function utf16End(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var s=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,s)}return e}function base64Text(t,e){var s=(t.length-e)%3;return 0===s?t.toString("base64",e):(this.lastNeed=3-s,this.lastTotal=3,1===s?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-s))}function base64End(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function simpleWrite(t){return t.toString(this.encoding)}function simpleEnd(t){return t&&t.length?this.write(t):""}exports.StringDecoder=StringDecoder,StringDecoder.prototype.write=function(t){if(0===t.length)return"";var e,s;if(this.lastNeed){if(void 0===(e=this.fillLast(t)))return"";s=this.lastNeed,this.lastNeed=0}else s=0;return s<t.length?e?e+this.text(t,s):this.text(t,s):e||""},StringDecoder.prototype.end=utf8End,StringDecoder.prototype.text=utf8Text,StringDecoder.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length};

},{"safe-buffer":284}],280:[function(require,module,exports){
module.exports=require("./readable").PassThrough;

},{"./readable":281}],281:[function(require,module,exports){
exports=module.exports=require("./lib/_stream_readable.js"),exports.Stream=exports,exports.Readable=exports,exports.Writable=require("./lib/_stream_writable.js"),exports.Duplex=require("./lib/_stream_duplex.js"),exports.Transform=require("./lib/_stream_transform.js"),exports.PassThrough=require("./lib/_stream_passthrough.js");

},{"./lib/_stream_duplex.js":271,"./lib/_stream_passthrough.js":272,"./lib/_stream_readable.js":273,"./lib/_stream_transform.js":274,"./lib/_stream_writable.js":275}],282:[function(require,module,exports){
module.exports=require("./readable").Transform;

},{"./readable":281}],283:[function(require,module,exports){
module.exports=require("./lib/_stream_writable.js");

},{"./lib/_stream_writable.js":275}],284:[function(require,module,exports){
var buffer=require("buffer"),Buffer=buffer.Buffer;function copyProps(f,r){for(var e in f)r[e]=f[e]}function SafeBuffer(f,r,e){return Buffer(f,r,e)}Buffer.from&&Buffer.alloc&&Buffer.allocUnsafe&&Buffer.allocUnsafeSlow?module.exports=buffer:(copyProps(buffer,exports),exports.Buffer=SafeBuffer),copyProps(Buffer,SafeBuffer),SafeBuffer.from=function(f,r,e){if("number"==typeof f)throw new TypeError("Argument must not be a number");return Buffer(f,r,e)},SafeBuffer.alloc=function(f,r,e){if("number"!=typeof f)throw new TypeError("Argument must be a number");var u=Buffer(f);return void 0!==r?"string"==typeof e?u.fill(r,e):u.fill(r):u.fill(0),u},SafeBuffer.allocUnsafe=function(f){if("number"!=typeof f)throw new TypeError("Argument must be a number");return Buffer(f)},SafeBuffer.allocUnsafeSlow=function(f){if("number"!=typeof f)throw new TypeError("Argument must be a number");return buffer.SlowBuffer(f)};

},{"buffer":52}],285:[function(require,module,exports){
(function(){var l={}.hasOwnProperty,n=[].slice;module.exports=function(t,a){var c,i,o,p;for(c in i=[],p=[],a)l.call(a,c)&&(o=a[c],"this"!==c&&(i.push(c),p.push(o)));return Function.apply(null,n.call(i).concat([t])).apply(a.this,p)}}).call(this);

},{}],286:[function(require,module,exports){
!function(t){if("object"==typeof exports)module.exports=t();else if("function"==typeof define&&define.amd)define(t);else{var r;try{r=window}catch(t){r=self}r.SparkMD5=t()}}(function(t){"use strict";var r=function(t,r){return t+r&4294967295},n=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function e(t,n,e,f,i,h){return n=r(r(n,t),r(f,h)),r(n<<i|n>>>32-i,e)}function f(t,r,n,f,i,h,o){return e(r&n|~r&f,t,r,i,h,o)}function i(t,r,n,f,i,h,o){return e(r&f|n&~f,t,r,i,h,o)}function h(t,r,n,f,i,h,o){return e(r^n^f,t,r,i,h,o)}function o(t,r,n,f,i,h,o){return e(n^(r|~f),t,r,i,h,o)}function u(t,n){var e=t[0],u=t[1],s=t[2],a=t[3];u=o(u=o(u=o(u=o(u=h(u=h(u=h(u=h(u=i(u=i(u=i(u=i(u=f(u=f(u=f(u=f(u,s=f(s,a=f(a,e=f(e,u,s,a,n[0],7,-680876936),u,s,n[1],12,-389564586),e,u,n[2],17,606105819),a,e,n[3],22,-1044525330),s=f(s,a=f(a,e=f(e,u,s,a,n[4],7,-176418897),u,s,n[5],12,1200080426),e,u,n[6],17,-1473231341),a,e,n[7],22,-45705983),s=f(s,a=f(a,e=f(e,u,s,a,n[8],7,1770035416),u,s,n[9],12,-1958414417),e,u,n[10],17,-42063),a,e,n[11],22,-1990404162),s=f(s,a=f(a,e=f(e,u,s,a,n[12],7,1804603682),u,s,n[13],12,-40341101),e,u,n[14],17,-1502002290),a,e,n[15],22,1236535329),s=i(s,a=i(a,e=i(e,u,s,a,n[1],5,-165796510),u,s,n[6],9,-1069501632),e,u,n[11],14,643717713),a,e,n[0],20,-373897302),s=i(s,a=i(a,e=i(e,u,s,a,n[5],5,-701558691),u,s,n[10],9,38016083),e,u,n[15],14,-660478335),a,e,n[4],20,-405537848),s=i(s,a=i(a,e=i(e,u,s,a,n[9],5,568446438),u,s,n[14],9,-1019803690),e,u,n[3],14,-187363961),a,e,n[8],20,1163531501),s=i(s,a=i(a,e=i(e,u,s,a,n[13],5,-1444681467),u,s,n[2],9,-51403784),e,u,n[7],14,1735328473),a,e,n[12],20,-1926607734),s=h(s,a=h(a,e=h(e,u,s,a,n[5],4,-378558),u,s,n[8],11,-2022574463),e,u,n[11],16,1839030562),a,e,n[14],23,-35309556),s=h(s,a=h(a,e=h(e,u,s,a,n[1],4,-1530992060),u,s,n[4],11,1272893353),e,u,n[7],16,-155497632),a,e,n[10],23,-1094730640),s=h(s,a=h(a,e=h(e,u,s,a,n[13],4,681279174),u,s,n[0],11,-358537222),e,u,n[3],16,-722521979),a,e,n[6],23,76029189),s=h(s,a=h(a,e=h(e,u,s,a,n[9],4,-640364487),u,s,n[12],11,-421815835),e,u,n[15],16,530742520),a,e,n[2],23,-995338651),s=o(s,a=o(a,e=o(e,u,s,a,n[0],6,-198630844),u,s,n[7],10,1126891415),e,u,n[14],15,-1416354905),a,e,n[5],21,-57434055),s=o(s,a=o(a,e=o(e,u,s,a,n[12],6,1700485571),u,s,n[3],10,-1894986606),e,u,n[10],15,-1051523),a,e,n[1],21,-2054922799),s=o(s,a=o(a,e=o(e,u,s,a,n[8],6,1873313359),u,s,n[15],10,-30611744),e,u,n[6],15,-1560198380),a,e,n[13],21,1309151649),s=o(s,a=o(a,e=o(e,u,s,a,n[4],6,-145523070),u,s,n[11],10,-1120210379),e,u,n[2],15,718787259),a,e,n[9],21,-343485551),t[0]=r(e,t[0]),t[1]=r(u,t[1]),t[2]=r(s,t[2]),t[3]=r(a,t[3])}function s(t){var r,n=[];for(r=0;r<64;r+=4)n[r>>2]=t.charCodeAt(r)+(t.charCodeAt(r+1)<<8)+(t.charCodeAt(r+2)<<16)+(t.charCodeAt(r+3)<<24);return n}function a(t){var r,n=[];for(r=0;r<64;r+=4)n[r>>2]=t[r]+(t[r+1]<<8)+(t[r+2]<<16)+(t[r+3]<<24);return n}function p(t){var r,n,e,f,i,h,o=t.length,a=[1732584193,-271733879,-1732584194,271733878];for(r=64;r<=o;r+=64)u(a,s(t.substring(r-64,r)));for(n=(t=t.substring(r-64)).length,e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],r=0;r<n;r+=1)e[r>>2]|=t.charCodeAt(r)<<(r%4<<3);if(e[r>>2]|=128<<(r%4<<3),r>55)for(u(a,e),r=0;r<16;r+=1)e[r]=0;return f=(f=8*o).toString(16).match(/(.*?)(.{0,8})$/),i=parseInt(f[2],16),h=parseInt(f[1],16)||0,e[14]=i,e[15]=h,u(a,e),a}function y(t){var r,e="";for(r=0;r<4;r+=1)e+=n[t>>8*r+4&15]+n[t>>8*r&15];return e}function c(t){var r;for(r=0;r<t.length;r+=1)t[r]=y(t[r]);return t.join("")}function l(t){return/[\u0080-\uFFFF]/.test(t)&&(t=unescape(encodeURIComponent(t))),t}function b(t){var r,n=[],e=t.length;for(r=0;r<e-1;r+=2)n.push(parseInt(t.substr(r,2),16));return String.fromCharCode.apply(String,n)}function g(){this.reset()}return"5d41402abc4b2a76b9719d911017c592"!==c(p("hello"))&&(r=function(t,r){var n=(65535&t)+(65535&r);return(t>>16)+(r>>16)+(n>>16)<<16|65535&n}),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||function(){function r(t,r){return(t=0|t||0)<0?Math.max(t+r,0):Math.min(t,r)}ArrayBuffer.prototype.slice=function(n,e){var f,i,h,o,u=this.byteLength,s=r(n,u),a=u;return e!==t&&(a=r(e,u)),s>a?new ArrayBuffer(0):(f=a-s,i=new ArrayBuffer(f),h=new Uint8Array(i),o=new Uint8Array(this,s,f),h.set(o),i)}}(),g.prototype.append=function(t){return this.appendBinary(l(t)),this},g.prototype.appendBinary=function(t){this._buff+=t,this._length+=t.length;var r,n=this._buff.length;for(r=64;r<=n;r+=64)u(this._hash,s(this._buff.substring(r-64,r)));return this._buff=this._buff.substring(r-64),this},g.prototype.end=function(t){var r,n,e=this._buff,f=e.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(r=0;r<f;r+=1)i[r>>2]|=e.charCodeAt(r)<<(r%4<<3);return this._finish(i,f),n=c(this._hash),t&&(n=b(n)),this.reset(),n},g.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},g.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},g.prototype.setState=function(t){return this._buff=t.buff,this._length=t.length,this._hash=t.hash,this},g.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},g.prototype._finish=function(t,r){var n,e,f,i=r;if(t[i>>2]|=128<<(i%4<<3),i>55)for(u(this._hash,t),i=0;i<16;i+=1)t[i]=0;n=(n=8*this._length).toString(16).match(/(.*?)(.{0,8})$/),e=parseInt(n[2],16),f=parseInt(n[1],16)||0,t[14]=e,t[15]=f,u(this._hash,t)},g.hash=function(t,r){return g.hashBinary(l(t),r)},g.hashBinary=function(t,r){var n=c(p(t));return r?b(n):n},g.ArrayBuffer=function(){this.reset()},g.ArrayBuffer.prototype.append=function(t){var r,n,e,f,i,h=(n=this._buff.buffer,e=t,f=!0,(i=new Uint8Array(n.byteLength+e.byteLength)).set(new Uint8Array(n)),i.set(new Uint8Array(e),n.byteLength),f?i:i.buffer),o=h.length;for(this._length+=t.byteLength,r=64;r<=o;r+=64)u(this._hash,a(h.subarray(r-64,r)));return this._buff=r-64<o?new Uint8Array(h.buffer.slice(r-64)):new Uint8Array(0),this},g.ArrayBuffer.prototype.end=function(t){var r,n,e=this._buff,f=e.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(r=0;r<f;r+=1)i[r>>2]|=e[r]<<(r%4<<3);return this._finish(i,f),n=c(this._hash),t&&(n=b(n)),this.reset(),n},g.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},g.ArrayBuffer.prototype.getState=function(){var t,r=g.prototype.getState.call(this);return r.buff=(t=r.buff,String.fromCharCode.apply(null,new Uint8Array(t))),r},g.ArrayBuffer.prototype.setState=function(t){return t.buff=function(t,r){var n,e=t.length,f=new ArrayBuffer(e),i=new Uint8Array(f);for(n=0;n<e;n+=1)i[n]=t.charCodeAt(n);return r?i:f}(t.buff,!0),g.prototype.setState.call(this,t)},g.ArrayBuffer.prototype.destroy=g.prototype.destroy,g.ArrayBuffer.prototype._finish=g.prototype._finish,g.ArrayBuffer.hash=function(t,r){var n=c(function(t){var r,n,e,f,i,h,o=t.length,s=[1732584193,-271733879,-1732584194,271733878];for(r=64;r<=o;r+=64)u(s,a(t.subarray(r-64,r)));for(n=(t=r-64<o?t.subarray(r-64):new Uint8Array(0)).length,e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],r=0;r<n;r+=1)e[r>>2]|=t[r]<<(r%4<<3);if(e[r>>2]|=128<<(r%4<<3),r>55)for(u(s,e),r=0;r<16;r+=1)e[r]=0;return f=(f=8*o).toString(16).match(/(.*?)(.{0,8})$/),i=parseInt(f[2],16),h=parseInt(f[1],16)||0,e[14]=i,e[15]=h,u(s,e),s}(new Uint8Array(t)));return r?b(n):n},g});

},{}],287:[function(require,module,exports){
module.exports=Stream;var EE=require("events").EventEmitter,inherits=require("inherits");function Stream(){EE.call(this)}inherits(Stream,EE),Stream.Readable=require("readable-stream/readable.js"),Stream.Writable=require("readable-stream/writable.js"),Stream.Duplex=require("readable-stream/duplex.js"),Stream.Transform=require("readable-stream/transform.js"),Stream.PassThrough=require("readable-stream/passthrough.js"),Stream.Stream=Stream,Stream.prototype.pipe=function(e,r){var t=this;function n(r){e.writable&&!1===e.write(r)&&t.pause&&t.pause()}function a(){t.readable&&t.resume&&t.resume()}t.on("data",n),e.on("drain",a),e._isStdio||r&&!1===r.end||(t.on("end",i),t.on("close",s));var o=!1;function i(){o||(o=!0,e.end())}function s(){o||(o=!0,"function"==typeof e.destroy&&e.destroy())}function m(e){if(u(),0===EE.listenerCount(this,"error"))throw e}function u(){t.removeListener("data",n),e.removeListener("drain",a),t.removeListener("end",i),t.removeListener("close",s),t.removeListener("error",m),e.removeListener("error",m),t.removeListener("end",u),t.removeListener("close",u),e.removeListener("close",u)}return t.on("error",m),e.on("error",m),t.on("end",u),t.on("close",u),e.on("close",u),e.emit("pipe",t),e};

},{"events":65,"inherits":94,"readable-stream/duplex.js":270,"readable-stream/passthrough.js":280,"readable-stream/readable.js":281,"readable-stream/transform.js":282,"readable-stream/writable.js":283}],288:[function(require,module,exports){
var Buffer=require("buffer").Buffer,isBufferEncoding=Buffer.isEncoding||function(e){switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function assertEncoding(e){if(e&&!isBufferEncoding(e))throw new Error("Unknown encoding: "+e)}var StringDecoder=exports.StringDecoder=function(e){switch(this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,""),assertEncoding(e),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=utf16DetectIncompleteChar;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=base64DetectIncompleteChar;break;default:return void(this.write=passThroughWrite)}this.charBuffer=new Buffer(6),this.charReceived=0,this.charLength=0};function passThroughWrite(e){return e.toString(this.encoding)}function utf16DetectIncompleteChar(e){this.charReceived=e.length%2,this.charLength=this.charReceived?2:0}function base64DetectIncompleteChar(e){this.charReceived=e.length%3,this.charLength=this.charReceived?3:0}StringDecoder.prototype.write=function(e){for(var t="";this.charLength;){var r=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length;if(e.copy(this.charBuffer,this.charReceived,0,r),this.charReceived+=r,this.charReceived<this.charLength)return"";if(e=e.slice(r,e.length),!((i=(t=this.charBuffer.slice(0,this.charLength).toString(this.encoding)).charCodeAt(t.length-1))>=55296&&i<=56319)){if(this.charReceived=this.charLength=0,0===e.length)return t;break}this.charLength+=this.surrogateSize,t=""}this.detectIncompleteChar(e);var h=e.length;this.charLength&&(e.copy(this.charBuffer,0,e.length-this.charReceived,h),h-=this.charReceived);var i;h=(t+=e.toString(this.encoding,0,h)).length-1;if((i=t.charCodeAt(h))>=55296&&i<=56319){var c=this.surrogateSize;return this.charLength+=c,this.charReceived+=c,this.charBuffer.copy(this.charBuffer,c,0,c),e.copy(this.charBuffer,0,0,c),t.substring(0,h)}return t},StringDecoder.prototype.detectIncompleteChar=function(e){for(var t=e.length>=3?3:e.length;t>0;t--){var r=e[e.length-t];if(1==t&&r>>5==6){this.charLength=2;break}if(t<=2&&r>>4==14){this.charLength=3;break}if(t<=3&&r>>3==30){this.charLength=4;break}}this.charReceived=t},StringDecoder.prototype.end=function(e){var t="";if(e&&e.length&&(t=this.write(e)),this.charReceived){var r=this.charReceived,h=this.charBuffer,i=this.encoding;t+=h.slice(0,r).toString(i)}return t};

},{"buffer":52}],289:[function(require,module,exports){
module.exports={encode:function(n){return"ÿ"+n[0]+"ÿ"+n[1]},decode:function(n){var e=n.toString(),r=e.indexOf("ÿ",1);return[e.substring(1,r),e.substring(r+1)]},lowerBound:"\0",upperBound:"ÿ"};

},{}],290:[function(require,module,exports){
var createError=require("errno").create,LevelUPError=createError("LevelUPError"),NotFoundError=createError("NotFoundError",LevelUPError);NotFoundError.prototype.notFound=!0,NotFoundError.prototype.status=404,module.exports={LevelUPError:LevelUPError,InitializationError:createError("InitializationError",LevelUPError),OpenError:createError("OpenError",LevelUPError),ReadError:createError("ReadError",LevelUPError),WriteError:createError("WriteError",LevelUPError),NotFoundError:NotFoundError,EncodingError:createError("EncodingError",LevelUPError)};

},{"errno":296}],291:[function(require,module,exports){
var nut=require("./nut"),shell=require("./shell"),Codec=require("level-codec"),codec=new Codec,ReadStream=require("./read-stream"),precodec=require("./codec/legacy");module.exports=function(e){return shell(nut(e,precodec,codec),[],ReadStream,e.options)};

},{"./codec/legacy":289,"./nut":292,"./read-stream":293,"./shell":294,"level-codec":98}],292:[function(require,module,exports){
var ltgt=require("ltgt");function isFunction(e){return"function"==typeof e}function getPrefix(e){return null==e?e:isFunction(e.prefix)?e.prefix():e}function clone(e){var n={};for(var t in e)n[t]=e[t];return n}module.exports=function(e,n,t,u){var o=[],r=!1;function i(e,u,o,r){return n.encode([e,t.encodeKey(u,o,r)])}function f(e,n){return n&&n.options&&(e.keyEncoding=e.keyEncoding||n.options.keyEncoding,e.valueEncoding=e.valueEncoding||n.options.valueEncoding),e}function c(){for(r=!0;o.length;)o.shift()()}return isFunction(e.isOpen)&&e.isOpen()?r=!0:e.open(c),{apply:function(n,u,o){for(var r=0;r<n.length;r++){var c=n[r];f(c,c.prefix),c.prefix=getPrefix(c.prefix)}if("object"!=typeof(u=u||{}))throw new Error("opts must be object, was:"+u);"function"==typeof u&&(o=u,u={}),n.length?(e.db||e).batch(n.map(function(e){return{key:i(e.prefix,e.key,u,e),value:"del"!==e.type?t.encodeValue(e.value,u,e):void 0,type:e.type||(void 0===e.value?"del":"put")}}),u,function(e){if(e)return o(e);o()}):o()},get:function(n,u,o,r){return o.asBuffer=t.valueAsBuffer(o),(e.db||e).get(i(u,n,o),o,function(e,n){e?r(e):r(null,t.decodeValue(n,o))})},createDecoder:function(e){return function(u,o){return{key:t.decodeKey(n.decode(u)[1],e),value:t.decodeValue(o,e)}}},isOpen:function(){return e.db&&isFunction(e.db.isOpen)?e.db.isOpen():e.isOpen()},isClosed:function(){return e.db&&isFunction(e.db.isClosed)?e.db.isClosed():e.isClosed()},close:function(n){return e.close(n)},iterator:function(u,f){var c=clone(u||{}),l=u.prefix||[];function d(e){return{next:function(n){return e.next(n)},end:function(n){e.end(n)}}}if(ltgt.toLtgt(u,c,function(e){return i(l,e,c,{})},n.lowerBound,n.upperBound),c.prefix=null,c.keyAsBuffer=c.valueAsBuffer=!1,"number"!=typeof c.limit&&(c.limit=-1),c.keyAsBuffer=n.buffer,c.valueAsBuffer=t.valueAsBuffer(c),r)return d((e.db||e).iterator(c));o.push(function(){f(null,d((e.db||e).iterator(c)))})}}};

},{"ltgt":298}],293:[function(require,module,exports){
var Readable=require("readable-stream").Readable,inherits=require("inherits"),EncodingError=require("./errors").EncodingError;function ReadStream(e,t){if(!(this instanceof ReadStream))return new ReadStream(e,t);Readable.call(this,{objectMode:!0,highWaterMark:e.highWaterMark}),this._waiting=!1,this._options=e,this._makeData=t}inherits(ReadStream,Readable),ReadStream.prototype.setIterator=function(e){return this._iterator=e,this._destroyed?e.end(function(){}):this._waiting?(this._waiting=!1,this._read()):this},ReadStream.prototype._read=function(){var e=this;if(!e._destroyed)return e._iterator?void e._iterator.next(function(t,r,i){if(t||void 0===r&&void 0===i)return t||e._destroyed||e.push(null),e._cleanup(t);try{i=e._makeData(r,i)}catch(t){return e._cleanup(new EncodingError(t))}e._destroyed||e.push(i)}):this._waiting=!0},ReadStream.prototype._cleanup=function(e){if(!this._destroyed){this._destroyed=!0;var t=this;e&&t.emit("error",e),t._iterator?t._iterator.end(function(){t._iterator=null,t.emit("close")}):t.emit("close")}},ReadStream.prototype.destroy=function(){this._cleanup()},ReadStream.prototype.toString=function(){return"LevelUP.ReadStream"},module.exports=ReadStream;

},{"./errors":290,"inherits":94,"readable-stream":305}],294:[function(require,module,exports){
(function (process){
var EventEmitter=require("events").EventEmitter,errors=require("./errors"),version="6.5.4",sublevel=module.exports=function(e,t,n,r){var i=new EventEmitter;function o(e){e&&i.emit("error",e)}function u(e){var t={};if(r)for(var n in r)void 0!=r[n]&&(t[n]=r[n]);if(e)for(var n in e)void 0!=e[n]&&(t[n]=e[n]);return t}return i.sublevels={},i.options=r,i.version=version,i.methods={},t=t||[],i.put=function(n,r,c,a){"function"==typeof c&&(a=c,c={}),a||(a=o),e.apply([{key:n,value:r,prefix:t.slice(),type:"put"}],u(c),function(e){if(e||(i.emit("put",n,r),a(null)),e)return a(e)})},i.prefix=function(){return t.slice()},i.del=function(n,r,c){"function"==typeof r&&(c=r,r={}),c||(c=o),e.apply([{key:n,prefix:t.slice(),type:"del"}],u(r),function(e){if(e||(i.emit("del",n),c(null)),e)return c(e)})},i.batch=function(n,r,c){"function"==typeof r&&(c=r,r={}),c||(c=o),n=n.map(function(e){return{key:e.key,value:e.value,prefix:e.prefix||t,keyEncoding:e.keyEncoding,valueEncoding:e.valueEncoding,type:e.type}}),e.apply(n,u(r),function(e){if(e||(i.emit("batch",n),c(null)),e)return c(e)})},i.get=function(n,r,i){"function"==typeof r&&(i=r,r={}),e.get(n,t,u(r),function(e,t){e?i(new errors.NotFoundError("Key not found in database",e)):i(null,t)})},i.clone=function(r){return sublevel(e,t,n,u(r))},i.sublevel=function(r,o){return i.sublevels[r]=i.sublevels[r]||sublevel(e,t.concat(r),n,u(o))},i.readStream=i.createReadStream=function(r){var i;(r=u(r)).prefix=t;var o=e.iterator(r,function(e,t){i.setIterator(t)});return i=n(r,e.createDecoder(r)),o&&i.setIterator(o),i},i.valueStream=i.createValueStream=function(e){return(e=e||{}).values=!0,e.keys=!1,i.createReadStream(e)},i.keyStream=i.createKeyStream=function(e){return(e=e||{}).values=!1,e.keys=!0,i.createReadStream(e)},i.close=function(n){n=n||function(){},t.length?process.nextTick(n):e.close(n)},i.isOpen=e.isOpen,i.isClosed=e.isClosed,i};

}).call(this,require('_process'))
},{"./errors":290,"_process":140,"events":65}],295:[function(require,module,exports){
var prr=require("prr");function init(r,e,t){prr(this,{type:r,name:r,cause:"string"!=typeof e?e:t,message:e&&"string"!=typeof e?e.message:e},"ewr")}function CustomError(r,e){Error.call(this),Error.captureStackTrace&&Error.captureStackTrace(this,arguments.callee),init.call(this,"CustomError",r,e)}function createError(r,e,t){var s=function(t,s){init.call(this,e,t,s),"FilesystemError"==e&&(this.code=this.cause.code,this.path=this.cause.path,this.errno=this.cause.errno,this.message=(r.errno[this.cause.errno]?r.errno[this.cause.errno].description:this.cause.message)+(this.cause.path?" ["+this.cause.path+"]":"")),Error.call(this),Error.captureStackTrace&&Error.captureStackTrace(this,arguments.callee)};return s.prototype=t?new t:new CustomError,s}CustomError.prototype=new Error,module.exports=function(r){var e=function(e,t){return createError(r,e,t)};return{CustomError:CustomError,FilesystemError:e("FilesystemError"),createError:e}};

},{"prr":299}],296:[function(require,module,exports){
var all=module.exports.all=[{errno:-2,code:"ENOENT",description:"no such file or directory"},{errno:-1,code:"UNKNOWN",description:"unknown error"},{errno:0,code:"OK",description:"success"},{errno:1,code:"EOF",description:"end of file"},{errno:2,code:"EADDRINFO",description:"getaddrinfo error"},{errno:3,code:"EACCES",description:"permission denied"},{errno:4,code:"EAGAIN",description:"resource temporarily unavailable"},{errno:5,code:"EADDRINUSE",description:"address already in use"},{errno:6,code:"EADDRNOTAVAIL",description:"address not available"},{errno:7,code:"EAFNOSUPPORT",description:"address family not supported"},{errno:8,code:"EALREADY",description:"connection already in progress"},{errno:9,code:"EBADF",description:"bad file descriptor"},{errno:10,code:"EBUSY",description:"resource busy or locked"},{errno:11,code:"ECONNABORTED",description:"software caused connection abort"},{errno:12,code:"ECONNREFUSED",description:"connection refused"},{errno:13,code:"ECONNRESET",description:"connection reset by peer"},{errno:14,code:"EDESTADDRREQ",description:"destination address required"},{errno:15,code:"EFAULT",description:"bad address in system call argument"},{errno:16,code:"EHOSTUNREACH",description:"host is unreachable"},{errno:17,code:"EINTR",description:"interrupted system call"},{errno:18,code:"EINVAL",description:"invalid argument"},{errno:19,code:"EISCONN",description:"socket is already connected"},{errno:20,code:"EMFILE",description:"too many open files"},{errno:21,code:"EMSGSIZE",description:"message too long"},{errno:22,code:"ENETDOWN",description:"network is down"},{errno:23,code:"ENETUNREACH",description:"network is unreachable"},{errno:24,code:"ENFILE",description:"file table overflow"},{errno:25,code:"ENOBUFS",description:"no buffer space available"},{errno:26,code:"ENOMEM",description:"not enough memory"},{errno:27,code:"ENOTDIR",description:"not a directory"},{errno:28,code:"EISDIR",description:"illegal operation on a directory"},{errno:29,code:"ENONET",description:"machine is not on the network"},{errno:31,code:"ENOTCONN",description:"socket is not connected"},{errno:32,code:"ENOTSOCK",description:"socket operation on non-socket"},{errno:33,code:"ENOTSUP",description:"operation not supported on socket"},{errno:34,code:"ENOENT",description:"no such file or directory"},{errno:35,code:"ENOSYS",description:"function not implemented"},{errno:36,code:"EPIPE",description:"broken pipe"},{errno:37,code:"EPROTO",description:"protocol error"},{errno:38,code:"EPROTONOSUPPORT",description:"protocol not supported"},{errno:39,code:"EPROTOTYPE",description:"protocol wrong type for socket"},{errno:40,code:"ETIMEDOUT",description:"connection timed out"},{errno:41,code:"ECHARSET",description:"invalid Unicode character"},{errno:42,code:"EAIFAMNOSUPPORT",description:"address family for hostname not supported"},{errno:44,code:"EAISERVICE",description:"servname not supported for ai_socktype"},{errno:45,code:"EAISOCKTYPE",description:"ai_socktype not supported"},{errno:46,code:"ESHUTDOWN",description:"cannot send after transport endpoint shutdown"},{errno:47,code:"EEXIST",description:"file already exists"},{errno:48,code:"ESRCH",description:"no such process"},{errno:49,code:"ENAMETOOLONG",description:"name too long"},{errno:50,code:"EPERM",description:"operation not permitted"},{errno:51,code:"ELOOP",description:"too many symbolic links encountered"},{errno:52,code:"EXDEV",description:"cross-device link not permitted"},{errno:53,code:"ENOTEMPTY",description:"directory not empty"},{errno:54,code:"ENOSPC",description:"no space left on device"},{errno:55,code:"EIO",description:"i/o error"},{errno:56,code:"EROFS",description:"read-only file system"},{errno:57,code:"ENODEV",description:"no such device"},{errno:58,code:"ESPIPE",description:"invalid seek"},{errno:59,code:"ECANCELED",description:"operation canceled"}];module.exports.errno={},module.exports.code={},all.forEach(function(e){module.exports.errno[e.errno]=e,module.exports.code[e.code]=e}),module.exports.custom=require("./custom")(module.exports),module.exports.create=module.exports.custom.createError;

},{"./custom":295}],297:[function(require,module,exports){
module.exports=Array.isArray||function(r){return"[object Array]"==Object.prototype.toString.call(r)};

},{}],298:[function(require,module,exports){
(function (Buffer){
function has(e,r){return Object.hasOwnProperty.call(e,r)}function isDef(e){return void 0!==e&&""!==e}function has(e,r){return Object.hasOwnProperty.call(e,r)}function hasKey(e,r){return Object.hasOwnProperty.call(e,r)&&r}exports.compare=function(e,r){if(Buffer.isBuffer(e)){for(var n=Math.min(e.length,r.length),t=0;t<n;t++){var u=e[t]-r[t];if(u)return u}return e.length-r.length}return e<r?-1:e>r?1:0};var lowerBoundKey=exports.lowerBoundKey=function(e){return hasKey(e,"gt")||hasKey(e,"gte")||hasKey(e,"min")||(e.reverse?hasKey(e,"end"):hasKey(e,"start"))||void 0},lowerBound=exports.lowerBound=function(e){var r=lowerBoundKey(e);return r&&e[r]};exports.lowerBoundInclusive=function(e){return!has(e,"gt")},exports.upperBoundInclusive=function(e){return!(has(e,"lt")||!e.minEx)};var lowerBoundExclusive=exports.lowerBoundExclusive=function(e){return!(!has(e,"gt")&&!e.minEx)},upperBoundExclusive=exports.upperBoundExclusive=function(e){return!!has(e,"lt")},upperBoundKey=exports.upperBoundKey=function(e){return hasKey(e,"lt")||hasKey(e,"lte")||hasKey(e,"max")||(e.reverse?hasKey(e,"start"):hasKey(e,"end"))||void 0},upperBound=exports.upperBound=function(e){var r=upperBoundKey(e);return r&&e[r]};function id(e){return e}exports.toLtgt=function(e,r,n,t,u){r=r||{},n=n||id;var o=arguments.length>3,s=exports.lowerBoundKey(e),a=exports.upperBoundKey(e);return s?"gt"===s?r.gt=n(e.gt,!1):r.gte=n(e[s],!1):o&&(r.gte=n(t,!1)),a?"lt"===a?r.lt=n(e.lt,!0):r.lte=n(e[a],!0):o&&(r.lte=n(u,!0)),null!=e.reverse&&(r.reverse=!!e.reverse),has(r,"max")&&delete r.max,has(r,"min")&&delete r.min,has(r,"start")&&delete r.start,has(r,"end")&&delete r.end,r},exports.contains=function(e,r,n){n=n||exports.compare;var t=lowerBound(e);if(isDef(t)&&((u=n(r,t))<0||0===u&&lowerBoundExclusive(e)))return!1;var u,o=upperBound(e);if(isDef(o)&&((u=n(r,o))>0||0===u&&upperBoundExclusive(e)))return!1;return!0},exports.filter=function(e,r){return function(n){return exports.contains(e,n,r)}};

}).call(this,{"isBuffer":require("../../../is-buffer/index.js")})
},{"../../../is-buffer/index.js":95}],299:[function(require,module,exports){
!function(e,n,r){"undefined"!=typeof module&&module.exports?module.exports=r():n.prr=r()}(0,this,function(){var e="function"==typeof Object.defineProperty?function(e,n,r){return Object.defineProperty(e,n,r),e}:function(e,n,r){return e[n]=r.value,e};return function(n,r,t,o){var u;if(o=function(e,n){var r="object"==typeof n,t=!r&&"string"==typeof n,o=function(e){return r?!!n[e]:!!t&&n.indexOf(e[0])>-1};return{enumerable:o("enumerable"),configurable:o("configurable"),writable:o("writable"),value:e}}(t,o),"object"==typeof r){for(u in r)Object.hasOwnProperty.call(r,u)&&(o.value=r[u],e(n,u,o));return n}return e(n,r,o)}});

},{}],300:[function(require,module,exports){
(function (process){
module.exports=Duplex;var objectKeys=Object.keys||function(e){var t=[];for(var i in e)t.push(i);return t},util=require("core-util-is");util.inherits=require("inherits");var Readable=require("./_stream_readable"),Writable=require("./_stream_writable");function Duplex(e){if(!(this instanceof Duplex))return new Duplex(e);Readable.call(this,e),Writable.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",onend)}function onend(){this.allowHalfOpen||this._writableState.ended||process.nextTick(this.end.bind(this))}function forEach(e,t){for(var i=0,r=e.length;i<r;i++)t(e[i],i)}util.inherits(Duplex,Readable),forEach(objectKeys(Writable.prototype),function(e){Duplex.prototype[e]||(Duplex.prototype[e]=Writable.prototype[e])});

}).call(this,require('_process'))
},{"./_stream_readable":302,"./_stream_writable":304,"_process":140,"core-util-is":53,"inherits":94}],301:[function(require,module,exports){
module.exports=PassThrough;var Transform=require("./_stream_transform"),util=require("core-util-is");function PassThrough(r){if(!(this instanceof PassThrough))return new PassThrough(r);Transform.call(this,r)}util.inherits=require("inherits"),util.inherits(PassThrough,Transform),PassThrough.prototype._transform=function(r,s,i){i(null,r)};

},{"./_stream_transform":303,"core-util-is":53,"inherits":94}],302:[function(require,module,exports){
(function (process){
module.exports=Readable;var isArray=require("isarray"),Buffer=require("buffer").Buffer;Readable.ReadableState=ReadableState;var EE=require("events").EventEmitter;EE.listenerCount||(EE.listenerCount=function(e,t){return e.listeners(t).length});var StringDecoder,Stream=require("stream"),util=require("core-util-is");function ReadableState(e,t){var n=(e=e||{}).highWaterMark;this.highWaterMark=n||0===n?n:16384,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=!1,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.calledRead=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.objectMode=!!e.objectMode,this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(StringDecoder||(StringDecoder=require("string_decoder/").StringDecoder),this.decoder=new StringDecoder(e.encoding),this.encoding=e.encoding)}function Readable(e){if(!(this instanceof Readable))return new Readable(e);this._readableState=new ReadableState(e,this),this.readable=!0,Stream.call(this)}function readableAddChunk(e,t,n,r,i){var a=chunkInvalid(t,n);if(a)e.emit("error",a);else if(null===n||void 0===n)t.reading=!1,t.ended||onEofChunk(e,t);else if(t.objectMode||n&&n.length>0)if(t.ended&&!i){var d=new Error("stream.push() after EOF");e.emit("error",d)}else if(t.endEmitted&&i){d=new Error("stream.unshift() after end event");e.emit("error",d)}else!t.decoder||i||r||(n=t.decoder.write(n)),t.length+=t.objectMode?1:n.length,i?t.buffer.unshift(n):(t.reading=!1,t.buffer.push(n)),t.needReadable&&emitReadable(e),maybeReadMore(e,t);else i||(t.reading=!1);return needMoreData(t)}function needMoreData(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}util.inherits=require("inherits"),util.inherits(Readable,Stream),Readable.prototype.push=function(e,t){var n=this._readableState;return"string"!=typeof e||n.objectMode||(t=t||n.defaultEncoding)!==n.encoding&&(e=new Buffer(e,t),t=""),readableAddChunk(this,n,e,t,!1)},Readable.prototype.unshift=function(e){return readableAddChunk(this,this._readableState,e,"",!0)},Readable.prototype.setEncoding=function(e){StringDecoder||(StringDecoder=require("string_decoder/").StringDecoder),this._readableState.decoder=new StringDecoder(e),this._readableState.encoding=e};var MAX_HWM=8388608;function roundUpToNextPowerOf2(e){if(e>=MAX_HWM)e=MAX_HWM;else{e--;for(var t=1;t<32;t<<=1)e|=e>>t;e++}return e}function howMuchToRead(e,t){return 0===t.length&&t.ended?0:t.objectMode?0===e?0:1:null===e||isNaN(e)?t.flowing&&t.buffer.length?t.buffer[0].length:t.length:e<=0?0:(e>t.highWaterMark&&(t.highWaterMark=roundUpToNextPowerOf2(e)),e>t.length?t.ended?t.length:(t.needReadable=!0,0):e)}function chunkInvalid(e,t){var n=null;return Buffer.isBuffer(t)||"string"==typeof t||null===t||void 0===t||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n}function onEofChunk(e,t){if(t.decoder&&!t.ended){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,t.length>0?emitReadable(e):endReadable(e)}function emitReadable(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,t.sync?process.nextTick(function(){emitReadable_(e)}):emitReadable_(e))}function emitReadable_(e){e.emit("readable")}function maybeReadMore(e,t){t.readingMore||(t.readingMore=!0,process.nextTick(function(){maybeReadMore_(e,t)}))}function maybeReadMore_(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function pipeOnDrain(e){return function(){var t=e._readableState;t.awaitDrain--,0===t.awaitDrain&&flow(e)}}function flow(e){var t,n=e._readableState;function r(e,r,i){!1===e.write(t)&&n.awaitDrain++}for(n.awaitDrain=0;n.pipesCount&&null!==(t=e.read());)if(1===n.pipesCount?r(n.pipes):forEach(n.pipes,r),e.emit("data",t),n.awaitDrain>0)return;if(0===n.pipesCount)return n.flowing=!1,void(EE.listenerCount(e,"data")>0&&emitDataEvents(e));n.ranOut=!0}function pipeOnReadable(){this._readableState.ranOut&&(this._readableState.ranOut=!1,flow(this))}function emitDataEvents(e,t){if(e._readableState.flowing)throw new Error("Cannot switch to old mode now.");var n=t||!1,r=!1;e.readable=!0,e.pipe=Stream.prototype.pipe,e.on=e.addListener=Stream.prototype.on,e.on("readable",function(){var t;for(r=!0;!n&&null!==(t=e.read());)e.emit("data",t);null===t&&(r=!1,e._readableState.needReadable=!0)}),e.pause=function(){n=!0,this.emit("pause")},e.resume=function(){n=!1,r?process.nextTick(function(){e.emit("readable")}):this.read(0),this.emit("resume")},e.emit("readable")}function fromList(e,t){var n,r=t.buffer,i=t.length,a=!!t.decoder,d=!!t.objectMode;if(0===r.length)return null;if(0===i)n=null;else if(d)n=r.shift();else if(!e||e>=i)n=a?r.join(""):Buffer.concat(r,i),r.length=0;else{if(e<r[0].length)n=(u=r[0]).slice(0,e),r[0]=u.slice(e);else if(e===r[0].length)n=r.shift();else{n=a?"":new Buffer(e);for(var o=0,l=0,s=r.length;l<s&&o<e;l++){var u=r[0],h=Math.min(e-o,u.length);a?n+=u.slice(0,h):u.copy(n,o,0,h),h<u.length?r[0]=u.slice(h):r.shift(),o+=h}}}return n}function endReadable(e){var t=e._readableState;if(t.length>0)throw new Error("endReadable called on non-empty stream");!t.endEmitted&&t.calledRead&&(t.ended=!0,process.nextTick(function(){t.endEmitted||0!==t.length||(t.endEmitted=!0,e.readable=!1,e.emit("end"))}))}function forEach(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n)}function indexOf(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}Readable.prototype.read=function(e){var t=this._readableState;t.calledRead=!0;var n,r=e;if(("number"!=typeof e||e>0)&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return emitReadable(this),null;if(0===(e=howMuchToRead(e,t))&&t.ended)return n=null,t.length>0&&t.decoder&&(n=fromList(e,t),t.length-=n.length),0===t.length&&endReadable(this),n;var i=t.needReadable;return t.length-e<=t.highWaterMark&&(i=!0),(t.ended||t.reading)&&(i=!1),i&&(t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1),i&&!t.reading&&(e=howMuchToRead(r,t)),null===(n=e>0?fromList(e,t):null)&&(t.needReadable=!0,e=0),t.length-=e,0!==t.length||t.ended||(t.needReadable=!0),t.ended&&!t.endEmitted&&0===t.length&&endReadable(this),n},Readable.prototype._read=function(e){this.emit("error",new Error("not implemented"))},Readable.prototype.pipe=function(e,t){var n=this,r=this._readableState;switch(r.pipesCount){case 0:r.pipes=e;break;case 1:r.pipes=[r.pipes,e];break;default:r.pipes.push(e)}r.pipesCount+=1;var i=(!t||!1!==t.end)&&e!==process.stdout&&e!==process.stderr?d:l;function a(e){e===n&&l()}function d(){e.end()}r.endEmitted?process.nextTick(i):n.once("end",i),e.on("unpipe",a);var o=pipeOnDrain(n);function l(){e.removeListener("close",u),e.removeListener("finish",h),e.removeListener("drain",o),e.removeListener("error",s),e.removeListener("unpipe",a),n.removeListener("end",d),n.removeListener("end",l),e._writableState&&!e._writableState.needDrain||o()}function s(t){f(),e.removeListener("error",s),0===EE.listenerCount(e,"error")&&e.emit("error",t)}function u(){e.removeListener("finish",h),f()}function h(){e.removeListener("close",u),f()}function f(){n.unpipe(e)}return e.on("drain",o),e._events&&e._events.error?isArray(e._events.error)?e._events.error.unshift(s):e._events.error=[s,e._events.error]:e.on("error",s),e.once("close",u),e.once("finish",h),e.emit("pipe",n),r.flowing||(this.on("readable",pipeOnReadable),r.flowing=!0,process.nextTick(function(){flow(n)})),e},Readable.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,this.removeListener("readable",pipeOnReadable),t.flowing=!1,e&&e.emit("unpipe",this),this);if(!e){var n=t.pipes,r=t.pipesCount;t.pipes=null,t.pipesCount=0,this.removeListener("readable",pipeOnReadable),t.flowing=!1;for(var i=0;i<r;i++)n[i].emit("unpipe",this);return this}return-1===(i=indexOf(t.pipes,e))?this:(t.pipes.splice(i,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this),this)},Readable.prototype.on=function(e,t){var n=Stream.prototype.on.call(this,e,t);if("data"!==e||this._readableState.flowing||emitDataEvents(this),"readable"===e&&this.readable){var r=this._readableState;r.readableListening||(r.readableListening=!0,r.emittedReadable=!1,r.needReadable=!0,r.reading?r.length&&emitReadable(this,r):this.read(0))}return n},Readable.prototype.addListener=Readable.prototype.on,Readable.prototype.resume=function(){emitDataEvents(this),this.read(0),this.emit("resume")},Readable.prototype.pause=function(){emitDataEvents(this,!0),this.emit("pause")},Readable.prototype.wrap=function(e){var t=this._readableState,n=!1,r=this;for(var i in e.on("end",function(){if(t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&r.push(e)}r.push(null)}),e.on("data",function(i){(t.decoder&&(i=t.decoder.write(i)),!t.objectMode||null!==i&&void 0!==i)&&((t.objectMode||i&&i.length)&&(r.push(i)||(n=!0,e.pause())))}),e)"function"==typeof e[i]&&void 0===this[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));return forEach(["error","close","destroy","pause","resume"],function(t){e.on(t,r.emit.bind(r,t))}),r._read=function(t){n&&(n=!1,e.resume())},r},Readable._fromList=fromList;

}).call(this,require('_process'))
},{"_process":140,"buffer":52,"core-util-is":53,"events":65,"inherits":94,"isarray":297,"stream":287,"string_decoder/":288}],303:[function(require,module,exports){
module.exports=Transform;var Duplex=require("./_stream_duplex"),util=require("core-util-is");function TransformState(r,t){this.afterTransform=function(r,e){return afterTransform(t,r,e)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null}function afterTransform(r,t,e){var n=r._transformState;n.transforming=!1;var a=n.writecb;if(!a)return r.emit("error",new Error("no writecb in Transform class"));n.writechunk=null,n.writecb=null,null!==e&&void 0!==e&&r.push(e),a&&a(t);var i=r._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&r._read(i.highWaterMark)}function Transform(r){if(!(this instanceof Transform))return new Transform(r);Duplex.call(this,r);this._transformState=new TransformState(r,this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,this.once("finish",function(){"function"==typeof this._flush?this._flush(function(r){done(t,r)}):done(t)})}function done(r,t){if(t)return r.emit("error",t);var e=r._writableState,n=(r._readableState,r._transformState);if(e.length)throw new Error("calling transform done when ws.length != 0");if(n.transforming)throw new Error("calling transform done when still transforming");return r.push(null)}util.inherits=require("inherits"),util.inherits(Transform,Duplex),Transform.prototype.push=function(r,t){return this._transformState.needTransform=!1,Duplex.prototype.push.call(this,r,t)},Transform.prototype._transform=function(r,t,e){throw new Error("not implemented")},Transform.prototype._write=function(r,t,e){var n=this._transformState;if(n.writecb=e,n.writechunk=r,n.writeencoding=t,!n.transforming){var a=this._readableState;(n.needTransform||a.needReadable||a.length<a.highWaterMark)&&this._read(a.highWaterMark)}},Transform.prototype._read=function(r){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0};

},{"./_stream_duplex":300,"core-util-is":53,"inherits":94}],304:[function(require,module,exports){
(function (process){
module.exports=Writable;var Buffer=require("buffer").Buffer;Writable.WritableState=WritableState;var util=require("core-util-is");util.inherits=require("inherits");var Stream=require("stream");function WriteReq(e,t,i){this.chunk=e,this.encoding=t,this.callback=i}function WritableState(e,t){var i=(e=e||{}).highWaterMark;this.highWaterMark=i||0===i?i:16384,this.objectMode=!!e.objectMode,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var r=!1===e.decodeStrings;this.decodeStrings=!r,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){onwrite(t,e)},this.writecb=null,this.writelen=0,this.buffer=[],this.errorEmitted=!1}function Writable(e){var t=require("./_stream_duplex");if(!(this instanceof Writable||this instanceof t))return new Writable(e);this._writableState=new WritableState(e,this),this.writable=!0,Stream.call(this)}function writeAfterEnd(e,t,i){var r=new Error("write after end");e.emit("error",r),process.nextTick(function(){i(r)})}function validChunk(e,t,i,r){var n=!0;if(!Buffer.isBuffer(i)&&"string"!=typeof i&&null!==i&&void 0!==i&&!t.objectMode){var f=new TypeError("Invalid non-string/buffer chunk");e.emit("error",f),process.nextTick(function(){r(f)}),n=!1}return n}function decodeChunk(e,t,i){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=new Buffer(t,i)),t}function writeOrBuffer(e,t,i,r,n){i=decodeChunk(t,i,r),Buffer.isBuffer(i)&&(r="buffer");var f=t.objectMode?1:i.length;t.length+=f;var o=t.length<t.highWaterMark;return o||(t.needDrain=!0),t.writing?t.buffer.push(new WriteReq(i,r,n)):doWrite(e,t,f,i,r,n),o}function doWrite(e,t,i,r,n,f){t.writelen=i,t.writecb=f,t.writing=!0,t.sync=!0,e._write(r,n,t.onwrite),t.sync=!1}function onwriteError(e,t,i,r,n){i?process.nextTick(function(){n(r)}):n(r),e._writableState.errorEmitted=!0,e.emit("error",r)}function onwriteStateUpdate(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function onwrite(e,t){var i=e._writableState,r=i.sync,n=i.writecb;if(onwriteStateUpdate(i),t)onwriteError(e,i,r,t,n);else{var f=needFinish(e,i);f||i.bufferProcessing||!i.buffer.length||clearBuffer(e,i),r?process.nextTick(function(){afterWrite(e,i,f,n)}):afterWrite(e,i,f,n)}}function afterWrite(e,t,i,r){i||onwriteDrain(e,t),r(),i&&finishMaybe(e,t)}function onwriteDrain(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}function clearBuffer(e,t){t.bufferProcessing=!0;for(var i=0;i<t.buffer.length;i++){var r=t.buffer[i],n=r.chunk,f=r.encoding,o=r.callback;if(doWrite(e,t,t.objectMode?1:n.length,n,f,o),t.writing){i++;break}}t.bufferProcessing=!1,i<t.buffer.length?t.buffer=t.buffer.slice(i):t.buffer.length=0}function needFinish(e,t){return t.ending&&0===t.length&&!t.finished&&!t.writing}function finishMaybe(e,t){var i=needFinish(e,t);return i&&(t.finished=!0,e.emit("finish")),i}function endWritable(e,t,i){t.ending=!0,finishMaybe(e,t),i&&(t.finished?process.nextTick(i):e.once("finish",i)),t.ended=!0}util.inherits(Writable,Stream),Writable.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},Writable.prototype.write=function(e,t,i){var r=this._writableState,n=!1;return"function"==typeof t&&(i=t,t=null),Buffer.isBuffer(e)?t="buffer":t||(t=r.defaultEncoding),"function"!=typeof i&&(i=function(){}),r.ended?writeAfterEnd(this,r,i):validChunk(this,r,e,i)&&(n=writeOrBuffer(this,r,e,t,i)),n},Writable.prototype._write=function(e,t,i){i(new Error("not implemented"))},Writable.prototype.end=function(e,t,i){var r=this._writableState;"function"==typeof e?(i=e,e=null,t=null):"function"==typeof t&&(i=t,t=null),void 0!==e&&null!==e&&this.write(e,t),r.ending||r.finished||endWritable(this,r,i)};

}).call(this,require('_process'))
},{"./_stream_duplex":300,"_process":140,"buffer":52,"core-util-is":53,"inherits":94,"stream":287}],305:[function(require,module,exports){
var Stream=require("stream");exports=module.exports=require("./lib/_stream_readable.js"),exports.Stream=Stream,exports.Readable=exports,exports.Writable=require("./lib/_stream_writable.js"),exports.Duplex=require("./lib/_stream_duplex.js"),exports.Transform=require("./lib/_stream_transform.js"),exports.PassThrough=require("./lib/_stream_passthrough.js");

},{"./lib/_stream_duplex.js":300,"./lib/_stream_passthrough.js":301,"./lib/_stream_readable.js":302,"./lib/_stream_transform.js":303,"./lib/_stream_writable.js":304,"stream":287}],306:[function(require,module,exports){
(function (global){
function deprecate(r,e){if(config("noDeprecation"))return r;var o=!1;return function(){if(!o){if(config("throwDeprecation"))throw new Error(e);config("traceDeprecation")?console.trace(e):console.warn(e),o=!0}return r.apply(this,arguments)}}function config(r){try{if(!global.localStorage)return!1}catch(r){return!1}var e=global.localStorage[r];return null!=e&&"true"===String(e).toLowerCase()}module.exports=deprecate;

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],307:[function(require,module,exports){
"function"==typeof Object.create?module.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:module.exports=function(t,e){t.super_=e;var o=function(){};o.prototype=e.prototype,t.prototype=new o,t.prototype.constructor=t};

},{}],308:[function(require,module,exports){
module.exports=function(o){return o&&"object"==typeof o&&"function"==typeof o.copy&&"function"==typeof o.fill&&"function"==typeof o.readUInt8};

},{}],309:[function(require,module,exports){
(function (process,global){
var formatRegExp=/%[sdj%]/g;exports.format=function(e){if(!isString(e)){for(var r=[],t=0;t<arguments.length;t++)r.push(inspect(arguments[t]));return r.join(" ")}t=1;for(var n=arguments,i=n.length,o=String(e).replace(formatRegExp,function(e){if("%%"===e)return"%";if(t>=i)return e;switch(e){case"%s":return String(n[t++]);case"%d":return Number(n[t++]);case"%j":try{return JSON.stringify(n[t++])}catch(e){return"[Circular]"}default:return e}}),s=n[t];t<i;s=n[++t])isNull(s)||!isObject(s)?o+=" "+s:o+=" "+inspect(s);return o},exports.deprecate=function(e,r){if(isUndefined(global.process))return function(){return exports.deprecate(e,r).apply(this,arguments)};if(!0===process.noDeprecation)return e;var t=!1;return function(){if(!t){if(process.throwDeprecation)throw new Error(r);process.traceDeprecation?console.trace(r):console.error(r),t=!0}return e.apply(this,arguments)}};var debugEnviron,debugs={};function inspect(e,r){var t={seen:[],stylize:stylizeNoColor};return arguments.length>=3&&(t.depth=arguments[2]),arguments.length>=4&&(t.colors=arguments[3]),isBoolean(r)?t.showHidden=r:r&&exports._extend(t,r),isUndefined(t.showHidden)&&(t.showHidden=!1),isUndefined(t.depth)&&(t.depth=2),isUndefined(t.colors)&&(t.colors=!1),isUndefined(t.customInspect)&&(t.customInspect=!0),t.colors&&(t.stylize=stylizeWithColor),formatValue(t,e,t.depth)}function stylizeWithColor(e,r){var t=inspect.styles[r];return t?"["+inspect.colors[t][0]+"m"+e+"["+inspect.colors[t][1]+"m":e}function stylizeNoColor(e,r){return e}function arrayToHash(e){var r={};return e.forEach(function(e,t){r[e]=!0}),r}function formatValue(e,r,t){if(e.customInspect&&r&&isFunction(r.inspect)&&r.inspect!==exports.inspect&&(!r.constructor||r.constructor.prototype!==r)){var n=r.inspect(t,e);return isString(n)||(n=formatValue(e,n,t)),n}var i=formatPrimitive(e,r);if(i)return i;var o=Object.keys(r),s=arrayToHash(o);if(e.showHidden&&(o=Object.getOwnPropertyNames(r)),isError(r)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return formatError(r);if(0===o.length){if(isFunction(r)){var u=r.name?": "+r.name:"";return e.stylize("[Function"+u+"]","special")}if(isRegExp(r))return e.stylize(RegExp.prototype.toString.call(r),"regexp");if(isDate(r))return e.stylize(Date.prototype.toString.call(r),"date");if(isError(r))return formatError(r)}var c,a="",l=!1,p=["{","}"];(isArray(r)&&(l=!0,p=["[","]"]),isFunction(r))&&(a=" [Function"+(r.name?": "+r.name:"")+"]");return isRegExp(r)&&(a=" "+RegExp.prototype.toString.call(r)),isDate(r)&&(a=" "+Date.prototype.toUTCString.call(r)),isError(r)&&(a=" "+formatError(r)),0!==o.length||l&&0!=r.length?t<0?isRegExp(r)?e.stylize(RegExp.prototype.toString.call(r),"regexp"):e.stylize("[Object]","special"):(e.seen.push(r),c=l?formatArray(e,r,t,s,o):o.map(function(n){return formatProperty(e,r,t,s,n,l)}),e.seen.pop(),reduceToSingleString(c,a,p)):p[0]+a+p[1]}function formatPrimitive(e,r){if(isUndefined(r))return e.stylize("undefined","undefined");if(isString(r)){var t="'"+JSON.stringify(r).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(t,"string")}return isNumber(r)?e.stylize(""+r,"number"):isBoolean(r)?e.stylize(""+r,"boolean"):isNull(r)?e.stylize("null","null"):void 0}function formatError(e){return"["+Error.prototype.toString.call(e)+"]"}function formatArray(e,r,t,n,i){for(var o=[],s=0,u=r.length;s<u;++s)hasOwnProperty(r,String(s))?o.push(formatProperty(e,r,t,n,String(s),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(formatProperty(e,r,t,n,i,!0))}),o}function formatProperty(e,r,t,n,i,o){var s,u,c;if((c=Object.getOwnPropertyDescriptor(r,i)||{value:r[i]}).get?u=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(u=e.stylize("[Setter]","special")),hasOwnProperty(n,i)||(s="["+i+"]"),u||(e.seen.indexOf(c.value)<0?(u=isNull(t)?formatValue(e,c.value,null):formatValue(e,c.value,t-1)).indexOf("\n")>-1&&(u=o?u.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+u.split("\n").map(function(e){return"   "+e}).join("\n")):u=e.stylize("[Circular]","special")),isUndefined(s)){if(o&&i.match(/^\d+$/))return u;(s=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+u}function reduceToSingleString(e,r,t){return e.reduce(function(e,r){return 0,r.indexOf("\n")>=0&&0,e+r.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?t[0]+(""===r?"":r+"\n ")+" "+e.join(",\n  ")+" "+t[1]:t[0]+r+" "+e.join(", ")+" "+t[1]}function isArray(e){return Array.isArray(e)}function isBoolean(e){return"boolean"==typeof e}function isNull(e){return null===e}function isNullOrUndefined(e){return null==e}function isNumber(e){return"number"==typeof e}function isString(e){return"string"==typeof e}function isSymbol(e){return"symbol"==typeof e}function isUndefined(e){return void 0===e}function isRegExp(e){return isObject(e)&&"[object RegExp]"===objectToString(e)}function isObject(e){return"object"==typeof e&&null!==e}function isDate(e){return isObject(e)&&"[object Date]"===objectToString(e)}function isError(e){return isObject(e)&&("[object Error]"===objectToString(e)||e instanceof Error)}function isFunction(e){return"function"==typeof e}function isPrimitive(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e}function objectToString(e){return Object.prototype.toString.call(e)}function pad(e){return e<10?"0"+e.toString(10):e.toString(10)}exports.debuglog=function(e){if(isUndefined(debugEnviron)&&(debugEnviron=process.env.NODE_DEBUG||""),e=e.toUpperCase(),!debugs[e])if(new RegExp("\\b"+e+"\\b","i").test(debugEnviron)){var r=process.pid;debugs[e]=function(){var t=exports.format.apply(exports,arguments);console.error("%s %d: %s",e,r,t)}}else debugs[e]=function(){};return debugs[e]},exports.inspect=inspect,inspect.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},inspect.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},exports.isArray=isArray,exports.isBoolean=isBoolean,exports.isNull=isNull,exports.isNullOrUndefined=isNullOrUndefined,exports.isNumber=isNumber,exports.isString=isString,exports.isSymbol=isSymbol,exports.isUndefined=isUndefined,exports.isRegExp=isRegExp,exports.isObject=isObject,exports.isDate=isDate,exports.isError=isError,exports.isFunction=isFunction,exports.isPrimitive=isPrimitive,exports.isBuffer=require("./support/isBuffer");var months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function timestamp(){var e=new Date,r=[pad(e.getHours()),pad(e.getMinutes()),pad(e.getSeconds())].join(":");return[e.getDate(),months[e.getMonth()],r].join(" ")}function hasOwnProperty(e,r){return Object.prototype.hasOwnProperty.call(e,r)}exports.log=function(){console.log("%s - %s",timestamp(),exports.format.apply(exports,arguments))},exports.inherits=require("inherits"),exports._extend=function(e,r){if(!r||!isObject(r))return e;for(var t=Object.keys(r),n=t.length;n--;)e[t[n]]=r[t[n]];return e};

}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"./support/isBuffer":308,"_process":140,"inherits":307}],310:[function(require,module,exports){
"use strict";function pop(e,s,a){var r=a[a.length-1];e===r.element&&(a.pop(),r=a[a.length-1]);var p=r.element,n=r.index;if(Array.isArray(p))p.push(e);else if(n===s.length-2){p[s.pop()]=e}else s.push(e)}exports.stringify=function(e){var s=[];s.push({obj:e});for(var a,r,p,n,t,o,l,i,c,f,u="";a=s.pop();)if(r=a.obj,u+=a.prefix||"",p=a.val||"")u+=p;else if("object"!=typeof r)u+=void 0===r?null:JSON.stringify(r);else if(null===r)u+="null";else if(Array.isArray(r)){for(s.push({val:"]"}),n=r.length-1;n>=0;n--)t=0===n?"":",",s.push({obj:r[n],prefix:t});s.push({val:"["})}else{for(l in o=[],r)r.hasOwnProperty(l)&&o.push(l);for(s.push({val:"}"}),n=o.length-1;n>=0;n--)c=r[i=o[n]],f=n>0?",":"",f+=JSON.stringify(i)+":",s.push({obj:c,prefix:f});s.push({val:"{"})}return u},exports.parse=function(e){for(var s,a,r,p,n,t,o,l,i,c=[],f=[],u=0;;)if("}"!==(s=e[u++])&&"]"!==s&&void 0!==s)switch(s){case" ":case"\t":case"\n":case":":case",":break;case"n":u+=3,pop(null,c,f);break;case"t":u+=3,pop(!0,c,f);break;case"f":u+=4,pop(!1,c,f);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(a="",u--;;){if(r=e[u++],!/[\d\.\-e\+]/.test(r)){u--;break}a+=r}pop(parseFloat(a),c,f);break;case'"':for(p="",n=void 0,t=0;'"'!==(o=e[u++])||"\\"===n&&t%2==1;)p+=o,"\\"===(n=o)?t++:t=0;pop(JSON.parse('"'+p+'"'),c,f);break;case"[":l={element:[],index:c.length},c.push(l.element),f.push(l);break;case"{":i={element:{},index:c.length},c.push(i.element),f.push(i);break;default:throw new Error("unexpectedly reached end of input: "+s)}else{if(1===c.length)return c.pop();pop(c.pop(),c,f)}};

},{}],311:[function(require,module,exports){
module.exports=extend;var hasOwnProperty=Object.prototype.hasOwnProperty;function extend(){for(var r={},e=0;e<arguments.length;e++){var t=arguments[e];for(var n in t)hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r}

},{}]},{},[2]);
